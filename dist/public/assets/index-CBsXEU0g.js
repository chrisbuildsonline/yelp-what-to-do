function sA(s,c){for(var p=0;p<c.length;p++){const _=c[p];if(typeof _!="string"&&!Array.isArray(_)){for(const S in _)if(S!=="default"&&!(S in s)){const A=Object.getOwnPropertyDescriptor(_,S);A&&Object.defineProperty(s,S,A.get?A:{enumerable:!0,get:()=>_[S]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const S of document.querySelectorAll('link[rel="modulepreload"]'))_(S);new MutationObserver(S=>{for(const A of S)if(A.type==="childList")for(const T of A.addedNodes)T.tagName==="LINK"&&T.rel==="modulepreload"&&_(T)}).observe(document,{childList:!0,subtree:!0});function p(S){const A={};return S.integrity&&(A.integrity=S.integrity),S.referrerPolicy&&(A.referrerPolicy=S.referrerPolicy),S.crossOrigin==="use-credentials"?A.credentials="include":S.crossOrigin==="anonymous"?A.credentials="omit":A.credentials="same-origin",A}function _(S){if(S.ep)return;S.ep=!0;const A=p(S);fetch(S.href,A)}})();function m0(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Gv={exports:{}},Ig={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jb;function aA(){if(jb)return Ig;jb=1;var s=Symbol.for("react.transitional.element"),c=Symbol.for("react.fragment");function p(_,S,A){var T=null;if(A!==void 0&&(T=""+A),S.key!==void 0&&(T=""+S.key),"key"in S){A={};for(var u in S)u!=="key"&&(A[u]=S[u])}else A=S;return S=A.ref,{$$typeof:s,type:_,key:T,ref:S!==void 0?S:null,props:A}}return Ig.Fragment=c,Ig.jsx=p,Ig.jsxs=p,Ig}var Bb;function oA(){return Bb||(Bb=1,Gv.exports=aA()),Gv.exports}var F=oA(),qv={exports:{}},zg={},Zv={exports:{}},$v={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vb;function lA(){return Vb||(Vb=1,(function(s){function c(jt,Qt){var Gt=jt.length;jt.push(Qt);t:for(;0<Gt;){var we=Gt-1>>>1,He=jt[we];if(0<S(He,Qt))jt[we]=Qt,jt[Gt]=He,Gt=we;else break t}}function p(jt){return jt.length===0?null:jt[0]}function _(jt){if(jt.length===0)return null;var Qt=jt[0],Gt=jt.pop();if(Gt!==Qt){jt[0]=Gt;t:for(var we=0,He=jt.length,Rt=He>>>1;we<Rt;){var se=2*(we+1)-1,be=jt[se],Te=se+1,Ze=jt[Te];if(0>S(be,Gt))Te<He&&0>S(Ze,be)?(jt[we]=Ze,jt[Te]=Gt,we=Te):(jt[we]=be,jt[se]=Gt,we=se);else if(Te<He&&0>S(Ze,Gt))jt[we]=Ze,jt[Te]=Gt,we=Te;else break t}}return Qt}function S(jt,Qt){var Gt=jt.sortIndex-Qt.sortIndex;return Gt!==0?Gt:jt.id-Qt.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var A=performance;s.unstable_now=function(){return A.now()}}else{var T=Date,u=T.now();s.unstable_now=function(){return T.now()-u}}var L=[],k=[],B=1,H=null,W=3,it=!1,pt=!1,rt=!1,J=!1,mt=typeof setTimeout=="function"?setTimeout:null,Et=typeof clearTimeout=="function"?clearTimeout:null,bt=typeof setImmediate<"u"?setImmediate:null;function Lt(jt){for(var Qt=p(k);Qt!==null;){if(Qt.callback===null)_(k);else if(Qt.startTime<=jt)_(k),Qt.sortIndex=Qt.expirationTime,c(L,Qt);else break;Qt=p(k)}}function Ot(jt){if(rt=!1,Lt(jt),!pt)if(p(L)!==null)pt=!0,ee||(ee=!0,ze());else{var Qt=p(k);Qt!==null&&me(Ot,Qt.startTime-jt)}}var ee=!1,Nt=-1,Kt=5,xe=-1;function Ae(){return J?!0:!(s.unstable_now()-xe<Kt)}function ae(){if(J=!1,ee){var jt=s.unstable_now();xe=jt;var Qt=!0;try{t:{pt=!1,rt&&(rt=!1,Et(Nt),Nt=-1),it=!0;var Gt=W;try{e:{for(Lt(jt),H=p(L);H!==null&&!(H.expirationTime>jt&&Ae());){var we=H.callback;if(typeof we=="function"){H.callback=null,W=H.priorityLevel;var He=we(H.expirationTime<=jt);if(jt=s.unstable_now(),typeof He=="function"){H.callback=He,Lt(jt),Qt=!0;break e}H===p(L)&&_(L),Lt(jt)}else _(L);H=p(L)}if(H!==null)Qt=!0;else{var Rt=p(k);Rt!==null&&me(Ot,Rt.startTime-jt),Qt=!1}}break t}finally{H=null,W=Gt,it=!1}Qt=void 0}}finally{Qt?ze():ee=!1}}}var ze;if(typeof bt=="function")ze=function(){bt(ae)};else if(typeof MessageChannel<"u"){var We=new MessageChannel,Ee=We.port2;We.port1.onmessage=ae,ze=function(){Ee.postMessage(null)}}else ze=function(){mt(ae,0)};function me(jt,Qt){Nt=mt(function(){jt(s.unstable_now())},Qt)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(jt){jt.callback=null},s.unstable_forceFrameRate=function(jt){0>jt||125<jt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Kt=0<jt?Math.floor(1e3/jt):5},s.unstable_getCurrentPriorityLevel=function(){return W},s.unstable_next=function(jt){switch(W){case 1:case 2:case 3:var Qt=3;break;default:Qt=W}var Gt=W;W=Qt;try{return jt()}finally{W=Gt}},s.unstable_requestPaint=function(){J=!0},s.unstable_runWithPriority=function(jt,Qt){switch(jt){case 1:case 2:case 3:case 4:case 5:break;default:jt=3}var Gt=W;W=jt;try{return Qt()}finally{W=Gt}},s.unstable_scheduleCallback=function(jt,Qt,Gt){var we=s.unstable_now();switch(typeof Gt=="object"&&Gt!==null?(Gt=Gt.delay,Gt=typeof Gt=="number"&&0<Gt?we+Gt:we):Gt=we,jt){case 1:var He=-1;break;case 2:He=250;break;case 5:He=1073741823;break;case 4:He=1e4;break;default:He=5e3}return He=Gt+He,jt={id:B++,callback:Qt,priorityLevel:jt,startTime:Gt,expirationTime:He,sortIndex:-1},Gt>we?(jt.sortIndex=Gt,c(k,jt),p(L)===null&&jt===p(k)&&(rt?(Et(Nt),Nt=-1):rt=!0,me(Ot,Gt-we))):(jt.sortIndex=He,c(L,jt),pt||it||(pt=!0,ee||(ee=!0,ze()))),jt},s.unstable_shouldYield=Ae,s.unstable_wrapCallback=function(jt){var Qt=W;return function(){var Gt=W;W=Qt;try{return jt.apply(this,arguments)}finally{W=Gt}}}})($v)),$v}var Ub;function cA(){return Ub||(Ub=1,Zv.exports=lA()),Zv.exports}var Hv={exports:{}},pn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gb;function uA(){if(Gb)return pn;Gb=1;var s=Symbol.for("react.transitional.element"),c=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),A=Symbol.for("react.consumer"),T=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),k=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),H=Symbol.for("react.activity"),W=Symbol.iterator;function it(Rt){return Rt===null||typeof Rt!="object"?null:(Rt=W&&Rt[W]||Rt["@@iterator"],typeof Rt=="function"?Rt:null)}var pt={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},rt=Object.assign,J={};function mt(Rt,se,be){this.props=Rt,this.context=se,this.refs=J,this.updater=be||pt}mt.prototype.isReactComponent={},mt.prototype.setState=function(Rt,se){if(typeof Rt!="object"&&typeof Rt!="function"&&Rt!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Rt,se,"setState")},mt.prototype.forceUpdate=function(Rt){this.updater.enqueueForceUpdate(this,Rt,"forceUpdate")};function Et(){}Et.prototype=mt.prototype;function bt(Rt,se,be){this.props=Rt,this.context=se,this.refs=J,this.updater=be||pt}var Lt=bt.prototype=new Et;Lt.constructor=bt,rt(Lt,mt.prototype),Lt.isPureReactComponent=!0;var Ot=Array.isArray;function ee(){}var Nt={H:null,A:null,T:null,S:null},Kt=Object.prototype.hasOwnProperty;function xe(Rt,se,be){var Te=be.ref;return{$$typeof:s,type:Rt,key:se,ref:Te!==void 0?Te:null,props:be}}function Ae(Rt,se){return xe(Rt.type,se,Rt.props)}function ae(Rt){return typeof Rt=="object"&&Rt!==null&&Rt.$$typeof===s}function ze(Rt){var se={"=":"=0",":":"=2"};return"$"+Rt.replace(/[=:]/g,function(be){return se[be]})}var We=/\/+/g;function Ee(Rt,se){return typeof Rt=="object"&&Rt!==null&&Rt.key!=null?ze(""+Rt.key):se.toString(36)}function me(Rt){switch(Rt.status){case"fulfilled":return Rt.value;case"rejected":throw Rt.reason;default:switch(typeof Rt.status=="string"?Rt.then(ee,ee):(Rt.status="pending",Rt.then(function(se){Rt.status==="pending"&&(Rt.status="fulfilled",Rt.value=se)},function(se){Rt.status==="pending"&&(Rt.status="rejected",Rt.reason=se)})),Rt.status){case"fulfilled":return Rt.value;case"rejected":throw Rt.reason}}throw Rt}function jt(Rt,se,be,Te,Ze){var $e=typeof Rt;($e==="undefined"||$e==="boolean")&&(Rt=null);var Le=!1;if(Rt===null)Le=!0;else switch($e){case"bigint":case"string":case"number":Le=!0;break;case"object":switch(Rt.$$typeof){case s:case c:Le=!0;break;case B:return Le=Rt._init,jt(Le(Rt._payload),se,be,Te,Ze)}}if(Le)return Ze=Ze(Rt),Le=Te===""?"."+Ee(Rt,0):Te,Ot(Ze)?(be="",Le!=null&&(be=Le.replace(We,"$&/")+"/"),jt(Ze,se,be,"",function(Gi){return Gi})):Ze!=null&&(ae(Ze)&&(Ze=Ae(Ze,be+(Ze.key==null||Rt&&Rt.key===Ze.key?"":(""+Ze.key).replace(We,"$&/")+"/")+Le)),se.push(Ze)),1;Le=0;var yn=Te===""?".":Te+":";if(Ot(Rt))for(var Mn=0;Mn<Rt.length;Mn++)Te=Rt[Mn],$e=yn+Ee(Te,Mn),Le+=jt(Te,se,be,$e,Ze);else if(Mn=it(Rt),typeof Mn=="function")for(Rt=Mn.call(Rt),Mn=0;!(Te=Rt.next()).done;)Te=Te.value,$e=yn+Ee(Te,Mn++),Le+=jt(Te,se,be,$e,Ze);else if($e==="object"){if(typeof Rt.then=="function")return jt(me(Rt),se,be,Te,Ze);throw se=String(Rt),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(Rt).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return Le}function Qt(Rt,se,be){if(Rt==null)return Rt;var Te=[],Ze=0;return jt(Rt,Te,"","",function($e){return se.call(be,$e,Ze++)}),Te}function Gt(Rt){if(Rt._status===-1){var se=Rt._result;se=se(),se.then(function(be){(Rt._status===0||Rt._status===-1)&&(Rt._status=1,Rt._result=be)},function(be){(Rt._status===0||Rt._status===-1)&&(Rt._status=2,Rt._result=be)}),Rt._status===-1&&(Rt._status=0,Rt._result=se)}if(Rt._status===1)return Rt._result.default;throw Rt._result}var we=typeof reportError=="function"?reportError:function(Rt){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Rt=="object"&&Rt!==null&&typeof Rt.message=="string"?String(Rt.message):String(Rt),error:Rt});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Rt);return}console.error(Rt)},He={map:Qt,forEach:function(Rt,se,be){Qt(Rt,function(){se.apply(this,arguments)},be)},count:function(Rt){var se=0;return Qt(Rt,function(){se++}),se},toArray:function(Rt){return Qt(Rt,function(se){return se})||[]},only:function(Rt){if(!ae(Rt))throw Error("React.Children.only expected to receive a single React element child.");return Rt}};return pn.Activity=H,pn.Children=He,pn.Component=mt,pn.Fragment=p,pn.Profiler=S,pn.PureComponent=bt,pn.StrictMode=_,pn.Suspense=L,pn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Nt,pn.__COMPILER_RUNTIME={__proto__:null,c:function(Rt){return Nt.H.useMemoCache(Rt)}},pn.cache=function(Rt){return function(){return Rt.apply(null,arguments)}},pn.cacheSignal=function(){return null},pn.cloneElement=function(Rt,se,be){if(Rt==null)throw Error("The argument must be a React element, but you passed "+Rt+".");var Te=rt({},Rt.props),Ze=Rt.key;if(se!=null)for($e in se.key!==void 0&&(Ze=""+se.key),se)!Kt.call(se,$e)||$e==="key"||$e==="__self"||$e==="__source"||$e==="ref"&&se.ref===void 0||(Te[$e]=se[$e]);var $e=arguments.length-2;if($e===1)Te.children=be;else if(1<$e){for(var Le=Array($e),yn=0;yn<$e;yn++)Le[yn]=arguments[yn+2];Te.children=Le}return xe(Rt.type,Ze,Te)},pn.createContext=function(Rt){return Rt={$$typeof:T,_currentValue:Rt,_currentValue2:Rt,_threadCount:0,Provider:null,Consumer:null},Rt.Provider=Rt,Rt.Consumer={$$typeof:A,_context:Rt},Rt},pn.createElement=function(Rt,se,be){var Te,Ze={},$e=null;if(se!=null)for(Te in se.key!==void 0&&($e=""+se.key),se)Kt.call(se,Te)&&Te!=="key"&&Te!=="__self"&&Te!=="__source"&&(Ze[Te]=se[Te]);var Le=arguments.length-2;if(Le===1)Ze.children=be;else if(1<Le){for(var yn=Array(Le),Mn=0;Mn<Le;Mn++)yn[Mn]=arguments[Mn+2];Ze.children=yn}if(Rt&&Rt.defaultProps)for(Te in Le=Rt.defaultProps,Le)Ze[Te]===void 0&&(Ze[Te]=Le[Te]);return xe(Rt,$e,Ze)},pn.createRef=function(){return{current:null}},pn.forwardRef=function(Rt){return{$$typeof:u,render:Rt}},pn.isValidElement=ae,pn.lazy=function(Rt){return{$$typeof:B,_payload:{_status:-1,_result:Rt},_init:Gt}},pn.memo=function(Rt,se){return{$$typeof:k,type:Rt,compare:se===void 0?null:se}},pn.startTransition=function(Rt){var se=Nt.T,be={};Nt.T=be;try{var Te=Rt(),Ze=Nt.S;Ze!==null&&Ze(be,Te),typeof Te=="object"&&Te!==null&&typeof Te.then=="function"&&Te.then(ee,we)}catch($e){we($e)}finally{se!==null&&be.types!==null&&(se.types=be.types),Nt.T=se}},pn.unstable_useCacheRefresh=function(){return Nt.H.useCacheRefresh()},pn.use=function(Rt){return Nt.H.use(Rt)},pn.useActionState=function(Rt,se,be){return Nt.H.useActionState(Rt,se,be)},pn.useCallback=function(Rt,se){return Nt.H.useCallback(Rt,se)},pn.useContext=function(Rt){return Nt.H.useContext(Rt)},pn.useDebugValue=function(){},pn.useDeferredValue=function(Rt,se){return Nt.H.useDeferredValue(Rt,se)},pn.useEffect=function(Rt,se){return Nt.H.useEffect(Rt,se)},pn.useEffectEvent=function(Rt){return Nt.H.useEffectEvent(Rt)},pn.useId=function(){return Nt.H.useId()},pn.useImperativeHandle=function(Rt,se,be){return Nt.H.useImperativeHandle(Rt,se,be)},pn.useInsertionEffect=function(Rt,se){return Nt.H.useInsertionEffect(Rt,se)},pn.useLayoutEffect=function(Rt,se){return Nt.H.useLayoutEffect(Rt,se)},pn.useMemo=function(Rt,se){return Nt.H.useMemo(Rt,se)},pn.useOptimistic=function(Rt,se){return Nt.H.useOptimistic(Rt,se)},pn.useReducer=function(Rt,se,be){return Nt.H.useReducer(Rt,se,be)},pn.useRef=function(Rt){return Nt.H.useRef(Rt)},pn.useState=function(Rt){return Nt.H.useState(Rt)},pn.useSyncExternalStore=function(Rt,se,be){return Nt.H.useSyncExternalStore(Rt,se,be)},pn.useTransition=function(){return Nt.H.useTransition()},pn.version="19.2.0",pn}var qb;function $_(){return qb||(qb=1,Hv.exports=uA()),Hv.exports}var Xv={exports:{}},Fs={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zb;function hA(){if(Zb)return Fs;Zb=1;var s=$_();function c(L){var k="https://react.dev/errors/"+L;if(1<arguments.length){k+="?args[]="+encodeURIComponent(arguments[1]);for(var B=2;B<arguments.length;B++)k+="&args[]="+encodeURIComponent(arguments[B])}return"Minified React error #"+L+"; visit "+k+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function p(){}var _={d:{f:p,r:function(){throw Error(c(522))},D:p,C:p,L:p,m:p,X:p,S:p,M:p},p:0,findDOMNode:null},S=Symbol.for("react.portal");function A(L,k,B){var H=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:S,key:H==null?null:""+H,children:L,containerInfo:k,implementation:B}}var T=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(L,k){if(L==="font")return"";if(typeof k=="string")return k==="use-credentials"?k:""}return Fs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=_,Fs.createPortal=function(L,k){var B=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!k||k.nodeType!==1&&k.nodeType!==9&&k.nodeType!==11)throw Error(c(299));return A(L,k,null,B)},Fs.flushSync=function(L){var k=T.T,B=_.p;try{if(T.T=null,_.p=2,L)return L()}finally{T.T=k,_.p=B,_.d.f()}},Fs.preconnect=function(L,k){typeof L=="string"&&(k?(k=k.crossOrigin,k=typeof k=="string"?k==="use-credentials"?k:"":void 0):k=null,_.d.C(L,k))},Fs.prefetchDNS=function(L){typeof L=="string"&&_.d.D(L)},Fs.preinit=function(L,k){if(typeof L=="string"&&k&&typeof k.as=="string"){var B=k.as,H=u(B,k.crossOrigin),W=typeof k.integrity=="string"?k.integrity:void 0,it=typeof k.fetchPriority=="string"?k.fetchPriority:void 0;B==="style"?_.d.S(L,typeof k.precedence=="string"?k.precedence:void 0,{crossOrigin:H,integrity:W,fetchPriority:it}):B==="script"&&_.d.X(L,{crossOrigin:H,integrity:W,fetchPriority:it,nonce:typeof k.nonce=="string"?k.nonce:void 0})}},Fs.preinitModule=function(L,k){if(typeof L=="string")if(typeof k=="object"&&k!==null){if(k.as==null||k.as==="script"){var B=u(k.as,k.crossOrigin);_.d.M(L,{crossOrigin:B,integrity:typeof k.integrity=="string"?k.integrity:void 0,nonce:typeof k.nonce=="string"?k.nonce:void 0})}}else k==null&&_.d.M(L)},Fs.preload=function(L,k){if(typeof L=="string"&&typeof k=="object"&&k!==null&&typeof k.as=="string"){var B=k.as,H=u(B,k.crossOrigin);_.d.L(L,B,{crossOrigin:H,integrity:typeof k.integrity=="string"?k.integrity:void 0,nonce:typeof k.nonce=="string"?k.nonce:void 0,type:typeof k.type=="string"?k.type:void 0,fetchPriority:typeof k.fetchPriority=="string"?k.fetchPriority:void 0,referrerPolicy:typeof k.referrerPolicy=="string"?k.referrerPolicy:void 0,imageSrcSet:typeof k.imageSrcSet=="string"?k.imageSrcSet:void 0,imageSizes:typeof k.imageSizes=="string"?k.imageSizes:void 0,media:typeof k.media=="string"?k.media:void 0})}},Fs.preloadModule=function(L,k){if(typeof L=="string")if(k){var B=u(k.as,k.crossOrigin);_.d.m(L,{as:typeof k.as=="string"&&k.as!=="script"?k.as:void 0,crossOrigin:B,integrity:typeof k.integrity=="string"?k.integrity:void 0})}else _.d.m(L)},Fs.requestFormReset=function(L){_.d.r(L)},Fs.unstable_batchedUpdates=function(L,k){return L(k)},Fs.useFormState=function(L,k,B){return T.H.useFormState(L,k,B)},Fs.useFormStatus=function(){return T.H.useHostTransitionStatus()},Fs.version="19.2.0",Fs}var $b;function uT(){if($b)return Xv.exports;$b=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(c){console.error(c)}}return s(),Xv.exports=hA(),Xv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hb;function dA(){if(Hb)return zg;Hb=1;var s=cA(),c=$_(),p=uT();function _(i){var o="https://react.dev/errors/"+i;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)o+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function S(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function A(i){var o=i,f=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(f=o.return),i=o.return;while(i)}return o.tag===3?f:null}function T(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function u(i){if(i.tag===31){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function L(i){if(A(i)!==i)throw Error(_(188))}function k(i){var o=i.alternate;if(!o){if(o=A(i),o===null)throw Error(_(188));return o!==i?null:i}for(var f=i,b=o;;){var M=f.return;if(M===null)break;var I=M.alternate;if(I===null){if(b=M.return,b!==null){f=b;continue}break}if(M.child===I.child){for(I=M.child;I;){if(I===f)return L(M),i;if(I===b)return L(M),o;I=I.sibling}throw Error(_(188))}if(f.return!==b.return)f=M,b=I;else{for(var X=!1,ot=M.child;ot;){if(ot===f){X=!0,f=M,b=I;break}if(ot===b){X=!0,b=M,f=I;break}ot=ot.sibling}if(!X){for(ot=I.child;ot;){if(ot===f){X=!0,f=I,b=M;break}if(ot===b){X=!0,b=I,f=M;break}ot=ot.sibling}if(!X)throw Error(_(189))}}if(f.alternate!==b)throw Error(_(190))}if(f.tag!==3)throw Error(_(188));return f.stateNode.current===f?i:o}function B(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i;for(i=i.child;i!==null;){if(o=B(i),o!==null)return o;i=i.sibling}return null}var H=Object.assign,W=Symbol.for("react.element"),it=Symbol.for("react.transitional.element"),pt=Symbol.for("react.portal"),rt=Symbol.for("react.fragment"),J=Symbol.for("react.strict_mode"),mt=Symbol.for("react.profiler"),Et=Symbol.for("react.consumer"),bt=Symbol.for("react.context"),Lt=Symbol.for("react.forward_ref"),Ot=Symbol.for("react.suspense"),ee=Symbol.for("react.suspense_list"),Nt=Symbol.for("react.memo"),Kt=Symbol.for("react.lazy"),xe=Symbol.for("react.activity"),Ae=Symbol.for("react.memo_cache_sentinel"),ae=Symbol.iterator;function ze(i){return i===null||typeof i!="object"?null:(i=ae&&i[ae]||i["@@iterator"],typeof i=="function"?i:null)}var We=Symbol.for("react.client.reference");function Ee(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===We?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case rt:return"Fragment";case mt:return"Profiler";case J:return"StrictMode";case Ot:return"Suspense";case ee:return"SuspenseList";case xe:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case pt:return"Portal";case bt:return i.displayName||"Context";case Et:return(i._context.displayName||"Context")+".Consumer";case Lt:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Nt:return o=i.displayName||null,o!==null?o:Ee(i.type)||"Memo";case Kt:o=i._payload,i=i._init;try{return Ee(i(o))}catch{}}return null}var me=Array.isArray,jt=c.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Qt=p.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Gt={pending:!1,data:null,method:null,action:null},we=[],He=-1;function Rt(i){return{current:i}}function se(i){0>He||(i.current=we[He],we[He]=null,He--)}function be(i,o){He++,we[He]=i.current,i.current=o}var Te=Rt(null),Ze=Rt(null),$e=Rt(null),Le=Rt(null);function yn(i,o){switch(be($e,o),be(Ze,i),be(Te,null),o.nodeType){case 9:case 11:i=(i=o.documentElement)&&(i=i.namespaceURI)?lg(i):0;break;default:if(i=o.tagName,o=o.namespaceURI)o=lg(o),i=Lp(o,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}se(Te),be(Te,i)}function Mn(){se(Te),se(Ze),se($e)}function Gi(i){i.memoizedState!==null&&be(Le,i);var o=Te.current,f=Lp(o,i.type);o!==f&&(be(Ze,i),be(Te,f))}function br(i){Ze.current===i&&(se(Te),se(Ze)),Le.current===i&&(se(Le),Ku._currentValue=Gt)}var Ci,Vs;function Nn(i){if(Ci===void 0)try{throw Error()}catch(f){var o=f.stack.trim().match(/\n( *(at )?)/);Ci=o&&o[1]||"",Vs=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ci+i+Vs}var os=!1;function Ts(i,o){if(!i||os)return"";os=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var b={DetermineComponentFrameRoot:function(){try{if(o){var fe=function(){throw Error()};if(Object.defineProperty(fe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(fe,[])}catch(ne){var Jt=ne}Reflect.construct(i,[],fe)}else{try{fe.call()}catch(ne){Jt=ne}i.call(fe.prototype)}}else{try{throw Error()}catch(ne){Jt=ne}(fe=i())&&typeof fe.catch=="function"&&fe.catch(function(){})}}catch(ne){if(ne&&Jt&&typeof ne.stack=="string")return[ne.stack,Jt.stack]}return[null,null]}};b.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var M=Object.getOwnPropertyDescriptor(b.DetermineComponentFrameRoot,"name");M&&M.configurable&&Object.defineProperty(b.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var I=b.DetermineComponentFrameRoot(),X=I[0],ot=I[1];if(X&&ot){var Mt=X.split(`
`),Yt=ot.split(`
`);for(M=b=0;b<Mt.length&&!Mt[b].includes("DetermineComponentFrameRoot");)b++;for(;M<Yt.length&&!Yt[M].includes("DetermineComponentFrameRoot");)M++;if(b===Mt.length||M===Yt.length)for(b=Mt.length-1,M=Yt.length-1;1<=b&&0<=M&&Mt[b]!==Yt[M];)M--;for(;1<=b&&0<=M;b--,M--)if(Mt[b]!==Yt[M]){if(b!==1||M!==1)do if(b--,M--,0>M||Mt[b]!==Yt[M]){var le=`
`+Mt[b].replace(" at new "," at ");return i.displayName&&le.includes("<anonymous>")&&(le=le.replace("<anonymous>",i.displayName)),le}while(1<=b&&0<=M);break}}}finally{os=!1,Error.prepareStackTrace=f}return(f=i?i.displayName||i.name:"")?Nn(f):""}function ui(i,o){switch(i.tag){case 26:case 27:case 5:return Nn(i.type);case 16:return Nn("Lazy");case 13:return i.child!==o&&o!==null?Nn("Suspense Fallback"):Nn("Suspense");case 19:return Nn("SuspenseList");case 0:case 15:return Ts(i.type,!1);case 11:return Ts(i.type.render,!1);case 1:return Ts(i.type,!0);case 31:return Nn("Activity");default:return""}}function Us(i){try{var o="",f=null;do o+=ui(i,f),f=i,i=i.return;while(i);return o}catch(b){return`
Error generating stack: `+b.message+`
`+b.stack}}var Ss=Object.prototype.hasOwnProperty,To=s.unstable_scheduleCallback,da=s.unstable_cancelCallback,fa=s.unstable_shouldYield,So=s.unstable_requestPaint,qi=s.unstable_now,Hr=s.unstable_getCurrentPriorityLevel,nc=s.unstable_ImmediatePriority,ic=s.unstable_UserBlockingPriority,pa=s.unstable_NormalPriority,rc=s.unstable_LowPriority,Ga=s.unstable_IdlePriority,sc=s.log,ol=s.unstable_setDisableYieldValue,Ir=null,ri=null;function Ct(i){if(typeof sc=="function"&&ol(i),ri&&typeof ri.setStrictMode=="function")try{ri.setStrictMode(Ir,i)}catch{}}var K=Math.clz32?Math.clz32:vt,et=Math.log,st=Math.LN2;function vt(i){return i>>>=0,i===0?32:31-(et(i)/st|0)|0}var wt=256,Ft=262144,ht=4194304;function It(i){var o=i&42;if(o!==0)return o;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Xt(i,o,f){var b=i.pendingLanes;if(b===0)return 0;var M=0,I=i.suspendedLanes,X=i.pingedLanes;i=i.warmLanes;var ot=b&134217727;return ot!==0?(b=ot&~I,b!==0?M=It(b):(X&=ot,X!==0?M=It(X):f||(f=ot&~i,f!==0&&(M=It(f))))):(ot=b&~I,ot!==0?M=It(ot):X!==0?M=It(X):f||(f=b&~i,f!==0&&(M=It(f)))),M===0?0:o!==0&&o!==M&&(o&I)===0&&(I=M&-M,f=o&-o,I>=f||I===32&&(f&4194048)!==0)?o:M}function Wt(i,o){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&o)===0}function te(i,o){switch(i){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pe(){var i=ht;return ht<<=1,(ht&62914560)===0&&(ht=4194304),i}function Oe(i){for(var o=[],f=0;31>f;f++)o.push(i);return o}function Qe(i,o){i.pendingLanes|=o,o!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function mi(i,o,f,b,M,I){var X=i.pendingLanes;i.pendingLanes=f,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=f,i.entangledLanes&=f,i.errorRecoveryDisabledLanes&=f,i.shellSuspendCounter=0;var ot=i.entanglements,Mt=i.expirationTimes,Yt=i.hiddenUpdates;for(f=X&~f;0<f;){var le=31-K(f),fe=1<<le;ot[le]=0,Mt[le]=-1;var Jt=Yt[le];if(Jt!==null)for(Yt[le]=null,le=0;le<Jt.length;le++){var ne=Jt[le];ne!==null&&(ne.lane&=-536870913)}f&=~fe}b!==0&&ln(i,b,0),I!==0&&M===0&&i.tag!==0&&(i.suspendedLanes|=I&~(X&~o))}function ln(i,o,f){i.pendingLanes|=o,i.suspendedLanes&=~o;var b=31-K(o);i.entangledLanes|=o,i.entanglements[b]=i.entanglements[b]|1073741824|f&261930}function En(i,o){var f=i.entangledLanes|=o;for(i=i.entanglements;f;){var b=31-K(f),M=1<<b;M&o|i[b]&o&&(i[b]|=o),f&=~M}}function Un(i,o){var f=o&-o;return f=(f&42)!==0?1:pe(f),(f&(i.suspendedLanes|o))!==0?0:f}function pe(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Gn(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function qn(){var i=Qt.p;return i!==0?i:(i=window.event,i===void 0?32:Ky(i.type))}function Ai(i,o){var f=Qt.p;try{return Qt.p=i,o()}finally{Qt.p=f}}var Cn=Math.random().toString(36).slice(2),ce="__reactFiber$"+Cn,Ce="__reactProps$"+Cn,Ne="__reactContainer$"+Cn,wr="__reactEvents$"+Cn,ll="__reactListeners$"+Cn,nr="__reactHandles$"+Cn,Ye="__reactResources$"+Cn,ls="__reactMarker$"+Cn;function Eo(i){delete i[ce],delete i[Ce],delete i[wr],delete i[ll],delete i[nr]}function Gs(i){var o=i[ce];if(o)return o;for(var f=i.parentNode;f;){if(o=f[Ne]||f[ce]){if(f=o.alternate,o.child!==null||f!==null&&f.child!==null)for(i=dg(i);i!==null;){if(f=i[ce])return f;i=dg(i)}return o}i=f,f=i.parentNode}return null}function Tr(i){if(i=i[ce]||i[Ne]){var o=i.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return i}return null}function qs(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i.stateNode;throw Error(_(33))}function Zs(i){var o=i[Ye];return o||(o=i[Ye]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function gi(i){i[ls]=!0}var Xr=new Set,Zn={};function cl(i,o){zr(i,o),zr(i+"Capture",o)}function zr(i,o){for(Zn[i]=o,i=0;i<o.length;i++)Xr.add(o[i])}var nu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),si={},qa={};function xd(i){return Ss.call(qa,i)?!0:Ss.call(si,i)?!1:nu.test(i)?qa[i]=!0:(si[i]=!0,!1)}function Za(i,o,f){if(xd(o))if(f===null)i.removeAttribute(o);else{switch(typeof f){case"undefined":case"function":case"symbol":i.removeAttribute(o);return;case"boolean":var b=o.toLowerCase().slice(0,5);if(b!=="data-"&&b!=="aria-"){i.removeAttribute(o);return}}i.setAttribute(o,""+f)}}function ac(i,o,f){if(f===null)i.removeAttribute(o);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttribute(o,""+f)}}function Yr(i,o,f,b){if(b===null)i.removeAttribute(f);else{switch(typeof b){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(f);return}i.setAttributeNS(o,f,""+b)}}function cs(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function bd(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Tm(i,o,f){var b=Object.getOwnPropertyDescriptor(i.constructor.prototype,o);if(!i.hasOwnProperty(o)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var M=b.get,I=b.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return M.call(this)},set:function(X){f=""+X,I.call(this,X)}}),Object.defineProperty(i,o,{enumerable:b.enumerable}),{getValue:function(){return f},setValue:function(X){f=""+X},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function lh(i){if(!i._valueTracker){var o=bd(i)?"checked":"value";i._valueTracker=Tm(i,o,""+i[o])}}function wd(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var f=o.getValue(),b="";return i&&(b=bd(i)?i.checked?"true":"false":i.value),i=b,i!==f?(o.setValue(i),!0):!1}function iu(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Td=/[\n"\\]/g;function Wr(i){return i.replace(Td,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function ch(i,o,f,b,M,I,X,ot){i.name="",X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"?i.type=X:i.removeAttribute("type"),o!=null?X==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+cs(o)):i.value!==""+cs(o)&&(i.value=""+cs(o)):X!=="submit"&&X!=="reset"||i.removeAttribute("value"),o!=null?ru(i,X,cs(o)):f!=null?ru(i,X,cs(f)):b!=null&&i.removeAttribute("value"),M==null&&I!=null&&(i.defaultChecked=!!I),M!=null&&(i.checked=M&&typeof M!="function"&&typeof M!="symbol"),ot!=null&&typeof ot!="function"&&typeof ot!="symbol"&&typeof ot!="boolean"?i.name=""+cs(ot):i.removeAttribute("name")}function uh(i,o,f,b,M,I,X,ot){if(I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"&&(i.type=I),o!=null||f!=null){if(!(I!=="submit"&&I!=="reset"||o!=null)){lh(i);return}f=f!=null?""+cs(f):"",o=o!=null?""+cs(o):f,ot||o===i.value||(i.value=o),i.defaultValue=o}b=b??M,b=typeof b!="function"&&typeof b!="symbol"&&!!b,i.checked=ot?i.checked:!!b,i.defaultChecked=!!b,X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"&&(i.name=X),lh(i)}function ru(i,o,f){o==="number"&&iu(i.ownerDocument)===i||i.defaultValue===""+f||(i.defaultValue=""+f)}function ul(i,o,f,b){if(i=i.options,o){o={};for(var M=0;M<f.length;M++)o["$"+f[M]]=!0;for(f=0;f<i.length;f++)M=o.hasOwnProperty("$"+i[f].value),i[f].selected!==M&&(i[f].selected=M),M&&b&&(i[f].defaultSelected=!0)}else{for(f=""+cs(f),o=null,M=0;M<i.length;M++){if(i[M].value===f){i[M].selected=!0,b&&(i[M].defaultSelected=!0);return}o!==null||i[M].disabled||(o=i[M])}o!==null&&(o.selected=!0)}}function ma(i,o,f){if(o!=null&&(o=""+cs(o),o!==i.value&&(i.value=o),f==null)){i.defaultValue!==o&&(i.defaultValue=o);return}i.defaultValue=f!=null?""+cs(f):""}function su(i,o,f,b){if(o==null){if(b!=null){if(f!=null)throw Error(_(92));if(me(b)){if(1<b.length)throw Error(_(93));b=b[0]}f=b}f==null&&(f=""),o=f}f=cs(o),i.defaultValue=f,b=i.textContent,b===f&&b!==""&&b!==null&&(i.value=b),lh(i)}function hl(i,o){if(o){var f=i.firstChild;if(f&&f===i.lastChild&&f.nodeType===3){f.nodeValue=o;return}}i.textContent=o}var ga=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Sd(i,o,f){var b=o.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?b?i.setProperty(o,""):o==="float"?i.cssFloat="":i[o]="":b?i.setProperty(o,f):typeof f!="number"||f===0||ga.has(o)?o==="float"?i.cssFloat=f:i[o]=(""+f).trim():i[o]=f+"px"}function Gf(i,o,f){if(o!=null&&typeof o!="object")throw Error(_(62));if(i=i.style,f!=null){for(var b in f)!f.hasOwnProperty(b)||o!=null&&o.hasOwnProperty(b)||(b.indexOf("--")===0?i.setProperty(b,""):b==="float"?i.cssFloat="":i[b]="");for(var M in o)b=o[M],o.hasOwnProperty(M)&&f[M]!==b&&Sd(i,M,b)}else for(var I in o)o.hasOwnProperty(I)&&Sd(i,I,o[I])}function ya(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dl=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Lr(i){return hn.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function rn(){}var _a=null;function bi(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Mi=null,Pi=null;function Li(i){var o=Tr(i);if(o&&(i=o.stateNode)){var f=i[Ce]||null;t:switch(i=o.stateNode,o.type){case"input":if(ch(i,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),o=f.name,f.type==="radio"&&o!=null){for(f=i;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Wr(""+o)+'"][type="radio"]'),o=0;o<f.length;o++){var b=f[o];if(b!==i&&b.form===i.form){var M=b[Ce]||null;if(!M)throw Error(_(90));ch(b,M.value,M.defaultValue,M.defaultValue,M.checked,M.defaultChecked,M.type,M.name)}}for(o=0;o<f.length;o++)b=f[o],b.form===i.form&&wd(b)}break t;case"textarea":ma(i,f.value,f.defaultValue);break t;case"select":o=f.value,o!=null&&ul(i,!!f.multiple,o,!1)}}}var Bn=!1;function au(i,o,f){if(Bn)return i(o,f);Bn=!0;try{var b=i(o);return b}finally{if(Bn=!1,(Mi!==null||Pi!==null)&&(Yh(),Mi&&(o=Mi,i=Pi,Pi=Mi=null,Li(o),i)))for(o=0;o<i.length;o++)Li(i[o])}}function Zi(i,o){var f=i.stateNode;if(f===null)return null;var b=f[Ce]||null;if(b===null)return null;f=b[o];t:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(b=!b.disabled)||(i=i.type,b=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!b;break t;default:i=!1}if(i)return null;if(f&&typeof f!="function")throw Error(_(231,o,typeof f));return f}var wi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ir=!1;if(wi)try{var oc={};Object.defineProperty(oc,"passive",{get:function(){ir=!0}}),window.addEventListener("test",oc,oc),window.removeEventListener("test",oc,oc)}catch{ir=!1}var kr=null,$n=null,$a=null;function Ha(){if($a)return $a;var i,o=$n,f=o.length,b,M="value"in kr?kr.value:kr.textContent,I=M.length;for(i=0;i<f&&o[i]===M[i];i++);var X=f-i;for(b=1;b<=X&&o[f-b]===M[I-b];b++);return $a=M.slice(i,1<b?1-b:void 0)}function Co(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function ur(){return!0}function Qn(){return!1}function yi(i){function o(f,b,M,I,X){this._reactName=f,this._targetInst=M,this.type=b,this.nativeEvent=I,this.target=X,this.currentTarget=null;for(var ot in i)i.hasOwnProperty(ot)&&(f=i[ot],this[ot]=f?f(I):I[ot]);return this.isDefaultPrevented=(I.defaultPrevented!=null?I.defaultPrevented:I.returnValue===!1)?ur:Qn,this.isPropagationStopped=Qn,this}return H(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=ur)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=ur)},persist:function(){},isPersistent:ur}),o}var cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},en=yi(cn),va=H({},cn,{view:0,detail:0}),gn=yi(va),Ao,us,Xa,xa=H({},va,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fh,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Xa&&(Xa&&i.type==="mousemove"?(Ao=i.screenX-Xa.screenX,us=i.screenY-Xa.screenY):us=Ao=0,Xa=i),Ao)},movementY:function(i){return"movementY"in i?i.movementY:us}}),ou=yi(xa),lu=H({},xa,{dataTransfer:0}),cu=yi(lu),hh=H({},va,{relatedTarget:0}),Mo=yi(hh),qf=H({},cn,{animationName:0,elapsedTime:0,pseudoElement:0}),ba=yi(qf),hr=H({},cn,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),dh=yi(hr),Zf=H({},cn,{data:0}),rr=yi(Zf),ki={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$s={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ed(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=lc[i])?!!o[i]:!1}function fh(){return Ed}var Hs=H({},va,{key:function(i){if(i.key){var o=ki[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Co(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?$s[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fh,charCode:function(i){return i.type==="keypress"?Co(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Co(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),ph=yi(Hs),Cd=H({},xa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$f=yi(Cd),Hf=H({},va,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fh}),mh=yi(Hf),gh=H({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Kr=yi(gh),yh=H({},xa,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),fl=yi(yh),Ad=H({},cn,{newState:0,oldState:0}),uu=yi(Ad),wa=[9,13,27,32],Md=wi&&"CompositionEvent"in window,pl=null;wi&&"documentMode"in document&&(pl=document.documentMode);var hu=wi&&"TextEvent"in window&&!pl,Ya=wi&&(!Md||pl&&8<pl&&11>=pl),Xf=" ",cc=!1;function Pd(i,o){switch(i){case"keyup":return wa.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ml(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var gl=!1;function Yf(i,o){switch(i){case"compositionend":return ml(o);case"keypress":return o.which!==32?null:(cc=!0,Xf);case"textInput":return i=o.data,i===Xf&&cc?null:i;default:return null}}function Sm(i,o){if(gl)return i==="compositionend"||!Md&&Pd(i,o)?(i=Ha(),$a=$n=kr=null,gl=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Ya&&o.locale!=="ko"?null:o.data;default:return null}}var Wf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _h(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!Wf[i.type]:o==="textarea"}function Dd(i,o,f,b){Mi?Pi?Pi.push(b):Pi=[b]:Mi=b,o=gf(o,"onChange"),0<o.length&&(f=new en("onChange","change",null,f,b),i.push({event:f,listeners:o}))}var yl=null,_l=null;function Rd(i){Gl(i,0)}function Ta(i){var o=qs(i);if(wd(o))return i}function Id(i,o){if(i==="change")return o}var zd=!1;if(wi){var vl;if(wi){var uc="oninput"in document;if(!uc){var hc=document.createElement("div");hc.setAttribute("oninput","return;"),uc=typeof hc.oninput=="function"}vl=uc}else vl=!1;zd=vl&&(!document.documentMode||9<document.documentMode)}function Kf(){yl&&(yl.detachEvent("onpropertychange",Qf),_l=yl=null)}function Qf(i){if(i.propertyName==="value"&&Ta(_l)){var o=[];Dd(o,_l,i,bi(i)),au(Rd,o)}}function Jf(i,o,f){i==="focusin"?(Kf(),yl=o,_l=f,yl.attachEvent("onpropertychange",Qf)):i==="focusout"&&Kf()}function vh(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Ta(_l)}function Ld(i,o){if(i==="click")return Ta(o)}function kd(i,o){if(i==="input"||i==="change")return Ta(o)}function tp(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var dr=typeof Object.is=="function"?Object.is:tp;function Qr(i,o){if(dr(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var f=Object.keys(i),b=Object.keys(o);if(f.length!==b.length)return!1;for(b=0;b<f.length;b++){var M=f[b];if(!Ss.call(o,M)||!dr(i[M],o[M]))return!1}return!0}function xh(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function bh(i,o){var f=xh(i);i=0;for(var b;f;){if(f.nodeType===3){if(b=i+f.textContent.length,i<=o&&b>=o)return{node:f,offset:o-i};i=b}t:{for(;f;){if(f.nextSibling){f=f.nextSibling;break t}f=f.parentNode}f=void 0}f=xh(f)}}function wh(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?wh(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Th(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var o=iu(i.document);o instanceof i.HTMLIFrameElement;){try{var f=typeof o.contentWindow.location.href=="string"}catch{f=!1}if(f)i=o.contentWindow;else break;o=iu(i.document)}return o}function du(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}var xl=wi&&"documentMode"in document&&11>=document.documentMode,Po=null,Od=null,_n=null,Nd=!1;function ep(i,o,f){var b=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Nd||Po==null||Po!==iu(b)||(b=Po,"selectionStart"in b&&du(b)?b={start:b.selectionStart,end:b.selectionEnd}:(b=(b.ownerDocument&&b.ownerDocument.defaultView||window).getSelection(),b={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}),_n&&Qr(_n,b)||(_n=b,b=gf(Od,"onSelect"),0<b.length&&(o=new en("onSelect","select",null,o,f),i.push({event:o,listeners:b}),o.target=Po)))}function Do(i,o){var f={};return f[i.toLowerCase()]=o.toLowerCase(),f["Webkit"+i]="webkit"+o,f["Moz"+i]="moz"+o,f}var dc={animationend:Do("Animation","AnimationEnd"),animationiteration:Do("Animation","AnimationIteration"),animationstart:Do("Animation","AnimationStart"),transitionrun:Do("Transition","TransitionRun"),transitionstart:Do("Transition","TransitionStart"),transitioncancel:Do("Transition","TransitionCancel"),transitionend:Do("Transition","TransitionEnd")},Sh={},fu={};wi&&(fu=document.createElement("div").style,"AnimationEvent"in window||(delete dc.animationend.animation,delete dc.animationiteration.animation,delete dc.animationstart.animation),"TransitionEvent"in window||delete dc.transitionend.transition);function Sa(i){if(Sh[i])return Sh[i];if(!dc[i])return i;var o=dc[i],f;for(f in o)if(o.hasOwnProperty(f)&&f in fu)return Sh[i]=o[f];return i}var pu=Sa("animationend"),Eh=Sa("animationiteration"),Ro=Sa("animationstart"),mu=Sa("transitionrun"),fc=Sa("transitionstart"),Es=Sa("transitioncancel"),Fd=Sa("transitionend"),jd=new Map,gu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");gu.push("scrollEnd");function fr(i,o){jd.set(i,o),cl(o,[i])}var bl=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Or=[],Ea=0,pc=0;function yu(){for(var i=Ea,o=pc=Ea=0;o<i;){var f=Or[o];Or[o++]=null;var b=Or[o];Or[o++]=null;var M=Or[o];Or[o++]=null;var I=Or[o];if(Or[o++]=null,b!==null&&M!==null){var X=b.pending;X===null?M.next=M:(M.next=X.next,X.next=M),b.pending=M}I!==0&&Ch(f,M,I)}}function Wa(i,o,f,b){Or[Ea++]=i,Or[Ea++]=o,Or[Ea++]=f,Or[Ea++]=b,pc|=b,i.lanes|=b,i=i.alternate,i!==null&&(i.lanes|=b)}function Io(i,o,f,b){return Wa(i,o,f,b),an(i)}function zo(i,o){return Wa(i,null,null,o),an(i)}function Ch(i,o,f){i.lanes|=f;var b=i.alternate;b!==null&&(b.lanes|=f);for(var M=!1,I=i.return;I!==null;)I.childLanes|=f,b=I.alternate,b!==null&&(b.childLanes|=f),I.tag===22&&(i=I.stateNode,i===null||i._visibility&1||(M=!0)),i=I,I=I.return;return i.tag===3?(I=i.stateNode,M&&o!==null&&(M=31-K(f),i=I.hiddenUpdates,b=i[M],b===null?i[M]=[o]:b.push(o),o.lane=f|536870912),I):null}function an(i){if(50<Vl)throw Vl=0,qm=null,Error(_(185));for(var o=i.return;o!==null;)i=o,o=i.return;return i.tag===3?i.stateNode:null}var Ka={};function Em(i,o,f,b){this.tag=i,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jr(i,o,f,b){return new Em(i,o,f,b)}function wl(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Xs(i,o){var f=i.alternate;return f===null?(f=Jr(i.tag,o,i.key,i.mode),f.elementType=i.elementType,f.type=i.type,f.stateNode=i.stateNode,f.alternate=i,i.alternate=f):(f.pendingProps=o,f.type=i.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=i.flags&65011712,f.childLanes=i.childLanes,f.lanes=i.lanes,f.child=i.child,f.memoizedProps=i.memoizedProps,f.memoizedState=i.memoizedState,f.updateQueue=i.updateQueue,o=i.dependencies,f.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},f.sibling=i.sibling,f.index=i.index,f.ref=i.ref,f.refCleanup=i.refCleanup,f}function np(i,o){i.flags&=65011714;var f=i.alternate;return f===null?(i.childLanes=0,i.lanes=o,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=f.childLanes,i.lanes=f.lanes,i.child=f.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=f.memoizedProps,i.memoizedState=f.memoizedState,i.updateQueue=f.updateQueue,i.type=f.type,o=f.dependencies,i.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),i}function _u(i,o,f,b,M,I){var X=0;if(b=i,typeof i=="function")wl(i)&&(X=1);else if(typeof i=="string")X=_g(i,f,Te.current)?26:i==="html"||i==="head"||i==="body"?27:5;else t:switch(i){case xe:return i=Jr(31,f,o,M),i.elementType=xe,i.lanes=I,i;case rt:return Tl(f.children,M,I,o);case J:X=8,M|=24;break;case mt:return i=Jr(12,f,o,M|2),i.elementType=mt,i.lanes=I,i;case Ot:return i=Jr(13,f,o,M),i.elementType=Ot,i.lanes=I,i;case ee:return i=Jr(19,f,o,M),i.elementType=ee,i.lanes=I,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case bt:X=10;break t;case Et:X=9;break t;case Lt:X=11;break t;case Nt:X=14;break t;case Kt:X=16,b=null;break t}X=29,f=Error(_(130,i===null?"null":typeof i,"")),b=null}return o=Jr(X,f,o,M),o.elementType=i,o.type=b,o.lanes=I,o}function Tl(i,o,f,b){return i=Jr(7,i,b,o),i.lanes=f,i}function mc(i,o,f){return i=Jr(6,i,null,o),i.lanes=f,i}function vu(i){var o=Jr(18,null,null,0);return o.stateNode=i,o}function gc(i,o,f){return o=Jr(4,i.children!==null?i.children:[],i.key,o),o.lanes=f,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}var Lo=new WeakMap;function Nr(i,o){if(typeof i=="object"&&i!==null){var f=Lo.get(i);return f!==void 0?f:(o={value:i,source:o,stack:Us(o)},Lo.set(i,o),o)}return{value:i,source:o,stack:Us(o)}}var Sl=[],Qa=0,El=null,ko=0,pr=[],Fr=0,Ja=null,ts=1,Ca="";function Ys(i,o){Sl[Qa++]=ko,Sl[Qa++]=El,El=i,ko=o}function yc(i,o,f){pr[Fr++]=ts,pr[Fr++]=Ca,pr[Fr++]=Ja,Ja=i;var b=ts;i=Ca;var M=32-K(b)-1;b&=~(1<<M),f+=1;var I=32-K(o)+M;if(30<I){var X=M-M%5;I=(b&(1<<X)-1).toString(32),b>>=X,M-=X,ts=1<<32-K(o)+M|f<<M|b,Ca=I+i}else ts=1<<I|f<<M|b,Ca=i}function _c(i){i.return!==null&&(Ys(i,1),yc(i,1,0))}function Ah(i){for(;i===El;)El=Sl[--Qa],Sl[Qa]=null,ko=Sl[--Qa],Sl[Qa]=null;for(;i===Ja;)Ja=pr[--Fr],pr[Fr]=null,Ca=pr[--Fr],pr[Fr]=null,ts=pr[--Fr],pr[Fr]=null}function Bd(i,o){pr[Fr++]=ts,pr[Fr++]=Ca,pr[Fr++]=Ja,ts=o.id,Ca=o.overflow,Ja=i}var Oi=null,Jn=null,vn=!1,Aa=null,wn=!1,Ws=Error(_(519));function Di(i){var o=Error(_(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw to(Nr(o,i)),Ws}function vc(i){var o=i.stateNode,f=i.type,b=i.memoizedProps;switch(o[ce]=i,o[Ce]=b,f){case"dialog":xn("cancel",o),xn("close",o);break;case"iframe":case"object":case"embed":xn("load",o);break;case"video":case"audio":for(f=0;f<pf.length;f++)xn(pf[f],o);break;case"source":xn("error",o);break;case"img":case"image":case"link":xn("error",o),xn("load",o);break;case"details":xn("toggle",o);break;case"input":xn("invalid",o),uh(o,b.value,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name,!0);break;case"select":xn("invalid",o);break;case"textarea":xn("invalid",o),su(o,b.value,b.defaultValue,b.children)}f=b.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||o.textContent===""+f||b.suppressHydrationWarning===!0||$u(o.textContent,f)?(b.popover!=null&&(xn("beforetoggle",o),xn("toggle",o)),b.onScroll!=null&&xn("scroll",o),b.onScrollEnd!=null&&xn("scrollend",o),b.onClick!=null&&(o.onclick=rn),o=!0):o=!1,o||Di(i,!0)}function Oo(i){for(Oi=i.return;Oi;)switch(Oi.tag){case 5:case 31:case 13:wn=!1;return;case 27:case 3:wn=!0;return;default:Oi=Oi.return}}function Cl(i){if(i!==Oi)return!1;if(!vn)return Oo(i),vn=!0,!1;var o=i.tag,f;if((f=o!==3&&o!==27)&&((f=o===5)&&(f=i.type,f=!(f!=="form"&&f!=="button")||vf(i.type,i.memoizedProps)),f=!f),f&&Jn&&Di(i),Oo(i),o===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(_(317));Jn=qy(i)}else if(o===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(_(317));Jn=qy(i)}else o===27?(o=Jn,Qi(i.type)?(i=Fc,Fc=null,Jn=i):Jn=o):Jn=Oi?Mr(i.stateNode.nextSibling):null;return!0}function Cs(){Jn=Oi=null,vn=!1}function xu(){var i=Aa;return i!==null&&(gs===null?gs=i:gs.push.apply(gs,i),Aa=null),i}function to(i){Aa===null?Aa=[i]:Aa.push(i)}var bu=Rt(null),No=null,Ks=null;function Ma(i,o,f){be(bu,o._currentValue),o._currentValue=f}function hs(i){i._currentValue=bu.current,se(bu)}function Mh(i,o,f){for(;i!==null;){var b=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,b!==null&&(b.childLanes|=o)):b!==null&&(b.childLanes&o)!==o&&(b.childLanes|=o),i===f)break;i=i.return}}function Pa(i,o,f,b){var M=i.child;for(M!==null&&(M.return=i);M!==null;){var I=M.dependencies;if(I!==null){var X=M.child;I=I.firstContext;t:for(;I!==null;){var ot=I;I=M;for(var Mt=0;Mt<o.length;Mt++)if(ot.context===o[Mt]){I.lanes|=f,ot=I.alternate,ot!==null&&(ot.lanes|=f),Mh(I.return,f,i),b||(X=null);break t}I=ot.next}}else if(M.tag===18){if(X=M.return,X===null)throw Error(_(341));X.lanes|=f,I=X.alternate,I!==null&&(I.lanes|=f),Mh(X,f,i),X=null}else X=M.child;if(X!==null)X.return=M;else for(X=M;X!==null;){if(X===i){X=null;break}if(M=X.sibling,M!==null){M.return=X.return,X=M;break}X=X.return}M=X}}function Fo(i,o,f,b){i=null;for(var M=o,I=!1;M!==null;){if(!I){if((M.flags&524288)!==0)I=!0;else if((M.flags&262144)!==0)break}if(M.tag===10){var X=M.alternate;if(X===null)throw Error(_(387));if(X=X.memoizedProps,X!==null){var ot=M.type;dr(M.pendingProps.value,X.value)||(i!==null?i.push(ot):i=[ot])}}else if(M===Le.current){if(X=M.alternate,X===null)throw Error(_(387));X.memoizedState.memoizedState!==M.memoizedState.memoizedState&&(i!==null?i.push(Ku):i=[Ku])}M=M.return}i!==null&&Pa(o,i,f,b),o.flags|=262144}function wu(i){for(i=i.firstContext;i!==null;){if(!dr(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function eo(i){No=i,Ks=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function $i(i){return Vd(No,i)}function no(i,o){return No===null&&eo(i),Vd(i,o)}function Vd(i,o){var f=o._currentValue;if(o={context:o,memoizedValue:f,next:null},Ks===null){if(i===null)throw Error(_(308));Ks=o,i.dependencies={lanes:0,firstContext:o},i.flags|=524288}else Ks=Ks.next=o;return f}var ip=typeof AbortController<"u"?AbortController:function(){var i=[],o=this.signal={aborted:!1,addEventListener:function(f,b){i.push(b)}};this.abort=function(){o.aborted=!0,i.forEach(function(f){return f()})}},rp=s.unstable_scheduleCallback,Ph=s.unstable_NormalPriority,Ri={$$typeof:bt,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function es(){return{controller:new ip,data:new Map,refCount:0}}function Hi(i){i.refCount--,i.refCount===0&&rp(Ph,function(){i.controller.abort()})}var Da=null,ai=0,Ra=0,As=null;function Cm(i,o){if(Da===null){var f=Da=[];ai=0,Ra=df(),As={status:"pending",value:void 0,then:function(b){f.push(b)}}}return ai++,o.then(sp,sp),o}function sp(){if(--ai===0&&Da!==null){As!==null&&(As.status="fulfilled");var i=Da;Da=null,Ra=0,As=null;for(var o=0;o<i.length;o++)(0,i[o])()}}function Tu(i,o){var f=[],b={status:"pending",value:null,reason:null,then:function(M){f.push(M)}};return i.then(function(){b.status="fulfilled",b.value=o;for(var M=0;M<f.length;M++)(0,f[M])(o)},function(M){for(b.status="rejected",b.reason=M,M=0;M<f.length;M++)(0,f[M])(void 0)}),b}var Ud=jt.S;jt.S=function(i,o){My=qi(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&Cm(i,o),Ud!==null&&Ud(i,o)};var Ia=Rt(null);function Al(){var i=Ia.current;return i!==null?i:ni.pooledCache}function ns(i,o){o===null?be(Ia,Ia.current):be(Ia,o.pool)}function Me(){var i=Al();return i===null?null:{parent:Ri._currentValue,pool:i}}var Qs=Error(_(460)),Su=Error(_(474)),Eu=Error(_(542)),jo={then:function(){}};function za(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Dh(i,o,f){switch(f=i[f],f===void 0?i.push(o):f!==o&&(o.then(rn,rn),o=f),o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,xc(i),i;default:if(typeof o.status=="string")o.then(rn,rn);else{if(i=ni,i!==null&&100<i.shellSuspendCounter)throw Error(_(482));i=o,i.status="pending",i.then(function(b){if(o.status==="pending"){var M=o;M.status="fulfilled",M.value=b}},function(b){if(o.status==="pending"){var M=o;M.status="rejected",M.reason=b}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,xc(i),i}throw Ms=o,Qs}}function Ml(i){try{var o=i._init;return o(i._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(Ms=f,Qs):f}}var Ms=null;function Gd(){if(Ms===null)throw Error(_(459));var i=Ms;return Ms=null,i}function xc(i){if(i===Qs||i===Eu)throw Error(_(483))}var io=null,Pl=0;function Cu(i){var o=Pl;return Pl+=1,io===null&&(io=[]),Dh(io,i,o)}function bc(i,o){o=o.props.ref,i.ref=o!==void 0?o:null}function wc(i,o){throw o.$$typeof===W?Error(_(525)):(i=Object.prototype.toString.call(o),Error(_(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i)))}function Rh(i){function o(Bt,kt){if(i){var Ht=Bt.deletions;Ht===null?(Bt.deletions=[kt],Bt.flags|=16):Ht.push(kt)}}function f(Bt,kt){if(!i)return null;for(;kt!==null;)o(Bt,kt),kt=kt.sibling;return null}function b(Bt){for(var kt=new Map;Bt!==null;)Bt.key!==null?kt.set(Bt.key,Bt):kt.set(Bt.index,Bt),Bt=Bt.sibling;return kt}function M(Bt,kt){return Bt=Xs(Bt,kt),Bt.index=0,Bt.sibling=null,Bt}function I(Bt,kt,Ht){return Bt.index=Ht,i?(Ht=Bt.alternate,Ht!==null?(Ht=Ht.index,Ht<kt?(Bt.flags|=67108866,kt):Ht):(Bt.flags|=67108866,kt)):(Bt.flags|=1048576,kt)}function X(Bt){return i&&Bt.alternate===null&&(Bt.flags|=67108866),Bt}function ot(Bt,kt,Ht,he){return kt===null||kt.tag!==6?(kt=mc(Ht,Bt.mode,he),kt.return=Bt,kt):(kt=M(kt,Ht),kt.return=Bt,kt)}function Mt(Bt,kt,Ht,he){var Xe=Ht.type;return Xe===rt?le(Bt,kt,Ht.props.children,he,Ht.key):kt!==null&&(kt.elementType===Xe||typeof Xe=="object"&&Xe!==null&&Xe.$$typeof===Kt&&Ml(Xe)===kt.type)?(kt=M(kt,Ht.props),bc(kt,Ht),kt.return=Bt,kt):(kt=_u(Ht.type,Ht.key,Ht.props,null,Bt.mode,he),bc(kt,Ht),kt.return=Bt,kt)}function Yt(Bt,kt,Ht,he){return kt===null||kt.tag!==4||kt.stateNode.containerInfo!==Ht.containerInfo||kt.stateNode.implementation!==Ht.implementation?(kt=gc(Ht,Bt.mode,he),kt.return=Bt,kt):(kt=M(kt,Ht.children||[]),kt.return=Bt,kt)}function le(Bt,kt,Ht,he,Xe){return kt===null||kt.tag!==7?(kt=Tl(Ht,Bt.mode,he,Xe),kt.return=Bt,kt):(kt=M(kt,Ht),kt.return=Bt,kt)}function fe(Bt,kt,Ht){if(typeof kt=="string"&&kt!==""||typeof kt=="number"||typeof kt=="bigint")return kt=mc(""+kt,Bt.mode,Ht),kt.return=Bt,kt;if(typeof kt=="object"&&kt!==null){switch(kt.$$typeof){case it:return Ht=_u(kt.type,kt.key,kt.props,null,Bt.mode,Ht),bc(Ht,kt),Ht.return=Bt,Ht;case pt:return kt=gc(kt,Bt.mode,Ht),kt.return=Bt,kt;case Kt:return kt=Ml(kt),fe(Bt,kt,Ht)}if(me(kt)||ze(kt))return kt=Tl(kt,Bt.mode,Ht,null),kt.return=Bt,kt;if(typeof kt.then=="function")return fe(Bt,Cu(kt),Ht);if(kt.$$typeof===bt)return fe(Bt,no(Bt,kt),Ht);wc(Bt,kt)}return null}function Jt(Bt,kt,Ht,he){var Xe=kt!==null?kt.key:null;if(typeof Ht=="string"&&Ht!==""||typeof Ht=="number"||typeof Ht=="bigint")return Xe!==null?null:ot(Bt,kt,""+Ht,he);if(typeof Ht=="object"&&Ht!==null){switch(Ht.$$typeof){case it:return Ht.key===Xe?Mt(Bt,kt,Ht,he):null;case pt:return Ht.key===Xe?Yt(Bt,kt,Ht,he):null;case Kt:return Ht=Ml(Ht),Jt(Bt,kt,Ht,he)}if(me(Ht)||ze(Ht))return Xe!==null?null:le(Bt,kt,Ht,he,null);if(typeof Ht.then=="function")return Jt(Bt,kt,Cu(Ht),he);if(Ht.$$typeof===bt)return Jt(Bt,kt,no(Bt,Ht),he);wc(Bt,Ht)}return null}function ne(Bt,kt,Ht,he,Xe){if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return Bt=Bt.get(Ht)||null,ot(kt,Bt,""+he,Xe);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case it:return Bt=Bt.get(he.key===null?Ht:he.key)||null,Mt(kt,Bt,he,Xe);case pt:return Bt=Bt.get(he.key===null?Ht:he.key)||null,Yt(kt,Bt,he,Xe);case Kt:return he=Ml(he),ne(Bt,kt,Ht,he,Xe)}if(me(he)||ze(he))return Bt=Bt.get(Ht)||null,le(kt,Bt,he,Xe,null);if(typeof he.then=="function")return ne(Bt,kt,Ht,Cu(he),Xe);if(he.$$typeof===bt)return ne(Bt,kt,Ht,no(kt,he),Xe);wc(kt,he)}return null}function ke(Bt,kt,Ht,he){for(var Xe=null,Dn=null,Fe=kt,un=kt=0,bn=null;Fe!==null&&un<Ht.length;un++){Fe.index>un?(bn=Fe,Fe=null):bn=Fe.sibling;var Ln=Jt(Bt,Fe,Ht[un],he);if(Ln===null){Fe===null&&(Fe=bn);break}i&&Fe&&Ln.alternate===null&&o(Bt,Fe),kt=I(Ln,kt,un),Dn===null?Xe=Ln:Dn.sibling=Ln,Dn=Ln,Fe=bn}if(un===Ht.length)return f(Bt,Fe),vn&&Ys(Bt,un),Xe;if(Fe===null){for(;un<Ht.length;un++)Fe=fe(Bt,Ht[un],he),Fe!==null&&(kt=I(Fe,kt,un),Dn===null?Xe=Fe:Dn.sibling=Fe,Dn=Fe);return vn&&Ys(Bt,un),Xe}for(Fe=b(Fe);un<Ht.length;un++)bn=ne(Fe,Bt,un,Ht[un],he),bn!==null&&(i&&bn.alternate!==null&&Fe.delete(bn.key===null?un:bn.key),kt=I(bn,kt,un),Dn===null?Xe=bn:Dn.sibling=bn,Dn=bn);return i&&Fe.forEach(function(Gc){return o(Bt,Gc)}),vn&&Ys(Bt,un),Xe}function Je(Bt,kt,Ht,he){if(Ht==null)throw Error(_(151));for(var Xe=null,Dn=null,Fe=kt,un=kt=0,bn=null,Ln=Ht.next();Fe!==null&&!Ln.done;un++,Ln=Ht.next()){Fe.index>un?(bn=Fe,Fe=null):bn=Fe.sibling;var Gc=Jt(Bt,Fe,Ln.value,he);if(Gc===null){Fe===null&&(Fe=bn);break}i&&Fe&&Gc.alternate===null&&o(Bt,Fe),kt=I(Gc,kt,un),Dn===null?Xe=Gc:Dn.sibling=Gc,Dn=Gc,Fe=bn}if(Ln.done)return f(Bt,Fe),vn&&Ys(Bt,un),Xe;if(Fe===null){for(;!Ln.done;un++,Ln=Ht.next())Ln=fe(Bt,Ln.value,he),Ln!==null&&(kt=I(Ln,kt,un),Dn===null?Xe=Ln:Dn.sibling=Ln,Dn=Ln);return vn&&Ys(Bt,un),Xe}for(Fe=b(Fe);!Ln.done;un++,Ln=Ht.next())Ln=ne(Fe,Bt,un,Ln.value,he),Ln!==null&&(i&&Ln.alternate!==null&&Fe.delete(Ln.key===null?un:Ln.key),kt=I(Ln,kt,un),Dn===null?Xe=Ln:Dn.sibling=Ln,Dn=Ln);return i&&Fe.forEach(function(r){return o(Bt,r)}),vn&&Ys(Bt,un),Xe}function Kn(Bt,kt,Ht,he){if(typeof Ht=="object"&&Ht!==null&&Ht.type===rt&&Ht.key===null&&(Ht=Ht.props.children),typeof Ht=="object"&&Ht!==null){switch(Ht.$$typeof){case it:t:{for(var Xe=Ht.key;kt!==null;){if(kt.key===Xe){if(Xe=Ht.type,Xe===rt){if(kt.tag===7){f(Bt,kt.sibling),he=M(kt,Ht.props.children),he.return=Bt,Bt=he;break t}}else if(kt.elementType===Xe||typeof Xe=="object"&&Xe!==null&&Xe.$$typeof===Kt&&Ml(Xe)===kt.type){f(Bt,kt.sibling),he=M(kt,Ht.props),bc(he,Ht),he.return=Bt,Bt=he;break t}f(Bt,kt);break}else o(Bt,kt);kt=kt.sibling}Ht.type===rt?(he=Tl(Ht.props.children,Bt.mode,he,Ht.key),he.return=Bt,Bt=he):(he=_u(Ht.type,Ht.key,Ht.props,null,Bt.mode,he),bc(he,Ht),he.return=Bt,Bt=he)}return X(Bt);case pt:t:{for(Xe=Ht.key;kt!==null;){if(kt.key===Xe)if(kt.tag===4&&kt.stateNode.containerInfo===Ht.containerInfo&&kt.stateNode.implementation===Ht.implementation){f(Bt,kt.sibling),he=M(kt,Ht.children||[]),he.return=Bt,Bt=he;break t}else{f(Bt,kt);break}else o(Bt,kt);kt=kt.sibling}he=gc(Ht,Bt.mode,he),he.return=Bt,Bt=he}return X(Bt);case Kt:return Ht=Ml(Ht),Kn(Bt,kt,Ht,he)}if(me(Ht))return ke(Bt,kt,Ht,he);if(ze(Ht)){if(Xe=ze(Ht),typeof Xe!="function")throw Error(_(150));return Ht=Xe.call(Ht),Je(Bt,kt,Ht,he)}if(typeof Ht.then=="function")return Kn(Bt,kt,Cu(Ht),he);if(Ht.$$typeof===bt)return Kn(Bt,kt,no(Bt,Ht),he);wc(Bt,Ht)}return typeof Ht=="string"&&Ht!==""||typeof Ht=="number"||typeof Ht=="bigint"?(Ht=""+Ht,kt!==null&&kt.tag===6?(f(Bt,kt.sibling),he=M(kt,Ht),he.return=Bt,Bt=he):(f(Bt,kt),he=mc(Ht,Bt.mode,he),he.return=Bt,Bt=he),X(Bt)):f(Bt,kt)}return function(Bt,kt,Ht,he){try{Pl=0;var Xe=Kn(Bt,kt,Ht,he);return io=null,Xe}catch(Fe){if(Fe===Qs||Fe===Eu)throw Fe;var Dn=Jr(29,Fe,null,Bt.mode);return Dn.lanes=he,Dn.return=Bt,Dn}finally{}}}var ro=Rh(!0),ap=Rh(!1),so=!1;function La(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function kn(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Bo(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Ps(i,o,f){var b=i.updateQueue;if(b===null)return null;if(b=b.shared,(Pn&2)!==0){var M=b.pending;return M===null?o.next=o:(o.next=M.next,M.next=o),b.pending=o,o=an(i),Ch(i,null,f),o}return Wa(i,b,o,f),an(i)}function ao(i,o,f){if(o=o.updateQueue,o!==null&&(o=o.shared,(f&4194048)!==0)){var b=o.lanes;b&=i.pendingLanes,f|=b,o.lanes=f,En(i,f)}}function Au(i,o){var f=i.updateQueue,b=i.alternate;if(b!==null&&(b=b.updateQueue,f===b)){var M=null,I=null;if(f=f.firstBaseUpdate,f!==null){do{var X={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};I===null?M=I=X:I=I.next=X,f=f.next}while(f!==null);I===null?M=I=o:I=I.next=o}else M=I=o;f={baseState:b.baseState,firstBaseUpdate:M,lastBaseUpdate:I,shared:b.shared,callbacks:b.callbacks},i.updateQueue=f;return}i=f.lastBaseUpdate,i===null?f.firstBaseUpdate=o:i.next=o,f.lastBaseUpdate=o}var Ih=!1;function Dl(){if(Ih){var i=As;if(i!==null)throw i}}function Rl(i,o,f,b){Ih=!1;var M=i.updateQueue;so=!1;var I=M.firstBaseUpdate,X=M.lastBaseUpdate,ot=M.shared.pending;if(ot!==null){M.shared.pending=null;var Mt=ot,Yt=Mt.next;Mt.next=null,X===null?I=Yt:X.next=Yt,X=Mt;var le=i.alternate;le!==null&&(le=le.updateQueue,ot=le.lastBaseUpdate,ot!==X&&(ot===null?le.firstBaseUpdate=Yt:ot.next=Yt,le.lastBaseUpdate=Mt))}if(I!==null){var fe=M.baseState;X=0,le=Yt=Mt=null,ot=I;do{var Jt=ot.lane&-536870913,ne=Jt!==ot.lane;if(ne?(An&Jt)===Jt:(b&Jt)===Jt){Jt!==0&&Jt===Ra&&(Ih=!0),le!==null&&(le=le.next={lane:0,tag:ot.tag,payload:ot.payload,callback:null,next:null});t:{var ke=i,Je=ot;Jt=o;var Kn=f;switch(Je.tag){case 1:if(ke=Je.payload,typeof ke=="function"){fe=ke.call(Kn,fe,Jt);break t}fe=ke;break t;case 3:ke.flags=ke.flags&-65537|128;case 0:if(ke=Je.payload,Jt=typeof ke=="function"?ke.call(Kn,fe,Jt):ke,Jt==null)break t;fe=H({},fe,Jt);break t;case 2:so=!0}}Jt=ot.callback,Jt!==null&&(i.flags|=64,ne&&(i.flags|=8192),ne=M.callbacks,ne===null?M.callbacks=[Jt]:ne.push(Jt))}else ne={lane:Jt,tag:ot.tag,payload:ot.payload,callback:ot.callback,next:null},le===null?(Yt=le=ne,Mt=fe):le=le.next=ne,X|=Jt;if(ot=ot.next,ot===null){if(ot=M.shared.pending,ot===null)break;ne=ot,ot=ne.next,ne.next=null,M.lastBaseUpdate=ne,M.shared.pending=null}}while(!0);le===null&&(Mt=fe),M.baseState=Mt,M.firstBaseUpdate=Yt,M.lastBaseUpdate=le,I===null&&(M.shared.lanes=0),Lc|=X,i.lanes=X,i.memoizedState=fe}}function qd(i,o){if(typeof i!="function")throw Error(_(191,i));i.call(o)}function Ds(i,o){var f=i.callbacks;if(f!==null)for(i.callbacks=null,i=0;i<f.length;i++)qd(f[i],o)}var Rs=Rt(null),Re=Rt(0);function Ve(i,o){i=Yo,be(Re,i),be(Rs,o),Yo=i|o.baseLanes}function Il(){be(Re,Yo),be(Rs,Rs.current)}function zh(){Yo=Re.current,se(Rs),se(Re)}var mr=Rt(null),ti=null;function Xi(i){var o=i.alternate;be(oi,oi.current&1),be(mr,i),ti===null&&(o===null||Rs.current!==null||o.memoizedState!==null)&&(ti=i)}function Lh(i){be(oi,oi.current),be(mr,i),ti===null&&(ti=i)}function op(i){i.tag===22?(be(oi,oi.current),be(mr,i),ti===null&&(ti=i)):Vo()}function Vo(){be(oi,oi.current),be(mr,mr.current)}function ds(i){se(mr),ti===i&&(ti=null),se(oi)}var oi=Rt(0);function In(i){for(var o=i;o!==null;){if(o.tag===13){var f=o.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||td(f)||hg(f)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Fn=0,on=null,zn=null,hi=null,Tc=!1,Uo=!1,jr=!1,oo=0,lo=0,co=null,Mu=0;function di(){throw Error(_(321))}function Go(i,o){if(o===null)return!1;for(var f=0;f<o.length&&f<i.length;f++)if(!dr(i[f],o[f]))return!1;return!0}function uo(i,o,f,b,M,I){return Fn=I,on=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,jt.H=i===null||i.memoizedState===null?$d:fo,jr=!1,I=f(b,M),jr=!1,Uo&&(I=Pu(o,f,b,M)),kh(i),I}function kh(i){jt.H=Cc;var o=zn!==null&&zn.next!==null;if(Fn=0,hi=zn=on=null,Tc=!1,lo=0,co=null,o)throw Error(_(300));i===null||Yi||(i=i.dependencies,i!==null&&wu(i)&&(Yi=!0))}function Pu(i,o,f,b){on=i;var M=0;do{if(Uo&&(co=null),lo=0,Uo=!1,25<=M)throw Error(_(301));if(M+=1,hi=zn=null,i.updateQueue!=null){var I=i.updateQueue;I.lastEffect=null,I.events=null,I.stores=null,I.memoCache!=null&&(I.memoCache.index=0)}jt.H=lp,I=o(f,b)}while(Uo);return I}function zl(){var i=jt.H,o=i.useState()[0];return o=typeof o.then=="function"?a(o):o,i=i.useState()[0],(zn!==null?zn.memoizedState:null)!==i&&(on.flags|=1024),o}function Sc(){var i=oo!==0;return oo=0,i}function Du(i,o,f){o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~f}function Ec(i){if(Tc){for(i=i.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}Tc=!1}Fn=0,hi=zn=on=null,Uo=!1,lo=oo=0,co=null}function sr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hi===null?on.memoizedState=hi=i:hi=hi.next=i,hi}function v(){if(zn===null){var i=on.alternate;i=i!==null?i.memoizedState:null}else i=zn.next;var o=hi===null?on.memoizedState:hi.next;if(o!==null)hi=o,zn=i;else{if(i===null)throw on.alternate===null?Error(_(467)):Error(_(310));zn=i,i={memoizedState:zn.memoizedState,baseState:zn.baseState,baseQueue:zn.baseQueue,queue:zn.queue,next:null},hi===null?on.memoizedState=hi=i:hi=hi.next=i}return hi}function e(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function a(i){var o=lo;return lo+=1,co===null&&(co=[]),i=Dh(co,i,o),o=on,(hi===null?o.memoizedState:hi.next)===null&&(o=o.alternate,jt.H=o===null||o.memoizedState===null?$d:fo),i}function d(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return a(i);if(i.$$typeof===bt)return $i(i)}throw Error(_(438,String(i)))}function g(i){var o=null,f=on.updateQueue;if(f!==null&&(o=f.memoCache),o==null){var b=on.alternate;b!==null&&(b=b.updateQueue,b!==null&&(b=b.memoCache,b!=null&&(o={data:b.data.map(function(M){return M.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),f===null&&(f=e(),on.updateQueue=f),f.memoCache=o,f=o.data[o.index],f===void 0)for(f=o.data[o.index]=Array(i),b=0;b<i;b++)f[b]=Ae;return o.index++,f}function x(i,o){return typeof o=="function"?o(i):o}function E(i){var o=v();return P(o,zn,i)}function P(i,o,f){var b=i.queue;if(b===null)throw Error(_(311));b.lastRenderedReducer=f;var M=i.baseQueue,I=b.pending;if(I!==null){if(M!==null){var X=M.next;M.next=I.next,I.next=X}o.baseQueue=M=I,b.pending=null}if(I=i.baseState,M===null)i.memoizedState=I;else{o=M.next;var ot=X=null,Mt=null,Yt=o,le=!1;do{var fe=Yt.lane&-536870913;if(fe!==Yt.lane?(An&fe)===fe:(Fn&fe)===fe){var Jt=Yt.revertLane;if(Jt===0)Mt!==null&&(Mt=Mt.next={lane:0,revertLane:0,gesture:null,action:Yt.action,hasEagerState:Yt.hasEagerState,eagerState:Yt.eagerState,next:null}),fe===Ra&&(le=!0);else if((Fn&Jt)===Jt){Yt=Yt.next,Jt===Ra&&(le=!0);continue}else fe={lane:0,revertLane:Yt.revertLane,gesture:null,action:Yt.action,hasEagerState:Yt.hasEagerState,eagerState:Yt.eagerState,next:null},Mt===null?(ot=Mt=fe,X=I):Mt=Mt.next=fe,on.lanes|=Jt,Lc|=Jt;fe=Yt.action,jr&&f(I,fe),I=Yt.hasEagerState?Yt.eagerState:f(I,fe)}else Jt={lane:fe,revertLane:Yt.revertLane,gesture:Yt.gesture,action:Yt.action,hasEagerState:Yt.hasEagerState,eagerState:Yt.eagerState,next:null},Mt===null?(ot=Mt=Jt,X=I):Mt=Mt.next=Jt,on.lanes|=fe,Lc|=fe;Yt=Yt.next}while(Yt!==null&&Yt!==o);if(Mt===null?X=I:Mt.next=ot,!dr(I,i.memoizedState)&&(Yi=!0,le&&(f=As,f!==null)))throw f;i.memoizedState=I,i.baseState=X,i.baseQueue=Mt,b.lastRenderedState=I}return M===null&&(b.lanes=0),[i.memoizedState,b.dispatch]}function R(i){var o=v(),f=o.queue;if(f===null)throw Error(_(311));f.lastRenderedReducer=i;var b=f.dispatch,M=f.pending,I=o.memoizedState;if(M!==null){f.pending=null;var X=M=M.next;do I=i(I,X.action),X=X.next;while(X!==M);dr(I,o.memoizedState)||(Yi=!0),o.memoizedState=I,o.baseQueue===null&&(o.baseState=I),f.lastRenderedState=I}return[I,b]}function O(i,o,f){var b=on,M=v(),I=vn;if(I){if(f===void 0)throw Error(_(407));f=f()}else f=o();var X=!dr((zn||M).memoizedState,f);if(X&&(M.memoizedState=f,Yi=!0),M=M.queue,Ke(q.bind(null,b,M,i),[i]),M.getSnapshot!==o||X||hi!==null&&hi.memoizedState.tag&1){if(b.flags|=2048,ge(9,{destroy:void 0},$.bind(null,b,M,f,o),null),ni===null)throw Error(_(349));I||(Fn&127)!==0||j(b,o,f)}return f}function j(i,o,f){i.flags|=16384,i={getSnapshot:o,value:f},o=on.updateQueue,o===null?(o=e(),on.updateQueue=o,o.stores=[i]):(f=o.stores,f===null?o.stores=[i]:f.push(i))}function $(i,o,f,b){o.value=f,o.getSnapshot=b,Q(o)&&nt(i)}function q(i,o,f){return f(function(){Q(o)&&nt(i)})}function Q(i){var o=i.getSnapshot;i=i.value;try{var f=o();return!dr(i,f)}catch{return!0}}function nt(i){var o=zo(i,2);o!==null&&ys(o,i,2)}function lt(i){var o=sr();if(typeof i=="function"){var f=i;if(i=f(),jr){Ct(!0);try{f()}finally{Ct(!1)}}}return o.memoizedState=o.baseState=i,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:x,lastRenderedState:i},o}function ut(i,o,f,b){return i.baseState=f,P(i,zn,typeof b=="function"?b:x)}function ft(i,o,f,b,M){if(On(i))throw Error(_(485));if(i=o.action,i!==null){var I={payload:M,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(X){I.listeners.push(X)}};jt.T!==null?f(!0):I.isTransition=!1,b(I),f=o.pending,f===null?(I.next=o.pending=I,_t(o,I)):(I.next=f.next,o.pending=f.next=I)}}function _t(i,o){var f=o.action,b=o.payload,M=i.state;if(o.isTransition){var I=jt.T,X={};jt.T=X;try{var ot=f(M,b),Mt=jt.S;Mt!==null&&Mt(X,ot),Tt(i,o,ot)}catch(Yt){St(i,o,Yt)}finally{I!==null&&X.types!==null&&(I.types=X.types),jt.T=I}}else try{I=f(M,b),Tt(i,o,I)}catch(Yt){St(i,o,Yt)}}function Tt(i,o,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(b){gt(i,o,b)},function(b){return St(i,o,b)}):gt(i,o,f)}function gt(i,o,f){o.status="fulfilled",o.value=f,At(o),i.state=f,o=i.pending,o!==null&&(f=o.next,f===o?i.pending=null:(f=f.next,o.next=f,_t(i,f)))}function St(i,o,f){var b=i.pending;if(i.pending=null,b!==null){b=b.next;do o.status="rejected",o.reason=f,At(o),o=o.next;while(o!==b)}i.action=null}function At(i){i=i.listeners;for(var o=0;o<i.length;o++)(0,i[o])()}function xt(i,o){return o}function zt(i,o){if(vn){var f=ni.formState;if(f!==null){t:{var b=on;if(vn){if(Jn){e:{for(var M=Jn,I=wn;M.nodeType!==8;){if(!I){M=null;break e}if(M=Mr(M.nextSibling),M===null){M=null;break e}}I=M.data,M=I==="F!"||I==="F"?M:null}if(M){Jn=Mr(M.nextSibling),b=M.data==="F!";break t}}Di(b)}b=!1}b&&(o=f[0])}}return f=sr(),f.memoizedState=f.baseState=o,b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xt,lastRenderedState:o},f.queue=b,f=fi.bind(null,on,b),b.dispatch=f,b=lt(!1),I=Si.bind(null,on,!1,b.queue),b=sr(),M={state:o,dispatch:null,action:i,pending:null},b.queue=M,f=ft.bind(null,on,M,I,f),M.dispatch=f,b.memoizedState=i,[o,f,!1]}function $t(i){var o=v();return Vt(o,zn,i)}function Vt(i,o,f){if(o=P(i,o,xt)[0],i=E(x)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var b=a(o)}catch(X){throw X===Qs?Eu:X}else b=o;o=v();var M=o.queue,I=M.dispatch;return f!==o.memoizedState&&(on.flags|=2048,ge(9,{destroy:void 0},Ut.bind(null,M,f),null)),[b,I,i]}function Ut(i,o){i.action=o}function qt(i){var o=v(),f=zn;if(f!==null)return Vt(o,f,i);v(),o=o.memoizedState,f=v();var b=f.queue.dispatch;return f.memoizedState=i,[o,b,!1]}function ge(i,o,f,b){return i={tag:i,create:f,deps:b,inst:o,next:null},o=on.updateQueue,o===null&&(o=e(),on.updateQueue=o),f=o.lastEffect,f===null?o.lastEffect=i.next=i:(b=f.next,f.next=i,i.next=b,o.lastEffect=i),i}function ye(){return v().memoizedState}function oe(i,o,f,b){var M=sr();on.flags|=i,M.memoizedState=ge(1|o,{destroy:void 0},f,b===void 0?null:b)}function De(i,o,f,b){var M=v();b=b===void 0?null:b;var I=M.memoizedState.inst;zn!==null&&b!==null&&Go(b,zn.memoizedState.deps)?M.memoizedState=ge(o,I,f,b):(on.flags|=i,M.memoizedState=ge(1|o,I,f,b))}function tn(i,o){oe(8390656,8,i,o)}function Ke(i,o){De(2048,8,i,o)}function ei(i){on.flags|=4;var o=on.updateQueue;if(o===null)o=e(),on.updateQueue=o,o.events=[i];else{var f=o.events;f===null?o.events=[i]:f.push(i)}}function Hn(i){var o=v().memoizedState;return ei({ref:o,nextImpl:i}),function(){if((Pn&2)!==0)throw Error(_(440));return o.impl.apply(void 0,arguments)}}function li(i,o){return De(4,2,i,o)}function Vn(i,o){return De(4,4,i,o)}function Ii(i,o){if(typeof o=="function"){i=i();var f=o(i);return function(){typeof f=="function"?f():o(null)}}if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function ii(i,o,f){f=f!=null?f.concat([i]):null,De(4,4,Ii.bind(null,o,i),f)}function _i(){}function vi(i,o){var f=v();o=o===void 0?null:o;var b=f.memoizedState;return o!==null&&Go(o,b[1])?b[0]:(f.memoizedState=[i,o],i)}function Ti(i,o){var f=v();o=o===void 0?null:o;var b=f.memoizedState;if(o!==null&&Go(o,b[1]))return b[0];if(b=i(),jr){Ct(!0);try{i()}finally{Ct(!1)}}return f.memoizedState=[b,o],b}function Sr(i,o,f){return f===void 0||(Fn&1073741824)!==0&&(An&261930)===0?i.memoizedState=o:(i.memoizedState=f,i=Zm(),on.lanes|=i,Lc|=i,f)}function ka(i,o,f,b){return dr(f,o)?f:Rs.current!==null?(i=Sr(i,f,b),dr(i,o)||(Yi=!0),i):(Fn&42)===0||(Fn&1073741824)!==0&&(An&261930)===0?(Yi=!0,i.memoizedState=f):(i=Zm(),on.lanes|=i,Lc|=i,o)}function Js(i,o,f,b,M){var I=Qt.p;Qt.p=I!==0&&8>I?I:8;var X=jt.T,ot={};jt.T=ot,Si(i,!1,o,f);try{var Mt=M(),Yt=jt.S;if(Yt!==null&&Yt(ot,Mt),Mt!==null&&typeof Mt=="object"&&typeof Mt.then=="function"){var le=Tu(Mt,b);Xn(i,o,le,ia(i))}else Xn(i,o,b,ia(i))}catch(fe){Xn(i,o,{then:function(){},status:"rejected",reason:fe},ia())}finally{Qt.p=I,X!==null&&ot.types!==null&&(X.types=ot.types),jt.T=X}}function qo(){}function Oa(i,o,f,b){if(i.tag!==5)throw Error(_(476));var M=Zo(i).queue;Js(i,M,o,Gt,f===null?qo:function(){return fs(i),f(b)})}function Zo(i){var o=i.memoizedState;if(o!==null)return o;o={memoizedState:Gt,baseState:Gt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:x,lastRenderedState:Gt},next:null};var f={};return o.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:x,lastRenderedState:f},next:null},i.memoizedState=o,i=i.alternate,i!==null&&(i.memoizedState=o),o}function fs(i){var o=Zo(i);o.next===null&&(o=i.alternate.memoizedState),Xn(i,o.next.queue,{},ia())}function ta(){return $i(Ku)}function is(){return v().memoizedState}function Na(){return v().memoizedState}function Ll(i){for(var o=i.return;o!==null;){switch(o.tag){case 24:case 3:var f=ia();i=Bo(f);var b=Ps(o,i,f);b!==null&&(ys(b,o,f),ao(b,o,f)),o={cache:es()},i.payload=o;return}o=o.return}}function kl(i,o,f){var b=ia();f={lane:b,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},On(i)?ho(o,f):(f=Io(i,o,f,b),f!==null&&(ys(f,i,b),Zd(f,o,b)))}function fi(i,o,f){var b=ia();Xn(i,o,f,b)}function Xn(i,o,f,b){var M={lane:b,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(On(i))ho(o,M);else{var I=i.alternate;if(i.lanes===0&&(I===null||I.lanes===0)&&(I=o.lastRenderedReducer,I!==null))try{var X=o.lastRenderedState,ot=I(X,f);if(M.hasEagerState=!0,M.eagerState=ot,dr(ot,X))return Wa(i,o,M,0),ni===null&&yu(),!1}catch{}finally{}if(f=Io(i,o,M,b),f!==null)return ys(f,i,b),Zd(f,o,b),!0}return!1}function Si(i,o,f,b){if(b={lane:2,revertLane:df(),gesture:null,action:b,hasEagerState:!1,eagerState:null,next:null},On(i)){if(o)throw Error(_(479))}else o=Io(i,f,b,2),o!==null&&ys(o,i,2)}function On(i){var o=i.alternate;return i===on||o!==null&&o===on}function ho(i,o){Uo=Tc=!0;var f=i.pending;f===null?o.next=o:(o.next=f.next,f.next=o),i.pending=o}function Zd(i,o,f){if((f&4194048)!==0){var b=o.lanes;b&=i.pendingLanes,f|=b,o.lanes=f,En(i,f)}}var Cc={readContext:$i,use:d,useCallback:di,useContext:di,useEffect:di,useImperativeHandle:di,useLayoutEffect:di,useInsertionEffect:di,useMemo:di,useReducer:di,useRef:di,useState:di,useDebugValue:di,useDeferredValue:di,useTransition:di,useSyncExternalStore:di,useId:di,useHostTransitionStatus:di,useFormState:di,useActionState:di,useOptimistic:di,useMemoCache:di,useCacheRefresh:di};Cc.useEffectEvent=di;var $d={readContext:$i,use:d,useCallback:function(i,o){return sr().memoizedState=[i,o===void 0?null:o],i},useContext:$i,useEffect:tn,useImperativeHandle:function(i,o,f){f=f!=null?f.concat([i]):null,oe(4194308,4,Ii.bind(null,o,i),f)},useLayoutEffect:function(i,o){return oe(4194308,4,i,o)},useInsertionEffect:function(i,o){oe(4,2,i,o)},useMemo:function(i,o){var f=sr();o=o===void 0?null:o;var b=i();if(jr){Ct(!0);try{i()}finally{Ct(!1)}}return f.memoizedState=[b,o],b},useReducer:function(i,o,f){var b=sr();if(f!==void 0){var M=f(o);if(jr){Ct(!0);try{f(o)}finally{Ct(!1)}}}else M=o;return b.memoizedState=b.baseState=M,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:M},b.queue=i,i=i.dispatch=kl.bind(null,on,i),[b.memoizedState,i]},useRef:function(i){var o=sr();return i={current:i},o.memoizedState=i},useState:function(i){i=lt(i);var o=i.queue,f=fi.bind(null,on,o);return o.dispatch=f,[i.memoizedState,f]},useDebugValue:_i,useDeferredValue:function(i,o){var f=sr();return Sr(f,i,o)},useTransition:function(){var i=lt(!1);return i=Js.bind(null,on,i.queue,!0,!1),sr().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,o,f){var b=on,M=sr();if(vn){if(f===void 0)throw Error(_(407));f=f()}else{if(f=o(),ni===null)throw Error(_(349));(An&127)!==0||j(b,o,f)}M.memoizedState=f;var I={value:f,getSnapshot:o};return M.queue=I,tn(q.bind(null,b,I,i),[i]),b.flags|=2048,ge(9,{destroy:void 0},$.bind(null,b,I,f,o),null),f},useId:function(){var i=sr(),o=ni.identifierPrefix;if(vn){var f=Ca,b=ts;f=(b&~(1<<32-K(b)-1)).toString(32)+f,o="_"+o+"R_"+f,f=oo++,0<f&&(o+="H"+f.toString(32)),o+="_"}else f=Mu++,o="_"+o+"r_"+f.toString(32)+"_";return i.memoizedState=o},useHostTransitionStatus:ta,useFormState:zt,useActionState:zt,useOptimistic:function(i){var o=sr();o.memoizedState=o.baseState=i;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=f,o=Si.bind(null,on,!0,f),f.dispatch=o,[i,o]},useMemoCache:g,useCacheRefresh:function(){return sr().memoizedState=Ll.bind(null,on)},useEffectEvent:function(i){var o=sr(),f={impl:i};return o.memoizedState=f,function(){if((Pn&2)!==0)throw Error(_(440));return f.impl.apply(void 0,arguments)}}},fo={readContext:$i,use:d,useCallback:vi,useContext:$i,useEffect:Ke,useImperativeHandle:ii,useInsertionEffect:li,useLayoutEffect:Vn,useMemo:Ti,useReducer:E,useRef:ye,useState:function(){return E(x)},useDebugValue:_i,useDeferredValue:function(i,o){var f=v();return ka(f,zn.memoizedState,i,o)},useTransition:function(){var i=E(x)[0],o=v().memoizedState;return[typeof i=="boolean"?i:a(i),o]},useSyncExternalStore:O,useId:is,useHostTransitionStatus:ta,useFormState:$t,useActionState:$t,useOptimistic:function(i,o){var f=v();return ut(f,zn,i,o)},useMemoCache:g,useCacheRefresh:Na};fo.useEffectEvent=Hn;var lp={readContext:$i,use:d,useCallback:vi,useContext:$i,useEffect:Ke,useImperativeHandle:ii,useInsertionEffect:li,useLayoutEffect:Vn,useMemo:Ti,useReducer:R,useRef:ye,useState:function(){return R(x)},useDebugValue:_i,useDeferredValue:function(i,o){var f=v();return zn===null?Sr(f,i,o):ka(f,zn.memoizedState,i,o)},useTransition:function(){var i=R(x)[0],o=v().memoizedState;return[typeof i=="boolean"?i:a(i),o]},useSyncExternalStore:O,useId:is,useHostTransitionStatus:ta,useFormState:qt,useActionState:qt,useOptimistic:function(i,o){var f=v();return zn!==null?ut(f,zn,i,o):(f.baseState=i,[i,f.queue.dispatch])},useMemoCache:g,useCacheRefresh:Na};lp.useEffectEvent=Hn;function Fa(i,o,f,b){o=i.memoizedState,f=f(b,o),f=f==null?o:H({},o,f),i.memoizedState=f,i.lanes===0&&(i.updateQueue.baseState=f)}var Ac={enqueueSetState:function(i,o,f){i=i._reactInternals;var b=ia(),M=Bo(b);M.payload=o,f!=null&&(M.callback=f),o=Ps(i,M,b),o!==null&&(ys(o,i,b),ao(o,i,b))},enqueueReplaceState:function(i,o,f){i=i._reactInternals;var b=ia(),M=Bo(b);M.tag=1,M.payload=o,f!=null&&(M.callback=f),o=Ps(i,M,b),o!==null&&(ys(o,i,b),ao(o,i,b))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var f=ia(),b=Bo(f);b.tag=2,o!=null&&(b.callback=o),o=Ps(i,b,f),o!==null&&(ys(o,i,f),ao(o,i,f))}};function Oh(i,o,f,b,M,I,X){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(b,I,X):o.prototype&&o.prototype.isPureReactComponent?!Qr(f,b)||!Qr(M,I):!0}function po(i,o,f,b){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(f,b),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(f,b),o.state!==i&&Ac.enqueueReplaceState(o,o.state,null)}function Br(i,o){var f=o;if("ref"in o){f={};for(var b in o)b!=="ref"&&(f[b]=o[b])}if(i=i.defaultProps){f===o&&(f=H({},f));for(var M in i)f[M]===void 0&&(f[M]=i[M])}return f}function Nh(i){bl(i)}function Fh(i){console.error(i)}function cp(i){bl(i)}function Hd(i,o){try{var f=i.onUncaughtError;f(o.value,{componentStack:o.stack})}catch(b){setTimeout(function(){throw b})}}function Xd(i,o,f){try{var b=i.onCaughtError;b(f.value,{componentStack:f.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(M){setTimeout(function(){throw M})}}function up(i,o,f){return f=Bo(f),f.tag=3,f.payload={element:null},f.callback=function(){Hd(i,o)},f}function dy(i){return i=Bo(i),i.tag=3,i}function hp(i,o,f,b){var M=f.type.getDerivedStateFromError;if(typeof M=="function"){var I=b.value;i.payload=function(){return M(I)},i.callback=function(){Xd(o,f,b)}}var X=f.stateNode;X!==null&&typeof X.componentDidCatch=="function"&&(i.callback=function(){Xd(o,f,b),typeof M!="function"&&(Bl===null?Bl=new Set([this]):Bl.add(this));var ot=b.stack;this.componentDidCatch(b.value,{componentStack:ot!==null?ot:""})})}function bv(i,o,f,b,M){if(f.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){if(o=f.alternate,o!==null&&Fo(o,f,M,!0),f=mr.current,f!==null){switch(f.tag){case 31:case 13:return ti===null?Ep():f.alternate===null&&Ni===0&&(Ni=3),f.flags&=-257,f.flags|=65536,f.lanes=M,b===jo?f.flags|=16384:(o=f.updateQueue,o===null?f.updateQueue=new Set([b]):o.add(b),Km(i,b,M)),!1;case 22:return f.flags|=65536,b===jo?f.flags|=16384:(o=f.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([b])},f.updateQueue=o):(f=o.retryQueue,f===null?o.retryQueue=new Set([b]):f.add(b)),Km(i,b,M)),!1}throw Error(_(435,f.tag))}return Km(i,b,M),Ep(),!1}if(vn)return o=mr.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=M,b!==Ws&&(i=Error(_(422),{cause:b}),to(Nr(i,f)))):(b!==Ws&&(o=Error(_(423),{cause:b}),to(Nr(o,f))),i=i.current.alternate,i.flags|=65536,M&=-M,i.lanes|=M,b=Nr(b,f),M=up(i.stateNode,b,M),Au(i,M),Ni!==4&&(Ni=2)),!1;var I=Error(_(520),{cause:b});if(I=Nr(I,f),ju===null?ju=[I]:ju.push(I),Ni!==4&&(Ni=2),o===null)return!0;b=Nr(b,f),f=o;do{switch(f.tag){case 3:return f.flags|=65536,i=M&-M,f.lanes|=i,i=up(f.stateNode,b,i),Au(f,i),!1;case 1:if(o=f.type,I=f.stateNode,(f.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(Bl===null||!Bl.has(I))))return f.flags|=65536,M&=-M,f.lanes|=M,M=dy(M),hp(M,i,f,b),Au(f,M),!1}f=f.return}while(f!==null);return!1}var Yd=Error(_(461)),Yi=!1;function Er(i,o,f,b){o.child=i===null?ap(o,null,f,b):ro(o,i.child,f,b)}function Ru(i,o,f,b,M){f=f.render;var I=o.ref;if("ref"in b){var X={};for(var ot in b)ot!=="ref"&&(X[ot]=b[ot])}else X=b;return eo(o),b=uo(i,o,f,X,I,M),ot=Sc(),i!==null&&!Yi?(Du(i,o,M),mo(i,o,M)):(vn&&ot&&_c(o),o.flags|=1,Er(i,o,b,M),o.child)}function fy(i,o,f,b,M){if(i===null){var I=f.type;return typeof I=="function"&&!wl(I)&&I.defaultProps===void 0&&f.compare===null?(o.tag=15,o.type=I,Iu(i,o,I,b,M)):(i=_u(f.type,null,b,o,o.mode,M),i.ref=o.ref,i.return=o,o.child=i)}if(I=i.child,!Rm(i,M)){var X=I.memoizedProps;if(f=f.compare,f=f!==null?f:Qr,f(X,b)&&i.ref===o.ref)return mo(i,o,M)}return o.flags|=1,i=Xs(I,b),i.ref=o.ref,i.return=o,o.child=i}function Iu(i,o,f,b,M){if(i!==null){var I=i.memoizedProps;if(Qr(I,b)&&i.ref===o.ref)if(Yi=!1,o.pendingProps=b=I,Rm(i,M))(i.flags&131072)!==0&&(Yi=!0);else return o.lanes=i.lanes,mo(i,o,M)}return Qd(i,o,f,b,M)}function Wd(i,o,f,b){var M=b.children,I=i!==null?i.memoizedState:null;if(i===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),b.mode==="hidden"){if((o.flags&128)!==0){if(I=I!==null?I.baseLanes|f:f,i!==null){for(b=o.child=i.child,M=0;b!==null;)M=M|b.lanes|b.childLanes,b=b.sibling;b=M&~I}else b=0,o.child=null;return py(i,o,I,f,b)}if((f&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},i!==null&&ns(o,I!==null?I.cachePool:null),I!==null?Ve(o,I):Il(),op(o);else return b=o.lanes=536870912,py(i,o,I!==null?I.baseLanes|f:f,f,b)}else I!==null?(ns(o,I.cachePool),Ve(o,I),Vo(),o.memoizedState=null):(i!==null&&ns(o,null),Il(),Vo());return Er(i,o,M,f),o.child}function Mc(i,o){return i!==null&&i.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function py(i,o,f,b,M){var I=Al();return I=I===null?null:{parent:Ri._currentValue,pool:I},o.memoizedState={baseLanes:f,cachePool:I},i!==null&&ns(o,null),Il(),op(o),i!==null&&Fo(i,o,b,!0),o.childLanes=M,null}function dp(i,o){return o=tf({mode:o.mode,children:o.children},i.mode),o.ref=i.ref,i.child=o,o.return=i,o}function my(i,o,f){return ro(o,i.child,null,f),i=dp(o,o.pendingProps),i.flags|=2,ds(o),o.memoizedState=null,i}function wv(i,o,f){var b=o.pendingProps,M=(o.flags&128)!==0;if(o.flags&=-129,i===null){if(vn){if(b.mode==="hidden")return i=dp(o,b),o.lanes=536870912,Mc(null,i);if(Lh(o),(i=Jn)?(i=Fi(i,wn),i=i!==null&&i.data==="&"?i:null,i!==null&&(o.memoizedState={dehydrated:i,treeContext:Ja!==null?{id:ts,overflow:Ca}:null,retryLane:536870912,hydrationErrors:null},f=vu(i),f.return=o,o.child=f,Oi=o,Jn=null)):i=null,i===null)throw Di(o);return o.lanes=536870912,null}return dp(o,b)}var I=i.memoizedState;if(I!==null){var X=I.dehydrated;if(Lh(o),M)if(o.flags&256)o.flags&=-257,o=my(i,o,f);else if(o.memoizedState!==null)o.child=i.child,o.flags|=128,o=null;else throw Error(_(558));else if(Yi||Fo(i,o,f,!1),M=(f&i.childLanes)!==0,Yi||M){if(b=ni,b!==null&&(X=Un(b,f),X!==0&&X!==I.retryLane))throw I.retryLane=X,zo(i,X),ys(b,i,X),Yd;Ep(),o=my(i,o,f)}else i=I.treeContext,Jn=Mr(X.nextSibling),Oi=o,vn=!0,Aa=null,wn=!1,i!==null&&Bd(o,i),o=dp(o,b),o.flags|=4096;return o}return i=Xs(i.child,{mode:b.mode,children:b.children}),i.ref=o.ref,o.child=i,i.return=o,i}function Kd(i,o){var f=o.ref;if(f===null)i!==null&&i.ref!==null&&(o.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(_(284));(i===null||i.ref!==f)&&(o.flags|=4194816)}}function Qd(i,o,f,b,M){return eo(o),f=uo(i,o,f,b,void 0,M),b=Sc(),i!==null&&!Yi?(Du(i,o,M),mo(i,o,M)):(vn&&b&&_c(o),o.flags|=1,Er(i,o,f,M),o.child)}function Am(i,o,f,b,M,I){return eo(o),o.updateQueue=null,f=Pu(o,b,f,M),kh(i),b=Sc(),i!==null&&!Yi?(Du(i,o,I),mo(i,o,I)):(vn&&b&&_c(o),o.flags|=1,Er(i,o,f,I),o.child)}function Mm(i,o,f,b,M){if(eo(o),o.stateNode===null){var I=Ka,X=f.contextType;typeof X=="object"&&X!==null&&(I=$i(X)),I=new f(b,I),o.memoizedState=I.state!==null&&I.state!==void 0?I.state:null,I.updater=Ac,o.stateNode=I,I._reactInternals=o,I=o.stateNode,I.props=b,I.state=o.memoizedState,I.refs={},La(o),X=f.contextType,I.context=typeof X=="object"&&X!==null?$i(X):Ka,I.state=o.memoizedState,X=f.getDerivedStateFromProps,typeof X=="function"&&(Fa(o,f,X,b),I.state=o.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof I.getSnapshotBeforeUpdate=="function"||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(X=I.state,typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount(),X!==I.state&&Ac.enqueueReplaceState(I,I.state,null),Rl(o,b,I,M),Dl(),I.state=o.memoizedState),typeof I.componentDidMount=="function"&&(o.flags|=4194308),b=!0}else if(i===null){I=o.stateNode;var ot=o.memoizedProps,Mt=Br(f,ot);I.props=Mt;var Yt=I.context,le=f.contextType;X=Ka,typeof le=="object"&&le!==null&&(X=$i(le));var fe=f.getDerivedStateFromProps;le=typeof fe=="function"||typeof I.getSnapshotBeforeUpdate=="function",ot=o.pendingProps!==ot,le||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(ot||Yt!==X)&&po(o,I,b,X),so=!1;var Jt=o.memoizedState;I.state=Jt,Rl(o,b,I,M),Dl(),Yt=o.memoizedState,ot||Jt!==Yt||so?(typeof fe=="function"&&(Fa(o,f,fe,b),Yt=o.memoizedState),(Mt=so||Oh(o,f,Mt,b,Jt,Yt,X))?(le||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(o.flags|=4194308)):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=b,o.memoizedState=Yt),I.props=b,I.state=Yt,I.context=X,b=Mt):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),b=!1)}else{I=o.stateNode,kn(i,o),X=o.memoizedProps,le=Br(f,X),I.props=le,fe=o.pendingProps,Jt=I.context,Yt=f.contextType,Mt=Ka,typeof Yt=="object"&&Yt!==null&&(Mt=$i(Yt)),ot=f.getDerivedStateFromProps,(Yt=typeof ot=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(X!==fe||Jt!==Mt)&&po(o,I,b,Mt),so=!1,Jt=o.memoizedState,I.state=Jt,Rl(o,b,I,M),Dl();var ne=o.memoizedState;X!==fe||Jt!==ne||so||i!==null&&i.dependencies!==null&&wu(i.dependencies)?(typeof ot=="function"&&(Fa(o,f,ot,b),ne=o.memoizedState),(le=so||Oh(o,f,le,b,Jt,ne,Mt)||i!==null&&i.dependencies!==null&&wu(i.dependencies))?(Yt||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(b,ne,Mt),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(b,ne,Mt)),typeof I.componentDidUpdate=="function"&&(o.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof I.componentDidUpdate!="function"||X===i.memoizedProps&&Jt===i.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||X===i.memoizedProps&&Jt===i.memoizedState||(o.flags|=1024),o.memoizedProps=b,o.memoizedState=ne),I.props=b,I.state=ne,I.context=Mt,b=le):(typeof I.componentDidUpdate!="function"||X===i.memoizedProps&&Jt===i.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||X===i.memoizedProps&&Jt===i.memoizedState||(o.flags|=1024),b=!1)}return I=b,Kd(i,o),b=(o.flags&128)!==0,I||b?(I=o.stateNode,f=b&&typeof f.getDerivedStateFromError!="function"?null:I.render(),o.flags|=1,i!==null&&b?(o.child=ro(o,i.child,null,M),o.child=ro(o,null,f,M)):Er(i,o,f,M),o.memoizedState=I.state,i=o.child):i=mo(i,o,M),i}function gy(i,o,f,b){return Cs(),o.flags|=256,Er(i,o,f,b),o.child}var Pm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function fp(i){return{baseLanes:i,cachePool:Me()}}function pp(i,o,f){return i=i!==null?i.childLanes&~f:0,o&&(i|=na),i}function yy(i,o,f){var b=o.pendingProps,M=!1,I=(o.flags&128)!==0,X;if((X=I)||(X=i!==null&&i.memoizedState===null?!1:(oi.current&2)!==0),X&&(M=!0,o.flags&=-129),X=(o.flags&32)!==0,o.flags&=-33,i===null){if(vn){if(M?Xi(o):Vo(),(i=Jn)?(i=Fi(i,wn),i=i!==null&&i.data!=="&"?i:null,i!==null&&(o.memoizedState={dehydrated:i,treeContext:Ja!==null?{id:ts,overflow:Ca}:null,retryLane:536870912,hydrationErrors:null},f=vu(i),f.return=o,o.child=f,Oi=o,Jn=null)):i=null,i===null)throw Di(o);return hg(i)?o.lanes=32:o.lanes=536870912,null}var ot=b.children;return b=b.fallback,M?(Vo(),M=o.mode,ot=tf({mode:"hidden",children:ot},M),b=Tl(b,M,f,null),ot.return=o,b.return=o,ot.sibling=b,o.child=ot,b=o.child,b.memoizedState=fp(f),b.childLanes=pp(i,X,f),o.memoizedState=Pm,Mc(null,b)):(Xi(o),Jd(o,ot))}var Mt=i.memoizedState;if(Mt!==null&&(ot=Mt.dehydrated,ot!==null)){if(I)o.flags&256?(Xi(o),o.flags&=-257,o=ef(i,o,f)):o.memoizedState!==null?(Vo(),o.child=i.child,o.flags|=128,o=null):(Vo(),ot=b.fallback,M=o.mode,b=tf({mode:"visible",children:b.children},M),ot=Tl(ot,M,f,null),ot.flags|=2,b.return=o,ot.return=o,b.sibling=ot,o.child=b,ro(o,i.child,null,f),b=o.child,b.memoizedState=fp(f),b.childLanes=pp(i,X,f),o.memoizedState=Pm,o=Mc(null,b));else if(Xi(o),hg(ot)){if(X=ot.nextSibling&&ot.nextSibling.dataset,X)var Yt=X.dgst;X=Yt,b=Error(_(419)),b.stack="",b.digest=X,to({value:b,source:null,stack:null}),o=ef(i,o,f)}else if(Yi||Fo(i,o,f,!1),X=(f&i.childLanes)!==0,Yi||X){if(X=ni,X!==null&&(b=Un(X,f),b!==0&&b!==Mt.retryLane))throw Mt.retryLane=b,zo(i,b),ys(X,i,b),Yd;td(ot)||Ep(),o=ef(i,o,f)}else td(ot)?(o.flags|=192,o.child=i.child,o=null):(i=Mt.treeContext,Jn=Mr(ot.nextSibling),Oi=o,vn=!0,Aa=null,wn=!1,i!==null&&Bd(o,i),o=Jd(o,b.children),o.flags|=4096);return o}return M?(Vo(),ot=b.fallback,M=o.mode,Mt=i.child,Yt=Mt.sibling,b=Xs(Mt,{mode:"hidden",children:b.children}),b.subtreeFlags=Mt.subtreeFlags&65011712,Yt!==null?ot=Xs(Yt,ot):(ot=Tl(ot,M,f,null),ot.flags|=2),ot.return=o,b.return=o,b.sibling=ot,o.child=b,Mc(null,b),b=o.child,ot=i.child.memoizedState,ot===null?ot=fp(f):(M=ot.cachePool,M!==null?(Mt=Ri._currentValue,M=M.parent!==Mt?{parent:Mt,pool:Mt}:M):M=Me(),ot={baseLanes:ot.baseLanes|f,cachePool:M}),b.memoizedState=ot,b.childLanes=pp(i,X,f),o.memoizedState=Pm,Mc(i.child,b)):(Xi(o),f=i.child,i=f.sibling,f=Xs(f,{mode:"visible",children:b.children}),f.return=o,f.sibling=null,i!==null&&(X=o.deletions,X===null?(o.deletions=[i],o.flags|=16):X.push(i)),o.child=f,o.memoizedState=null,f)}function Jd(i,o){return o=tf({mode:"visible",children:o},i.mode),o.return=i,i.child=o}function tf(i,o){return i=Jr(22,i,null,o),i.lanes=0,i}function ef(i,o,f){return ro(o,i.child,null,f),i=Jd(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function jh(i,o,f){i.lanes|=o;var b=i.alternate;b!==null&&(b.lanes|=o),Mh(i.return,o,f)}function Vr(i,o,f,b,M,I){var X=i.memoizedState;X===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:b,tail:f,tailMode:M,treeForkCount:I}:(X.isBackwards=o,X.rendering=null,X.renderingStartTime=0,X.last=b,X.tail=f,X.tailMode=M,X.treeForkCount=I)}function Dm(i,o,f){var b=o.pendingProps,M=b.revealOrder,I=b.tail;b=b.children;var X=oi.current,ot=(X&2)!==0;if(ot?(X=X&1|2,o.flags|=128):X&=1,be(oi,X),Er(i,o,b,f),b=vn?ko:0,!ot&&i!==null&&(i.flags&128)!==0)t:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&jh(i,f,o);else if(i.tag===19)jh(i,f,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break t;for(;i.sibling===null;){if(i.return===null||i.return===o)break t;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(M){case"forwards":for(f=o.child,M=null;f!==null;)i=f.alternate,i!==null&&In(i)===null&&(M=f),f=f.sibling;f=M,f===null?(M=o.child,o.child=null):(M=f.sibling,f.sibling=null),Vr(o,!1,M,f,I,b);break;case"backwards":case"unstable_legacy-backwards":for(f=null,M=o.child,o.child=null;M!==null;){if(i=M.alternate,i!==null&&In(i)===null){o.child=M;break}i=M.sibling,M.sibling=f,f=M,M=i}Vr(o,!0,f,null,I,b);break;case"together":Vr(o,!1,null,null,void 0,b);break;default:o.memoizedState=null}return o.child}function mo(i,o,f){if(i!==null&&(o.dependencies=i.dependencies),Lc|=o.lanes,(f&o.childLanes)===0)if(i!==null){if(Fo(i,o,f,!1),(f&o.childLanes)===0)return null}else return null;if(i!==null&&o.child!==i.child)throw Error(_(153));if(o.child!==null){for(i=o.child,f=Xs(i,i.pendingProps),o.child=f,f.return=o;i.sibling!==null;)i=i.sibling,f=f.sibling=Xs(i,i.pendingProps),f.return=o;f.sibling=null}return o.child}function Rm(i,o){return(i.lanes&o)!==0?!0:(i=i.dependencies,!!(i!==null&&wu(i)))}function _y(i,o,f){switch(o.tag){case 3:yn(o,o.stateNode.containerInfo),Ma(o,Ri,i.memoizedState.cache),Cs();break;case 27:case 5:Gi(o);break;case 4:yn(o,o.stateNode.containerInfo);break;case 10:Ma(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Lh(o),null;break;case 13:var b=o.memoizedState;if(b!==null)return b.dehydrated!==null?(Xi(o),o.flags|=128,null):(f&o.child.childLanes)!==0?yy(i,o,f):(Xi(o),i=mo(i,o,f),i!==null?i.sibling:null);Xi(o);break;case 19:var M=(i.flags&128)!==0;if(b=(f&o.childLanes)!==0,b||(Fo(i,o,f,!1),b=(f&o.childLanes)!==0),M){if(b)return Dm(i,o,f);o.flags|=128}if(M=o.memoizedState,M!==null&&(M.rendering=null,M.tail=null,M.lastEffect=null),be(oi,oi.current),b)break;return null;case 22:return o.lanes=0,Wd(i,o,f,o.pendingProps);case 24:Ma(o,Ri,i.memoizedState.cache)}return mo(i,o,f)}function vy(i,o,f){if(i!==null)if(i.memoizedProps!==o.pendingProps)Yi=!0;else{if(!Rm(i,f)&&(o.flags&128)===0)return Yi=!1,_y(i,o,f);Yi=(i.flags&131072)!==0}else Yi=!1,vn&&(o.flags&1048576)!==0&&yc(o,ko,o.index);switch(o.lanes=0,o.tag){case 16:t:{var b=o.pendingProps;if(i=Ml(o.elementType),o.type=i,typeof i=="function")wl(i)?(b=Br(i,b),o.tag=1,o=Mm(null,o,i,b,f)):(o.tag=0,o=Qd(null,o,i,b,f));else{if(i!=null){var M=i.$$typeof;if(M===Lt){o.tag=11,o=Ru(null,o,i,b,f);break t}else if(M===Nt){o.tag=14,o=fy(null,o,i,b,f);break t}}throw o=Ee(i)||i,Error(_(306,o,""))}}return o;case 0:return Qd(i,o,o.type,o.pendingProps,f);case 1:return b=o.type,M=Br(b,o.pendingProps),Mm(i,o,b,M,f);case 3:t:{if(yn(o,o.stateNode.containerInfo),i===null)throw Error(_(387));b=o.pendingProps;var I=o.memoizedState;M=I.element,kn(i,o),Rl(o,b,null,f);var X=o.memoizedState;if(b=X.cache,Ma(o,Ri,b),b!==I.cache&&Pa(o,[Ri],f,!0),Dl(),b=X.element,I.isDehydrated)if(I={element:b,isDehydrated:!1,cache:X.cache},o.updateQueue.baseState=I,o.memoizedState=I,o.flags&256){o=gy(i,o,b,f);break t}else if(b!==M){M=Nr(Error(_(424)),o),to(M),o=gy(i,o,b,f);break t}else{switch(i=o.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(Jn=Mr(i.firstChild),Oi=o,vn=!0,Aa=null,wn=!0,f=ap(o,null,b,f),o.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(Cs(),b===M){o=mo(i,o,f);break t}Er(i,o,b,f)}o=o.child}return o;case 26:return Kd(i,o),i===null?(f=mg(o.type,null,o.pendingProps,null))?o.memoizedState=f:vn||(f=o.type,i=o.pendingProps,b=Jh($e.current).createElement(f),b[ce]=o,b[Ce]=i,Ar(b,f,i),gi(b),o.stateNode=b):o.memoizedState=mg(o.type,i.memoizedProps,o.pendingProps,i.memoizedState),null;case 27:return Gi(o),i===null&&vn&&(b=o.stateNode=fg(o.type,o.pendingProps,$e.current),Oi=o,wn=!0,M=Jn,Qi(o.type)?(Fc=M,Jn=Mr(b.firstChild)):Jn=M),Er(i,o,o.pendingProps.children,f),Kd(i,o),i===null&&(o.flags|=4194304),o.child;case 5:return i===null&&vn&&((M=b=Jn)&&(b=aa(b,o.type,o.pendingProps,wn),b!==null?(o.stateNode=b,Oi=o,Jn=Mr(b.firstChild),wn=!1,M=!0):M=!1),M||Di(o)),Gi(o),M=o.type,I=o.pendingProps,X=i!==null?i.memoizedProps:null,b=I.children,vf(M,I)?b=null:X!==null&&vf(M,X)&&(o.flags|=32),o.memoizedState!==null&&(M=uo(i,o,zl,null,null,f),Ku._currentValue=M),Kd(i,o),Er(i,o,b,f),o.child;case 6:return i===null&&vn&&((i=f=Jn)&&(f=ug(f,o.pendingProps,wn),f!==null?(o.stateNode=f,Oi=o,Jn=null,i=!0):i=!1),i||Di(o)),null;case 13:return yy(i,o,f);case 4:return yn(o,o.stateNode.containerInfo),b=o.pendingProps,i===null?o.child=ro(o,null,b,f):Er(i,o,b,f),o.child;case 11:return Ru(i,o,o.type,o.pendingProps,f);case 7:return Er(i,o,o.pendingProps,f),o.child;case 8:return Er(i,o,o.pendingProps.children,f),o.child;case 12:return Er(i,o,o.pendingProps.children,f),o.child;case 10:return b=o.pendingProps,Ma(o,o.type,b.value),Er(i,o,b.children,f),o.child;case 9:return M=o.type._context,b=o.pendingProps.children,eo(o),M=$i(M),b=b(M),o.flags|=1,Er(i,o,b,f),o.child;case 14:return fy(i,o,o.type,o.pendingProps,f);case 15:return Iu(i,o,o.type,o.pendingProps,f);case 19:return Dm(i,o,f);case 31:return wv(i,o,f);case 22:return Wd(i,o,f,o.pendingProps);case 24:return eo(o),b=$i(Ri),i===null?(M=Al(),M===null&&(M=ni,I=es(),M.pooledCache=I,I.refCount++,I!==null&&(M.pooledCacheLanes|=f),M=I),o.memoizedState={parent:b,cache:M},La(o),Ma(o,Ri,M)):((i.lanes&f)!==0&&(kn(i,o),Rl(o,null,null,f),Dl()),M=i.memoizedState,I=o.memoizedState,M.parent!==b?(M={parent:b,cache:b},o.memoizedState=M,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=M),Ma(o,Ri,b)):(b=I.cache,Ma(o,Ri,b),b!==M.cache&&Pa(o,[Ri],f,!0))),Er(i,o,o.pendingProps.children,f),o.child;case 29:throw o.pendingProps}throw Error(_(156,o.tag))}function Ol(i){i.flags|=4}function mp(i,o,f,b,M){if((o=(i.mode&32)!==0)&&(o=!1),o){if(i.flags|=16777216,(M&335544128)===M)if(i.stateNode.complete)i.flags|=8192;else if(Uu())i.flags|=8192;else throw Ms=jo,Su}else i.flags&=-16777217}function xy(i,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!vg(o))if(Uu())i.flags|=8192;else throw Ms=jo,Su}function Bh(i,o){o!==null&&(i.flags|=4),i.flags&16384&&(o=i.tag!==22?Pe():536870912,i.lanes|=o,Fu|=o)}function Vh(i,o){if(!vn)switch(i.tailMode){case"hidden":o=i.tail;for(var f=null;o!==null;)o.alternate!==null&&(f=o),o=o.sibling;f===null?i.tail=null:f.sibling=null;break;case"collapsed":f=i.tail;for(var b=null;f!==null;)f.alternate!==null&&(b=f),f=f.sibling;b===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:b.sibling=null}}function pi(i){var o=i.alternate!==null&&i.alternate.child===i.child,f=0,b=0;if(o)for(var M=i.child;M!==null;)f|=M.lanes|M.childLanes,b|=M.subtreeFlags&65011712,b|=M.flags&65011712,M.return=i,M=M.sibling;else for(M=i.child;M!==null;)f|=M.lanes|M.childLanes,b|=M.subtreeFlags,b|=M.flags,M.return=i,M=M.sibling;return i.subtreeFlags|=b,i.childLanes=f,o}function Tv(i,o,f){var b=o.pendingProps;switch(Ah(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pi(o),null;case 1:return pi(o),null;case 3:return f=o.stateNode,b=null,i!==null&&(b=i.memoizedState.cache),o.memoizedState.cache!==b&&(o.flags|=2048),hs(Ri),Mn(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(i===null||i.child===null)&&(Cl(o)?Ol(o):i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,xu())),pi(o),null;case 26:var M=o.type,I=o.memoizedState;return i===null?(Ol(o),I!==null?(pi(o),xy(o,I)):(pi(o),mp(o,M,null,b,f))):I?I!==i.memoizedState?(Ol(o),pi(o),xy(o,I)):(pi(o),o.flags&=-16777217):(i=i.memoizedProps,i!==b&&Ol(o),pi(o),mp(o,M,i,b,f)),null;case 27:if(br(o),f=$e.current,M=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==b&&Ol(o);else{if(!b){if(o.stateNode===null)throw Error(_(166));return pi(o),null}i=Te.current,Cl(o)?vc(o):(i=fg(M,b,f),o.stateNode=i,Ol(o))}return pi(o),null;case 5:if(br(o),M=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==b&&Ol(o);else{if(!b){if(o.stateNode===null)throw Error(_(166));return pi(o),null}if(I=Te.current,Cl(o))vc(o);else{var X=Jh($e.current);switch(I){case 1:I=X.createElementNS("http://www.w3.org/2000/svg",M);break;case 2:I=X.createElementNS("http://www.w3.org/1998/Math/MathML",M);break;default:switch(M){case"svg":I=X.createElementNS("http://www.w3.org/2000/svg",M);break;case"math":I=X.createElementNS("http://www.w3.org/1998/Math/MathML",M);break;case"script":I=X.createElement("div"),I.innerHTML="<script><\/script>",I=I.removeChild(I.firstChild);break;case"select":I=typeof b.is=="string"?X.createElement("select",{is:b.is}):X.createElement("select"),b.multiple?I.multiple=!0:b.size&&(I.size=b.size);break;default:I=typeof b.is=="string"?X.createElement(M,{is:b.is}):X.createElement(M)}}I[ce]=o,I[Ce]=b;t:for(X=o.child;X!==null;){if(X.tag===5||X.tag===6)I.appendChild(X.stateNode);else if(X.tag!==4&&X.tag!==27&&X.child!==null){X.child.return=X,X=X.child;continue}if(X===o)break t;for(;X.sibling===null;){if(X.return===null||X.return===o)break t;X=X.return}X.sibling.return=X.return,X=X.sibling}o.stateNode=I;t:switch(Ar(I,M,b),M){case"button":case"input":case"select":case"textarea":b=!!b.autoFocus;break t;case"img":b=!0;break t;default:b=!1}b&&Ol(o)}}return pi(o),mp(o,o.type,i===null?null:i.memoizedProps,o.pendingProps,f),null;case 6:if(i&&o.stateNode!=null)i.memoizedProps!==b&&Ol(o);else{if(typeof b!="string"&&o.stateNode===null)throw Error(_(166));if(i=$e.current,Cl(o)){if(i=o.stateNode,f=o.memoizedProps,b=null,M=Oi,M!==null)switch(M.tag){case 27:case 5:b=M.memoizedProps}i[ce]=o,i=!!(i.nodeValue===f||b!==null&&b.suppressHydrationWarning===!0||$u(i.nodeValue,f)),i||Di(o,!0)}else i=Jh(i).createTextNode(b),i[ce]=o,o.stateNode=i}return pi(o),null;case 31:if(f=o.memoizedState,i===null||i.memoizedState!==null){if(b=Cl(o),f!==null){if(i===null){if(!b)throw Error(_(318));if(i=o.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(_(557));i[ce]=o}else Cs(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;pi(o),i=!1}else f=xu(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=f),i=!0;if(!i)return o.flags&256?(ds(o),o):(ds(o),null);if((o.flags&128)!==0)throw Error(_(558))}return pi(o),null;case 13:if(b=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(M=Cl(o),b!==null&&b.dehydrated!==null){if(i===null){if(!M)throw Error(_(318));if(M=o.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(_(317));M[ce]=o}else Cs(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;pi(o),M=!1}else M=xu(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=M),M=!0;if(!M)return o.flags&256?(ds(o),o):(ds(o),null)}return ds(o),(o.flags&128)!==0?(o.lanes=f,o):(f=b!==null,i=i!==null&&i.memoizedState!==null,f&&(b=o.child,M=null,b.alternate!==null&&b.alternate.memoizedState!==null&&b.alternate.memoizedState.cachePool!==null&&(M=b.alternate.memoizedState.cachePool.pool),I=null,b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(I=b.memoizedState.cachePool.pool),I!==M&&(b.flags|=2048)),f!==i&&f&&(o.child.flags|=8192),Bh(o,o.updateQueue),pi(o),null);case 4:return Mn(),i===null&&Ip(o.stateNode.containerInfo),pi(o),null;case 10:return hs(o.type),pi(o),null;case 19:if(se(oi),b=o.memoizedState,b===null)return pi(o),null;if(M=(o.flags&128)!==0,I=b.rendering,I===null)if(M)Vh(b,!1);else{if(Ni!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(I=In(i),I!==null){for(o.flags|=128,Vh(b,!1),i=I.updateQueue,o.updateQueue=i,Bh(o,i),o.subtreeFlags=0,i=f,f=o.child;f!==null;)np(f,i),f=f.sibling;return be(oi,oi.current&1|2),vn&&Ys(o,b.treeForkCount),o.child}i=i.sibling}b.tail!==null&&qi()>Bu&&(o.flags|=128,M=!0,Vh(b,!1),o.lanes=4194304)}else{if(!M)if(i=In(I),i!==null){if(o.flags|=128,M=!0,i=i.updateQueue,o.updateQueue=i,Bh(o,i),Vh(b,!0),b.tail===null&&b.tailMode==="hidden"&&!I.alternate&&!vn)return pi(o),null}else 2*qi()-b.renderingStartTime>Bu&&f!==536870912&&(o.flags|=128,M=!0,Vh(b,!1),o.lanes=4194304);b.isBackwards?(I.sibling=o.child,o.child=I):(i=b.last,i!==null?i.sibling=I:o.child=I,b.last=I)}return b.tail!==null?(i=b.tail,b.rendering=i,b.tail=i.sibling,b.renderingStartTime=qi(),i.sibling=null,f=oi.current,be(oi,M?f&1|2:f&1),vn&&Ys(o,b.treeForkCount),i):(pi(o),null);case 22:case 23:return ds(o),zh(),b=o.memoizedState!==null,i!==null?i.memoizedState!==null!==b&&(o.flags|=8192):b&&(o.flags|=8192),b?(f&536870912)!==0&&(o.flags&128)===0&&(pi(o),o.subtreeFlags&6&&(o.flags|=8192)):pi(o),f=o.updateQueue,f!==null&&Bh(o,f.retryQueue),f=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),b=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(b=o.memoizedState.cachePool.pool),b!==f&&(o.flags|=2048),i!==null&&se(Ia),null;case 24:return f=null,i!==null&&(f=i.memoizedState.cache),o.memoizedState.cache!==f&&(o.flags|=2048),hs(Ri),pi(o),null;case 25:return null;case 30:return null}throw Error(_(156,o.tag))}function Sv(i,o){switch(Ah(o),o.tag){case 1:return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return hs(Ri),Mn(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 26:case 27:case 5:return br(o),null;case 31:if(o.memoizedState!==null){if(ds(o),o.alternate===null)throw Error(_(340));Cs()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 13:if(ds(o),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(_(340));Cs()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return se(oi),null;case 4:return Mn(),null;case 10:return hs(o.type),null;case 22:case 23:return ds(o),zh(),i!==null&&se(Ia),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 24:return hs(Ri),null;case 25:return null;default:return null}}function by(i,o){switch(Ah(o),o.tag){case 3:hs(Ri),Mn();break;case 26:case 27:case 5:br(o);break;case 4:Mn();break;case 31:o.memoizedState!==null&&ds(o);break;case 13:ds(o);break;case 19:se(oi);break;case 10:hs(o.type);break;case 22:case 23:ds(o),zh(),i!==null&&se(Ia);break;case 24:hs(Ri)}}function Pc(i,o){try{var f=o.updateQueue,b=f!==null?f.lastEffect:null;if(b!==null){var M=b.next;f=M;do{if((f.tag&i)===i){b=void 0;var I=f.create,X=f.inst;b=I(),X.destroy=b}f=f.next}while(f!==M)}}catch(ot){Wn(o,o.return,ot)}}function $o(i,o,f){try{var b=o.updateQueue,M=b!==null?b.lastEffect:null;if(M!==null){var I=M.next;b=I;do{if((b.tag&i)===i){var X=b.inst,ot=X.destroy;if(ot!==void 0){X.destroy=void 0,M=o;var Mt=f,Yt=ot;try{Yt()}catch(le){Wn(M,Mt,le)}}}b=b.next}while(b!==I)}}catch(le){Wn(o,o.return,le)}}function Im(i){var o=i.updateQueue;if(o!==null){var f=i.stateNode;try{Ds(o,f)}catch(b){Wn(i,i.return,b)}}}function Dc(i,o,f){f.props=Br(i.type,i.memoizedProps),f.state=i.memoizedState;try{f.componentWillUnmount()}catch(b){Wn(i,o,b)}}function Nl(i,o){try{var f=i.ref;if(f!==null){switch(i.tag){case 26:case 27:case 5:var b=i.stateNode;break;case 30:b=i.stateNode;break;default:b=i.stateNode}typeof f=="function"?i.refCleanup=f(b):f.current=b}}catch(M){Wn(i,o,M)}}function Ho(i,o){var f=i.ref,b=i.refCleanup;if(f!==null)if(typeof b=="function")try{b()}catch(M){Wn(i,o,M)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(M){Wn(i,o,M)}else f.current=null}function wy(i){var o=i.type,f=i.memoizedProps,b=i.stateNode;try{t:switch(o){case"button":case"input":case"select":case"textarea":f.autoFocus&&b.focus();break t;case"img":f.src?b.src=f.src:f.srcSet&&(b.srcset=f.srcSet)}}catch(M){Wn(i,i.return,M)}}function zm(i,o,f){try{var b=i.stateNode;Uy(b,i.type,f,o),b[Ce]=o}catch(M){Wn(i,i.return,M)}}function Ty(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Qi(i.type)||i.tag===4}function Lm(i){t:for(;;){for(;i.sibling===null;){if(i.return===null||Ty(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Qi(i.type)||i.flags&2||i.child===null||i.tag===4)continue t;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function km(i,o,f){var b=i.tag;if(b===5||b===6)i=i.stateNode,o?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(i,o):(o=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,o.appendChild(i),f=f._reactRootContainer,f!=null||o.onclick!==null||(o.onclick=rn));else if(b!==4&&(b===27&&Qi(i.type)&&(f=i.stateNode,o=null),i=i.child,i!==null))for(km(i,o,f),i=i.sibling;i!==null;)km(i,o,f),i=i.sibling}function gp(i,o,f){var b=i.tag;if(b===5||b===6)i=i.stateNode,o?f.insertBefore(i,o):f.appendChild(i);else if(b!==4&&(b===27&&Qi(i.type)&&(f=i.stateNode),i=i.child,i!==null))for(gp(i,o,f),i=i.sibling;i!==null;)gp(i,o,f),i=i.sibling}function yp(i){var o=i.stateNode,f=i.memoizedProps;try{for(var b=i.type,M=o.attributes;M.length;)o.removeAttributeNode(M[0]);Ar(o,b,f),o[ce]=i,o[Ce]=f}catch(I){Wn(i,i.return,I)}}var Fl=!1,Wi=!1,zu=!1,Sy=typeof WeakSet=="function"?WeakSet:Set,mn=null;function Uh(i,o){if(i=i.containerInfo,Qh=jp,i=Th(i),du(i)){if("selectionStart"in i)var f={start:i.selectionStart,end:i.selectionEnd};else t:{f=(f=i.ownerDocument)&&f.defaultView||window;var b=f.getSelection&&f.getSelection();if(b&&b.rangeCount!==0){f=b.anchorNode;var M=b.anchorOffset,I=b.focusNode;b=b.focusOffset;try{f.nodeType,I.nodeType}catch{f=null;break t}var X=0,ot=-1,Mt=-1,Yt=0,le=0,fe=i,Jt=null;e:for(;;){for(var ne;fe!==f||M!==0&&fe.nodeType!==3||(ot=X+M),fe!==I||b!==0&&fe.nodeType!==3||(Mt=X+b),fe.nodeType===3&&(X+=fe.nodeValue.length),(ne=fe.firstChild)!==null;)Jt=fe,fe=ne;for(;;){if(fe===i)break e;if(Jt===f&&++Yt===M&&(ot=X),Jt===I&&++le===b&&(Mt=X),(ne=fe.nextSibling)!==null)break;fe=Jt,Jt=fe.parentNode}fe=ne}f=ot===-1||Mt===-1?null:{start:ot,end:Mt}}else f=null}f=f||{start:0,end:0}}else f=null;for(_f={focusedElem:i,selectionRange:f},jp=!1,mn=o;mn!==null;)if(o=mn,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,mn=i;else for(;mn!==null;){switch(o=mn,I=o.alternate,i=o.flags,o.tag){case 0:if((i&4)!==0&&(i=o.updateQueue,i=i!==null?i.events:null,i!==null))for(f=0;f<i.length;f++)M=i[f],M.ref.impl=M.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&I!==null){i=void 0,f=o,M=I.memoizedProps,I=I.memoizedState,b=f.stateNode;try{var ke=Br(f.type,M);i=b.getSnapshotBeforeUpdate(ke,I),b.__reactInternalSnapshotBeforeUpdate=i}catch(Je){Wn(f,f.return,Je)}}break;case 3:if((i&1024)!==0){if(i=o.stateNode.containerInfo,f=i.nodeType,f===9)kp(i);else if(f===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":kp(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(_(163))}if(i=o.sibling,i!==null){i.return=o.return,mn=i;break}mn=o.return}}function Om(i,o,f){var b=f.flags;switch(f.tag){case 0:case 11:case 15:jl(i,f),b&4&&Pc(5,f);break;case 1:if(jl(i,f),b&4)if(i=f.stateNode,o===null)try{i.componentDidMount()}catch(X){Wn(f,f.return,X)}else{var M=Br(f.type,o.memoizedProps);o=o.memoizedState;try{i.componentDidUpdate(M,o,i.__reactInternalSnapshotBeforeUpdate)}catch(X){Wn(f,f.return,X)}}b&64&&Im(f),b&512&&Nl(f,f.return);break;case 3:if(jl(i,f),b&64&&(i=f.updateQueue,i!==null)){if(o=null,f.child!==null)switch(f.child.tag){case 27:case 5:o=f.child.stateNode;break;case 1:o=f.child.stateNode}try{Ds(i,o)}catch(X){Wn(f,f.return,X)}}break;case 27:o===null&&b&4&&yp(f);case 26:case 5:jl(i,f),o===null&&b&4&&wy(f),b&512&&Nl(f,f.return);break;case 12:jl(i,f);break;case 31:jl(i,f),b&4&&Gh(i,f);break;case 13:jl(i,f),b&4&&_p(i,f),b&64&&(i=f.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(f=Dv.bind(null,f),Gy(i,f))));break;case 22:if(b=f.memoizedState!==null||Fl,!b){o=o!==null&&o.memoizedState!==null||Wi,M=Fl;var I=Wi;Fl=b,(Wi=o)&&!I?ea(i,f,(f.subtreeFlags&8772)!==0):jl(i,f),Fl=M,Wi=I}break;case 30:break;default:jl(i,f)}}function nf(i){var o=i.alternate;o!==null&&(i.alternate=null,nf(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&Eo(o)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var ci=null,Cr=!1;function Xo(i,o,f){for(f=f.child;f!==null;)Nm(i,o,f),f=f.sibling}function Nm(i,o,f){if(ri&&typeof ri.onCommitFiberUnmount=="function")try{ri.onCommitFiberUnmount(Ir,f)}catch{}switch(f.tag){case 26:Wi||Ho(f,o),Xo(i,o,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:Wi||Ho(f,o);var b=ci,M=Cr;Qi(f.type)&&(ci=f.stateNode,Cr=!1),Xo(i,o,f),ed(f.stateNode),ci=b,Cr=M;break;case 5:Wi||Ho(f,o);case 6:if(b=ci,M=Cr,ci=null,Xo(i,o,f),ci=b,Cr=M,ci!==null)if(Cr)try{(ci.nodeType===9?ci.body:ci.nodeName==="HTML"?ci.ownerDocument.body:ci).removeChild(f.stateNode)}catch(I){Wn(f,o,I)}else try{ci.removeChild(f.stateNode)}catch(I){Wn(f,o,I)}break;case 18:ci!==null&&(Cr?(i=ci,Ji(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,f.stateNode),ld(i)):Ji(ci,f.stateNode));break;case 4:b=ci,M=Cr,ci=f.stateNode.containerInfo,Cr=!0,Xo(i,o,f),ci=b,Cr=M;break;case 0:case 11:case 14:case 15:$o(2,f,o),Wi||$o(4,f,o),Xo(i,o,f);break;case 1:Wi||(Ho(f,o),b=f.stateNode,typeof b.componentWillUnmount=="function"&&Dc(f,o,b)),Xo(i,o,f);break;case 21:Xo(i,o,f);break;case 22:Wi=(b=Wi)||f.memoizedState!==null,Xo(i,o,f),Wi=b;break;default:Xo(i,o,f)}}function Gh(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{ld(i)}catch(f){Wn(o,o.return,f)}}}function _p(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{ld(i)}catch(f){Wn(o,o.return,f)}}function qh(i){switch(i.tag){case 31:case 13:case 19:var o=i.stateNode;return o===null&&(o=i.stateNode=new Sy),o;case 22:return i=i.stateNode,o=i._retryCache,o===null&&(o=i._retryCache=new Sy),o;default:throw Error(_(435,i.tag))}}function Lu(i,o){var f=qh(i);o.forEach(function(b){if(!f.has(b)){f.add(b);var M=Rv.bind(null,i,b);b.then(M,M)}})}function gr(i,o){var f=o.deletions;if(f!==null)for(var b=0;b<f.length;b++){var M=f[b],I=i,X=o,ot=X;t:for(;ot!==null;){switch(ot.tag){case 27:if(Qi(ot.type)){ci=ot.stateNode,Cr=!1;break t}break;case 5:ci=ot.stateNode,Cr=!1;break t;case 3:case 4:ci=ot.stateNode.containerInfo,Cr=!0;break t}ot=ot.return}if(ci===null)throw Error(_(160));Nm(I,X,M),ci=null,Cr=!1,I=M.alternate,I!==null&&(I.return=null),M.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)Ey(o,i),o=o.sibling}var ps=null;function Ey(i,o){var f=i.alternate,b=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:gr(o,i),ms(i),b&4&&($o(3,i,i.return),Pc(3,i),$o(5,i,i.return));break;case 1:gr(o,i),ms(i),b&512&&(Wi||f===null||Ho(f,f.return)),b&64&&Fl&&(i=i.updateQueue,i!==null&&(b=i.callbacks,b!==null&&(f=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=f===null?b:f.concat(b))));break;case 26:var M=ps;if(gr(o,i),ms(i),b&512&&(Wi||f===null||Ho(f,f.return)),b&4){var I=f!==null?f.memoizedState:null;if(b=i.memoizedState,f===null)if(b===null)if(i.stateNode===null){t:{b=i.type,f=i.memoizedProps,M=M.ownerDocument||M;e:switch(b){case"title":I=M.getElementsByTagName("title")[0],(!I||I[ls]||I[ce]||I.namespaceURI==="http://www.w3.org/2000/svg"||I.hasAttribute("itemprop"))&&(I=M.createElement(b),M.head.insertBefore(I,M.querySelector("head > title"))),Ar(I,b,f),I[ce]=i,gi(I),b=I;break t;case"link":var X=wf("link","href",M).get(b+(f.href||""));if(X){for(var ot=0;ot<X.length;ot++)if(I=X[ot],I.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&I.getAttribute("rel")===(f.rel==null?null:f.rel)&&I.getAttribute("title")===(f.title==null?null:f.title)&&I.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){X.splice(ot,1);break e}}I=M.createElement(b),Ar(I,b,f),M.head.appendChild(I);break;case"meta":if(X=wf("meta","content",M).get(b+(f.content||""))){for(ot=0;ot<X.length;ot++)if(I=X[ot],I.getAttribute("content")===(f.content==null?null:""+f.content)&&I.getAttribute("name")===(f.name==null?null:f.name)&&I.getAttribute("property")===(f.property==null?null:f.property)&&I.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&I.getAttribute("charset")===(f.charSet==null?null:f.charSet)){X.splice(ot,1);break e}}I=M.createElement(b),Ar(I,b,f),M.head.appendChild(I);break;default:throw Error(_(468,b))}I[ce]=i,gi(I),b=I}i.stateNode=b}else Hy(M,i.type,i.stateNode);else i.stateNode=yg(M,b,i.memoizedProps);else I!==b?(I===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):I.count--,b===null?Hy(M,i.type,i.stateNode):yg(M,b,i.memoizedProps)):b===null&&i.stateNode!==null&&zm(i,i.memoizedProps,f.memoizedProps)}break;case 27:gr(o,i),ms(i),b&512&&(Wi||f===null||Ho(f,f.return)),f!==null&&b&4&&zm(i,i.memoizedProps,f.memoizedProps);break;case 5:if(gr(o,i),ms(i),b&512&&(Wi||f===null||Ho(f,f.return)),i.flags&32){M=i.stateNode;try{hl(M,"")}catch(ke){Wn(i,i.return,ke)}}b&4&&i.stateNode!=null&&(M=i.memoizedProps,zm(i,M,f!==null?f.memoizedProps:M)),b&1024&&(zu=!0);break;case 6:if(gr(o,i),ms(i),b&4){if(i.stateNode===null)throw Error(_(162));b=i.memoizedProps,f=i.stateNode;try{f.nodeValue=b}catch(ke){Wn(i,i.return,ke)}}break;case 3:if(Wu=null,M=ps,ps=yo(o.containerInfo),gr(o,i),ps=M,ms(i),b&4&&f!==null&&f.memoizedState.isDehydrated)try{ld(o.containerInfo)}catch(ke){Wn(i,i.return,ke)}zu&&(zu=!1,Rc(i));break;case 4:b=ps,ps=yo(i.stateNode.containerInfo),gr(o,i),ms(i),ps=b;break;case 12:gr(o,i),ms(i);break;case 31:gr(o,i),ms(i),b&4&&(b=i.updateQueue,b!==null&&(i.updateQueue=null,Lu(i,b)));break;case 13:gr(o,i),ms(i),i.child.flags&8192&&i.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(lf=qi()),b&4&&(b=i.updateQueue,b!==null&&(i.updateQueue=null,Lu(i,b)));break;case 22:M=i.memoizedState!==null;var Mt=f!==null&&f.memoizedState!==null,Yt=Fl,le=Wi;if(Fl=Yt||M,Wi=le||Mt,gr(o,i),Wi=le,Fl=Yt,ms(i),b&8192)t:for(o=i.stateNode,o._visibility=M?o._visibility&-2:o._visibility|1,M&&(f===null||Mt||Fl||Wi||Ic(i)),f=null,o=i;;){if(o.tag===5||o.tag===26){if(f===null){Mt=f=o;try{if(I=Mt.stateNode,M)X=I.style,typeof X.setProperty=="function"?X.setProperty("display","none","important"):X.display="none";else{ot=Mt.stateNode;var fe=Mt.memoizedProps.style,Jt=fe!=null&&fe.hasOwnProperty("display")?fe.display:null;ot.style.display=Jt==null||typeof Jt=="boolean"?"":(""+Jt).trim()}}catch(ke){Wn(Mt,Mt.return,ke)}}}else if(o.tag===6){if(f===null){Mt=o;try{Mt.stateNode.nodeValue=M?"":Mt.memoizedProps}catch(ke){Wn(Mt,Mt.return,ke)}}}else if(o.tag===18){if(f===null){Mt=o;try{var ne=Mt.stateNode;M?tr(ne,!0):tr(Mt.stateNode,!1)}catch(ke){Wn(Mt,Mt.return,ke)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===i)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break t;for(;o.sibling===null;){if(o.return===null||o.return===i)break t;f===o&&(f=null),o=o.return}f===o&&(f=null),o.sibling.return=o.return,o=o.sibling}b&4&&(b=i.updateQueue,b!==null&&(f=b.retryQueue,f!==null&&(b.retryQueue=null,Lu(i,f))));break;case 19:gr(o,i),ms(i),b&4&&(b=i.updateQueue,b!==null&&(i.updateQueue=null,Lu(i,b)));break;case 30:break;case 21:break;default:gr(o,i),ms(i)}}function ms(i){var o=i.flags;if(o&2){try{for(var f,b=i.return;b!==null;){if(Ty(b)){f=b;break}b=b.return}if(f==null)throw Error(_(160));switch(f.tag){case 27:var M=f.stateNode,I=Lm(i);gp(i,I,M);break;case 5:var X=f.stateNode;f.flags&32&&(hl(X,""),f.flags&=-33);var ot=Lm(i);gp(i,ot,X);break;case 3:case 4:var Mt=f.stateNode.containerInfo,Yt=Lm(i);km(i,Yt,Mt);break;default:throw Error(_(161))}}catch(le){Wn(i,i.return,le)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function Rc(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var o=i;Rc(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),i=i.sibling}}function jl(i,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Om(i,o.alternate,o),o=o.sibling}function Ic(i){for(i=i.child;i!==null;){var o=i;switch(o.tag){case 0:case 11:case 14:case 15:$o(4,o,o.return),Ic(o);break;case 1:Ho(o,o.return);var f=o.stateNode;typeof f.componentWillUnmount=="function"&&Dc(o,o.return,f),Ic(o);break;case 27:ed(o.stateNode);case 26:case 5:Ho(o,o.return),Ic(o);break;case 22:o.memoizedState===null&&Ic(o);break;case 30:Ic(o);break;default:Ic(o)}i=i.sibling}}function ea(i,o,f){for(f=f&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var b=o.alternate,M=i,I=o,X=I.flags;switch(I.tag){case 0:case 11:case 15:ea(M,I,f),Pc(4,I);break;case 1:if(ea(M,I,f),b=I,M=b.stateNode,typeof M.componentDidMount=="function")try{M.componentDidMount()}catch(Yt){Wn(b,b.return,Yt)}if(b=I,M=b.updateQueue,M!==null){var ot=b.stateNode;try{var Mt=M.shared.hiddenCallbacks;if(Mt!==null)for(M.shared.hiddenCallbacks=null,M=0;M<Mt.length;M++)qd(Mt[M],ot)}catch(Yt){Wn(b,b.return,Yt)}}f&&X&64&&Im(I),Nl(I,I.return);break;case 27:yp(I);case 26:case 5:ea(M,I,f),f&&b===null&&X&4&&wy(I),Nl(I,I.return);break;case 12:ea(M,I,f);break;case 31:ea(M,I,f),f&&X&4&&Gh(M,I);break;case 13:ea(M,I,f),f&&X&4&&_p(M,I);break;case 22:I.memoizedState===null&&ea(M,I,f),Nl(I,I.return);break;case 30:break;default:ea(M,I,f)}o=o.sibling}}function rf(i,o){var f=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),i=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(i=o.memoizedState.cachePool.pool),i!==f&&(i!=null&&i.refCount++,f!=null&&Hi(f))}function vp(i,o){i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&Hi(i))}function ja(i,o,f,b){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Cy(i,o,f,b),o=o.sibling}function Cy(i,o,f,b){var M=o.flags;switch(o.tag){case 0:case 11:case 15:ja(i,o,f,b),M&2048&&Pc(9,o);break;case 1:ja(i,o,f,b);break;case 3:ja(i,o,f,b),M&2048&&(i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&Hi(i)));break;case 12:if(M&2048){ja(i,o,f,b),i=o.stateNode;try{var I=o.memoizedProps,X=I.id,ot=I.onPostCommit;typeof ot=="function"&&ot(X,o.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Mt){Wn(o,o.return,Mt)}}else ja(i,o,f,b);break;case 31:ja(i,o,f,b);break;case 13:ja(i,o,f,b);break;case 23:break;case 22:I=o.stateNode,X=o.alternate,o.memoizedState!==null?I._visibility&2?ja(i,o,f,b):sf(i,o):I._visibility&2?ja(i,o,f,b):(I._visibility|=2,Zh(i,o,f,b,(o.subtreeFlags&10256)!==0||!1)),M&2048&&rf(X,o);break;case 24:ja(i,o,f,b),M&2048&&vp(o.alternate,o);break;default:ja(i,o,f,b)}}function Zh(i,o,f,b,M){for(M=M&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var I=i,X=o,ot=f,Mt=b,Yt=X.flags;switch(X.tag){case 0:case 11:case 15:Zh(I,X,ot,Mt,M),Pc(8,X);break;case 23:break;case 22:var le=X.stateNode;X.memoizedState!==null?le._visibility&2?Zh(I,X,ot,Mt,M):sf(I,X):(le._visibility|=2,Zh(I,X,ot,Mt,M)),M&&Yt&2048&&rf(X.alternate,X);break;case 24:Zh(I,X,ot,Mt,M),M&&Yt&2048&&vp(X.alternate,X);break;default:Zh(I,X,ot,Mt,M)}o=o.sibling}}function sf(i,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var f=i,b=o,M=b.flags;switch(b.tag){case 22:sf(f,b),M&2048&&rf(b.alternate,b);break;case 24:sf(f,b),M&2048&&vp(b.alternate,b);break;default:sf(f,b)}o=o.sibling}}var af=8192;function $h(i,o,f){if(i.subtreeFlags&af)for(i=i.child;i!==null;)ku(i,o,f),i=i.sibling}function ku(i,o,f){switch(i.tag){case 26:$h(i,o,f),i.flags&af&&i.memoizedState!==null&&Fv(f,ps,i.memoizedState,i.memoizedProps);break;case 5:$h(i,o,f);break;case 3:case 4:var b=ps;ps=yo(i.stateNode.containerInfo),$h(i,o,f),ps=b;break;case 22:i.memoizedState===null&&(b=i.alternate,b!==null&&b.memoizedState!==null?(b=af,af=16777216,$h(i,o,f),af=b):$h(i,o,f));break;default:$h(i,o,f)}}function Ay(i){var o=i.alternate;if(o!==null&&(i=o.child,i!==null)){o.child=null;do o=i.sibling,i.sibling=null,i=o;while(i!==null)}}function of(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var f=0;f<o.length;f++){var b=o[f];mn=b,jm(b,i)}Ay(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Fm(i),i=i.sibling}function Fm(i){switch(i.tag){case 0:case 11:case 15:of(i),i.flags&2048&&$o(9,i,i.return);break;case 3:of(i);break;case 12:of(i);break;case 22:var o=i.stateNode;i.memoizedState!==null&&o._visibility&2&&(i.return===null||i.return.tag!==13)?(o._visibility&=-3,xp(i)):of(i);break;default:of(i)}}function xp(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var f=0;f<o.length;f++){var b=o[f];mn=b,jm(b,i)}Ay(i)}for(i=i.child;i!==null;){switch(o=i,o.tag){case 0:case 11:case 15:$o(8,o,o.return),xp(o);break;case 22:f=o.stateNode,f._visibility&2&&(f._visibility&=-3,xp(o));break;default:xp(o)}i=i.sibling}}function jm(i,o){for(;mn!==null;){var f=mn;switch(f.tag){case 0:case 11:case 15:$o(8,f,o);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var b=f.memoizedState.cachePool.pool;b!=null&&b.refCount++}break;case 24:Hi(f.memoizedState.cache)}if(b=f.child,b!==null)b.return=f,mn=b;else t:for(f=i;mn!==null;){b=mn;var M=b.sibling,I=b.return;if(nf(b),b===f){mn=null;break t}if(M!==null){M.return=I,mn=M;break t}mn=I}}}var Ev={getCacheForType:function(i){var o=$i(Ri),f=o.data.get(i);return f===void 0&&(f=i(),o.data.set(i,f)),f},cacheSignal:function(){return $i(Ri).controller.signal}},Bm=typeof WeakMap=="function"?WeakMap:Map,Pn=0,ni=null,Tn=null,An=0,Yn=0,Is=null,zc=!1,Hh=!1,Ou=!1,Yo=0,Ni=0,Lc=0,Nu=0,Vm=0,na=0,Fu=0,ju=null,gs=null,bp=!1,lf=0,My=0,Bu=1/0,wp=null,Bl=null,yr=0,kc=null,Xh=null,Wo=0,Um=0,Gm=null,Ki=null,Vl=0,qm=null;function ia(){return(Pn&2)!==0&&An!==0?An&-An:jt.T!==null?df():qn()}function Zm(){if(na===0)if((An&536870912)===0||vn){var i=Ft;Ft<<=1,(Ft&3932160)===0&&(Ft=262144),na=i}else na=536870912;return i=mr.current,i!==null&&(i.flags|=32),na}function ys(i,o,f){(i===ni&&(Yn===2||Yn===9)||i.cancelPendingCommit!==null)&&(Vu(i,0),ra(i,An,na,!1)),Qe(i,f),((Pn&2)===0||i!==ni)&&(i===ni&&((Pn&2)===0&&(Nu|=f),Ni===4&&ra(i,An,na,!1)),sa(i))}function Py(i,o,f){if((Pn&6)!==0)throw Error(_(327));var b=!f&&(o&127)===0&&(o&i.expiredLanes)===0||Wt(i,o),M=b?Av(i,o):Xm(i,o,!0),I=b;do{if(M===0){Hh&&!b&&ra(i,o,0,!1);break}else{if(f=i.current.alternate,I&&!Dy(f)){M=Xm(i,o,!1),I=!1;continue}if(M===2){if(I=o,i.errorRecoveryDisabledLanes&I)var X=0;else X=i.pendingLanes&-536870913,X=X!==0?X:X&536870912?536870912:0;if(X!==0){o=X;t:{var ot=i;M=ju;var Mt=ot.current.memoizedState.isDehydrated;if(Mt&&(Vu(ot,X).flags|=256),X=Xm(ot,X,!1),X!==2){if(Ou&&!Mt){ot.errorRecoveryDisabledLanes|=I,Nu|=I,M=4;break t}I=gs,gs=M,I!==null&&(gs===null?gs=I:gs.push.apply(gs,I))}M=X}if(I=!1,M!==2)continue}}if(M===1){Vu(i,0),ra(i,o,0,!0);break}t:{switch(b=i,I=M,I){case 0:case 1:throw Error(_(345));case 4:if((o&4194048)!==o)break;case 6:ra(b,o,na,!zc);break t;case 2:gs=null;break;case 3:case 5:break;default:throw Error(_(329))}if((o&62914560)===o&&(M=lf+300-qi(),10<M)){if(ra(b,o,na,!zc),Xt(b,0,!0)!==0)break t;Wo=o,b.timeoutHandle=_r($m.bind(null,b,f,gs,wp,bp,o,na,Nu,Fu,zc,I,"Throttled",-0,0),M);break t}$m(b,f,gs,wp,bp,o,na,Nu,Fu,zc,I,null,-0,0)}}break}while(!0);sa(i)}function $m(i,o,f,b,M,I,X,ot,Mt,Yt,le,fe,Jt,ne){if(i.timeoutHandle=-1,fe=o.subtreeFlags,fe&8192||(fe&16785408)===16785408){fe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:rn},ku(o,I,fe);var ke=(I&62914560)===I?lf-qi():(I&4194048)===I?My-qi():0;if(ke=Xy(fe,ke),ke!==null){Wo=I,i.cancelPendingCommit=ke(ky.bind(null,i,o,I,f,b,M,X,ot,Mt,le,fe,null,Jt,ne)),ra(i,I,X,!Yt);return}}ky(i,o,I,f,b,M,X,ot,Mt)}function Dy(i){for(var o=i;;){var f=o.tag;if((f===0||f===11||f===15)&&o.flags&16384&&(f=o.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var b=0;b<f.length;b++){var M=f[b],I=M.getSnapshot;M=M.value;try{if(!dr(I(),M))return!1}catch{return!1}}if(f=o.child,o.subtreeFlags&16384&&f!==null)f.return=o,o=f;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ra(i,o,f,b){o&=~Vm,o&=~Nu,i.suspendedLanes|=o,i.pingedLanes&=~o,b&&(i.warmLanes|=o),b=i.expirationTimes;for(var M=o;0<M;){var I=31-K(M),X=1<<I;b[I]=-1,M&=~X}f!==0&&ln(i,f,o)}function Yh(){return(Pn&6)===0?(qu(0),!1):!0}function Tp(){if(Tn!==null){if(Yn===0)var i=Tn.return;else i=Tn,Ks=No=null,Ec(i),io=null,Pl=0,i=Tn;for(;i!==null;)by(i.alternate,i),i=i.return;Tn=null}}function Vu(i,o){var f=i.timeoutHandle;f!==-1&&(i.timeoutHandle=-1,dn(f)),f=i.cancelPendingCommit,f!==null&&(i.cancelPendingCommit=null,f()),Wo=0,Tp(),ni=i,Tn=f=Xs(i.current,null),An=o,Yn=0,Is=null,zc=!1,Hh=Wt(i,o),Ou=!1,Fu=na=Vm=Nu=Lc=Ni=0,gs=ju=null,bp=!1,(o&8)!==0&&(o|=o&32);var b=i.entangledLanes;if(b!==0)for(i=i.entanglements,b&=o;0<b;){var M=31-K(b),I=1<<M;o|=i[M],b&=~I}return Yo=o,yu(),f}function Sp(i,o){on=null,jt.H=Cc,o===Qs||o===Eu?(o=Gd(),Yn=3):o===Su?(o=Gd(),Yn=4):Yn=o===Yd?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Is=o,Tn===null&&(Ni=1,Hd(i,Nr(o,i.current)))}function Uu(){var i=mr.current;return i===null?!0:(An&4194048)===An?ti===null:(An&62914560)===An||(An&536870912)!==0?i===ti:!1}function Hm(){var i=jt.H;return jt.H=Cc,i===null?Cc:i}function Ry(){var i=jt.A;return jt.A=Ev,i}function Ep(){Ni=4,zc||(An&4194048)!==An&&mr.current!==null||(Hh=!0),(Lc&134217727)===0&&(Nu&134217727)===0||ni===null||ra(ni,An,na,!1)}function Xm(i,o,f){var b=Pn;Pn|=2;var M=Hm(),I=Ry();(ni!==i||An!==o)&&(wp=null,Vu(i,o)),o=!1;var X=Ni;t:do try{if(Yn!==0&&Tn!==null){var ot=Tn,Mt=Is;switch(Yn){case 8:Tp(),X=6;break t;case 3:case 2:case 9:case 6:mr.current===null&&(o=!0);var Yt=Yn;if(Yn=0,Is=null,Wh(i,ot,Mt,Yt),f&&Hh){X=0;break t}break;default:Yt=Yn,Yn=0,Is=null,Wh(i,ot,Mt,Yt)}}Cv(),X=Ni;break}catch(le){Sp(i,le)}while(!0);return o&&i.shellSuspendCounter++,Ks=No=null,Pn=b,jt.H=M,jt.A=I,Tn===null&&(ni=null,An=0,yu()),X}function Cv(){for(;Tn!==null;)Iy(Tn)}function Av(i,o){var f=Pn;Pn|=2;var b=Hm(),M=Ry();ni!==i||An!==o?(wp=null,Bu=qi()+500,Vu(i,o)):Hh=Wt(i,o);t:do try{if(Yn!==0&&Tn!==null){o=Tn;var I=Is;e:switch(Yn){case 1:Yn=0,Is=null,Wh(i,o,I,1);break;case 2:case 9:if(za(I)){Yn=0,Is=null,zy(o);break}o=function(){Yn!==2&&Yn!==9||ni!==i||(Yn=7),sa(i)},I.then(o,o);break t;case 3:Yn=7;break t;case 4:Yn=5;break t;case 7:za(I)?(Yn=0,Is=null,zy(o)):(Yn=0,Is=null,Wh(i,o,I,7));break;case 5:var X=null;switch(Tn.tag){case 26:X=Tn.memoizedState;case 5:case 27:var ot=Tn;if(X?vg(X):ot.stateNode.complete){Yn=0,Is=null;var Mt=ot.sibling;if(Mt!==null)Tn=Mt;else{var Yt=ot.return;Yt!==null?(Tn=Yt,Cp(Yt)):Tn=null}break e}}Yn=0,Is=null,Wh(i,o,I,5);break;case 6:Yn=0,Is=null,Wh(i,o,I,6);break;case 8:Tp(),Ni=6;break t;default:throw Error(_(462))}}Mv();break}catch(le){Sp(i,le)}while(!0);return Ks=No=null,jt.H=b,jt.A=M,Pn=f,Tn!==null?0:(ni=null,An=0,yu(),Ni)}function Mv(){for(;Tn!==null&&!fa();)Iy(Tn)}function Iy(i){var o=vy(i.alternate,i,Yo);i.memoizedProps=i.pendingProps,o===null?Cp(i):Tn=o}function zy(i){var o=i,f=o.alternate;switch(o.tag){case 15:case 0:o=Am(f,o,o.pendingProps,o.type,void 0,An);break;case 11:o=Am(f,o,o.pendingProps,o.type.render,o.ref,An);break;case 5:Ec(o);default:by(f,o),o=Tn=np(o,Yo),o=vy(f,o,Yo)}i.memoizedProps=i.pendingProps,o===null?Cp(i):Tn=o}function Wh(i,o,f,b){Ks=No=null,Ec(o),io=null,Pl=0;var M=o.return;try{if(bv(i,M,o,f,An)){Ni=1,Hd(i,Nr(f,i.current)),Tn=null;return}}catch(I){if(M!==null)throw Tn=M,I;Ni=1,Hd(i,Nr(f,i.current)),Tn=null;return}o.flags&32768?(vn||b===1?i=!0:Hh||(An&536870912)!==0?i=!1:(zc=i=!0,(b===2||b===9||b===3||b===6)&&(b=mr.current,b!==null&&b.tag===13&&(b.flags|=16384))),Ly(o,i)):Cp(o)}function Cp(i){var o=i;do{if((o.flags&32768)!==0){Ly(o,zc);return}i=o.return;var f=Tv(o.alternate,o,Yo);if(f!==null){Tn=f;return}if(o=o.sibling,o!==null){Tn=o;return}Tn=o=i}while(o!==null);Ni===0&&(Ni=5)}function Ly(i,o){do{var f=Sv(i.alternate,i);if(f!==null){f.flags&=32767,Tn=f;return}if(f=i.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!o&&(i=i.sibling,i!==null)){Tn=i;return}Tn=i=f}while(i!==null);Ni=6,Tn=null}function ky(i,o,f,b,M,I,X,ot,Mt){i.cancelPendingCommit=null;do Gu();while(yr!==0);if((Pn&6)!==0)throw Error(_(327));if(o!==null){if(o===i.current)throw Error(_(177));if(I=o.lanes|o.childLanes,I|=pc,mi(i,f,I,X,ot,Mt),i===ni&&(Tn=ni=null,An=0),Xh=o,kc=i,Wo=f,Um=I,Gm=M,Ki=b,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,Fy(pa,function(){return Mp(),null})):(i.callbackNode=null,i.callbackPriority=0),b=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||b){b=jt.T,jt.T=null,M=Qt.p,Qt.p=2,X=Pn,Pn|=4;try{Uh(i,o,f)}finally{Pn=X,Qt.p=M,jt.T=b}}yr=1,Ym(),Ap(),Wm()}}function Ym(){if(yr===1){yr=0;var i=kc,o=Xh,f=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||f){f=jt.T,jt.T=null;var b=Qt.p;Qt.p=2;var M=Pn;Pn|=4;try{Ey(o,i);var I=_f,X=Th(i.containerInfo),ot=I.focusedElem,Mt=I.selectionRange;if(X!==ot&&ot&&ot.ownerDocument&&wh(ot.ownerDocument.documentElement,ot)){if(Mt!==null&&du(ot)){var Yt=Mt.start,le=Mt.end;if(le===void 0&&(le=Yt),"selectionStart"in ot)ot.selectionStart=Yt,ot.selectionEnd=Math.min(le,ot.value.length);else{var fe=ot.ownerDocument||document,Jt=fe&&fe.defaultView||window;if(Jt.getSelection){var ne=Jt.getSelection(),ke=ot.textContent.length,Je=Math.min(Mt.start,ke),Kn=Mt.end===void 0?Je:Math.min(Mt.end,ke);!ne.extend&&Je>Kn&&(X=Kn,Kn=Je,Je=X);var Bt=bh(ot,Je),kt=bh(ot,Kn);if(Bt&&kt&&(ne.rangeCount!==1||ne.anchorNode!==Bt.node||ne.anchorOffset!==Bt.offset||ne.focusNode!==kt.node||ne.focusOffset!==kt.offset)){var Ht=fe.createRange();Ht.setStart(Bt.node,Bt.offset),ne.removeAllRanges(),Je>Kn?(ne.addRange(Ht),ne.extend(kt.node,kt.offset)):(Ht.setEnd(kt.node,kt.offset),ne.addRange(Ht))}}}}for(fe=[],ne=ot;ne=ne.parentNode;)ne.nodeType===1&&fe.push({element:ne,left:ne.scrollLeft,top:ne.scrollTop});for(typeof ot.focus=="function"&&ot.focus(),ot=0;ot<fe.length;ot++){var he=fe[ot];he.element.scrollLeft=he.left,he.element.scrollTop=he.top}}jp=!!Qh,_f=Qh=null}finally{Pn=M,Qt.p=b,jt.T=f}}i.current=o,yr=2}}function Ap(){if(yr===2){yr=0;var i=kc,o=Xh,f=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||f){f=jt.T,jt.T=null;var b=Qt.p;Qt.p=2;var M=Pn;Pn|=4;try{Om(i,o.alternate,o)}finally{Pn=M,Qt.p=b,jt.T=f}}yr=3}}function Wm(){if(yr===4||yr===3){yr=0,So();var i=kc,o=Xh,f=Wo,b=Ki;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?yr=5:(yr=0,Xh=kc=null,Ul(i,i.pendingLanes));var M=i.pendingLanes;if(M===0&&(Bl=null),Gn(f),o=o.stateNode,ri&&typeof ri.onCommitFiberRoot=="function")try{ri.onCommitFiberRoot(Ir,o,void 0,(o.current.flags&128)===128)}catch{}if(b!==null){o=jt.T,M=Qt.p,Qt.p=2,jt.T=null;try{for(var I=i.onRecoverableError,X=0;X<b.length;X++){var ot=b[X];I(ot.value,{componentStack:ot.stack})}}finally{jt.T=o,Qt.p=M}}(Wo&3)!==0&&Gu(),sa(i),M=i.pendingLanes,(f&261930)!==0&&(M&42)!==0?i===qm?Vl++:(Vl=0,qm=i):Vl=0,qu(0)}}function Ul(i,o){(i.pooledCacheLanes&=o)===0&&(o=i.pooledCache,o!=null&&(i.pooledCache=null,Hi(o)))}function Gu(){return Ym(),Ap(),Wm(),Mp()}function Mp(){if(yr!==5)return!1;var i=kc,o=Um;Um=0;var f=Gn(Wo),b=jt.T,M=Qt.p;try{Qt.p=32>f?32:f,jt.T=null,f=Gm,Gm=null;var I=kc,X=Wo;if(yr=0,Xh=kc=null,Wo=0,(Pn&6)!==0)throw Error(_(331));var ot=Pn;if(Pn|=4,Fm(I.current),Cy(I,I.current,X,f),Pn=ot,qu(0,!1),ri&&typeof ri.onPostCommitFiberRoot=="function")try{ri.onPostCommitFiberRoot(Ir,I)}catch{}return!0}finally{Qt.p=M,jt.T=b,Ul(i,o)}}function Oy(i,o,f){o=Nr(f,o),o=up(i.stateNode,o,2),i=Ps(i,o,2),i!==null&&(Qe(i,2),sa(i))}function Wn(i,o,f){if(i.tag===3)Oy(i,i,f);else for(;o!==null;){if(o.tag===3){Oy(o,i,f);break}else if(o.tag===1){var b=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(Bl===null||!Bl.has(b))){i=Nr(f,i),f=dy(2),b=Ps(o,f,2),b!==null&&(hp(f,b,o,i),Qe(b,2),sa(b));break}}o=o.return}}function Km(i,o,f){var b=i.pingCache;if(b===null){b=i.pingCache=new Bm;var M=new Set;b.set(o,M)}else M=b.get(o),M===void 0&&(M=new Set,b.set(o,M));M.has(f)||(Ou=!0,M.add(f),i=Pv.bind(null,i,o,f),o.then(i,i))}function Pv(i,o,f){var b=i.pingCache;b!==null&&b.delete(o),i.pingedLanes|=i.suspendedLanes&f,i.warmLanes&=~f,ni===i&&(An&f)===f&&(Ni===4||Ni===3&&(An&62914560)===An&&300>qi()-lf?(Pn&2)===0&&Vu(i,0):Vm|=f,Fu===An&&(Fu=0)),sa(i)}function Ny(i,o){o===0&&(o=Pe()),i=zo(i,o),i!==null&&(Qe(i,o),sa(i))}function Dv(i){var o=i.memoizedState,f=0;o!==null&&(f=o.retryLane),Ny(i,f)}function Rv(i,o){var f=0;switch(i.tag){case 31:case 13:var b=i.stateNode,M=i.memoizedState;M!==null&&(f=M.retryLane);break;case 19:b=i.stateNode;break;case 22:b=i.stateNode._retryCache;break;default:throw Error(_(314))}b!==null&&b.delete(o),Ny(i,f)}function Fy(i,o){return To(i,o)}var cf=null,zs=null,Ko=!1,uf=!1,hf=!1,Oc=0;function sa(i){i!==zs&&i.next===null&&(zs===null?cf=zs=i:zs=zs.next=i),uf=!0,Ko||(Ko=!0,jy())}function qu(i,o){if(!hf&&uf){hf=!0;do for(var f=!1,b=cf;b!==null;){if(i!==0){var M=b.pendingLanes;if(M===0)var I=0;else{var X=b.suspendedLanes,ot=b.pingedLanes;I=(1<<31-K(42|i)+1)-1,I&=M&~(X&~ot),I=I&201326741?I&201326741|1:I?I|2:0}I!==0&&(f=!0,Qm(b,I))}else I=An,I=Xt(b,b===ni?I:0,b.cancelPendingCommit!==null||b.timeoutHandle!==-1),(I&3)===0||Wt(b,I)||(f=!0,Qm(b,I));b=b.next}while(f);hf=!1}}function Iv(){Pp()}function Pp(){uf=Ko=!1;var i=0;Oc!==0&&kv()&&(i=Oc);for(var o=qi(),f=null,b=cf;b!==null;){var M=b.next,I=Dp(b,o);I===0?(b.next=null,f===null?cf=M:f.next=M,M===null&&(zs=f)):(f=b,(i!==0||(I&3)!==0)&&(uf=!0)),b=M}yr!==0&&yr!==5||qu(i),Oc!==0&&(Oc=0)}function Dp(i,o){for(var f=i.suspendedLanes,b=i.pingedLanes,M=i.expirationTimes,I=i.pendingLanes&-62914561;0<I;){var X=31-K(I),ot=1<<X,Mt=M[X];Mt===-1?((ot&f)===0||(ot&b)!==0)&&(M[X]=te(ot,o)):Mt<=o&&(i.expiredLanes|=ot),I&=~ot}if(o=ni,f=An,f=Xt(i,i===o?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),b=i.callbackNode,f===0||i===o&&(Yn===2||Yn===9)||i.cancelPendingCommit!==null)return b!==null&&b!==null&&da(b),i.callbackNode=null,i.callbackPriority=0;if((f&3)===0||Wt(i,f)){if(o=f&-f,o===i.callbackPriority)return o;switch(b!==null&&da(b),Gn(f)){case 2:case 8:f=ic;break;case 32:f=pa;break;case 268435456:f=Ga;break;default:f=pa}return b=Zu.bind(null,i),f=To(f,b),i.callbackPriority=o,i.callbackNode=f,o}return b!==null&&b!==null&&da(b),i.callbackPriority=2,i.callbackNode=null,2}function Zu(i,o){if(yr!==0&&yr!==5)return i.callbackNode=null,i.callbackPriority=0,null;var f=i.callbackNode;if(Gu()&&i.callbackNode!==f)return null;var b=An;return b=Xt(i,i===ni?b:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),b===0?null:(Py(i,b,o),Dp(i,qi()),i.callbackNode!=null&&i.callbackNode===f?Zu.bind(null,i):null)}function Qm(i,o){if(Gu())return null;Py(i,o,!0)}function jy(){go(function(){(Pn&6)!==0?To(nc,Iv):Pp()})}function df(){if(Oc===0){var i=Ra;i===0&&(i=wt,wt<<=1,(wt&261888)===0&&(wt=256)),Oc=i}return Oc}function Jm(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Lr(""+i)}function ff(i,o){var f=o.ownerDocument.createElement("input");return f.name=o.name,f.value=o.value,i.id&&f.setAttribute("form",i.id),o.parentNode.insertBefore(f,o),i=new FormData(i),f.parentNode.removeChild(f),i}function By(i,o,f,b,M){if(o==="submit"&&f&&f.stateNode===M){var I=Jm((M[Ce]||null).action),X=b.submitter;X&&(o=(o=X[Ce]||null)?Jm(o.formAction):X.getAttribute("formAction"),o!==null&&(I=o,X=null));var ot=new en("action","action",null,b,M);i.push({event:ot,listeners:[{instance:null,listener:function(){if(b.defaultPrevented){if(Oc!==0){var Mt=X?ff(M,X):new FormData(M);Oa(f,{pending:!0,data:Mt,method:M.method,action:I},null,Mt)}}else typeof I=="function"&&(ot.preventDefault(),Mt=X?ff(M,X):new FormData(M),Oa(f,{pending:!0,data:Mt,method:M.method,action:I},I,Mt))},currentTarget:M}]})}}for(var tg=0;tg<gu.length;tg++){var eg=gu[tg],zv=eg.toLowerCase(),Lv=eg[0].toUpperCase()+eg.slice(1);fr(zv,"on"+Lv)}fr(pu,"onAnimationEnd"),fr(Eh,"onAnimationIteration"),fr(Ro,"onAnimationStart"),fr("dblclick","onDoubleClick"),fr("focusin","onFocus"),fr("focusout","onBlur"),fr(mu,"onTransitionRun"),fr(fc,"onTransitionStart"),fr(Es,"onTransitionCancel"),fr(Fd,"onTransitionEnd"),zr("onMouseEnter",["mouseout","mouseover"]),zr("onMouseLeave",["mouseout","mouseover"]),zr("onPointerEnter",["pointerout","pointerover"]),zr("onPointerLeave",["pointerout","pointerover"]),cl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),cl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),cl("onBeforeInput",["compositionend","keypress","textInput","paste"]),cl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),cl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),cl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ng=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(pf));function Gl(i,o){o=(o&4)!==0;for(var f=0;f<i.length;f++){var b=i[f],M=b.event;b=b.listeners;t:{var I=void 0;if(o)for(var X=b.length-1;0<=X;X--){var ot=b[X],Mt=ot.instance,Yt=ot.currentTarget;if(ot=ot.listener,Mt!==I&&M.isPropagationStopped())break t;I=ot,M.currentTarget=Yt;try{I(M)}catch(le){bl(le)}M.currentTarget=null,I=Mt}else for(X=0;X<b.length;X++){if(ot=b[X],Mt=ot.instance,Yt=ot.currentTarget,ot=ot.listener,Mt!==I&&M.isPropagationStopped())break t;I=ot,M.currentTarget=Yt;try{I(M)}catch(le){bl(le)}M.currentTarget=null,I=Mt}}}}function xn(i,o){var f=o[wr];f===void 0&&(f=o[wr]=new Set);var b=i+"__bubble";f.has(b)||(ig(o,i,2,!1),f.add(b))}function Rp(i,o,f){var b=0;o&&(b|=4),ig(f,i,b,o)}var mf="_reactListening"+Math.random().toString(36).slice(2);function Ip(i){if(!i[mf]){i[mf]=!0,Xr.forEach(function(f){f!=="selectionchange"&&(ng.has(f)||Rp(f,!1,i),Rp(f,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[mf]||(o[mf]=!0,Rp("selectionchange",!1,o))}}function ig(i,o,f,b){switch(Ky(o)){case 2:var M=Yy;break;case 8:M=Wy;break;default:M=Eg}f=M.bind(null,o,f,i),M=void 0,!ir||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(M=!0),b?M!==void 0?i.addEventListener(o,f,{capture:!0,passive:M}):i.addEventListener(o,f,!0):M!==void 0?i.addEventListener(o,f,{passive:M}):i.addEventListener(o,f,!1)}function zp(i,o,f,b,M){var I=b;if((o&1)===0&&(o&2)===0&&b!==null)t:for(;;){if(b===null)return;var X=b.tag;if(X===3||X===4){var ot=b.stateNode.containerInfo;if(ot===M)break;if(X===4)for(X=b.return;X!==null;){var Mt=X.tag;if((Mt===3||Mt===4)&&X.stateNode.containerInfo===M)return;X=X.return}for(;ot!==null;){if(X=Gs(ot),X===null)return;if(Mt=X.tag,Mt===5||Mt===6||Mt===26||Mt===27){b=I=X;continue t}ot=ot.parentNode}}b=b.return}au(function(){var Yt=I,le=bi(f),fe=[];t:{var Jt=jd.get(i);if(Jt!==void 0){var ne=en,ke=i;switch(i){case"keypress":if(Co(f)===0)break t;case"keydown":case"keyup":ne=ph;break;case"focusin":ke="focus",ne=Mo;break;case"focusout":ke="blur",ne=Mo;break;case"beforeblur":case"afterblur":ne=Mo;break;case"click":if(f.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ne=ou;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ne=cu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ne=mh;break;case pu:case Eh:case Ro:ne=ba;break;case Fd:ne=Kr;break;case"scroll":case"scrollend":ne=gn;break;case"wheel":ne=fl;break;case"copy":case"cut":case"paste":ne=dh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ne=$f;break;case"toggle":case"beforetoggle":ne=uu}var Je=(o&4)!==0,Kn=!Je&&(i==="scroll"||i==="scrollend"),Bt=Je?Jt!==null?Jt+"Capture":null:Jt;Je=[];for(var kt=Yt,Ht;kt!==null;){var he=kt;if(Ht=he.stateNode,he=he.tag,he!==5&&he!==26&&he!==27||Ht===null||Bt===null||(he=Zi(kt,Bt),he!=null&&Je.push(Nc(kt,he,Ht))),Kn)break;kt=kt.return}0<Je.length&&(Jt=new ne(Jt,ke,null,f,le),fe.push({event:Jt,listeners:Je}))}}if((o&7)===0){t:{if(Jt=i==="mouseover"||i==="pointerover",ne=i==="mouseout"||i==="pointerout",Jt&&f!==_a&&(ke=f.relatedTarget||f.fromElement)&&(Gs(ke)||ke[Ne]))break t;if((ne||Jt)&&(Jt=le.window===le?le:(Jt=le.ownerDocument)?Jt.defaultView||Jt.parentWindow:window,ne?(ke=f.relatedTarget||f.toElement,ne=Yt,ke=ke?Gs(ke):null,ke!==null&&(Kn=A(ke),Je=ke.tag,ke!==Kn||Je!==5&&Je!==27&&Je!==6)&&(ke=null)):(ne=null,ke=Yt),ne!==ke)){if(Je=ou,he="onMouseLeave",Bt="onMouseEnter",kt="mouse",(i==="pointerout"||i==="pointerover")&&(Je=$f,he="onPointerLeave",Bt="onPointerEnter",kt="pointer"),Kn=ne==null?Jt:qs(ne),Ht=ke==null?Jt:qs(ke),Jt=new Je(he,kt+"leave",ne,f,le),Jt.target=Kn,Jt.relatedTarget=Ht,he=null,Gs(le)===Yt&&(Je=new Je(Bt,kt+"enter",ke,f,le),Je.target=Ht,Je.relatedTarget=Kn,he=Je),Kn=he,ne&&ke)e:{for(Je=yf,Bt=ne,kt=ke,Ht=0,he=Bt;he;he=Je(he))Ht++;he=0;for(var Xe=kt;Xe;Xe=Je(Xe))he++;for(;0<Ht-he;)Bt=Je(Bt),Ht--;for(;0<he-Ht;)kt=Je(kt),he--;for(;Ht--;){if(Bt===kt||kt!==null&&Bt===kt.alternate){Je=Bt;break e}Bt=Je(Bt),kt=Je(kt)}Je=null}else Je=null;ne!==null&&rg(fe,Jt,ne,Je,!1),ke!==null&&Kn!==null&&rg(fe,Kn,ke,Je,!0)}}t:{if(Jt=Yt?qs(Yt):window,ne=Jt.nodeName&&Jt.nodeName.toLowerCase(),ne==="select"||ne==="input"&&Jt.type==="file")var Dn=Id;else if(_h(Jt))if(zd)Dn=kd;else{Dn=vh;var Fe=Jf}else ne=Jt.nodeName,!ne||ne.toLowerCase()!=="input"||Jt.type!=="checkbox"&&Jt.type!=="radio"?Yt&&ya(Yt.elementType)&&(Dn=Id):Dn=Ld;if(Dn&&(Dn=Dn(i,Yt))){Dd(fe,Dn,f,le);break t}Fe&&Fe(i,Jt,Yt),i==="focusout"&&Yt&&Jt.type==="number"&&Yt.memoizedProps.value!=null&&ru(Jt,"number",Jt.value)}switch(Fe=Yt?qs(Yt):window,i){case"focusin":(_h(Fe)||Fe.contentEditable==="true")&&(Po=Fe,Od=Yt,_n=null);break;case"focusout":_n=Od=Po=null;break;case"mousedown":Nd=!0;break;case"contextmenu":case"mouseup":case"dragend":Nd=!1,ep(fe,f,le);break;case"selectionchange":if(xl)break;case"keydown":case"keyup":ep(fe,f,le)}var un;if(Md)t:{switch(i){case"compositionstart":var bn="onCompositionStart";break t;case"compositionend":bn="onCompositionEnd";break t;case"compositionupdate":bn="onCompositionUpdate";break t}bn=void 0}else gl?Pd(i,f)&&(bn="onCompositionEnd"):i==="keydown"&&f.keyCode===229&&(bn="onCompositionStart");bn&&(Ya&&f.locale!=="ko"&&(gl||bn!=="onCompositionStart"?bn==="onCompositionEnd"&&gl&&(un=Ha()):(kr=le,$n="value"in kr?kr.value:kr.textContent,gl=!0)),Fe=gf(Yt,bn),0<Fe.length&&(bn=new rr(bn,i,null,f,le),fe.push({event:bn,listeners:Fe}),un?bn.data=un:(un=ml(f),un!==null&&(bn.data=un)))),(un=hu?Yf(i,f):Sm(i,f))&&(bn=gf(Yt,"onBeforeInput"),0<bn.length&&(Fe=new rr("onBeforeInput","beforeinput",null,f,le),fe.push({event:Fe,listeners:bn}),Fe.data=un)),By(fe,i,Yt,f,le)}Gl(fe,o)})}function Nc(i,o,f){return{instance:i,listener:o,currentTarget:f}}function gf(i,o){for(var f=o+"Capture",b=[];i!==null;){var M=i,I=M.stateNode;if(M=M.tag,M!==5&&M!==26&&M!==27||I===null||(M=Zi(i,f),M!=null&&b.unshift(Nc(i,M,I)),M=Zi(i,o),M!=null&&b.push(Nc(i,M,I))),i.tag===3)return b;i=i.return}return[]}function yf(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function rg(i,o,f,b,M){for(var I=o._reactName,X=[];f!==null&&f!==b;){var ot=f,Mt=ot.alternate,Yt=ot.stateNode;if(ot=ot.tag,Mt!==null&&Mt===b)break;ot!==5&&ot!==26&&ot!==27||Yt===null||(Mt=Yt,M?(Yt=Zi(f,I),Yt!=null&&X.unshift(Nc(f,Yt,Mt))):M||(Yt=Zi(f,I),Yt!=null&&X.push(Nc(f,Yt,Mt)))),f=f.return}X.length!==0&&i.push({event:o,listeners:X})}var sg=/\r\n?/g,Vy=/\u0000|\uFFFD/g;function Ls(i){return(typeof i=="string"?i:""+i).replace(sg,`
`).replace(Vy,"")}function $u(i,o){return o=Ls(o),Ls(i)===o}function jn(i,o,f,b,M,I){switch(f){case"children":typeof b=="string"?o==="body"||o==="textarea"&&b===""||hl(i,b):(typeof b=="number"||typeof b=="bigint")&&o!=="body"&&hl(i,""+b);break;case"className":ac(i,"class",b);break;case"tabIndex":ac(i,"tabindex",b);break;case"dir":case"role":case"viewBox":case"width":case"height":ac(i,f,b);break;case"style":Gf(i,b,I);break;case"data":if(o!=="object"){ac(i,"data",b);break}case"src":case"href":if(b===""&&(o!=="a"||f!=="href")){i.removeAttribute(f);break}if(b==null||typeof b=="function"||typeof b=="symbol"||typeof b=="boolean"){i.removeAttribute(f);break}b=Lr(""+b),i.setAttribute(f,b);break;case"action":case"formAction":if(typeof b=="function"){i.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof I=="function"&&(f==="formAction"?(o!=="input"&&jn(i,o,"name",M.name,M,null),jn(i,o,"formEncType",M.formEncType,M,null),jn(i,o,"formMethod",M.formMethod,M,null),jn(i,o,"formTarget",M.formTarget,M,null)):(jn(i,o,"encType",M.encType,M,null),jn(i,o,"method",M.method,M,null),jn(i,o,"target",M.target,M,null)));if(b==null||typeof b=="symbol"||typeof b=="boolean"){i.removeAttribute(f);break}b=Lr(""+b),i.setAttribute(f,b);break;case"onClick":b!=null&&(i.onclick=rn);break;case"onScroll":b!=null&&xn("scroll",i);break;case"onScrollEnd":b!=null&&xn("scrollend",i);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(_(61));if(f=b.__html,f!=null){if(M.children!=null)throw Error(_(60));i.innerHTML=f}}break;case"multiple":i.multiple=b&&typeof b!="function"&&typeof b!="symbol";break;case"muted":i.muted=b&&typeof b!="function"&&typeof b!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(b==null||typeof b=="function"||typeof b=="boolean"||typeof b=="symbol"){i.removeAttribute("xlink:href");break}f=Lr(""+b),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":b!=null&&typeof b!="function"&&typeof b!="symbol"?i.setAttribute(f,""+b):i.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":b&&typeof b!="function"&&typeof b!="symbol"?i.setAttribute(f,""):i.removeAttribute(f);break;case"capture":case"download":b===!0?i.setAttribute(f,""):b!==!1&&b!=null&&typeof b!="function"&&typeof b!="symbol"?i.setAttribute(f,b):i.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":b!=null&&typeof b!="function"&&typeof b!="symbol"&&!isNaN(b)&&1<=b?i.setAttribute(f,b):i.removeAttribute(f);break;case"rowSpan":case"start":b==null||typeof b=="function"||typeof b=="symbol"||isNaN(b)?i.removeAttribute(f):i.setAttribute(f,b);break;case"popover":xn("beforetoggle",i),xn("toggle",i),Za(i,"popover",b);break;case"xlinkActuate":Yr(i,"http://www.w3.org/1999/xlink","xlink:actuate",b);break;case"xlinkArcrole":Yr(i,"http://www.w3.org/1999/xlink","xlink:arcrole",b);break;case"xlinkRole":Yr(i,"http://www.w3.org/1999/xlink","xlink:role",b);break;case"xlinkShow":Yr(i,"http://www.w3.org/1999/xlink","xlink:show",b);break;case"xlinkTitle":Yr(i,"http://www.w3.org/1999/xlink","xlink:title",b);break;case"xlinkType":Yr(i,"http://www.w3.org/1999/xlink","xlink:type",b);break;case"xmlBase":Yr(i,"http://www.w3.org/XML/1998/namespace","xml:base",b);break;case"xmlLang":Yr(i,"http://www.w3.org/XML/1998/namespace","xml:lang",b);break;case"xmlSpace":Yr(i,"http://www.w3.org/XML/1998/namespace","xml:space",b);break;case"is":Za(i,"is",b);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=dl.get(f)||f,Za(i,f,b))}}function ag(i,o,f,b,M,I){switch(f){case"style":Gf(i,b,I);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(_(61));if(f=b.__html,f!=null){if(M.children!=null)throw Error(_(60));i.innerHTML=f}}break;case"children":typeof b=="string"?hl(i,b):(typeof b=="number"||typeof b=="bigint")&&hl(i,""+b);break;case"onScroll":b!=null&&xn("scroll",i);break;case"onScrollEnd":b!=null&&xn("scrollend",i);break;case"onClick":b!=null&&(i.onclick=rn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Zn.hasOwnProperty(f))t:{if(f[0]==="o"&&f[1]==="n"&&(M=f.endsWith("Capture"),o=f.slice(2,M?f.length-7:void 0),I=i[Ce]||null,I=I!=null?I[f]:null,typeof I=="function"&&i.removeEventListener(o,I,M),typeof b=="function")){typeof I!="function"&&I!==null&&(f in i?i[f]=null:i.hasAttribute(f)&&i.removeAttribute(f)),i.addEventListener(o,b,M);break t}f in i?i[f]=b:b===!0?i.setAttribute(f,""):Za(i,f,b)}}}function Ar(i,o,f){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":xn("error",i),xn("load",i);var b=!1,M=!1,I;for(I in f)if(f.hasOwnProperty(I)){var X=f[I];if(X!=null)switch(I){case"src":b=!0;break;case"srcSet":M=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(_(137,o));default:jn(i,o,I,X,f,null)}}M&&jn(i,o,"srcSet",f.srcSet,f,null),b&&jn(i,o,"src",f.src,f,null);return;case"input":xn("invalid",i);var ot=I=X=M=null,Mt=null,Yt=null;for(b in f)if(f.hasOwnProperty(b)){var le=f[b];if(le!=null)switch(b){case"name":M=le;break;case"type":X=le;break;case"checked":Mt=le;break;case"defaultChecked":Yt=le;break;case"value":I=le;break;case"defaultValue":ot=le;break;case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(_(137,o));break;default:jn(i,o,b,le,f,null)}}uh(i,I,ot,Mt,Yt,X,M,!1);return;case"select":xn("invalid",i),b=X=I=null;for(M in f)if(f.hasOwnProperty(M)&&(ot=f[M],ot!=null))switch(M){case"value":I=ot;break;case"defaultValue":X=ot;break;case"multiple":b=ot;default:jn(i,o,M,ot,f,null)}o=I,f=X,i.multiple=!!b,o!=null?ul(i,!!b,o,!1):f!=null&&ul(i,!!b,f,!0);return;case"textarea":xn("invalid",i),I=M=b=null;for(X in f)if(f.hasOwnProperty(X)&&(ot=f[X],ot!=null))switch(X){case"value":b=ot;break;case"defaultValue":M=ot;break;case"children":I=ot;break;case"dangerouslySetInnerHTML":if(ot!=null)throw Error(_(91));break;default:jn(i,o,X,ot,f,null)}su(i,b,M,I);return;case"option":for(Mt in f)if(f.hasOwnProperty(Mt)&&(b=f[Mt],b!=null))switch(Mt){case"selected":i.selected=b&&typeof b!="function"&&typeof b!="symbol";break;default:jn(i,o,Mt,b,f,null)}return;case"dialog":xn("beforetoggle",i),xn("toggle",i),xn("cancel",i),xn("close",i);break;case"iframe":case"object":xn("load",i);break;case"video":case"audio":for(b=0;b<pf.length;b++)xn(pf[b],i);break;case"image":xn("error",i),xn("load",i);break;case"details":xn("toggle",i);break;case"embed":case"source":case"link":xn("error",i),xn("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Yt in f)if(f.hasOwnProperty(Yt)&&(b=f[Yt],b!=null))switch(Yt){case"children":case"dangerouslySetInnerHTML":throw Error(_(137,o));default:jn(i,o,Yt,b,f,null)}return;default:if(ya(o)){for(le in f)f.hasOwnProperty(le)&&(b=f[le],b!==void 0&&ag(i,o,le,b,f,void 0));return}}for(ot in f)f.hasOwnProperty(ot)&&(b=f[ot],b!=null&&jn(i,o,ot,b,f,null))}function Uy(i,o,f,b){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var M=null,I=null,X=null,ot=null,Mt=null,Yt=null,le=null;for(ne in f){var fe=f[ne];if(f.hasOwnProperty(ne)&&fe!=null)switch(ne){case"checked":break;case"value":break;case"defaultValue":Mt=fe;default:b.hasOwnProperty(ne)||jn(i,o,ne,null,b,fe)}}for(var Jt in b){var ne=b[Jt];if(fe=f[Jt],b.hasOwnProperty(Jt)&&(ne!=null||fe!=null))switch(Jt){case"type":I=ne;break;case"name":M=ne;break;case"checked":Yt=ne;break;case"defaultChecked":le=ne;break;case"value":X=ne;break;case"defaultValue":ot=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(_(137,o));break;default:ne!==fe&&jn(i,o,Jt,ne,b,fe)}}ch(i,X,ot,Mt,Yt,le,I,M);return;case"select":ne=X=ot=Jt=null;for(I in f)if(Mt=f[I],f.hasOwnProperty(I)&&Mt!=null)switch(I){case"value":break;case"multiple":ne=Mt;default:b.hasOwnProperty(I)||jn(i,o,I,null,b,Mt)}for(M in b)if(I=b[M],Mt=f[M],b.hasOwnProperty(M)&&(I!=null||Mt!=null))switch(M){case"value":Jt=I;break;case"defaultValue":ot=I;break;case"multiple":X=I;default:I!==Mt&&jn(i,o,M,I,b,Mt)}o=ot,f=X,b=ne,Jt!=null?ul(i,!!f,Jt,!1):!!b!=!!f&&(o!=null?ul(i,!!f,o,!0):ul(i,!!f,f?[]:"",!1));return;case"textarea":ne=Jt=null;for(ot in f)if(M=f[ot],f.hasOwnProperty(ot)&&M!=null&&!b.hasOwnProperty(ot))switch(ot){case"value":break;case"children":break;default:jn(i,o,ot,null,b,M)}for(X in b)if(M=b[X],I=f[X],b.hasOwnProperty(X)&&(M!=null||I!=null))switch(X){case"value":Jt=M;break;case"defaultValue":ne=M;break;case"children":break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(_(91));break;default:M!==I&&jn(i,o,X,M,b,I)}ma(i,Jt,ne);return;case"option":for(var ke in f)if(Jt=f[ke],f.hasOwnProperty(ke)&&Jt!=null&&!b.hasOwnProperty(ke))switch(ke){case"selected":i.selected=!1;break;default:jn(i,o,ke,null,b,Jt)}for(Mt in b)if(Jt=b[Mt],ne=f[Mt],b.hasOwnProperty(Mt)&&Jt!==ne&&(Jt!=null||ne!=null))switch(Mt){case"selected":i.selected=Jt&&typeof Jt!="function"&&typeof Jt!="symbol";break;default:jn(i,o,Mt,Jt,b,ne)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Je in f)Jt=f[Je],f.hasOwnProperty(Je)&&Jt!=null&&!b.hasOwnProperty(Je)&&jn(i,o,Je,null,b,Jt);for(Yt in b)if(Jt=b[Yt],ne=f[Yt],b.hasOwnProperty(Yt)&&Jt!==ne&&(Jt!=null||ne!=null))switch(Yt){case"children":case"dangerouslySetInnerHTML":if(Jt!=null)throw Error(_(137,o));break;default:jn(i,o,Yt,Jt,b,ne)}return;default:if(ya(o)){for(var Kn in f)Jt=f[Kn],f.hasOwnProperty(Kn)&&Jt!==void 0&&!b.hasOwnProperty(Kn)&&ag(i,o,Kn,void 0,b,Jt);for(le in b)Jt=b[le],ne=f[le],!b.hasOwnProperty(le)||Jt===ne||Jt===void 0&&ne===void 0||ag(i,o,le,Jt,b,ne);return}}for(var Bt in f)Jt=f[Bt],f.hasOwnProperty(Bt)&&Jt!=null&&!b.hasOwnProperty(Bt)&&jn(i,o,Bt,null,b,Jt);for(fe in b)Jt=b[fe],ne=f[fe],!b.hasOwnProperty(fe)||Jt===ne||Jt==null&&ne==null||jn(i,o,fe,Jt,b,ne)}function og(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Kh(){if(typeof performance.getEntriesByType=="function"){for(var i=0,o=0,f=performance.getEntriesByType("resource"),b=0;b<f.length;b++){var M=f[b],I=M.transferSize,X=M.initiatorType,ot=M.duration;if(I&&ot&&og(X)){for(X=0,ot=M.responseEnd,b+=1;b<f.length;b++){var Mt=f[b],Yt=Mt.startTime;if(Yt>ot)break;var le=Mt.transferSize,fe=Mt.initiatorType;le&&og(fe)&&(Mt=Mt.responseEnd,X+=le*(Mt<ot?1:(ot-Yt)/(Mt-Yt)))}if(--b,o+=8*(I+X)/(M.duration/1e3),i++,10<i)break}}if(0<i)return o/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var Qh=null,_f=null;function Jh(i){return i.nodeType===9?i:i.ownerDocument}function lg(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Lp(i,o){if(i===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&o==="foreignObject"?0:i}function vf(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var cg=null;function kv(){var i=window.event;return i&&i.type==="popstate"?i===cg?!1:(cg=i,!0):(cg=null,!1)}var _r=typeof setTimeout=="function"?setTimeout:void 0,dn=typeof clearTimeout=="function"?clearTimeout:void 0,Qo=typeof Promise=="function"?Promise:void 0,go=typeof queueMicrotask=="function"?queueMicrotask:typeof Qo<"u"?function(i){return Qo.resolve(null).then(i).catch(Hu)}:_r;function Hu(i){setTimeout(function(){throw i})}function Qi(i){return i==="head"}function Ji(i,o){var f=o,b=0;do{var M=f.nextSibling;if(i.removeChild(f),M&&M.nodeType===8)if(f=M.data,f==="/$"||f==="/&"){if(b===0){i.removeChild(M),ld(o);return}b--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")b++;else if(f==="html")ed(i.ownerDocument.documentElement);else if(f==="head"){f=i.ownerDocument.head,ed(f);for(var I=f.firstChild;I;){var X=I.nextSibling,ot=I.nodeName;I[ls]||ot==="SCRIPT"||ot==="STYLE"||ot==="LINK"&&I.rel.toLowerCase()==="stylesheet"||f.removeChild(I),I=X}}else f==="body"&&ed(i.ownerDocument.body);f=M}while(f);ld(o)}function tr(i,o){var f=i;i=0;do{var b=f.nextSibling;if(f.nodeType===1?o?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(o?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),b&&b.nodeType===8)if(f=b.data,f==="/$"){if(i===0)break;i--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||i++;f=b}while(f)}function kp(i){var o=i.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var f=o;switch(o=o.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":kp(f),Eo(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}i.removeChild(f)}}function aa(i,o,f,b){for(;i.nodeType===1;){var M=f;if(i.nodeName.toLowerCase()!==o.toLowerCase()){if(!b&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(b){if(!i[ls])switch(o){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(I=i.getAttribute("rel"),I==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(I!==M.rel||i.getAttribute("href")!==(M.href==null||M.href===""?null:M.href)||i.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin)||i.getAttribute("title")!==(M.title==null?null:M.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(I=i.getAttribute("src"),(I!==(M.src==null?null:M.src)||i.getAttribute("type")!==(M.type==null?null:M.type)||i.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin))&&I&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(o==="input"&&i.type==="hidden"){var I=M.name==null?null:""+M.name;if(M.type==="hidden"&&i.getAttribute("name")===I)return i}else return i;if(i=Mr(i.nextSibling),i===null)break}return null}function ug(i,o,f){if(o==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!f||(i=Mr(i.nextSibling),i===null))return null;return i}function Fi(i,o){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!o||(i=Mr(i.nextSibling),i===null))return null;return i}function td(i){return i.data==="$?"||i.data==="$~"}function hg(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function Gy(i,o){var f=i.ownerDocument;if(i.data==="$~")i._reactRetry=o;else if(i.data!=="$?"||f.readyState!=="loading")o();else{var b=function(){o(),f.removeEventListener("DOMContentLoaded",b)};f.addEventListener("DOMContentLoaded",b),i._reactRetry=b}}function Mr(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return i}var Fc=null;function qy(i){i=i.nextSibling;for(var o=0;i;){if(i.nodeType===8){var f=i.data;if(f==="/$"||f==="/&"){if(o===0)return Mr(i.nextSibling);o--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||o++}i=i.nextSibling}return null}function dg(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var f=i.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(o===0)return i;o--}else f!=="/$"&&f!=="/&"||o++}i=i.previousSibling}return null}function fg(i,o,f){switch(o=Jh(f),i){case"html":if(i=o.documentElement,!i)throw Error(_(452));return i;case"head":if(i=o.head,!i)throw Error(_(453));return i;case"body":if(i=o.body,!i)throw Error(_(454));return i;default:throw Error(_(451))}}function ed(i){for(var o=i.attributes;o.length;)i.removeAttributeNode(o[0]);Eo(i)}var ks=new Map,pg=new Set;function yo(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var _s=Qt.d;Qt.d={f:Op,r:xf,D:nn,C:Zy,L:$y,m:nd,X:id,S:Ov,M:Nv};function Op(){var i=_s.f(),o=Yh();return i||o}function xf(i){var o=Tr(i);o!==null&&o.tag===5&&o.type==="form"?fs(o):_s.r(i)}var ji=typeof document>"u"?null:document;function Ba(i,o,f){var b=ji;if(b&&typeof o=="string"&&o){var M=Wr(o);M='link[rel="'+i+'"][href="'+M+'"]',typeof f=="string"&&(M+='[crossorigin="'+f+'"]'),pg.has(M)||(pg.add(M),i={rel:i,crossOrigin:f,href:o},b.querySelector(M)===null&&(o=b.createElement("link"),Ar(o,"link",i),gi(o),b.head.appendChild(o)))}}function nn(i){_s.D(i),Ba("dns-prefetch",i,null)}function Zy(i,o){_s.C(i,o),Ba("preconnect",i,o)}function $y(i,o,f){_s.L(i,o,f);var b=ji;if(b&&i&&o){var M='link[rel="preload"][as="'+Wr(o)+'"]';o==="image"&&f&&f.imageSrcSet?(M+='[imagesrcset="'+Wr(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(M+='[imagesizes="'+Wr(f.imageSizes)+'"]')):M+='[href="'+Wr(i)+'"]';var I=M;switch(o){case"style":I=ql(i);break;case"script":I=Bc(i)}ks.has(I)||(i=H({rel:"preload",href:o==="image"&&f&&f.imageSrcSet?void 0:i,as:o},f),ks.set(I,i),b.querySelector(M)!==null||o==="style"&&b.querySelector(jc(I))||o==="script"&&b.querySelector(Xu(I))||(o=b.createElement("link"),Ar(o,"link",i),gi(o),b.head.appendChild(o)))}}function nd(i,o){_s.m(i,o);var f=ji;if(f&&i){var b=o&&typeof o.as=="string"?o.as:"script",M='link[rel="modulepreload"][as="'+Wr(b)+'"][href="'+Wr(i)+'"]',I=M;switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":I=Bc(i)}if(!ks.has(I)&&(i=H({rel:"modulepreload",href:i},o),ks.set(I,i),f.querySelector(M)===null)){switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Xu(I)))return}b=f.createElement("link"),Ar(b,"link",i),gi(b),f.head.appendChild(b)}}}function Ov(i,o,f){_s.S(i,o,f);var b=ji;if(b&&i){var M=Zs(b).hoistableStyles,I=ql(i);o=o||"default";var X=M.get(I);if(!X){var ot={loading:0,preload:null};if(X=b.querySelector(jc(I)))ot.loading=5;else{i=H({rel:"stylesheet",href:i,"data-precedence":o},f),(f=ks.get(I))&&Yu(i,f);var Mt=X=b.createElement("link");gi(Mt),Ar(Mt,"link",i),Mt._p=new Promise(function(Yt,le){Mt.onload=Yt,Mt.onerror=le}),Mt.addEventListener("load",function(){ot.loading|=1}),Mt.addEventListener("error",function(){ot.loading|=2}),ot.loading|=4,Vc(X,o,b)}X={type:"stylesheet",instance:X,count:1,state:ot},M.set(I,X)}}}function id(i,o){_s.X(i,o);var f=ji;if(f&&i){var b=Zs(f).hoistableScripts,M=Bc(i),I=b.get(M);I||(I=f.querySelector(Xu(M)),I||(i=H({src:i,async:!0},o),(o=ks.get(M))&&Np(i,o),I=f.createElement("script"),gi(I),Ar(I,"link",i),f.head.appendChild(I)),I={type:"script",instance:I,count:1,state:null},b.set(M,I))}}function Nv(i,o){_s.M(i,o);var f=ji;if(f&&i){var b=Zs(f).hoistableScripts,M=Bc(i),I=b.get(M);I||(I=f.querySelector(Xu(M)),I||(i=H({src:i,async:!0,type:"module"},o),(o=ks.get(M))&&Np(i,o),I=f.createElement("script"),gi(I),Ar(I,"link",i),f.head.appendChild(I)),I={type:"script",instance:I,count:1,state:null},b.set(M,I))}}function mg(i,o,f,b){var M=(M=$e.current)?yo(M):null;if(!M)throw Error(_(446));switch(i){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(o=ql(f.href),f=Zs(M).hoistableStyles,b=f.get(o),b||(b={type:"style",instance:null,count:0,state:null},f.set(o,b)),b):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){i=ql(f.href);var I=Zs(M).hoistableStyles,X=I.get(i);if(X||(M=M.ownerDocument||M,X={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},I.set(i,X),(I=M.querySelector(jc(i)))&&!I._p&&(X.instance=I,X.state.loading=5),ks.has(i)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},ks.set(i,f),I||gg(M,i,f,X.state))),o&&b===null)throw Error(_(528,""));return X}if(o&&b!==null)throw Error(_(529,""));return null;case"script":return o=f.async,f=f.src,typeof f=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Bc(f),f=Zs(M).hoistableScripts,b=f.get(o),b||(b={type:"script",instance:null,count:0,state:null},f.set(o,b)),b):{type:"void",instance:null,count:0,state:null};default:throw Error(_(444,i))}}function ql(i){return'href="'+Wr(i)+'"'}function jc(i){return'link[rel="stylesheet"]['+i+"]"}function bf(i){return H({},i,{"data-precedence":i.precedence,precedence:null})}function gg(i,o,f,b){i.querySelector('link[rel="preload"][as="style"]['+o+"]")?b.loading=1:(o=i.createElement("link"),b.preload=o,o.addEventListener("load",function(){return b.loading|=1}),o.addEventListener("error",function(){return b.loading|=2}),Ar(o,"link",f),gi(o),i.head.appendChild(o))}function Bc(i){return'[src="'+Wr(i)+'"]'}function Xu(i){return"script[async]"+i}function yg(i,o,f){if(o.count++,o.instance===null)switch(o.type){case"style":var b=i.querySelector('style[data-href~="'+Wr(f.href)+'"]');if(b)return o.instance=b,gi(b),b;var M=H({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return b=(i.ownerDocument||i).createElement("style"),gi(b),Ar(b,"style",M),Vc(b,f.precedence,i),o.instance=b;case"stylesheet":M=ql(f.href);var I=i.querySelector(jc(M));if(I)return o.state.loading|=4,o.instance=I,gi(I),I;b=bf(f),(M=ks.get(M))&&Yu(b,M),I=(i.ownerDocument||i).createElement("link"),gi(I);var X=I;return X._p=new Promise(function(ot,Mt){X.onload=ot,X.onerror=Mt}),Ar(I,"link",b),o.state.loading|=4,Vc(I,f.precedence,i),o.instance=I;case"script":return I=Bc(f.src),(M=i.querySelector(Xu(I)))?(o.instance=M,gi(M),M):(b=f,(M=ks.get(I))&&(b=H({},f),Np(b,M)),i=i.ownerDocument||i,M=i.createElement("script"),gi(M),Ar(M,"link",b),i.head.appendChild(M),o.instance=M);case"void":return null;default:throw Error(_(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(b=o.instance,o.state.loading|=4,Vc(b,f.precedence,i));return o.instance}function Vc(i,o,f){for(var b=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),M=b.length?b[b.length-1]:null,I=M,X=0;X<b.length;X++){var ot=b[X];if(ot.dataset.precedence===o)I=ot;else if(I!==M)break}I?I.parentNode.insertBefore(i,I.nextSibling):(o=f.nodeType===9?f.head:f,o.insertBefore(i,o.firstChild))}function Yu(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.title==null&&(i.title=o.title)}function Np(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.integrity==null&&(i.integrity=o.integrity)}var Wu=null;function wf(i,o,f){if(Wu===null){var b=new Map,M=Wu=new Map;M.set(f,b)}else M=Wu,b=M.get(f),b||(b=new Map,M.set(f,b));if(b.has(i))return b;for(b.set(i,null),f=f.getElementsByTagName(i),M=0;M<f.length;M++){var I=f[M];if(!(I[ls]||I[ce]||i==="link"&&I.getAttribute("rel")==="stylesheet")&&I.namespaceURI!=="http://www.w3.org/2000/svg"){var X=I.getAttribute(o)||"";X=i+X;var ot=b.get(X);ot?ot.push(I):b.set(X,[I])}}return b}function Hy(i,o,f){i=i.ownerDocument||i,i.head.insertBefore(f,o==="title"?i.querySelector("head > title"):null)}function _g(i,o,f){if(f===1||o.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return i=o.disabled,typeof o.precedence=="string"&&i==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function vg(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function Fv(i,o,f,b){if(f.type==="stylesheet"&&(typeof b.media!="string"||matchMedia(b.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var M=ql(b.href),I=o.querySelector(jc(M));if(I){o=I._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(i.count++,i=Fp.bind(i),o.then(i,i)),f.state.loading|=4,f.instance=I,gi(I);return}I=o.ownerDocument||o,b=bf(b),(M=ks.get(M))&&Yu(b,M),I=I.createElement("link"),gi(I);var X=I;X._p=new Promise(function(ot,Mt){X.onload=ot,X.onerror=Mt}),Ar(I,"link",b),f.instance=I}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(f,o),(o=f.state.preload)&&(f.state.loading&3)===0&&(i.count++,f=Fp.bind(i),o.addEventListener("load",f),o.addEventListener("error",f))}}var xg=0;function Xy(i,o){return i.stylesheets&&i.count===0&&Tf(i,i.stylesheets),0<i.count||0<i.imgCount?function(f){var b=setTimeout(function(){if(i.stylesheets&&Tf(i,i.stylesheets),i.unsuspend){var I=i.unsuspend;i.unsuspend=null,I()}},6e4+o);0<i.imgBytes&&xg===0&&(xg=62500*Kh());var M=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Tf(i,i.stylesheets),i.unsuspend)){var I=i.unsuspend;i.unsuspend=null,I()}},(i.imgBytes>xg?50:800)+o);return i.unsuspend=f,function(){i.unsuspend=null,clearTimeout(b),clearTimeout(M)}}:null}function Fp(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Tf(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Uc=null;function Tf(i,o){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Uc=new Map,o.forEach(jv,i),Uc=null,Fp.call(i))}function jv(i,o){if(!(o.state.loading&4)){var f=Uc.get(i);if(f)var b=f.get(null);else{f=new Map,Uc.set(i,f);for(var M=i.querySelectorAll("link[data-precedence],style[data-precedence]"),I=0;I<M.length;I++){var X=M[I];(X.nodeName==="LINK"||X.getAttribute("media")!=="not all")&&(f.set(X.dataset.precedence,X),b=X)}b&&f.set(null,b)}M=o.instance,X=M.getAttribute("data-precedence"),I=f.get(X)||b,I===b&&f.set(null,M),f.set(X,M),this.count++,b=Fp.bind(this),M.addEventListener("load",b),M.addEventListener("error",b),I?I.parentNode.insertBefore(M,I.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(M,i.firstChild)),o.state.loading|=4}}var Ku={$$typeof:bt,Provider:null,Consumer:null,_currentValue:Gt,_currentValue2:Gt,_threadCount:0};function bg(i,o,f,b,M,I,X,ot,Mt){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Oe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Oe(0),this.hiddenUpdates=Oe(null),this.identifierPrefix=b,this.onUncaughtError=M,this.onCaughtError=I,this.onRecoverableError=X,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Mt,this.incompleteTransitions=new Map}function wg(i,o,f,b,M,I,X,ot,Mt,Yt,le,fe){return i=new bg(i,o,f,X,Mt,Yt,le,fe,ot),o=1,I===!0&&(o|=24),I=Jr(3,null,null,o),i.current=I,I.stateNode=i,o=es(),o.refCount++,i.pooledCache=o,o.refCount++,I.memoizedState={element:b,isDehydrated:f,cache:o},La(I),i}function Qu(i){return i?(i=Ka,i):Ka}function Tg(i,o,f,b,M,I){M=Qu(M),b.context===null?b.context=M:b.pendingContext=M,b=Bo(o),b.payload={element:f},I=I===void 0?null:I,I!==null&&(b.callback=I),f=Ps(i,b,o),f!==null&&(ys(f,i,o),ao(f,i,o))}function rd(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var f=i.retryLane;i.retryLane=f!==0&&f<o?f:o}}function Sg(i,o){rd(i,o),(i=i.alternate)&&rd(i,o)}function sd(i){if(i.tag===13||i.tag===31){var o=zo(i,67108864);o!==null&&ys(o,i,67108864),Sg(i,67108864)}}function Sf(i){if(i.tag===13||i.tag===31){var o=ia();o=pe(o);var f=zo(i,o);f!==null&&ys(f,i,o),Sg(i,o)}}var jp=!0;function Yy(i,o,f,b){var M=jt.T;jt.T=null;var I=Qt.p;try{Qt.p=2,Eg(i,o,f,b)}finally{Qt.p=I,jt.T=M}}function Wy(i,o,f,b){var M=jt.T;jt.T=null;var I=Qt.p;try{Qt.p=8,Eg(i,o,f,b)}finally{Qt.p=I,jt.T=M}}function Eg(i,o,f,b){if(jp){var M=Cg(b);if(M===null)zp(i,o,b,Bp,f),Jy(i,b);else if(Bv(M,i,o,f,b))b.stopPropagation();else if(Jy(i,b),o&4&&-1<Qy.indexOf(i)){for(;M!==null;){var I=Tr(M);if(I!==null)switch(I.tag){case 3:if(I=I.stateNode,I.current.memoizedState.isDehydrated){var X=It(I.pendingLanes);if(X!==0){var ot=I;for(ot.pendingLanes|=2,ot.entangledLanes|=2;X;){var Mt=1<<31-K(X);ot.entanglements[1]|=Mt,X&=~Mt}sa(I),(Pn&6)===0&&(Bu=qi()+500,qu(0))}}break;case 31:case 13:ot=zo(I,2),ot!==null&&ys(ot,I,2),Yh(),Sg(I,2)}if(I=Cg(b),I===null&&zp(i,o,b,Bp,f),I===M)break;M=I}M!==null&&b.stopPropagation()}else zp(i,o,b,null,f)}}function Cg(i){return i=bi(i),Ag(i)}var Bp=null;function Ag(i){if(Bp=null,i=Gs(i),i!==null){var o=A(i);if(o===null)i=null;else{var f=o.tag;if(f===13){if(i=T(o),i!==null)return i;i=null}else if(f===31){if(i=u(o),i!==null)return i;i=null}else if(f===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return Bp=i,null}function Ky(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Hr()){case nc:return 2;case ic:return 8;case pa:case rc:return 32;case Ga:return 268435456;default:return 32}default:return 32}}var Vp=!1,Os=null,Jo=null,Zl=null,ad=new Map,Ef=new Map,$l=[],Qy="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Jy(i,o){switch(i){case"focusin":case"focusout":Os=null;break;case"dragenter":case"dragleave":Jo=null;break;case"mouseover":case"mouseout":Zl=null;break;case"pointerover":case"pointerout":ad.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ef.delete(o.pointerId)}}function od(i,o,f,b,M,I){return i===null||i.nativeEvent!==I?(i={blockedOn:o,domEventName:f,eventSystemFlags:b,nativeEvent:I,targetContainers:[M]},o!==null&&(o=Tr(o),o!==null&&sd(o)),i):(i.eventSystemFlags|=b,o=i.targetContainers,M!==null&&o.indexOf(M)===-1&&o.push(M),i)}function Bv(i,o,f,b,M){switch(o){case"focusin":return Os=od(Os,i,o,f,b,M),!0;case"dragenter":return Jo=od(Jo,i,o,f,b,M),!0;case"mouseover":return Zl=od(Zl,i,o,f,b,M),!0;case"pointerover":var I=M.pointerId;return ad.set(I,od(ad.get(I)||null,i,o,f,b,M)),!0;case"gotpointercapture":return I=M.pointerId,Ef.set(I,od(Ef.get(I)||null,i,o,f,b,M)),!0}return!1}function t_(i){var o=Gs(i.target);if(o!==null){var f=A(o);if(f!==null){if(o=f.tag,o===13){if(o=T(f),o!==null){i.blockedOn=o,Ai(i.priority,function(){Sf(f)});return}}else if(o===31){if(o=u(f),o!==null){i.blockedOn=o,Ai(i.priority,function(){Sf(f)});return}}else if(o===3&&f.stateNode.current.memoizedState.isDehydrated){i.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}i.blockedOn=null}function _o(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var f=Cg(i.nativeEvent);if(f===null){f=i.nativeEvent;var b=new f.constructor(f.type,f);_a=b,f.target.dispatchEvent(b),_a=null}else return o=Tr(f),o!==null&&sd(o),i.blockedOn=f,!1;o.shift()}return!0}function Mg(i,o,f){_o(i)&&f.delete(o)}function e_(){Vp=!1,Os!==null&&_o(Os)&&(Os=null),Jo!==null&&_o(Jo)&&(Jo=null),Zl!==null&&_o(Zl)&&(Zl=null),ad.forEach(Mg),Ef.forEach(Mg)}function Cf(i,o){i.blockedOn===o&&(i.blockedOn=null,Vp||(Vp=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,e_)))}var Af=null;function n_(i){Af!==i&&(Af=i,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Af===i&&(Af=null);for(var o=0;o<i.length;o+=3){var f=i[o],b=i[o+1],M=i[o+2];if(typeof b!="function"){if(Ag(b||f)===null)continue;break}var I=Tr(f);I!==null&&(i.splice(o,3),o-=3,Oa(I,{pending:!0,data:M,method:f.method,action:b},b,M))}}))}function ld(i){function o(Mt){return Cf(Mt,i)}Os!==null&&Cf(Os,i),Jo!==null&&Cf(Jo,i),Zl!==null&&Cf(Zl,i),ad.forEach(o),Ef.forEach(o);for(var f=0;f<$l.length;f++){var b=$l[f];b.blockedOn===i&&(b.blockedOn=null)}for(;0<$l.length&&(f=$l[0],f.blockedOn===null);)t_(f),f.blockedOn===null&&$l.shift();if(f=(i.ownerDocument||i).$$reactFormReplay,f!=null)for(b=0;b<f.length;b+=3){var M=f[b],I=f[b+1],X=M[Ce]||null;if(typeof I=="function")X||n_(f);else if(X){var ot=null;if(I&&I.hasAttribute("formAction")){if(M=I,X=I[Ce]||null)ot=X.formAction;else if(Ag(M)!==null)continue}else ot=X.action;typeof ot=="function"?f[b+1]=ot:(f.splice(b,3),b-=3),n_(f)}}}function Pg(){function i(I){I.canIntercept&&I.info==="react-transition"&&I.intercept({handler:function(){return new Promise(function(X){return M=X})},focusReset:"manual",scroll:"manual"})}function o(){M!==null&&(M(),M=null),b||setTimeout(f,20)}function f(){if(!b&&!navigation.transition){var I=navigation.currentEntry;I&&I.url!=null&&navigation.navigate(I.url,{state:I.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var b=!1,M=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(f,100),function(){b=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),M!==null&&(M(),M=null)}}}function Up(i){this._internalRoot=i}Ju.prototype.render=Up.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(_(409));var f=o.current,b=ia();Tg(f,b,i,o,null,null)},Ju.prototype.unmount=Up.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;Tg(i.current,2,null,i,null,null),Yh(),o[Ne]=null}};function Ju(i){this._internalRoot=i}Ju.prototype.unstable_scheduleHydration=function(i){if(i){var o=qn();i={blockedOn:null,target:i,priority:o};for(var f=0;f<$l.length&&o!==0&&o<$l[f].priority;f++);$l.splice(f,0,i),f===0&&t_(i)}};var Dg=c.version;if(Dg!=="19.2.0")throw Error(_(527,Dg,"19.2.0"));Qt.findDOMNode=function(i){var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(_(188)):(i=Object.keys(i).join(","),Error(_(268,i)));return i=k(o),i=i!==null?B(i):null,i=i===null?null:i.stateNode,i};var Gp={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:jt,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var th=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!th.isDisabled&&th.supportsFiber)try{Ir=th.inject(Gp),ri=th}catch{}}return zg.createRoot=function(i,o){if(!S(i))throw Error(_(299));var f=!1,b="",M=Nh,I=Fh,X=cp;return o!=null&&(o.unstable_strictMode===!0&&(f=!0),o.identifierPrefix!==void 0&&(b=o.identifierPrefix),o.onUncaughtError!==void 0&&(M=o.onUncaughtError),o.onCaughtError!==void 0&&(I=o.onCaughtError),o.onRecoverableError!==void 0&&(X=o.onRecoverableError)),o=wg(i,1,!1,null,null,f,b,null,M,I,X,Pg),i[Ne]=o.current,Ip(i),new Up(o)},zg.hydrateRoot=function(i,o,f){if(!S(i))throw Error(_(299));var b=!1,M="",I=Nh,X=Fh,ot=cp,Mt=null;return f!=null&&(f.unstable_strictMode===!0&&(b=!0),f.identifierPrefix!==void 0&&(M=f.identifierPrefix),f.onUncaughtError!==void 0&&(I=f.onUncaughtError),f.onCaughtError!==void 0&&(X=f.onCaughtError),f.onRecoverableError!==void 0&&(ot=f.onRecoverableError),f.formState!==void 0&&(Mt=f.formState)),o=wg(i,1,!0,o,f??null,b,M,Mt,I,X,ot,Pg),o.context=Qu(null),f=o.current,b=ia(),b=pe(b),M=Bo(b),M.callback=null,Ps(f,M,b),f=b,o.current.lanes=f,Qe(o,f),sa(o),i[Ne]=o.current,Ip(i),new Ju(o)},zg.version="19.2.0",zg}var Xb;function fA(){if(Xb)return qv.exports;Xb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(c){console.error(c)}}return s(),qv.exports=dA(),qv.exports}var pA=fA();function mA(s,c){if(s instanceof RegExp)return{keys:!1,pattern:s};var p,_,S,A,T=[],u="",L=s.split("/");for(L[0]||L.shift();S=L.shift();)p=S[0],p==="*"?(T.push(p),u+=S[1]==="?"?"(?:/(.*))?":"/(.*)"):p===":"?(_=S.indexOf("?",1),A=S.indexOf(".",1),T.push(S.substring(1,~_?_:~A?A:S.length)),u+=~_&&!~A?"(?:/([^/]+?))?":"/([^/]+?)",~A&&(u+=(~_?"?":"")+"\\"+S.substring(A))):u+="/"+S;return{keys:T,pattern:new RegExp("^"+u+(c?"(?=$|/)":"/?$"),"i")}}var Z=$_();const dd=m0(Z),H_=sA({__proto__:null,default:dd},[Z]);var Yv={exports:{}},Wv={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yb;function gA(){if(Yb)return Wv;Yb=1;var s=$_();function c(H,W){return H===W&&(H!==0||1/H===1/W)||H!==H&&W!==W}var p=typeof Object.is=="function"?Object.is:c,_=s.useState,S=s.useEffect,A=s.useLayoutEffect,T=s.useDebugValue;function u(H,W){var it=W(),pt=_({inst:{value:it,getSnapshot:W}}),rt=pt[0].inst,J=pt[1];return A(function(){rt.value=it,rt.getSnapshot=W,L(rt)&&J({inst:rt})},[H,it,W]),S(function(){return L(rt)&&J({inst:rt}),H(function(){L(rt)&&J({inst:rt})})},[H]),T(it),it}function L(H){var W=H.getSnapshot;H=H.value;try{var it=W();return!p(H,it)}catch{return!0}}function k(H,W){return W()}var B=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?k:u;return Wv.useSyncExternalStore=s.useSyncExternalStore!==void 0?s.useSyncExternalStore:B,Wv}var Wb;function yA(){return Wb||(Wb=1,Yv.exports=gA()),Yv.exports}var hT=yA();const _A=H_.useInsertionEffect,vA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",dT=vA?Z.useLayoutEffect:Z.useEffect,xA=_A||dT,g0=s=>{const c=Z.useRef([s,(...p)=>c[0](...p)]).current;return xA(()=>{c[0]=s}),c[1]},bA="popstate",y0="pushState",_0="replaceState",wA="hashchange",Kb=[bA,y0,_0,wA],TA=s=>{for(const c of Kb)addEventListener(c,s);return()=>{for(const c of Kb)removeEventListener(c,s)}},fT=(s,c)=>hT.useSyncExternalStore(TA,s,c),SA=()=>location.search,EA=({ssrSearch:s=""}={})=>fT(SA,()=>s),Qb=()=>location.pathname,CA=({ssrPath:s}={})=>fT(Qb,s?()=>s:Qb),AA=(s,{replace:c=!1,state:p=null}={})=>history[c?_0:y0](p,"",s),MA=(s={})=>[CA(s),AA],Jb=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[Jb]>"u"){for(const s of[y0,_0]){const c=history[s];history[s]=function(){const p=c.apply(this,arguments),_=new Event(s);return _.arguments=arguments,dispatchEvent(_),p}}Object.defineProperty(window,Jb,{value:!0})}const PA=(s,c)=>c.toLowerCase().indexOf(s.toLowerCase())?"~"+c:c.slice(s.length)||"/",pT=(s="")=>s==="/"?"":s,DA=(s,c)=>s[0]==="~"?s.slice(1):pT(c)+s,RA=(s="",c)=>PA(t1(pT(s)),t1(c)),t1=s=>{try{return decodeURI(s)}catch{return s}},mT={hook:MA,searchHook:EA,parser:mA,base:"",ssrPath:void 0,ssrSearch:void 0,hrefs:s=>s},gT=Z.createContext(mT),ey=()=>Z.useContext(gT),yT={},_T=Z.createContext(yT),IA=()=>Z.useContext(_T),X_=s=>{const[c,p]=s.hook(s);return[RA(s.base,c),g0((_,S)=>p(DA(_,s.base),S))]},ny=()=>X_(ey()),vT=(s,c,p,_)=>{const{pattern:S,keys:A}=c instanceof RegExp?{keys:!1,pattern:c}:s(c||"*",_),T=S.exec(p)||[],[u,...L]=T;return u!==void 0?[!0,(()=>{const k=A!==!1?Object.fromEntries(A.map((H,W)=>[H,L[W]])):T.groups;let B={...L};return k&&Object.assign(B,k),B})(),..._?[u]:[]]:[!1,null]},zA=({children:s,...c})=>{const p=ey(),_=c.hook?mT:p;let S=_;const[A,T]=c.ssrPath?.split("?")??[];T&&(c.ssrSearch=T,c.ssrPath=A),c.hrefs=c.hrefs??c.hook?.hrefs;let u=Z.useRef({}),L=u.current,k=L;for(let B in _){const H=B==="base"?_[B]+(c[B]||""):c[B]||_[B];L===k&&H!==k[B]&&(u.current=k={...k}),k[B]=H,H!==_[B]&&(S=k)}return Z.createElement(gT.Provider,{value:S,children:s})},e1=({children:s,component:c},p)=>c?Z.createElement(c,{params:p}):typeof s=="function"?s(p):s,LA=s=>{let c=Z.useRef(yT),p=c.current;for(const _ in s)s[_]!==p[_]&&(p=s);return Object.keys(s).length===0&&(p=s),c.current=p},Hp=({path:s,nest:c,match:p,..._})=>{const S=ey(),[A]=X_(S),[T,u,L]=p??vT(S.parser,s,A,c),k=LA({...IA(),...u});if(!T)return null;const B=L?Z.createElement(zA,{base:L},e1(_,k)):e1(_,k);return Z.createElement(_T.Provider,{value:k,children:B})};Z.forwardRef((s,c)=>{const p=ey(),[_,S]=X_(p),{to:A="",href:T=A,onClick:u,asChild:L,children:k,className:B,replace:H,state:W,...it}=s,pt=g0(J=>{J.ctrlKey||J.metaKey||J.altKey||J.shiftKey||J.button!==0||(u?.(J),J.defaultPrevented||(J.preventDefault(),S(T,s)))}),rt=p.hrefs(T[0]==="~"?T.slice(1):p.base+T,p);return L&&Z.isValidElement(k)?Z.cloneElement(k,{onClick:pt,href:rt}):Z.createElement("a",{...it,onClick:pt,href:rt,className:B?.call?B(_===T):B,children:k,ref:c})});const xT=s=>Array.isArray(s)?s.flatMap(c=>xT(c&&c.type===Z.Fragment?c.props.children:c)):[s],kA=({children:s,location:c})=>{const p=ey(),[_]=X_(p);for(const S of xT(s)){let A=0;if(Z.isValidElement(S)&&(A=vT(p.parser,S.props.path,c||_,S.props.nest))[0])return Z.cloneElement(S,{match:A})}return null},ud=s=>{const{to:c,href:p=c}=s,[,_]=ny(),S=g0(()=>_(c||p,s));return dT(()=>{S()},[]),null};var Y_=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(s){return this.listeners.add(s),this.onSubscribe(),()=>{this.listeners.delete(s),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},W_=typeof window>"u"||"Deno"in globalThis;function Kl(){}function OA(s,c){return typeof s=="function"?s(c):s}function NA(s){return typeof s=="number"&&s>=0&&s!==1/0}function FA(s,c){return Math.max(s+(c||0)-Date.now(),0)}function n1(s,c){return typeof s=="function"?s(c):s}function jA(s,c){return typeof s=="function"?s(c):s}function i1(s,c){const{type:p="all",exact:_,fetchStatus:S,predicate:A,queryKey:T,stale:u}=s;if(T){if(_){if(c.queryHash!==v0(T,c.options))return!1}else if(!Zg(c.queryKey,T))return!1}if(p!=="all"){const L=c.isActive();if(p==="active"&&!L||p==="inactive"&&L)return!1}return!(typeof u=="boolean"&&c.isStale()!==u||S&&S!==c.state.fetchStatus||A&&!A(c))}function r1(s,c){const{exact:p,status:_,predicate:S,mutationKey:A}=s;if(A){if(!c.options.mutationKey)return!1;if(p){if(qg(c.options.mutationKey)!==qg(A))return!1}else if(!Zg(c.options.mutationKey,A))return!1}return!(_&&c.state.status!==_||S&&!S(c))}function v0(s,c){return(c?.queryKeyHashFn||qg)(s)}function qg(s){return JSON.stringify(s,(c,p)=>Px(p)?Object.keys(p).sort().reduce((_,S)=>(_[S]=p[S],_),{}):p)}function Zg(s,c){return s===c?!0:typeof s!=typeof c?!1:s&&c&&typeof s=="object"&&typeof c=="object"?!Object.keys(c).some(p=>!Zg(s[p],c[p])):!1}function bT(s,c){if(s===c)return s;const p=s1(s)&&s1(c);if(p||Px(s)&&Px(c)){const _=p?s:Object.keys(s),S=_.length,A=p?c:Object.keys(c),T=A.length,u=p?[]:{};let L=0;for(let k=0;k<T;k++){const B=p?k:A[k];(!p&&_.includes(B)||p)&&s[B]===void 0&&c[B]===void 0?(u[B]=void 0,L++):(u[B]=bT(s[B],c[B]),u[B]===s[B]&&s[B]!==void 0&&L++)}return S===T&&L===S?s:u}return c}function s1(s){return Array.isArray(s)&&s.length===Object.keys(s).length}function Px(s){if(!a1(s))return!1;const c=s.constructor;if(c===void 0)return!0;const p=c.prototype;return!(!a1(p)||!p.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(s)!==Object.prototype)}function a1(s){return Object.prototype.toString.call(s)==="[object Object]"}function BA(s){return new Promise(c=>{setTimeout(c,s)})}function VA(s,c,p){return typeof p.structuralSharing=="function"?p.structuralSharing(s,c):p.structuralSharing!==!1?bT(s,c):c}function UA(s,c,p=0){const _=[...s,c];return p&&_.length>p?_.slice(1):_}function GA(s,c,p=0){const _=[c,...s];return p&&_.length>p?_.slice(0,-1):_}var x0=Symbol();function wT(s,c){return!s.queryFn&&c?.initialPromise?()=>c.initialPromise:!s.queryFn||s.queryFn===x0?()=>Promise.reject(new Error(`Missing queryFn: '${s.queryHash}'`)):s.queryFn}var qA=class extends Y_{#t;#e;#n;constructor(){super(),this.#n=s=>{if(!W_&&window.addEventListener){const c=()=>s();return window.addEventListener("visibilitychange",c,!1),()=>{window.removeEventListener("visibilitychange",c)}}}}onSubscribe(){this.#e||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(s){this.#n=s,this.#e?.(),this.#e=s(c=>{typeof c=="boolean"?this.setFocused(c):this.onFocus()})}setFocused(s){this.#t!==s&&(this.#t=s,this.onFocus())}onFocus(){const s=this.isFocused();this.listeners.forEach(c=>{c(s)})}isFocused(){return typeof this.#t=="boolean"?this.#t:globalThis.document?.visibilityState!=="hidden"}},TT=new qA,ZA=class extends Y_{#t=!0;#e;#n;constructor(){super(),this.#n=s=>{if(!W_&&window.addEventListener){const c=()=>s(!0),p=()=>s(!1);return window.addEventListener("online",c,!1),window.addEventListener("offline",p,!1),()=>{window.removeEventListener("online",c),window.removeEventListener("offline",p)}}}}onSubscribe(){this.#e||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(s){this.#n=s,this.#e?.(),this.#e=s(this.setOnline.bind(this))}setOnline(s){this.#t!==s&&(this.#t=s,this.listeners.forEach(p=>{p(s)}))}isOnline(){return this.#t}},I_=new ZA;function $A(){let s,c;const p=new Promise((S,A)=>{s=S,c=A});p.status="pending",p.catch(()=>{});function _(S){Object.assign(p,S),delete p.resolve,delete p.reject}return p.resolve=S=>{_({status:"fulfilled",value:S}),s(S)},p.reject=S=>{_({status:"rejected",reason:S}),c(S)},p}function HA(s){return Math.min(1e3*2**s,3e4)}function ST(s){return(s??"online")==="online"?I_.isOnline():!0}var ET=class extends Error{constructor(s){super("CancelledError"),this.revert=s?.revert,this.silent=s?.silent}};function Kv(s){return s instanceof ET}function CT(s){let c=!1,p=0,_=!1,S;const A=$A(),T=rt=>{_||(W(new ET(rt)),s.abort?.())},u=()=>{c=!0},L=()=>{c=!1},k=()=>TT.isFocused()&&(s.networkMode==="always"||I_.isOnline())&&s.canRun(),B=()=>ST(s.networkMode)&&s.canRun(),H=rt=>{_||(_=!0,s.onSuccess?.(rt),S?.(),A.resolve(rt))},W=rt=>{_||(_=!0,s.onError?.(rt),S?.(),A.reject(rt))},it=()=>new Promise(rt=>{S=J=>{(_||k())&&rt(J)},s.onPause?.()}).then(()=>{S=void 0,_||s.onContinue?.()}),pt=()=>{if(_)return;let rt;const J=p===0?s.initialPromise:void 0;try{rt=J??s.fn()}catch(mt){rt=Promise.reject(mt)}Promise.resolve(rt).then(H).catch(mt=>{if(_)return;const Et=s.retry??(W_?0:3),bt=s.retryDelay??HA,Lt=typeof bt=="function"?bt(p,mt):bt,Ot=Et===!0||typeof Et=="number"&&p<Et||typeof Et=="function"&&Et(p,mt);if(c||!Ot){W(mt);return}p++,s.onFail?.(p,mt),BA(Lt).then(()=>k()?void 0:it()).then(()=>{c?W(mt):pt()})})};return{promise:A,cancel:T,continue:()=>(S?.(),A),cancelRetry:u,continueRetry:L,canStart:B,start:()=>(B()?pt():it().then(pt),A)}}function XA(){let s=[],c=0,p=u=>{u()},_=u=>{u()},S=u=>setTimeout(u,0);const A=u=>{c?s.push(u):S(()=>{p(u)})},T=()=>{const u=s;s=[],u.length&&S(()=>{_(()=>{u.forEach(L=>{p(L)})})})};return{batch:u=>{let L;c++;try{L=u()}finally{c--,c||T()}return L},batchCalls:u=>(...L)=>{A(()=>{u(...L)})},schedule:A,setNotifyFunction:u=>{p=u},setBatchNotifyFunction:u=>{_=u},setScheduler:u=>{S=u}}}var ca=XA(),AT=class{#t;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),NA(this.gcTime)&&(this.#t=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(s){this.gcTime=Math.max(this.gcTime||0,s??(W_?1/0:300*1e3))}clearGcTimeout(){this.#t&&(clearTimeout(this.#t),this.#t=void 0)}},YA=class extends AT{#t;#e;#n;#i;#a;#s;constructor(s){super(),this.#s=!1,this.#a=s.defaultOptions,this.setOptions(s.options),this.observers=[],this.#n=s.cache,this.queryKey=s.queryKey,this.queryHash=s.queryHash,this.#t=KA(this.options),this.state=s.state??this.#t,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#i?.promise}setOptions(s){this.options={...this.#a,...s},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(s,c){const p=VA(this.state.data,s,this.options);return this.#r({data:p,type:"success",dataUpdatedAt:c?.updatedAt,manual:c?.manual}),p}setState(s,c){this.#r({type:"setState",state:s,setStateOptions:c})}cancel(s){const c=this.#i?.promise;return this.#i?.cancel(s),c?c.then(Kl).catch(Kl):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#t)}isActive(){return this.observers.some(s=>jA(s.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===x0||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(s=>s.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(s=0){return this.state.isInvalidated||this.state.data===void 0||!FA(this.state.dataUpdatedAt,s)}onFocus(){this.observers.find(c=>c.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#i?.continue()}onOnline(){this.observers.find(c=>c.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#i?.continue()}addObserver(s){this.observers.includes(s)||(this.observers.push(s),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:s}))}removeObserver(s){this.observers.includes(s)&&(this.observers=this.observers.filter(c=>c!==s),this.observers.length||(this.#i&&(this.#s?this.#i.cancel({revert:!0}):this.#i.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:s}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#r({type:"invalidate"})}fetch(s,c){if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&c?.cancelRefetch)this.cancel({silent:!0});else if(this.#i)return this.#i.continueRetry(),this.#i.promise}if(s&&this.setOptions(s),!this.options.queryFn){const u=this.observers.find(L=>L.options.queryFn);u&&this.setOptions(u.options)}const p=new AbortController,_=u=>{Object.defineProperty(u,"signal",{enumerable:!0,get:()=>(this.#s=!0,p.signal)})},S=()=>{const u=wT(this.options,c),L={queryKey:this.queryKey,meta:this.meta};return _(L),this.#s=!1,this.options.persister?this.options.persister(u,L,this):u(L)},A={fetchOptions:c,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:S};_(A),this.options.behavior?.onFetch(A,this),this.#e=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==A.fetchOptions?.meta)&&this.#r({type:"fetch",meta:A.fetchOptions?.meta});const T=u=>{Kv(u)&&u.silent||this.#r({type:"error",error:u}),Kv(u)||(this.#n.config.onError?.(u,this),this.#n.config.onSettled?.(this.state.data,u,this)),this.scheduleGc()};return this.#i=CT({initialPromise:c?.initialPromise,fn:A.fetchFn,abort:p.abort.bind(p),onSuccess:u=>{if(u===void 0){T(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(u)}catch(L){T(L);return}this.#n.config.onSuccess?.(u,this),this.#n.config.onSettled?.(u,this.state.error,this),this.scheduleGc()},onError:T,onFail:(u,L)=>{this.#r({type:"failed",failureCount:u,error:L})},onPause:()=>{this.#r({type:"pause"})},onContinue:()=>{this.#r({type:"continue"})},retry:A.options.retry,retryDelay:A.options.retryDelay,networkMode:A.options.networkMode,canRun:()=>!0}),this.#i.start()}#r(s){const c=p=>{switch(s.type){case"failed":return{...p,fetchFailureCount:s.failureCount,fetchFailureReason:s.error};case"pause":return{...p,fetchStatus:"paused"};case"continue":return{...p,fetchStatus:"fetching"};case"fetch":return{...p,...WA(p.data,this.options),fetchMeta:s.meta??null};case"success":return{...p,data:s.data,dataUpdateCount:p.dataUpdateCount+1,dataUpdatedAt:s.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!s.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const _=s.error;return Kv(_)&&_.revert&&this.#e?{...this.#e,fetchStatus:"idle"}:{...p,error:_,errorUpdateCount:p.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:p.fetchFailureCount+1,fetchFailureReason:_,fetchStatus:"idle",status:"error"};case"invalidate":return{...p,isInvalidated:!0};case"setState":return{...p,...s.state}}};this.state=c(this.state),ca.batch(()=>{this.observers.forEach(p=>{p.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:s})})}};function WA(s,c){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ST(c.networkMode)?"fetching":"paused",...s===void 0&&{error:null,status:"pending"}}}function KA(s){const c=typeof s.initialData=="function"?s.initialData():s.initialData,p=c!==void 0,_=p?typeof s.initialDataUpdatedAt=="function"?s.initialDataUpdatedAt():s.initialDataUpdatedAt:0;return{data:c,dataUpdateCount:0,dataUpdatedAt:p?_??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:p?"success":"pending",fetchStatus:"idle"}}var QA=class extends Y_{constructor(s={}){super(),this.config=s,this.#t=new Map}#t;build(s,c,p){const _=c.queryKey,S=c.queryHash??v0(_,c);let A=this.get(S);return A||(A=new YA({cache:this,queryKey:_,queryHash:S,options:s.defaultQueryOptions(c),state:p,defaultOptions:s.getQueryDefaults(_)}),this.add(A)),A}add(s){this.#t.has(s.queryHash)||(this.#t.set(s.queryHash,s),this.notify({type:"added",query:s}))}remove(s){const c=this.#t.get(s.queryHash);c&&(s.destroy(),c===s&&this.#t.delete(s.queryHash),this.notify({type:"removed",query:s}))}clear(){ca.batch(()=>{this.getAll().forEach(s=>{this.remove(s)})})}get(s){return this.#t.get(s)}getAll(){return[...this.#t.values()]}find(s){const c={exact:!0,...s};return this.getAll().find(p=>i1(c,p))}findAll(s={}){const c=this.getAll();return Object.keys(s).length>0?c.filter(p=>i1(s,p)):c}notify(s){ca.batch(()=>{this.listeners.forEach(c=>{c(s)})})}onFocus(){ca.batch(()=>{this.getAll().forEach(s=>{s.onFocus()})})}onOnline(){ca.batch(()=>{this.getAll().forEach(s=>{s.onOnline()})})}},JA=class extends AT{#t;#e;#n;constructor(s){super(),this.mutationId=s.mutationId,this.#e=s.mutationCache,this.#t=[],this.state=s.state||tM(),this.setOptions(s.options),this.scheduleGc()}setOptions(s){this.options=s,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(s){this.#t.includes(s)||(this.#t.push(s),this.clearGcTimeout(),this.#e.notify({type:"observerAdded",mutation:this,observer:s}))}removeObserver(s){this.#t=this.#t.filter(c=>c!==s),this.scheduleGc(),this.#e.notify({type:"observerRemoved",mutation:this,observer:s})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#e.remove(this))}continue(){return this.#n?.continue()??this.execute(this.state.variables)}async execute(s){this.#n=CT({fn:()=>this.options.mutationFn?this.options.mutationFn(s):Promise.reject(new Error("No mutationFn found")),onFail:(_,S)=>{this.#i({type:"failed",failureCount:_,error:S})},onPause:()=>{this.#i({type:"pause"})},onContinue:()=>{this.#i({type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#e.canRun(this)});const c=this.state.status==="pending",p=!this.#n.canStart();try{if(!c){this.#i({type:"pending",variables:s,isPaused:p}),await this.#e.config.onMutate?.(s,this);const S=await this.options.onMutate?.(s);S!==this.state.context&&this.#i({type:"pending",context:S,variables:s,isPaused:p})}const _=await this.#n.start();return await this.#e.config.onSuccess?.(_,s,this.state.context,this),await this.options.onSuccess?.(_,s,this.state.context),await this.#e.config.onSettled?.(_,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(_,null,s,this.state.context),this.#i({type:"success",data:_}),_}catch(_){try{throw await this.#e.config.onError?.(_,s,this.state.context,this),await this.options.onError?.(_,s,this.state.context),await this.#e.config.onSettled?.(void 0,_,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,_,s,this.state.context),_}finally{this.#i({type:"error",error:_})}}finally{this.#e.runNext(this)}}#i(s){const c=p=>{switch(s.type){case"failed":return{...p,failureCount:s.failureCount,failureReason:s.error};case"pause":return{...p,isPaused:!0};case"continue":return{...p,isPaused:!1};case"pending":return{...p,context:s.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:s.isPaused,status:"pending",variables:s.variables,submittedAt:Date.now()};case"success":return{...p,data:s.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...p,data:void 0,error:s.error,failureCount:p.failureCount+1,failureReason:s.error,isPaused:!1,status:"error"}}};this.state=c(this.state),ca.batch(()=>{this.#t.forEach(p=>{p.onMutationUpdate(s)}),this.#e.notify({mutation:this,type:"updated",action:s})})}};function tM(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var eM=class extends Y_{constructor(s={}){super(),this.config=s,this.#t=new Map,this.#e=Date.now()}#t;#e;build(s,c,p){const _=new JA({mutationCache:this,mutationId:++this.#e,options:s.defaultMutationOptions(c),state:p});return this.add(_),_}add(s){const c=r_(s),p=this.#t.get(c)??[];p.push(s),this.#t.set(c,p),this.notify({type:"added",mutation:s})}remove(s){const c=r_(s);if(this.#t.has(c)){const p=this.#t.get(c)?.filter(_=>_!==s);p&&(p.length===0?this.#t.delete(c):this.#t.set(c,p))}this.notify({type:"removed",mutation:s})}canRun(s){const c=this.#t.get(r_(s))?.find(p=>p.state.status==="pending");return!c||c===s}runNext(s){return this.#t.get(r_(s))?.find(p=>p!==s&&p.state.isPaused)?.continue()??Promise.resolve()}clear(){ca.batch(()=>{this.getAll().forEach(s=>{this.remove(s)})})}getAll(){return[...this.#t.values()].flat()}find(s){const c={exact:!0,...s};return this.getAll().find(p=>r1(c,p))}findAll(s={}){return this.getAll().filter(c=>r1(s,c))}notify(s){ca.batch(()=>{this.listeners.forEach(c=>{c(s)})})}resumePausedMutations(){const s=this.getAll().filter(c=>c.state.isPaused);return ca.batch(()=>Promise.all(s.map(c=>c.continue().catch(Kl))))}};function r_(s){return s.options.scope?.id??String(s.mutationId)}function o1(s){return{onFetch:(c,p)=>{const _=c.options,S=c.fetchOptions?.meta?.fetchMore?.direction,A=c.state.data?.pages||[],T=c.state.data?.pageParams||[];let u={pages:[],pageParams:[]},L=0;const k=async()=>{let B=!1;const H=pt=>{Object.defineProperty(pt,"signal",{enumerable:!0,get:()=>(c.signal.aborted?B=!0:c.signal.addEventListener("abort",()=>{B=!0}),c.signal)})},W=wT(c.options,c.fetchOptions),it=async(pt,rt,J)=>{if(B)return Promise.reject();if(rt==null&&pt.pages.length)return Promise.resolve(pt);const mt={queryKey:c.queryKey,pageParam:rt,direction:J?"backward":"forward",meta:c.options.meta};H(mt);const Et=await W(mt),{maxPages:bt}=c.options,Lt=J?GA:UA;return{pages:Lt(pt.pages,Et,bt),pageParams:Lt(pt.pageParams,rt,bt)}};if(S&&A.length){const pt=S==="backward",rt=pt?nM:l1,J={pages:A,pageParams:T},mt=rt(_,J);u=await it(J,mt,pt)}else{const pt=s??A.length;do{const rt=L===0?T[0]??_.initialPageParam:l1(_,u);if(L>0&&rt==null)break;u=await it(u,rt),L++}while(L<pt)}return u};c.options.persister?c.fetchFn=()=>c.options.persister?.(k,{queryKey:c.queryKey,meta:c.options.meta,signal:c.signal},p):c.fetchFn=k}}}function l1(s,{pages:c,pageParams:p}){const _=c.length-1;return c.length>0?s.getNextPageParam(c[_],c,p[_],p):void 0}function nM(s,{pages:c,pageParams:p}){return c.length>0?s.getPreviousPageParam?.(c[0],c,p[0],p):void 0}var iM=class{#t;#e;#n;#i;#a;#s;#r;#o;constructor(s={}){this.#t=s.queryCache||new QA,this.#e=s.mutationCache||new eM,this.#n=s.defaultOptions||{},this.#i=new Map,this.#a=new Map,this.#s=0}mount(){this.#s++,this.#s===1&&(this.#r=TT.subscribe(async s=>{s&&(await this.resumePausedMutations(),this.#t.onFocus())}),this.#o=I_.subscribe(async s=>{s&&(await this.resumePausedMutations(),this.#t.onOnline())}))}unmount(){this.#s--,this.#s===0&&(this.#r?.(),this.#r=void 0,this.#o?.(),this.#o=void 0)}isFetching(s){return this.#t.findAll({...s,fetchStatus:"fetching"}).length}isMutating(s){return this.#e.findAll({...s,status:"pending"}).length}getQueryData(s){const c=this.defaultQueryOptions({queryKey:s});return this.#t.get(c.queryHash)?.state.data}ensureQueryData(s){const c=this.getQueryData(s.queryKey);if(c===void 0)return this.fetchQuery(s);{const p=this.defaultQueryOptions(s),_=this.#t.build(this,p);return s.revalidateIfStale&&_.isStaleByTime(n1(p.staleTime,_))&&this.prefetchQuery(p),Promise.resolve(c)}}getQueriesData(s){return this.#t.findAll(s).map(({queryKey:c,state:p})=>{const _=p.data;return[c,_]})}setQueryData(s,c,p){const _=this.defaultQueryOptions({queryKey:s}),A=this.#t.get(_.queryHash)?.state.data,T=OA(c,A);if(T!==void 0)return this.#t.build(this,_).setData(T,{...p,manual:!0})}setQueriesData(s,c,p){return ca.batch(()=>this.#t.findAll(s).map(({queryKey:_})=>[_,this.setQueryData(_,c,p)]))}getQueryState(s){const c=this.defaultQueryOptions({queryKey:s});return this.#t.get(c.queryHash)?.state}removeQueries(s){const c=this.#t;ca.batch(()=>{c.findAll(s).forEach(p=>{c.remove(p)})})}resetQueries(s,c){const p=this.#t,_={type:"active",...s};return ca.batch(()=>(p.findAll(s).forEach(S=>{S.reset()}),this.refetchQueries(_,c)))}cancelQueries(s={},c={}){const p={revert:!0,...c},_=ca.batch(()=>this.#t.findAll(s).map(S=>S.cancel(p)));return Promise.all(_).then(Kl).catch(Kl)}invalidateQueries(s={},c={}){return ca.batch(()=>{if(this.#t.findAll(s).forEach(_=>{_.invalidate()}),s.refetchType==="none")return Promise.resolve();const p={...s,type:s.refetchType??s.type??"active"};return this.refetchQueries(p,c)})}refetchQueries(s={},c){const p={...c,cancelRefetch:c?.cancelRefetch??!0},_=ca.batch(()=>this.#t.findAll(s).filter(S=>!S.isDisabled()).map(S=>{let A=S.fetch(void 0,p);return p.throwOnError||(A=A.catch(Kl)),S.state.fetchStatus==="paused"?Promise.resolve():A}));return Promise.all(_).then(Kl)}fetchQuery(s){const c=this.defaultQueryOptions(s);c.retry===void 0&&(c.retry=!1);const p=this.#t.build(this,c);return p.isStaleByTime(n1(c.staleTime,p))?p.fetch(c):Promise.resolve(p.state.data)}prefetchQuery(s){return this.fetchQuery(s).then(Kl).catch(Kl)}fetchInfiniteQuery(s){return s.behavior=o1(s.pages),this.fetchQuery(s)}prefetchInfiniteQuery(s){return this.fetchInfiniteQuery(s).then(Kl).catch(Kl)}ensureInfiniteQueryData(s){return s.behavior=o1(s.pages),this.ensureQueryData(s)}resumePausedMutations(){return I_.isOnline()?this.#e.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#t}getMutationCache(){return this.#e}getDefaultOptions(){return this.#n}setDefaultOptions(s){this.#n=s}setQueryDefaults(s,c){this.#i.set(qg(s),{queryKey:s,defaultOptions:c})}getQueryDefaults(s){const c=[...this.#i.values()];let p={};return c.forEach(_=>{Zg(s,_.queryKey)&&(p={...p,..._.defaultOptions})}),p}setMutationDefaults(s,c){this.#a.set(qg(s),{mutationKey:s,defaultOptions:c})}getMutationDefaults(s){const c=[...this.#a.values()];let p={};return c.forEach(_=>{Zg(s,_.mutationKey)&&(p={...p,..._.defaultOptions})}),p}defaultQueryOptions(s){if(s._defaulted)return s;const c={...this.#n.queries,...this.getQueryDefaults(s.queryKey),...s,_defaulted:!0};return c.queryHash||(c.queryHash=v0(c.queryKey,c)),c.refetchOnReconnect===void 0&&(c.refetchOnReconnect=c.networkMode!=="always"),c.throwOnError===void 0&&(c.throwOnError=!!c.suspense),!c.networkMode&&c.persister&&(c.networkMode="offlineFirst"),c.enabled!==!0&&c.queryFn===x0&&(c.enabled=!1),c}defaultMutationOptions(s){return s?._defaulted?s:{...this.#n.mutations,...s?.mutationKey&&this.getMutationDefaults(s.mutationKey),...s,_defaulted:!0}}clear(){this.#t.clear(),this.#e.clear()}},rM=Z.createContext(void 0),sM=({client:s,children:c})=>(Z.useEffect(()=>(s.mount(),()=>{s.unmount()}),[s]),F.jsx(rM.Provider,{value:s,children:c}));async function aM(s){if(!s.ok){const c=await s.text()||s.statusText;throw new Error(`${s.status}: ${c}`)}}const oM=({on401:s})=>async({queryKey:c})=>{const p=await fetch(c.join("/"),{credentials:"include"});return await aM(p),await p.json()},lM=new iM({defaultOptions:{queries:{queryFn:oM({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),cM=1,uM=1e6;let Qv=0;function hM(){return Qv=(Qv+1)%Number.MAX_SAFE_INTEGER,Qv.toString()}const Jv=new Map,c1=s=>{if(Jv.has(s))return;const c=setTimeout(()=>{Jv.delete(s),Ng({type:"REMOVE_TOAST",toastId:s})},uM);Jv.set(s,c)},dM=(s,c)=>{switch(c.type){case"ADD_TOAST":return{...s,toasts:[c.toast,...s.toasts].slice(0,cM)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(p=>p.id===c.toast.id?{...p,...c.toast}:p)};case"DISMISS_TOAST":{const{toastId:p}=c;return p?c1(p):s.toasts.forEach(_=>{c1(_.id)}),{...s,toasts:s.toasts.map(_=>_.id===p||p===void 0?{..._,open:!1}:_)}}case"REMOVE_TOAST":return c.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(p=>p.id!==c.toastId)}}},x_=[];let b_={toasts:[]};function Ng(s){b_=dM(b_,s),x_.forEach(c=>{c(b_)})}function fM({...s}){const c=hM(),p=S=>Ng({type:"UPDATE_TOAST",toast:{...S,id:c}}),_=()=>Ng({type:"DISMISS_TOAST",toastId:c});return Ng({type:"ADD_TOAST",toast:{...s,id:c,open:!0,onOpenChange:S=>{S||_()}}}),{id:c,dismiss:_,update:p}}function pM(){const[s,c]=Z.useState(b_);return Z.useEffect(()=>(x_.push(c),()=>{const p=x_.indexOf(c);p>-1&&x_.splice(p,1)}),[s]),{...s,toast:fM,dismiss:p=>Ng({type:"DISMISS_TOAST",toastId:p})}}var iy=uT();const MT=m0(iy);function bo(s,c,{checkForDefaultPrevented:p=!0}={}){return function(S){if(s?.(S),p===!1||!S.defaultPrevented)return c?.(S)}}function u1(s,c){if(typeof s=="function")return s(c);s!=null&&(s.current=c)}function ry(...s){return c=>{let p=!1;const _=s.map(S=>{const A=u1(S,c);return!p&&typeof A=="function"&&(p=!0),A});if(p)return()=>{for(let S=0;S<_.length;S++){const A=_[S];typeof A=="function"?A():u1(s[S],null)}}}}function Ui(...s){return Z.useCallback(ry(...s),s)}function mM(s,c){const p=Z.createContext(c),_=A=>{const{children:T,...u}=A,L=Z.useMemo(()=>u,Object.values(u));return F.jsx(p.Provider,{value:L,children:T})};_.displayName=s+"Provider";function S(A){const T=Z.useContext(p);if(T)return T;if(c!==void 0)return c;throw new Error(`\`${A}\` must be used within \`${s}\``)}return[_,S]}function pm(s,c=[]){let p=[];function _(A,T){const u=Z.createContext(T),L=p.length;p=[...p,T];const k=H=>{const{scope:W,children:it,...pt}=H,rt=W?.[s]?.[L]||u,J=Z.useMemo(()=>pt,Object.values(pt));return F.jsx(rt.Provider,{value:J,children:it})};k.displayName=A+"Provider";function B(H,W){const it=W?.[s]?.[L]||u,pt=Z.useContext(it);if(pt)return pt;if(T!==void 0)return T;throw new Error(`\`${H}\` must be used within \`${A}\``)}return[k,B]}const S=()=>{const A=p.map(T=>Z.createContext(T));return function(u){const L=u?.[s]||A;return Z.useMemo(()=>({[`__scope${s}`]:{...u,[s]:L}}),[u,L])}};return S.scopeName=s,[_,gM(S,...c)]}function gM(...s){const c=s[0];if(s.length===1)return c;const p=()=>{const _=s.map(S=>({useScope:S(),scopeName:S.scopeName}));return function(A){const T=_.reduce((u,{useScope:L,scopeName:k})=>{const H=L(A)[`__scope${k}`];return{...u,...H}},{});return Z.useMemo(()=>({[`__scope${c.scopeName}`]:T}),[T])}};return p.scopeName=c.scopeName,p}function Dx(s){const c=yM(s),p=Z.forwardRef((_,S)=>{const{children:A,...T}=_,u=Z.Children.toArray(A),L=u.find(vM);if(L){const k=L.props.children,B=u.map(H=>H===L?Z.Children.count(k)>1?Z.Children.only(null):Z.isValidElement(k)?k.props.children:null:H);return F.jsx(c,{...T,ref:S,children:Z.isValidElement(k)?Z.cloneElement(k,void 0,B):null})}return F.jsx(c,{...T,ref:S,children:A})});return p.displayName=`${s}.Slot`,p}function yM(s){const c=Z.forwardRef((p,_)=>{const{children:S,...A}=p;if(Z.isValidElement(S)){const T=bM(S),u=xM(A,S.props);return S.type!==Z.Fragment&&(u.ref=_?ry(_,T):T),Z.cloneElement(S,u)}return Z.Children.count(S)>1?Z.Children.only(null):null});return c.displayName=`${s}.SlotClone`,c}var _M=Symbol("radix.slottable");function vM(s){return Z.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===_M}function xM(s,c){const p={...c};for(const _ in c){const S=s[_],A=c[_];/^on[A-Z]/.test(_)?S&&A?p[_]=(...u)=>{A(...u),S(...u)}:S&&(p[_]=S):_==="style"?p[_]={...S,...A}:_==="className"&&(p[_]=[S,A].filter(Boolean).join(" "))}return{...s,...p}}function bM(s){let c=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,p=c&&"isReactWarning"in c&&c.isReactWarning;return p?s.ref:(c=Object.getOwnPropertyDescriptor(s,"ref")?.get,p=c&&"isReactWarning"in c&&c.isReactWarning,p?s.props.ref:s.props.ref||s.ref)}function wM(s){const c=s+"CollectionProvider",[p,_]=pm(c),[S,A]=p(c,{collectionRef:{current:null},itemMap:new Map}),T=rt=>{const{scope:J,children:mt}=rt,Et=dd.useRef(null),bt=dd.useRef(new Map).current;return F.jsx(S,{scope:J,itemMap:bt,collectionRef:Et,children:mt})};T.displayName=c;const u=s+"CollectionSlot",L=Dx(u),k=dd.forwardRef((rt,J)=>{const{scope:mt,children:Et}=rt,bt=A(u,mt),Lt=Ui(J,bt.collectionRef);return F.jsx(L,{ref:Lt,children:Et})});k.displayName=u;const B=s+"CollectionItemSlot",H="data-radix-collection-item",W=Dx(B),it=dd.forwardRef((rt,J)=>{const{scope:mt,children:Et,...bt}=rt,Lt=dd.useRef(null),Ot=Ui(J,Lt),ee=A(B,mt);return dd.useEffect(()=>(ee.itemMap.set(Lt,{ref:Lt,...bt}),()=>void ee.itemMap.delete(Lt))),F.jsx(W,{[H]:"",ref:Ot,children:Et})});it.displayName=B;function pt(rt){const J=A(s+"CollectionConsumer",rt);return dd.useCallback(()=>{const Et=J.collectionRef.current;if(!Et)return[];const bt=Array.from(Et.querySelectorAll(`[${H}]`));return Array.from(J.itemMap.values()).sort((ee,Nt)=>bt.indexOf(ee.ref.current)-bt.indexOf(Nt.ref.current))},[J.collectionRef,J.itemMap])}return[{Provider:T,Slot:k,ItemSlot:it},pt,_]}var TM=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Qc=TM.reduce((s,c)=>{const p=Dx(`Primitive.${c}`),_=Z.forwardRef((S,A)=>{const{asChild:T,...u}=S,L=T?p:c;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),F.jsx(L,{...u,ref:A})});return _.displayName=`Primitive.${c}`,{...s,[c]:_}},{});function PT(s,c){s&&iy.flushSync(()=>s.dispatchEvent(c))}function cr(s){const c=Z.useRef(s);return Z.useEffect(()=>{c.current=s}),Z.useMemo(()=>(...p)=>c.current?.(...p),[])}function DT(s,c=globalThis?.document){const p=cr(s);Z.useEffect(()=>{const _=S=>{S.key==="Escape"&&p(S)};return c.addEventListener("keydown",_,{capture:!0}),()=>c.removeEventListener("keydown",_,{capture:!0})},[p,c])}var SM="DismissableLayer",Rx="dismissableLayer.update",EM="dismissableLayer.pointerDownOutside",CM="dismissableLayer.focusOutside",h1,RT=Z.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),IT=Z.forwardRef((s,c)=>{const{disableOutsidePointerEvents:p=!1,onEscapeKeyDown:_,onPointerDownOutside:S,onFocusOutside:A,onInteractOutside:T,onDismiss:u,...L}=s,k=Z.useContext(RT),[B,H]=Z.useState(null),W=B?.ownerDocument??globalThis?.document,[,it]=Z.useState({}),pt=Ui(c,Nt=>H(Nt)),rt=Array.from(k.layers),[J]=[...k.layersWithOutsidePointerEventsDisabled].slice(-1),mt=rt.indexOf(J),Et=B?rt.indexOf(B):-1,bt=k.layersWithOutsidePointerEventsDisabled.size>0,Lt=Et>=mt,Ot=MM(Nt=>{const Kt=Nt.target,xe=[...k.branches].some(Ae=>Ae.contains(Kt));!Lt||xe||(S?.(Nt),T?.(Nt),Nt.defaultPrevented||u?.())},W),ee=PM(Nt=>{const Kt=Nt.target;[...k.branches].some(Ae=>Ae.contains(Kt))||(A?.(Nt),T?.(Nt),Nt.defaultPrevented||u?.())},W);return DT(Nt=>{Et===k.layers.size-1&&(_?.(Nt),!Nt.defaultPrevented&&u&&(Nt.preventDefault(),u()))},W),Z.useEffect(()=>{if(B)return p&&(k.layersWithOutsidePointerEventsDisabled.size===0&&(h1=W.body.style.pointerEvents,W.body.style.pointerEvents="none"),k.layersWithOutsidePointerEventsDisabled.add(B)),k.layers.add(B),d1(),()=>{p&&k.layersWithOutsidePointerEventsDisabled.size===1&&(W.body.style.pointerEvents=h1)}},[B,W,p,k]),Z.useEffect(()=>()=>{B&&(k.layers.delete(B),k.layersWithOutsidePointerEventsDisabled.delete(B),d1())},[B,k]),Z.useEffect(()=>{const Nt=()=>it({});return document.addEventListener(Rx,Nt),()=>document.removeEventListener(Rx,Nt)},[]),F.jsx(Qc.div,{...L,ref:pt,style:{pointerEvents:bt?Lt?"auto":"none":void 0,...s.style},onFocusCapture:bo(s.onFocusCapture,ee.onFocusCapture),onBlurCapture:bo(s.onBlurCapture,ee.onBlurCapture),onPointerDownCapture:bo(s.onPointerDownCapture,Ot.onPointerDownCapture)})});IT.displayName=SM;var AM="DismissableLayerBranch",zT=Z.forwardRef((s,c)=>{const p=Z.useContext(RT),_=Z.useRef(null),S=Ui(c,_);return Z.useEffect(()=>{const A=_.current;if(A)return p.branches.add(A),()=>{p.branches.delete(A)}},[p.branches]),F.jsx(Qc.div,{...s,ref:S})});zT.displayName=AM;function MM(s,c=globalThis?.document){const p=cr(s),_=Z.useRef(!1),S=Z.useRef(()=>{});return Z.useEffect(()=>{const A=u=>{if(u.target&&!_.current){let L=function(){LT(EM,p,k,{discrete:!0})};const k={originalEvent:u};u.pointerType==="touch"?(c.removeEventListener("click",S.current),S.current=L,c.addEventListener("click",S.current,{once:!0})):L()}else c.removeEventListener("click",S.current);_.current=!1},T=window.setTimeout(()=>{c.addEventListener("pointerdown",A)},0);return()=>{window.clearTimeout(T),c.removeEventListener("pointerdown",A),c.removeEventListener("click",S.current)}},[c,p]),{onPointerDownCapture:()=>_.current=!0}}function PM(s,c=globalThis?.document){const p=cr(s),_=Z.useRef(!1);return Z.useEffect(()=>{const S=A=>{A.target&&!_.current&&LT(CM,p,{originalEvent:A},{discrete:!1})};return c.addEventListener("focusin",S),()=>c.removeEventListener("focusin",S)},[c,p]),{onFocusCapture:()=>_.current=!0,onBlurCapture:()=>_.current=!1}}function d1(){const s=new CustomEvent(Rx);document.dispatchEvent(s)}function LT(s,c,p,{discrete:_}){const S=p.originalEvent.target,A=new CustomEvent(s,{bubbles:!1,cancelable:!0,detail:p});c&&S.addEventListener(s,c,{once:!0}),_?PT(S,A):S.dispatchEvent(A)}var DM=IT,RM=zT,Bs=globalThis?.document?Z.useLayoutEffect:()=>{},IM="Portal",kT=Z.forwardRef((s,c)=>{const{container:p,..._}=s,[S,A]=Z.useState(!1);Bs(()=>A(!0),[]);const T=p||S&&globalThis?.document?.body;return T?MT.createPortal(F.jsx(Qc.div,{..._,ref:c}),T):null});kT.displayName=IM;function zM(s,c){return Z.useReducer((p,_)=>c[p][_]??p,s)}var OT=s=>{const{present:c,children:p}=s,_=LM(c),S=typeof p=="function"?p({present:_.isPresent}):Z.Children.only(p),A=Ui(_.ref,kM(S));return typeof p=="function"||_.isPresent?Z.cloneElement(S,{ref:A}):null};OT.displayName="Presence";function LM(s){const[c,p]=Z.useState(),_=Z.useRef({}),S=Z.useRef(s),A=Z.useRef("none"),T=s?"mounted":"unmounted",[u,L]=zM(T,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return Z.useEffect(()=>{const k=s_(_.current);A.current=u==="mounted"?k:"none"},[u]),Bs(()=>{const k=_.current,B=S.current;if(B!==s){const W=A.current,it=s_(k);s?L("MOUNT"):it==="none"||k?.display==="none"?L("UNMOUNT"):L(B&&W!==it?"ANIMATION_OUT":"UNMOUNT"),S.current=s}},[s,L]),Bs(()=>{if(c){let k;const B=c.ownerDocument.defaultView??window,H=it=>{const rt=s_(_.current).includes(it.animationName);if(it.target===c&&rt&&(L("ANIMATION_END"),!S.current)){const J=c.style.animationFillMode;c.style.animationFillMode="forwards",k=B.setTimeout(()=>{c.style.animationFillMode==="forwards"&&(c.style.animationFillMode=J)})}},W=it=>{it.target===c&&(A.current=s_(_.current))};return c.addEventListener("animationstart",W),c.addEventListener("animationcancel",H),c.addEventListener("animationend",H),()=>{B.clearTimeout(k),c.removeEventListener("animationstart",W),c.removeEventListener("animationcancel",H),c.removeEventListener("animationend",H)}}else L("ANIMATION_END")},[c,L]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:Z.useCallback(k=>{k&&(_.current=getComputedStyle(k)),p(k)},[])}}function s_(s){return s?.animationName||"none"}function kM(s){let c=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,p=c&&"isReactWarning"in c&&c.isReactWarning;return p?s.ref:(c=Object.getOwnPropertyDescriptor(s,"ref")?.get,p=c&&"isReactWarning"in c&&c.isReactWarning,p?s.props.ref:s.props.ref||s.ref)}function OM({prop:s,defaultProp:c,onChange:p=()=>{}}){const[_,S]=NM({defaultProp:c,onChange:p}),A=s!==void 0,T=A?s:_,u=cr(p),L=Z.useCallback(k=>{if(A){const H=typeof k=="function"?k(s):k;H!==s&&u(H)}else S(k)},[A,s,S,u]);return[T,L]}function NM({defaultProp:s,onChange:c}){const p=Z.useState(s),[_]=p,S=Z.useRef(_),A=cr(c);return Z.useEffect(()=>{S.current!==_&&(A(_),S.current=_)},[_,S,A]),p}var FM="VisuallyHidden",b0=Z.forwardRef((s,c)=>F.jsx(Qc.span,{...s,ref:c,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...s.style}}));b0.displayName=FM;var w0="ToastProvider",[T0,jM,BM]=wM("Toast"),[NT]=pm("Toast",[BM]),[VM,K_]=NT(w0),FT=s=>{const{__scopeToast:c,label:p="Notification",duration:_=5e3,swipeDirection:S="right",swipeThreshold:A=50,children:T}=s,[u,L]=Z.useState(null),[k,B]=Z.useState(0),H=Z.useRef(!1),W=Z.useRef(!1);return p.trim()||console.error(`Invalid prop \`label\` supplied to \`${w0}\`. Expected non-empty \`string\`.`),F.jsx(T0.Provider,{scope:c,children:F.jsx(VM,{scope:c,label:p,duration:_,swipeDirection:S,swipeThreshold:A,toastCount:k,viewport:u,onViewportChange:L,onToastAdd:Z.useCallback(()=>B(it=>it+1),[]),onToastRemove:Z.useCallback(()=>B(it=>it-1),[]),isFocusedToastEscapeKeyDownRef:H,isClosePausedRef:W,children:T})})};FT.displayName=w0;var jT="ToastViewport",UM=["F8"],Ix="toast.viewportPause",zx="toast.viewportResume",BT=Z.forwardRef((s,c)=>{const{__scopeToast:p,hotkey:_=UM,label:S="Notifications ({hotkey})",...A}=s,T=K_(jT,p),u=jM(p),L=Z.useRef(null),k=Z.useRef(null),B=Z.useRef(null),H=Z.useRef(null),W=Ui(c,H,T.onViewportChange),it=_.join("+").replace(/Key/g,"").replace(/Digit/g,""),pt=T.toastCount>0;Z.useEffect(()=>{const J=mt=>{_.length!==0&&_.every(bt=>mt[bt]||mt.code===bt)&&H.current?.focus()};return document.addEventListener("keydown",J),()=>document.removeEventListener("keydown",J)},[_]),Z.useEffect(()=>{const J=L.current,mt=H.current;if(pt&&J&&mt){const Et=()=>{if(!T.isClosePausedRef.current){const ee=new CustomEvent(Ix);mt.dispatchEvent(ee),T.isClosePausedRef.current=!0}},bt=()=>{if(T.isClosePausedRef.current){const ee=new CustomEvent(zx);mt.dispatchEvent(ee),T.isClosePausedRef.current=!1}},Lt=ee=>{!J.contains(ee.relatedTarget)&&bt()},Ot=()=>{J.contains(document.activeElement)||bt()};return J.addEventListener("focusin",Et),J.addEventListener("focusout",Lt),J.addEventListener("pointermove",Et),J.addEventListener("pointerleave",Ot),window.addEventListener("blur",Et),window.addEventListener("focus",bt),()=>{J.removeEventListener("focusin",Et),J.removeEventListener("focusout",Lt),J.removeEventListener("pointermove",Et),J.removeEventListener("pointerleave",Ot),window.removeEventListener("blur",Et),window.removeEventListener("focus",bt)}}},[pt,T.isClosePausedRef]);const rt=Z.useCallback(({tabbingDirection:J})=>{const Et=u().map(bt=>{const Lt=bt.ref.current,Ot=[Lt,...eP(Lt)];return J==="forwards"?Ot:Ot.reverse()});return(J==="forwards"?Et.reverse():Et).flat()},[u]);return Z.useEffect(()=>{const J=H.current;if(J){const mt=Et=>{const bt=Et.altKey||Et.ctrlKey||Et.metaKey;if(Et.key==="Tab"&&!bt){const Ot=document.activeElement,ee=Et.shiftKey;if(Et.target===J&&ee){k.current?.focus();return}const xe=rt({tabbingDirection:ee?"backwards":"forwards"}),Ae=xe.findIndex(ae=>ae===Ot);tx(xe.slice(Ae+1))?Et.preventDefault():ee?k.current?.focus():B.current?.focus()}};return J.addEventListener("keydown",mt),()=>J.removeEventListener("keydown",mt)}},[u,rt]),F.jsxs(RM,{ref:L,role:"region","aria-label":S.replace("{hotkey}",it),tabIndex:-1,style:{pointerEvents:pt?void 0:"none"},children:[pt&&F.jsx(Lx,{ref:k,onFocusFromOutsideViewport:()=>{const J=rt({tabbingDirection:"forwards"});tx(J)}}),F.jsx(T0.Slot,{scope:p,children:F.jsx(Qc.ol,{tabIndex:-1,...A,ref:W})}),pt&&F.jsx(Lx,{ref:B,onFocusFromOutsideViewport:()=>{const J=rt({tabbingDirection:"backwards"});tx(J)}})]})});BT.displayName=jT;var VT="ToastFocusProxy",Lx=Z.forwardRef((s,c)=>{const{__scopeToast:p,onFocusFromOutsideViewport:_,...S}=s,A=K_(VT,p);return F.jsx(b0,{"aria-hidden":!0,tabIndex:0,...S,ref:c,style:{position:"fixed"},onFocus:T=>{const u=T.relatedTarget;!A.viewport?.contains(u)&&_()}})});Lx.displayName=VT;var Q_="Toast",GM="toast.swipeStart",qM="toast.swipeMove",ZM="toast.swipeCancel",$M="toast.swipeEnd",UT=Z.forwardRef((s,c)=>{const{forceMount:p,open:_,defaultOpen:S,onOpenChange:A,...T}=s,[u=!0,L]=OM({prop:_,defaultProp:S,onChange:A});return F.jsx(OT,{present:p||u,children:F.jsx(YM,{open:u,...T,ref:c,onClose:()=>L(!1),onPause:cr(s.onPause),onResume:cr(s.onResume),onSwipeStart:bo(s.onSwipeStart,k=>{k.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:bo(s.onSwipeMove,k=>{const{x:B,y:H}=k.detail.delta;k.currentTarget.setAttribute("data-swipe","move"),k.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${B}px`),k.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${H}px`)}),onSwipeCancel:bo(s.onSwipeCancel,k=>{k.currentTarget.setAttribute("data-swipe","cancel"),k.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),k.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),k.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),k.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:bo(s.onSwipeEnd,k=>{const{x:B,y:H}=k.detail.delta;k.currentTarget.setAttribute("data-swipe","end"),k.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),k.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),k.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${B}px`),k.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${H}px`),L(!1)})})})});UT.displayName=Q_;var[HM,XM]=NT(Q_,{onClose(){}}),YM=Z.forwardRef((s,c)=>{const{__scopeToast:p,type:_="foreground",duration:S,open:A,onClose:T,onEscapeKeyDown:u,onPause:L,onResume:k,onSwipeStart:B,onSwipeMove:H,onSwipeCancel:W,onSwipeEnd:it,...pt}=s,rt=K_(Q_,p),[J,mt]=Z.useState(null),Et=Ui(c,Ee=>mt(Ee)),bt=Z.useRef(null),Lt=Z.useRef(null),Ot=S||rt.duration,ee=Z.useRef(0),Nt=Z.useRef(Ot),Kt=Z.useRef(0),{onToastAdd:xe,onToastRemove:Ae}=rt,ae=cr(()=>{J?.contains(document.activeElement)&&rt.viewport?.focus(),T()}),ze=Z.useCallback(Ee=>{!Ee||Ee===1/0||(window.clearTimeout(Kt.current),ee.current=new Date().getTime(),Kt.current=window.setTimeout(ae,Ee))},[ae]);Z.useEffect(()=>{const Ee=rt.viewport;if(Ee){const me=()=>{ze(Nt.current),k?.()},jt=()=>{const Qt=new Date().getTime()-ee.current;Nt.current=Nt.current-Qt,window.clearTimeout(Kt.current),L?.()};return Ee.addEventListener(Ix,jt),Ee.addEventListener(zx,me),()=>{Ee.removeEventListener(Ix,jt),Ee.removeEventListener(zx,me)}}},[rt.viewport,Ot,L,k,ze]),Z.useEffect(()=>{A&&!rt.isClosePausedRef.current&&ze(Ot)},[A,Ot,rt.isClosePausedRef,ze]),Z.useEffect(()=>(xe(),()=>Ae()),[xe,Ae]);const We=Z.useMemo(()=>J?YT(J):null,[J]);return rt.viewport?F.jsxs(F.Fragment,{children:[We&&F.jsx(WM,{__scopeToast:p,role:"status","aria-live":_==="foreground"?"assertive":"polite","aria-atomic":!0,children:We}),F.jsx(HM,{scope:p,onClose:ae,children:iy.createPortal(F.jsx(T0.ItemSlot,{scope:p,children:F.jsx(DM,{asChild:!0,onEscapeKeyDown:bo(u,()=>{rt.isFocusedToastEscapeKeyDownRef.current||ae(),rt.isFocusedToastEscapeKeyDownRef.current=!1}),children:F.jsx(Qc.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":A?"open":"closed","data-swipe-direction":rt.swipeDirection,...pt,ref:Et,style:{userSelect:"none",touchAction:"none",...s.style},onKeyDown:bo(s.onKeyDown,Ee=>{Ee.key==="Escape"&&(u?.(Ee.nativeEvent),Ee.nativeEvent.defaultPrevented||(rt.isFocusedToastEscapeKeyDownRef.current=!0,ae()))}),onPointerDown:bo(s.onPointerDown,Ee=>{Ee.button===0&&(bt.current={x:Ee.clientX,y:Ee.clientY})}),onPointerMove:bo(s.onPointerMove,Ee=>{if(!bt.current)return;const me=Ee.clientX-bt.current.x,jt=Ee.clientY-bt.current.y,Qt=!!Lt.current,Gt=["left","right"].includes(rt.swipeDirection),we=["left","up"].includes(rt.swipeDirection)?Math.min:Math.max,He=Gt?we(0,me):0,Rt=Gt?0:we(0,jt),se=Ee.pointerType==="touch"?10:2,be={x:He,y:Rt},Te={originalEvent:Ee,delta:be};Qt?(Lt.current=be,a_(qM,H,Te,{discrete:!1})):f1(be,rt.swipeDirection,se)?(Lt.current=be,a_(GM,B,Te,{discrete:!1}),Ee.target.setPointerCapture(Ee.pointerId)):(Math.abs(me)>se||Math.abs(jt)>se)&&(bt.current=null)}),onPointerUp:bo(s.onPointerUp,Ee=>{const me=Lt.current,jt=Ee.target;if(jt.hasPointerCapture(Ee.pointerId)&&jt.releasePointerCapture(Ee.pointerId),Lt.current=null,bt.current=null,me){const Qt=Ee.currentTarget,Gt={originalEvent:Ee,delta:me};f1(me,rt.swipeDirection,rt.swipeThreshold)?a_($M,it,Gt,{discrete:!0}):a_(ZM,W,Gt,{discrete:!0}),Qt.addEventListener("click",we=>we.preventDefault(),{once:!0})}})})})}),rt.viewport)})]}):null}),WM=s=>{const{__scopeToast:c,children:p,..._}=s,S=K_(Q_,c),[A,T]=Z.useState(!1),[u,L]=Z.useState(!1);return JM(()=>T(!0)),Z.useEffect(()=>{const k=window.setTimeout(()=>L(!0),1e3);return()=>window.clearTimeout(k)},[]),u?null:F.jsx(kT,{asChild:!0,children:F.jsx(b0,{..._,children:A&&F.jsxs(F.Fragment,{children:[S.label," ",p]})})})},KM="ToastTitle",GT=Z.forwardRef((s,c)=>{const{__scopeToast:p,..._}=s;return F.jsx(Qc.div,{..._,ref:c})});GT.displayName=KM;var QM="ToastDescription",qT=Z.forwardRef((s,c)=>{const{__scopeToast:p,..._}=s;return F.jsx(Qc.div,{..._,ref:c})});qT.displayName=QM;var ZT="ToastAction",$T=Z.forwardRef((s,c)=>{const{altText:p,..._}=s;return p.trim()?F.jsx(XT,{altText:p,asChild:!0,children:F.jsx(S0,{..._,ref:c})}):(console.error(`Invalid prop \`altText\` supplied to \`${ZT}\`. Expected non-empty \`string\`.`),null)});$T.displayName=ZT;var HT="ToastClose",S0=Z.forwardRef((s,c)=>{const{__scopeToast:p,..._}=s,S=XM(HT,p);return F.jsx(XT,{asChild:!0,children:F.jsx(Qc.button,{type:"button",..._,ref:c,onClick:bo(s.onClick,S.onClose)})})});S0.displayName=HT;var XT=Z.forwardRef((s,c)=>{const{__scopeToast:p,altText:_,...S}=s;return F.jsx(Qc.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":_||void 0,...S,ref:c})});function YT(s){const c=[];return Array.from(s.childNodes).forEach(_=>{if(_.nodeType===_.TEXT_NODE&&_.textContent&&c.push(_.textContent),tP(_)){const S=_.ariaHidden||_.hidden||_.style.display==="none",A=_.dataset.radixToastAnnounceExclude==="";if(!S)if(A){const T=_.dataset.radixToastAnnounceAlt;T&&c.push(T)}else c.push(...YT(_))}}),c}function a_(s,c,p,{discrete:_}){const S=p.originalEvent.currentTarget,A=new CustomEvent(s,{bubbles:!0,cancelable:!0,detail:p});c&&S.addEventListener(s,c,{once:!0}),_?PT(S,A):S.dispatchEvent(A)}var f1=(s,c,p=0)=>{const _=Math.abs(s.x),S=Math.abs(s.y),A=_>S;return c==="left"||c==="right"?A&&_>p:!A&&S>p};function JM(s=()=>{}){const c=cr(s);Bs(()=>{let p=0,_=0;return p=window.requestAnimationFrame(()=>_=window.requestAnimationFrame(c)),()=>{window.cancelAnimationFrame(p),window.cancelAnimationFrame(_)}},[c])}function tP(s){return s.nodeType===s.ELEMENT_NODE}function eP(s){const c=[],p=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:_=>{const S=_.tagName==="INPUT"&&_.type==="hidden";return _.disabled||_.hidden||S?NodeFilter.FILTER_SKIP:_.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;p.nextNode();)c.push(p.currentNode);return c}function tx(s){const c=document.activeElement;return s.some(p=>p===c?!0:(p.focus(),document.activeElement!==c))}var nP=FT,WT=BT,KT=UT,QT=GT,JT=qT,t2=$T,e2=S0;function n2(s){var c,p,_="";if(typeof s=="string"||typeof s=="number")_+=s;else if(typeof s=="object")if(Array.isArray(s)){var S=s.length;for(c=0;c<S;c++)s[c]&&(p=n2(s[c]))&&(_&&(_+=" "),_+=p)}else for(p in s)s[p]&&(_&&(_+=" "),_+=p);return _}function i2(){for(var s,c,p=0,_="",S=arguments.length;p<S;p++)(s=arguments[p])&&(c=n2(s))&&(_&&(_+=" "),_+=c);return _}const p1=s=>typeof s=="boolean"?`${s}`:s===0?"0":s,m1=i2,sy=(s,c)=>p=>{var _;if(c?.variants==null)return m1(s,p?.class,p?.className);const{variants:S,defaultVariants:A}=c,T=Object.keys(S).map(k=>{const B=p?.[k],H=A?.[k];if(B===null)return null;const W=p1(B)||p1(H);return S[k][W]}),u=p&&Object.entries(p).reduce((k,B)=>{let[H,W]=B;return W===void 0||(k[H]=W),k},{}),L=c==null||(_=c.compoundVariants)===null||_===void 0?void 0:_.reduce((k,B)=>{let{class:H,className:W,...it}=B;return Object.entries(it).every(pt=>{let[rt,J]=pt;return Array.isArray(J)?J.includes({...A,...u}[rt]):{...A,...u}[rt]===J})?[...k,H,W]:k},[]);return m1(s,T,L,p?.class,p?.className)};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iP=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),rP=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(c,p,_)=>_?_.toUpperCase():p.toLowerCase()),g1=s=>{const c=rP(s);return c.charAt(0).toUpperCase()+c.slice(1)},r2=(...s)=>s.filter((c,p,_)=>!!c&&c.trim()!==""&&_.indexOf(c)===p).join(" ").trim(),sP=s=>{for(const c in s)if(c.startsWith("aria-")||c==="role"||c==="title")return!0};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var aP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oP=Z.forwardRef(({color:s="currentColor",size:c=24,strokeWidth:p=2,absoluteStrokeWidth:_,className:S="",children:A,iconNode:T,...u},L)=>Z.createElement("svg",{ref:L,...aP,width:c,height:c,stroke:s,strokeWidth:_?Number(p)*24/Number(c):p,className:r2("lucide",S),...!A&&!sP(u)&&{"aria-hidden":"true"},...u},[...T.map(([k,B])=>Z.createElement(k,B)),...Array.isArray(A)?A:[A]]));/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=(s,c)=>{const p=Z.forwardRef(({className:_,...S},A)=>Z.createElement(oP,{ref:A,iconNode:c,className:r2(`lucide-${iP(g1(s))}`,`lucide-${s}`,_),...S}));return p.displayName=g1(s),p};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lP=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],cP=Zr("arrow-left",lP);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uP=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],E0=Zr("arrow-right",uP);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hP=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],dP=Zr("bell",hP);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fP=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],pP=Zr("briefcase",fP);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],s2=Zr("circle-alert",mP);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],yP=Zr("globe",gP);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _P=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],C0=Zr("heart",_P);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vP=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],xP=Zr("list",vP);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bP=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],a2=Zr("loader",bP);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wP=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],TP=Zr("log-out",wP);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SP=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],lm=Zr("map-pin",SP);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EP=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],kx=Zr("pen",EP);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CP=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],AP=Zr("phone",CP);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MP=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],o2=Zr("plus",MP);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PP=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],l2=Zr("search",PP);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DP=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],$g=Zr("sparkles",DP);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RP=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Ox=Zr("star",RP);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IP=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],J_=Zr("users",IP);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zP=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],mm=Zr("x",zP),A0="-",LP=s=>{const c=OP(s),{conflictingClassGroups:p,conflictingClassGroupModifiers:_}=s;return{getClassGroupId:T=>{const u=T.split(A0);return u[0]===""&&u.length!==1&&u.shift(),c2(u,c)||kP(T)},getConflictingClassGroupIds:(T,u)=>{const L=p[T]||[];return u&&_[T]?[...L,..._[T]]:L}}},c2=(s,c)=>{if(s.length===0)return c.classGroupId;const p=s[0],_=c.nextPart.get(p),S=_?c2(s.slice(1),_):void 0;if(S)return S;if(c.validators.length===0)return;const A=s.join(A0);return c.validators.find(({validator:T})=>T(A))?.classGroupId},y1=/^\[(.+)\]$/,kP=s=>{if(y1.test(s)){const c=y1.exec(s)[1],p=c?.substring(0,c.indexOf(":"));if(p)return"arbitrary.."+p}},OP=s=>{const{theme:c,classGroups:p}=s,_={nextPart:new Map,validators:[]};for(const S in p)Nx(p[S],_,S,c);return _},Nx=(s,c,p,_)=>{s.forEach(S=>{if(typeof S=="string"){const A=S===""?c:_1(c,S);A.classGroupId=p;return}if(typeof S=="function"){if(NP(S)){Nx(S(_),c,p,_);return}c.validators.push({validator:S,classGroupId:p});return}Object.entries(S).forEach(([A,T])=>{Nx(T,_1(c,A),p,_)})})},_1=(s,c)=>{let p=s;return c.split(A0).forEach(_=>{p.nextPart.has(_)||p.nextPart.set(_,{nextPart:new Map,validators:[]}),p=p.nextPart.get(_)}),p},NP=s=>s.isThemeGetter,FP=s=>{if(s<1)return{get:()=>{},set:()=>{}};let c=0,p=new Map,_=new Map;const S=(A,T)=>{p.set(A,T),c++,c>s&&(c=0,_=p,p=new Map)};return{get(A){let T=p.get(A);if(T!==void 0)return T;if((T=_.get(A))!==void 0)return S(A,T),T},set(A,T){p.has(A)?p.set(A,T):S(A,T)}}},Fx="!",jx=":",jP=jx.length,BP=s=>{const{prefix:c,experimentalParseClassName:p}=s;let _=S=>{const A=[];let T=0,u=0,L=0,k;for(let pt=0;pt<S.length;pt++){let rt=S[pt];if(T===0&&u===0){if(rt===jx){A.push(S.slice(L,pt)),L=pt+jP;continue}if(rt==="/"){k=pt;continue}}rt==="["?T++:rt==="]"?T--:rt==="("?u++:rt===")"&&u--}const B=A.length===0?S:S.substring(L),H=VP(B),W=H!==B,it=k&&k>L?k-L:void 0;return{modifiers:A,hasImportantModifier:W,baseClassName:H,maybePostfixModifierPosition:it}};if(c){const S=c+jx,A=_;_=T=>T.startsWith(S)?A(T.substring(S.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:T,maybePostfixModifierPosition:void 0}}if(p){const S=_;_=A=>p({className:A,parseClassName:S})}return _},VP=s=>s.endsWith(Fx)?s.substring(0,s.length-1):s.startsWith(Fx)?s.substring(1):s,UP=s=>{const c=Object.fromEntries(s.orderSensitiveModifiers.map(_=>[_,!0]));return _=>{if(_.length<=1)return _;const S=[];let A=[];return _.forEach(T=>{T[0]==="["||c[T]?(S.push(...A.sort(),T),A=[]):A.push(T)}),S.push(...A.sort()),S}},GP=s=>({cache:FP(s.cacheSize),parseClassName:BP(s),sortModifiers:UP(s),...LP(s)}),qP=/\s+/,ZP=(s,c)=>{const{parseClassName:p,getClassGroupId:_,getConflictingClassGroupIds:S,sortModifiers:A}=c,T=[],u=s.trim().split(qP);let L="";for(let k=u.length-1;k>=0;k-=1){const B=u[k],{isExternal:H,modifiers:W,hasImportantModifier:it,baseClassName:pt,maybePostfixModifierPosition:rt}=p(B);if(H){L=B+(L.length>0?" "+L:L);continue}let J=!!rt,mt=_(J?pt.substring(0,rt):pt);if(!mt){if(!J){L=B+(L.length>0?" "+L:L);continue}if(mt=_(pt),!mt){L=B+(L.length>0?" "+L:L);continue}J=!1}const Et=A(W).join(":"),bt=it?Et+Fx:Et,Lt=bt+mt;if(T.includes(Lt))continue;T.push(Lt);const Ot=S(mt,J);for(let ee=0;ee<Ot.length;++ee){const Nt=Ot[ee];T.push(bt+Nt)}L=B+(L.length>0?" "+L:L)}return L};function $P(){let s=0,c,p,_="";for(;s<arguments.length;)(c=arguments[s++])&&(p=u2(c))&&(_&&(_+=" "),_+=p);return _}const u2=s=>{if(typeof s=="string")return s;let c,p="";for(let _=0;_<s.length;_++)s[_]&&(c=u2(s[_]))&&(p&&(p+=" "),p+=c);return p};function HP(s,...c){let p,_,S,A=T;function T(L){const k=c.reduce((B,H)=>H(B),s());return p=GP(k),_=p.cache.get,S=p.cache.set,A=u,u(L)}function u(L){const k=_(L);if(k)return k;const B=ZP(L,p);return S(L,B),B}return function(){return A($P.apply(null,arguments))}}const qr=s=>{const c=p=>p[s]||[];return c.isThemeGetter=!0,c},h2=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,d2=/^\((?:(\w[\w-]*):)?(.+)\)$/i,XP=/^\d+\/\d+$/,YP=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,WP=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,KP=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,QP=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,JP=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Xp=s=>XP.test(s),Sn=s=>!!s&&!Number.isNaN(Number(s)),hd=s=>!!s&&Number.isInteger(Number(s)),ex=s=>s.endsWith("%")&&Sn(s.slice(0,-1)),ih=s=>YP.test(s),tD=()=>!0,eD=s=>WP.test(s)&&!KP.test(s),f2=()=>!1,nD=s=>QP.test(s),iD=s=>JP.test(s),rD=s=>!Ue(s)&&!Ge(s),sD=s=>gm(s,g2,f2),Ue=s=>h2.test(s),Rf=s=>gm(s,y2,eD),nx=s=>gm(s,uD,Sn),v1=s=>gm(s,p2,f2),aD=s=>gm(s,m2,iD),o_=s=>gm(s,_2,nD),Ge=s=>d2.test(s),Lg=s=>ym(s,y2),oD=s=>ym(s,hD),x1=s=>ym(s,p2),lD=s=>ym(s,g2),cD=s=>ym(s,m2),l_=s=>ym(s,_2,!0),gm=(s,c,p)=>{const _=h2.exec(s);return _?_[1]?c(_[1]):p(_[2]):!1},ym=(s,c,p=!1)=>{const _=d2.exec(s);return _?_[1]?c(_[1]):p:!1},p2=s=>s==="position"||s==="percentage",m2=s=>s==="image"||s==="url",g2=s=>s==="length"||s==="size"||s==="bg-size",y2=s=>s==="length",uD=s=>s==="number",hD=s=>s==="family-name",_2=s=>s==="shadow",dD=()=>{const s=qr("color"),c=qr("font"),p=qr("text"),_=qr("font-weight"),S=qr("tracking"),A=qr("leading"),T=qr("breakpoint"),u=qr("container"),L=qr("spacing"),k=qr("radius"),B=qr("shadow"),H=qr("inset-shadow"),W=qr("text-shadow"),it=qr("drop-shadow"),pt=qr("blur"),rt=qr("perspective"),J=qr("aspect"),mt=qr("ease"),Et=qr("animate"),bt=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Lt=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],Ot=()=>[...Lt(),Ge,Ue],ee=()=>["auto","hidden","clip","visible","scroll"],Nt=()=>["auto","contain","none"],Kt=()=>[Ge,Ue,L],xe=()=>[Xp,"full","auto",...Kt()],Ae=()=>[hd,"none","subgrid",Ge,Ue],ae=()=>["auto",{span:["full",hd,Ge,Ue]},hd,Ge,Ue],ze=()=>[hd,"auto",Ge,Ue],We=()=>["auto","min","max","fr",Ge,Ue],Ee=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],me=()=>["start","end","center","stretch","center-safe","end-safe"],jt=()=>["auto",...Kt()],Qt=()=>[Xp,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...Kt()],Gt=()=>[s,Ge,Ue],we=()=>[...Lt(),x1,v1,{position:[Ge,Ue]}],He=()=>["no-repeat",{repeat:["","x","y","space","round"]}],Rt=()=>["auto","cover","contain",lD,sD,{size:[Ge,Ue]}],se=()=>[ex,Lg,Rf],be=()=>["","none","full",k,Ge,Ue],Te=()=>["",Sn,Lg,Rf],Ze=()=>["solid","dashed","dotted","double"],$e=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Le=()=>[Sn,ex,x1,v1],yn=()=>["","none",pt,Ge,Ue],Mn=()=>["none",Sn,Ge,Ue],Gi=()=>["none",Sn,Ge,Ue],br=()=>[Sn,Ge,Ue],Ci=()=>[Xp,"full",...Kt()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[ih],breakpoint:[ih],color:[tD],container:[ih],"drop-shadow":[ih],ease:["in","out","in-out"],font:[rD],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[ih],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[ih],shadow:[ih],spacing:["px",Sn],text:[ih],"text-shadow":[ih],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Xp,Ue,Ge,J]}],container:["container"],columns:[{columns:[Sn,Ue,Ge,u]}],"break-after":[{"break-after":bt()}],"break-before":[{"break-before":bt()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:Ot()}],overflow:[{overflow:ee()}],"overflow-x":[{"overflow-x":ee()}],"overflow-y":[{"overflow-y":ee()}],overscroll:[{overscroll:Nt()}],"overscroll-x":[{"overscroll-x":Nt()}],"overscroll-y":[{"overscroll-y":Nt()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:xe()}],"inset-x":[{"inset-x":xe()}],"inset-y":[{"inset-y":xe()}],start:[{start:xe()}],end:[{end:xe()}],top:[{top:xe()}],right:[{right:xe()}],bottom:[{bottom:xe()}],left:[{left:xe()}],visibility:["visible","invisible","collapse"],z:[{z:[hd,"auto",Ge,Ue]}],basis:[{basis:[Xp,"full","auto",u,...Kt()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Sn,Xp,"auto","initial","none",Ue]}],grow:[{grow:["",Sn,Ge,Ue]}],shrink:[{shrink:["",Sn,Ge,Ue]}],order:[{order:[hd,"first","last","none",Ge,Ue]}],"grid-cols":[{"grid-cols":Ae()}],"col-start-end":[{col:ae()}],"col-start":[{"col-start":ze()}],"col-end":[{"col-end":ze()}],"grid-rows":[{"grid-rows":Ae()}],"row-start-end":[{row:ae()}],"row-start":[{"row-start":ze()}],"row-end":[{"row-end":ze()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":We()}],"auto-rows":[{"auto-rows":We()}],gap:[{gap:Kt()}],"gap-x":[{"gap-x":Kt()}],"gap-y":[{"gap-y":Kt()}],"justify-content":[{justify:[...Ee(),"normal"]}],"justify-items":[{"justify-items":[...me(),"normal"]}],"justify-self":[{"justify-self":["auto",...me()]}],"align-content":[{content:["normal",...Ee()]}],"align-items":[{items:[...me(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...me(),{baseline:["","last"]}]}],"place-content":[{"place-content":Ee()}],"place-items":[{"place-items":[...me(),"baseline"]}],"place-self":[{"place-self":["auto",...me()]}],p:[{p:Kt()}],px:[{px:Kt()}],py:[{py:Kt()}],ps:[{ps:Kt()}],pe:[{pe:Kt()}],pt:[{pt:Kt()}],pr:[{pr:Kt()}],pb:[{pb:Kt()}],pl:[{pl:Kt()}],m:[{m:jt()}],mx:[{mx:jt()}],my:[{my:jt()}],ms:[{ms:jt()}],me:[{me:jt()}],mt:[{mt:jt()}],mr:[{mr:jt()}],mb:[{mb:jt()}],ml:[{ml:jt()}],"space-x":[{"space-x":Kt()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":Kt()}],"space-y-reverse":["space-y-reverse"],size:[{size:Qt()}],w:[{w:[u,"screen",...Qt()]}],"min-w":[{"min-w":[u,"screen","none",...Qt()]}],"max-w":[{"max-w":[u,"screen","none","prose",{screen:[T]},...Qt()]}],h:[{h:["screen","lh",...Qt()]}],"min-h":[{"min-h":["screen","lh","none",...Qt()]}],"max-h":[{"max-h":["screen","lh",...Qt()]}],"font-size":[{text:["base",p,Lg,Rf]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[_,Ge,nx]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",ex,Ue]}],"font-family":[{font:[oD,Ue,c]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[S,Ge,Ue]}],"line-clamp":[{"line-clamp":[Sn,"none",Ge,nx]}],leading:[{leading:[A,...Kt()]}],"list-image":[{"list-image":["none",Ge,Ue]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Ge,Ue]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:Gt()}],"text-color":[{text:Gt()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Ze(),"wavy"]}],"text-decoration-thickness":[{decoration:[Sn,"from-font","auto",Ge,Rf]}],"text-decoration-color":[{decoration:Gt()}],"underline-offset":[{"underline-offset":[Sn,"auto",Ge,Ue]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:Kt()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ge,Ue]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ge,Ue]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:we()}],"bg-repeat":[{bg:He()}],"bg-size":[{bg:Rt()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},hd,Ge,Ue],radial:["",Ge,Ue],conic:[hd,Ge,Ue]},cD,aD]}],"bg-color":[{bg:Gt()}],"gradient-from-pos":[{from:se()}],"gradient-via-pos":[{via:se()}],"gradient-to-pos":[{to:se()}],"gradient-from":[{from:Gt()}],"gradient-via":[{via:Gt()}],"gradient-to":[{to:Gt()}],rounded:[{rounded:be()}],"rounded-s":[{"rounded-s":be()}],"rounded-e":[{"rounded-e":be()}],"rounded-t":[{"rounded-t":be()}],"rounded-r":[{"rounded-r":be()}],"rounded-b":[{"rounded-b":be()}],"rounded-l":[{"rounded-l":be()}],"rounded-ss":[{"rounded-ss":be()}],"rounded-se":[{"rounded-se":be()}],"rounded-ee":[{"rounded-ee":be()}],"rounded-es":[{"rounded-es":be()}],"rounded-tl":[{"rounded-tl":be()}],"rounded-tr":[{"rounded-tr":be()}],"rounded-br":[{"rounded-br":be()}],"rounded-bl":[{"rounded-bl":be()}],"border-w":[{border:Te()}],"border-w-x":[{"border-x":Te()}],"border-w-y":[{"border-y":Te()}],"border-w-s":[{"border-s":Te()}],"border-w-e":[{"border-e":Te()}],"border-w-t":[{"border-t":Te()}],"border-w-r":[{"border-r":Te()}],"border-w-b":[{"border-b":Te()}],"border-w-l":[{"border-l":Te()}],"divide-x":[{"divide-x":Te()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":Te()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...Ze(),"hidden","none"]}],"divide-style":[{divide:[...Ze(),"hidden","none"]}],"border-color":[{border:Gt()}],"border-color-x":[{"border-x":Gt()}],"border-color-y":[{"border-y":Gt()}],"border-color-s":[{"border-s":Gt()}],"border-color-e":[{"border-e":Gt()}],"border-color-t":[{"border-t":Gt()}],"border-color-r":[{"border-r":Gt()}],"border-color-b":[{"border-b":Gt()}],"border-color-l":[{"border-l":Gt()}],"divide-color":[{divide:Gt()}],"outline-style":[{outline:[...Ze(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Sn,Ge,Ue]}],"outline-w":[{outline:["",Sn,Lg,Rf]}],"outline-color":[{outline:Gt()}],shadow:[{shadow:["","none",B,l_,o_]}],"shadow-color":[{shadow:Gt()}],"inset-shadow":[{"inset-shadow":["none",H,l_,o_]}],"inset-shadow-color":[{"inset-shadow":Gt()}],"ring-w":[{ring:Te()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:Gt()}],"ring-offset-w":[{"ring-offset":[Sn,Rf]}],"ring-offset-color":[{"ring-offset":Gt()}],"inset-ring-w":[{"inset-ring":Te()}],"inset-ring-color":[{"inset-ring":Gt()}],"text-shadow":[{"text-shadow":["none",W,l_,o_]}],"text-shadow-color":[{"text-shadow":Gt()}],opacity:[{opacity:[Sn,Ge,Ue]}],"mix-blend":[{"mix-blend":[...$e(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":$e()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Sn]}],"mask-image-linear-from-pos":[{"mask-linear-from":Le()}],"mask-image-linear-to-pos":[{"mask-linear-to":Le()}],"mask-image-linear-from-color":[{"mask-linear-from":Gt()}],"mask-image-linear-to-color":[{"mask-linear-to":Gt()}],"mask-image-t-from-pos":[{"mask-t-from":Le()}],"mask-image-t-to-pos":[{"mask-t-to":Le()}],"mask-image-t-from-color":[{"mask-t-from":Gt()}],"mask-image-t-to-color":[{"mask-t-to":Gt()}],"mask-image-r-from-pos":[{"mask-r-from":Le()}],"mask-image-r-to-pos":[{"mask-r-to":Le()}],"mask-image-r-from-color":[{"mask-r-from":Gt()}],"mask-image-r-to-color":[{"mask-r-to":Gt()}],"mask-image-b-from-pos":[{"mask-b-from":Le()}],"mask-image-b-to-pos":[{"mask-b-to":Le()}],"mask-image-b-from-color":[{"mask-b-from":Gt()}],"mask-image-b-to-color":[{"mask-b-to":Gt()}],"mask-image-l-from-pos":[{"mask-l-from":Le()}],"mask-image-l-to-pos":[{"mask-l-to":Le()}],"mask-image-l-from-color":[{"mask-l-from":Gt()}],"mask-image-l-to-color":[{"mask-l-to":Gt()}],"mask-image-x-from-pos":[{"mask-x-from":Le()}],"mask-image-x-to-pos":[{"mask-x-to":Le()}],"mask-image-x-from-color":[{"mask-x-from":Gt()}],"mask-image-x-to-color":[{"mask-x-to":Gt()}],"mask-image-y-from-pos":[{"mask-y-from":Le()}],"mask-image-y-to-pos":[{"mask-y-to":Le()}],"mask-image-y-from-color":[{"mask-y-from":Gt()}],"mask-image-y-to-color":[{"mask-y-to":Gt()}],"mask-image-radial":[{"mask-radial":[Ge,Ue]}],"mask-image-radial-from-pos":[{"mask-radial-from":Le()}],"mask-image-radial-to-pos":[{"mask-radial-to":Le()}],"mask-image-radial-from-color":[{"mask-radial-from":Gt()}],"mask-image-radial-to-color":[{"mask-radial-to":Gt()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":Lt()}],"mask-image-conic-pos":[{"mask-conic":[Sn]}],"mask-image-conic-from-pos":[{"mask-conic-from":Le()}],"mask-image-conic-to-pos":[{"mask-conic-to":Le()}],"mask-image-conic-from-color":[{"mask-conic-from":Gt()}],"mask-image-conic-to-color":[{"mask-conic-to":Gt()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:we()}],"mask-repeat":[{mask:He()}],"mask-size":[{mask:Rt()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Ge,Ue]}],filter:[{filter:["","none",Ge,Ue]}],blur:[{blur:yn()}],brightness:[{brightness:[Sn,Ge,Ue]}],contrast:[{contrast:[Sn,Ge,Ue]}],"drop-shadow":[{"drop-shadow":["","none",it,l_,o_]}],"drop-shadow-color":[{"drop-shadow":Gt()}],grayscale:[{grayscale:["",Sn,Ge,Ue]}],"hue-rotate":[{"hue-rotate":[Sn,Ge,Ue]}],invert:[{invert:["",Sn,Ge,Ue]}],saturate:[{saturate:[Sn,Ge,Ue]}],sepia:[{sepia:["",Sn,Ge,Ue]}],"backdrop-filter":[{"backdrop-filter":["","none",Ge,Ue]}],"backdrop-blur":[{"backdrop-blur":yn()}],"backdrop-brightness":[{"backdrop-brightness":[Sn,Ge,Ue]}],"backdrop-contrast":[{"backdrop-contrast":[Sn,Ge,Ue]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Sn,Ge,Ue]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Sn,Ge,Ue]}],"backdrop-invert":[{"backdrop-invert":["",Sn,Ge,Ue]}],"backdrop-opacity":[{"backdrop-opacity":[Sn,Ge,Ue]}],"backdrop-saturate":[{"backdrop-saturate":[Sn,Ge,Ue]}],"backdrop-sepia":[{"backdrop-sepia":["",Sn,Ge,Ue]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":Kt()}],"border-spacing-x":[{"border-spacing-x":Kt()}],"border-spacing-y":[{"border-spacing-y":Kt()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Ge,Ue]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Sn,"initial",Ge,Ue]}],ease:[{ease:["linear","initial",mt,Ge,Ue]}],delay:[{delay:[Sn,Ge,Ue]}],animate:[{animate:["none",Et,Ge,Ue]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[rt,Ge,Ue]}],"perspective-origin":[{"perspective-origin":Ot()}],rotate:[{rotate:Mn()}],"rotate-x":[{"rotate-x":Mn()}],"rotate-y":[{"rotate-y":Mn()}],"rotate-z":[{"rotate-z":Mn()}],scale:[{scale:Gi()}],"scale-x":[{"scale-x":Gi()}],"scale-y":[{"scale-y":Gi()}],"scale-z":[{"scale-z":Gi()}],"scale-3d":["scale-3d"],skew:[{skew:br()}],"skew-x":[{"skew-x":br()}],"skew-y":[{"skew-y":br()}],transform:[{transform:[Ge,Ue,"","none","gpu","cpu"]}],"transform-origin":[{origin:Ot()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Ci()}],"translate-x":[{"translate-x":Ci()}],"translate-y":[{"translate-y":Ci()}],"translate-z":[{"translate-z":Ci()}],"translate-none":["translate-none"],accent:[{accent:Gt()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:Gt()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ge,Ue]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Kt()}],"scroll-mx":[{"scroll-mx":Kt()}],"scroll-my":[{"scroll-my":Kt()}],"scroll-ms":[{"scroll-ms":Kt()}],"scroll-me":[{"scroll-me":Kt()}],"scroll-mt":[{"scroll-mt":Kt()}],"scroll-mr":[{"scroll-mr":Kt()}],"scroll-mb":[{"scroll-mb":Kt()}],"scroll-ml":[{"scroll-ml":Kt()}],"scroll-p":[{"scroll-p":Kt()}],"scroll-px":[{"scroll-px":Kt()}],"scroll-py":[{"scroll-py":Kt()}],"scroll-ps":[{"scroll-ps":Kt()}],"scroll-pe":[{"scroll-pe":Kt()}],"scroll-pt":[{"scroll-pt":Kt()}],"scroll-pr":[{"scroll-pr":Kt()}],"scroll-pb":[{"scroll-pb":Kt()}],"scroll-pl":[{"scroll-pl":Kt()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ge,Ue]}],fill:[{fill:["none",...Gt()]}],"stroke-w":[{stroke:[Sn,Lg,Rf,nx]}],stroke:[{stroke:["none",...Gt()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},fD=HP(dD);function Rn(...s){return fD(i2(s))}const pD=nP,v2=Z.forwardRef(({className:s,...c},p)=>F.jsx(WT,{ref:p,className:Rn("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...c}));v2.displayName=WT.displayName;const mD=sy("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),x2=Z.forwardRef(({className:s,variant:c,...p},_)=>F.jsx(KT,{ref:_,className:Rn(mD({variant:c}),s),...p}));x2.displayName=KT.displayName;const gD=Z.forwardRef(({className:s,...c},p)=>F.jsx(t2,{ref:p,className:Rn("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...c}));gD.displayName=t2.displayName;const b2=Z.forwardRef(({className:s,...c},p)=>F.jsx(e2,{ref:p,className:Rn("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...c,children:F.jsx(mm,{className:"h-4 w-4"})}));b2.displayName=e2.displayName;const w2=Z.forwardRef(({className:s,...c},p)=>F.jsx(QT,{ref:p,className:Rn("text-sm font-semibold",s),...c}));w2.displayName=QT.displayName;const T2=Z.forwardRef(({className:s,...c},p)=>F.jsx(JT,{ref:p,className:Rn("text-sm opacity-90",s),...c}));T2.displayName=JT.displayName;function yD(){const{toasts:s}=pM();return F.jsxs(pD,{children:[s.map(function({id:c,title:p,description:_,action:S,...A}){return F.jsxs(x2,{...A,children:[F.jsxs("div",{className:"grid gap-1",children:[p&&F.jsx(w2,{children:p}),_&&F.jsx(T2,{children:_})]}),S,F.jsx(b2,{})]},c)}),F.jsx(v2,{})]})}function Yp(s,c,{checkForDefaultPrevented:p=!0}={}){return function(S){if(s?.(S),p===!1||!S.defaultPrevented)return c?.(S)}}function ix(s,c,{checkForDefaultPrevented:p=!0}={}){return function(S){if(s?.(S),p===!1||!S.defaultPrevented)return c?.(S)}}function _D(s){const c=vD(s),p=Z.forwardRef((_,S)=>{const{children:A,...T}=_,u=Z.Children.toArray(A),L=u.find(bD);if(L){const k=L.props.children,B=u.map(H=>H===L?Z.Children.count(k)>1?Z.Children.only(null):Z.isValidElement(k)?k.props.children:null:H);return F.jsx(c,{...T,ref:S,children:Z.isValidElement(k)?Z.cloneElement(k,void 0,B):null})}return F.jsx(c,{...T,ref:S,children:A})});return p.displayName=`${s}.Slot`,p}function vD(s){const c=Z.forwardRef((p,_)=>{const{children:S,...A}=p;if(Z.isValidElement(S)){const T=TD(S),u=wD(A,S.props);return S.type!==Z.Fragment&&(u.ref=_?ry(_,T):T),Z.cloneElement(S,u)}return Z.Children.count(S)>1?Z.Children.only(null):null});return c.displayName=`${s}.SlotClone`,c}var xD=Symbol("radix.slottable");function bD(s){return Z.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===xD}function wD(s,c){const p={...c};for(const _ in c){const S=s[_],A=c[_];/^on[A-Z]/.test(_)?S&&A?p[_]=(...u)=>{const L=A(...u);return S(...u),L}:S&&(p[_]=S):_==="style"?p[_]={...S,...A}:_==="className"&&(p[_]=[S,A].filter(Boolean).join(" "))}return{...s,...p}}function TD(s){let c=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,p=c&&"isReactWarning"in c&&c.isReactWarning;return p?s.ref:(c=Object.getOwnPropertyDescriptor(s,"ref")?.get,p=c&&"isReactWarning"in c&&c.isReactWarning,p?s.props.ref:s.props.ref||s.ref)}var SD=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],$r=SD.reduce((s,c)=>{const p=_D(`Primitive.${c}`),_=Z.forwardRef((S,A)=>{const{asChild:T,...u}=S,L=T?p:c;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),F.jsx(L,{...u,ref:A})});return _.displayName=`Primitive.${c}`,{...s,[c]:_}},{});function ED(s,c){s&&iy.flushSync(()=>s.dispatchEvent(c))}var CD="DismissableLayer",Bx="dismissableLayer.update",AD="dismissableLayer.pointerDownOutside",MD="dismissableLayer.focusOutside",b1,S2=Z.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),M0=Z.forwardRef((s,c)=>{const{disableOutsidePointerEvents:p=!1,onEscapeKeyDown:_,onPointerDownOutside:S,onFocusOutside:A,onInteractOutside:T,onDismiss:u,...L}=s,k=Z.useContext(S2),[B,H]=Z.useState(null),W=B?.ownerDocument??globalThis?.document,[,it]=Z.useState({}),pt=Ui(c,Nt=>H(Nt)),rt=Array.from(k.layers),[J]=[...k.layersWithOutsidePointerEventsDisabled].slice(-1),mt=rt.indexOf(J),Et=B?rt.indexOf(B):-1,bt=k.layersWithOutsidePointerEventsDisabled.size>0,Lt=Et>=mt,Ot=RD(Nt=>{const Kt=Nt.target,xe=[...k.branches].some(Ae=>Ae.contains(Kt));!Lt||xe||(S?.(Nt),T?.(Nt),Nt.defaultPrevented||u?.())},W),ee=ID(Nt=>{const Kt=Nt.target;[...k.branches].some(Ae=>Ae.contains(Kt))||(A?.(Nt),T?.(Nt),Nt.defaultPrevented||u?.())},W);return DT(Nt=>{Et===k.layers.size-1&&(_?.(Nt),!Nt.defaultPrevented&&u&&(Nt.preventDefault(),u()))},W),Z.useEffect(()=>{if(B)return p&&(k.layersWithOutsidePointerEventsDisabled.size===0&&(b1=W.body.style.pointerEvents,W.body.style.pointerEvents="none"),k.layersWithOutsidePointerEventsDisabled.add(B)),k.layers.add(B),w1(),()=>{p&&k.layersWithOutsidePointerEventsDisabled.size===1&&(W.body.style.pointerEvents=b1)}},[B,W,p,k]),Z.useEffect(()=>()=>{B&&(k.layers.delete(B),k.layersWithOutsidePointerEventsDisabled.delete(B),w1())},[B,k]),Z.useEffect(()=>{const Nt=()=>it({});return document.addEventListener(Bx,Nt),()=>document.removeEventListener(Bx,Nt)},[]),F.jsx($r.div,{...L,ref:pt,style:{pointerEvents:bt?Lt?"auto":"none":void 0,...s.style},onFocusCapture:ix(s.onFocusCapture,ee.onFocusCapture),onBlurCapture:ix(s.onBlurCapture,ee.onBlurCapture),onPointerDownCapture:ix(s.onPointerDownCapture,Ot.onPointerDownCapture)})});M0.displayName=CD;var PD="DismissableLayerBranch",DD=Z.forwardRef((s,c)=>{const p=Z.useContext(S2),_=Z.useRef(null),S=Ui(c,_);return Z.useEffect(()=>{const A=_.current;if(A)return p.branches.add(A),()=>{p.branches.delete(A)}},[p.branches]),F.jsx($r.div,{...s,ref:S})});DD.displayName=PD;function RD(s,c=globalThis?.document){const p=cr(s),_=Z.useRef(!1),S=Z.useRef(()=>{});return Z.useEffect(()=>{const A=u=>{if(u.target&&!_.current){let L=function(){E2(AD,p,k,{discrete:!0})};const k={originalEvent:u};u.pointerType==="touch"?(c.removeEventListener("click",S.current),S.current=L,c.addEventListener("click",S.current,{once:!0})):L()}else c.removeEventListener("click",S.current);_.current=!1},T=window.setTimeout(()=>{c.addEventListener("pointerdown",A)},0);return()=>{window.clearTimeout(T),c.removeEventListener("pointerdown",A),c.removeEventListener("click",S.current)}},[c,p]),{onPointerDownCapture:()=>_.current=!0}}function ID(s,c=globalThis?.document){const p=cr(s),_=Z.useRef(!1);return Z.useEffect(()=>{const S=A=>{A.target&&!_.current&&E2(MD,p,{originalEvent:A},{discrete:!1})};return c.addEventListener("focusin",S),()=>c.removeEventListener("focusin",S)},[c,p]),{onFocusCapture:()=>_.current=!0,onBlurCapture:()=>_.current=!1}}function w1(){const s=new CustomEvent(Bx);document.dispatchEvent(s)}function E2(s,c,p,{discrete:_}){const S=p.originalEvent.target,A=new CustomEvent(s,{bubbles:!1,cancelable:!0,detail:p});c&&S.addEventListener(s,c,{once:!0}),_?ED(S,A):S.dispatchEvent(A)}var zD=H_[" useId ".trim().toString()]||(()=>{}),LD=0;function rx(s){const[c,p]=Z.useState(zD());return Bs(()=>{p(_=>_??String(LD++))},[s]),s||(c?`radix-${c}`:"")}const kD=["top","right","bottom","left"],md=Math.min,xo=Math.max,z_=Math.round,c_=Math.floor,Hc=s=>({x:s,y:s}),OD={left:"right",right:"left",bottom:"top",top:"bottom"},ND={start:"end",end:"start"};function Vx(s,c,p){return xo(s,md(c,p))}function rh(s,c){return typeof s=="function"?s(c):s}function sh(s){return s.split("-")[0]}function _m(s){return s.split("-")[1]}function P0(s){return s==="x"?"y":"x"}function D0(s){return s==="y"?"height":"width"}const FD=new Set(["top","bottom"]);function $c(s){return FD.has(sh(s))?"y":"x"}function R0(s){return P0($c(s))}function jD(s,c,p){p===void 0&&(p=!1);const _=_m(s),S=R0(s),A=D0(S);let T=S==="x"?_===(p?"end":"start")?"right":"left":_==="start"?"bottom":"top";return c.reference[A]>c.floating[A]&&(T=L_(T)),[T,L_(T)]}function BD(s){const c=L_(s);return[Ux(s),c,Ux(c)]}function Ux(s){return s.replace(/start|end/g,c=>ND[c])}const T1=["left","right"],S1=["right","left"],VD=["top","bottom"],UD=["bottom","top"];function GD(s,c,p){switch(s){case"top":case"bottom":return p?c?S1:T1:c?T1:S1;case"left":case"right":return c?VD:UD;default:return[]}}function qD(s,c,p,_){const S=_m(s);let A=GD(sh(s),p==="start",_);return S&&(A=A.map(T=>T+"-"+S),c&&(A=A.concat(A.map(Ux)))),A}function L_(s){return s.replace(/left|right|bottom|top/g,c=>OD[c])}function ZD(s){return{top:0,right:0,bottom:0,left:0,...s}}function C2(s){return typeof s!="number"?ZD(s):{top:s,right:s,bottom:s,left:s}}function k_(s){const{x:c,y:p,width:_,height:S}=s;return{width:_,height:S,top:p,left:c,right:c+_,bottom:p+S,x:c,y:p}}function E1(s,c,p){let{reference:_,floating:S}=s;const A=$c(c),T=R0(c),u=D0(T),L=sh(c),k=A==="y",B=_.x+_.width/2-S.width/2,H=_.y+_.height/2-S.height/2,W=_[u]/2-S[u]/2;let it;switch(L){case"top":it={x:B,y:_.y-S.height};break;case"bottom":it={x:B,y:_.y+_.height};break;case"right":it={x:_.x+_.width,y:H};break;case"left":it={x:_.x-S.width,y:H};break;default:it={x:_.x,y:_.y}}switch(_m(c)){case"start":it[T]-=W*(p&&k?-1:1);break;case"end":it[T]+=W*(p&&k?-1:1);break}return it}const $D=async(s,c,p)=>{const{placement:_="bottom",strategy:S="absolute",middleware:A=[],platform:T}=p,u=A.filter(Boolean),L=await(T.isRTL==null?void 0:T.isRTL(c));let k=await T.getElementRects({reference:s,floating:c,strategy:S}),{x:B,y:H}=E1(k,_,L),W=_,it={},pt=0;for(let rt=0;rt<u.length;rt++){const{name:J,fn:mt}=u[rt],{x:Et,y:bt,data:Lt,reset:Ot}=await mt({x:B,y:H,initialPlacement:_,placement:W,strategy:S,middlewareData:it,rects:k,platform:T,elements:{reference:s,floating:c}});B=Et??B,H=bt??H,it={...it,[J]:{...it[J],...Lt}},Ot&&pt<=50&&(pt++,typeof Ot=="object"&&(Ot.placement&&(W=Ot.placement),Ot.rects&&(k=Ot.rects===!0?await T.getElementRects({reference:s,floating:c,strategy:S}):Ot.rects),{x:B,y:H}=E1(k,W,L)),rt=-1)}return{x:B,y:H,placement:W,strategy:S,middlewareData:it}};async function Hg(s,c){var p;c===void 0&&(c={});const{x:_,y:S,platform:A,rects:T,elements:u,strategy:L}=s,{boundary:k="clippingAncestors",rootBoundary:B="viewport",elementContext:H="floating",altBoundary:W=!1,padding:it=0}=rh(c,s),pt=C2(it),J=u[W?H==="floating"?"reference":"floating":H],mt=k_(await A.getClippingRect({element:(p=await(A.isElement==null?void 0:A.isElement(J)))==null||p?J:J.contextElement||await(A.getDocumentElement==null?void 0:A.getDocumentElement(u.floating)),boundary:k,rootBoundary:B,strategy:L})),Et=H==="floating"?{x:_,y:S,width:T.floating.width,height:T.floating.height}:T.reference,bt=await(A.getOffsetParent==null?void 0:A.getOffsetParent(u.floating)),Lt=await(A.isElement==null?void 0:A.isElement(bt))?await(A.getScale==null?void 0:A.getScale(bt))||{x:1,y:1}:{x:1,y:1},Ot=k_(A.convertOffsetParentRelativeRectToViewportRelativeRect?await A.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:Et,offsetParent:bt,strategy:L}):Et);return{top:(mt.top-Ot.top+pt.top)/Lt.y,bottom:(Ot.bottom-mt.bottom+pt.bottom)/Lt.y,left:(mt.left-Ot.left+pt.left)/Lt.x,right:(Ot.right-mt.right+pt.right)/Lt.x}}const HD=s=>({name:"arrow",options:s,async fn(c){const{x:p,y:_,placement:S,rects:A,platform:T,elements:u,middlewareData:L}=c,{element:k,padding:B=0}=rh(s,c)||{};if(k==null)return{};const H=C2(B),W={x:p,y:_},it=R0(S),pt=D0(it),rt=await T.getDimensions(k),J=it==="y",mt=J?"top":"left",Et=J?"bottom":"right",bt=J?"clientHeight":"clientWidth",Lt=A.reference[pt]+A.reference[it]-W[it]-A.floating[pt],Ot=W[it]-A.reference[it],ee=await(T.getOffsetParent==null?void 0:T.getOffsetParent(k));let Nt=ee?ee[bt]:0;(!Nt||!await(T.isElement==null?void 0:T.isElement(ee)))&&(Nt=u.floating[bt]||A.floating[pt]);const Kt=Lt/2-Ot/2,xe=Nt/2-rt[pt]/2-1,Ae=md(H[mt],xe),ae=md(H[Et],xe),ze=Ae,We=Nt-rt[pt]-ae,Ee=Nt/2-rt[pt]/2+Kt,me=Vx(ze,Ee,We),jt=!L.arrow&&_m(S)!=null&&Ee!==me&&A.reference[pt]/2-(Ee<ze?Ae:ae)-rt[pt]/2<0,Qt=jt?Ee<ze?Ee-ze:Ee-We:0;return{[it]:W[it]+Qt,data:{[it]:me,centerOffset:Ee-me-Qt,...jt&&{alignmentOffset:Qt}},reset:jt}}}),XD=function(s){return s===void 0&&(s={}),{name:"flip",options:s,async fn(c){var p,_;const{placement:S,middlewareData:A,rects:T,initialPlacement:u,platform:L,elements:k}=c,{mainAxis:B=!0,crossAxis:H=!0,fallbackPlacements:W,fallbackStrategy:it="bestFit",fallbackAxisSideDirection:pt="none",flipAlignment:rt=!0,...J}=rh(s,c);if((p=A.arrow)!=null&&p.alignmentOffset)return{};const mt=sh(S),Et=$c(u),bt=sh(u)===u,Lt=await(L.isRTL==null?void 0:L.isRTL(k.floating)),Ot=W||(bt||!rt?[L_(u)]:BD(u)),ee=pt!=="none";!W&&ee&&Ot.push(...qD(u,rt,pt,Lt));const Nt=[u,...Ot],Kt=await Hg(c,J),xe=[];let Ae=((_=A.flip)==null?void 0:_.overflows)||[];if(B&&xe.push(Kt[mt]),H){const Ee=jD(S,T,Lt);xe.push(Kt[Ee[0]],Kt[Ee[1]])}if(Ae=[...Ae,{placement:S,overflows:xe}],!xe.every(Ee=>Ee<=0)){var ae,ze;const Ee=(((ae=A.flip)==null?void 0:ae.index)||0)+1,me=Nt[Ee];if(me&&(!(H==="alignment"?Et!==$c(me):!1)||Ae.every(Gt=>$c(Gt.placement)===Et?Gt.overflows[0]>0:!0)))return{data:{index:Ee,overflows:Ae},reset:{placement:me}};let jt=(ze=Ae.filter(Qt=>Qt.overflows[0]<=0).sort((Qt,Gt)=>Qt.overflows[1]-Gt.overflows[1])[0])==null?void 0:ze.placement;if(!jt)switch(it){case"bestFit":{var We;const Qt=(We=Ae.filter(Gt=>{if(ee){const we=$c(Gt.placement);return we===Et||we==="y"}return!0}).map(Gt=>[Gt.placement,Gt.overflows.filter(we=>we>0).reduce((we,He)=>we+He,0)]).sort((Gt,we)=>Gt[1]-we[1])[0])==null?void 0:We[0];Qt&&(jt=Qt);break}case"initialPlacement":jt=u;break}if(S!==jt)return{reset:{placement:jt}}}return{}}}};function C1(s,c){return{top:s.top-c.height,right:s.right-c.width,bottom:s.bottom-c.height,left:s.left-c.width}}function A1(s){return kD.some(c=>s[c]>=0)}const YD=function(s){return s===void 0&&(s={}),{name:"hide",options:s,async fn(c){const{rects:p}=c,{strategy:_="referenceHidden",...S}=rh(s,c);switch(_){case"referenceHidden":{const A=await Hg(c,{...S,elementContext:"reference"}),T=C1(A,p.reference);return{data:{referenceHiddenOffsets:T,referenceHidden:A1(T)}}}case"escaped":{const A=await Hg(c,{...S,altBoundary:!0}),T=C1(A,p.floating);return{data:{escapedOffsets:T,escaped:A1(T)}}}default:return{}}}}},A2=new Set(["left","top"]);async function WD(s,c){const{placement:p,platform:_,elements:S}=s,A=await(_.isRTL==null?void 0:_.isRTL(S.floating)),T=sh(p),u=_m(p),L=$c(p)==="y",k=A2.has(T)?-1:1,B=A&&L?-1:1,H=rh(c,s);let{mainAxis:W,crossAxis:it,alignmentAxis:pt}=typeof H=="number"?{mainAxis:H,crossAxis:0,alignmentAxis:null}:{mainAxis:H.mainAxis||0,crossAxis:H.crossAxis||0,alignmentAxis:H.alignmentAxis};return u&&typeof pt=="number"&&(it=u==="end"?pt*-1:pt),L?{x:it*B,y:W*k}:{x:W*k,y:it*B}}const KD=function(s){return s===void 0&&(s=0),{name:"offset",options:s,async fn(c){var p,_;const{x:S,y:A,placement:T,middlewareData:u}=c,L=await WD(c,s);return T===((p=u.offset)==null?void 0:p.placement)&&(_=u.arrow)!=null&&_.alignmentOffset?{}:{x:S+L.x,y:A+L.y,data:{...L,placement:T}}}}},QD=function(s){return s===void 0&&(s={}),{name:"shift",options:s,async fn(c){const{x:p,y:_,placement:S}=c,{mainAxis:A=!0,crossAxis:T=!1,limiter:u={fn:J=>{let{x:mt,y:Et}=J;return{x:mt,y:Et}}},...L}=rh(s,c),k={x:p,y:_},B=await Hg(c,L),H=$c(sh(S)),W=P0(H);let it=k[W],pt=k[H];if(A){const J=W==="y"?"top":"left",mt=W==="y"?"bottom":"right",Et=it+B[J],bt=it-B[mt];it=Vx(Et,it,bt)}if(T){const J=H==="y"?"top":"left",mt=H==="y"?"bottom":"right",Et=pt+B[J],bt=pt-B[mt];pt=Vx(Et,pt,bt)}const rt=u.fn({...c,[W]:it,[H]:pt});return{...rt,data:{x:rt.x-p,y:rt.y-_,enabled:{[W]:A,[H]:T}}}}}},JD=function(s){return s===void 0&&(s={}),{options:s,fn(c){const{x:p,y:_,placement:S,rects:A,middlewareData:T}=c,{offset:u=0,mainAxis:L=!0,crossAxis:k=!0}=rh(s,c),B={x:p,y:_},H=$c(S),W=P0(H);let it=B[W],pt=B[H];const rt=rh(u,c),J=typeof rt=="number"?{mainAxis:rt,crossAxis:0}:{mainAxis:0,crossAxis:0,...rt};if(L){const bt=W==="y"?"height":"width",Lt=A.reference[W]-A.floating[bt]+J.mainAxis,Ot=A.reference[W]+A.reference[bt]-J.mainAxis;it<Lt?it=Lt:it>Ot&&(it=Ot)}if(k){var mt,Et;const bt=W==="y"?"width":"height",Lt=A2.has(sh(S)),Ot=A.reference[H]-A.floating[bt]+(Lt&&((mt=T.offset)==null?void 0:mt[H])||0)+(Lt?0:J.crossAxis),ee=A.reference[H]+A.reference[bt]+(Lt?0:((Et=T.offset)==null?void 0:Et[H])||0)-(Lt?J.crossAxis:0);pt<Ot?pt=Ot:pt>ee&&(pt=ee)}return{[W]:it,[H]:pt}}}},tR=function(s){return s===void 0&&(s={}),{name:"size",options:s,async fn(c){var p,_;const{placement:S,rects:A,platform:T,elements:u}=c,{apply:L=()=>{},...k}=rh(s,c),B=await Hg(c,k),H=sh(S),W=_m(S),it=$c(S)==="y",{width:pt,height:rt}=A.floating;let J,mt;H==="top"||H==="bottom"?(J=H,mt=W===(await(T.isRTL==null?void 0:T.isRTL(u.floating))?"start":"end")?"left":"right"):(mt=H,J=W==="end"?"top":"bottom");const Et=rt-B.top-B.bottom,bt=pt-B.left-B.right,Lt=md(rt-B[J],Et),Ot=md(pt-B[mt],bt),ee=!c.middlewareData.shift;let Nt=Lt,Kt=Ot;if((p=c.middlewareData.shift)!=null&&p.enabled.x&&(Kt=bt),(_=c.middlewareData.shift)!=null&&_.enabled.y&&(Nt=Et),ee&&!W){const Ae=xo(B.left,0),ae=xo(B.right,0),ze=xo(B.top,0),We=xo(B.bottom,0);it?Kt=pt-2*(Ae!==0||ae!==0?Ae+ae:xo(B.left,B.right)):Nt=rt-2*(ze!==0||We!==0?ze+We:xo(B.top,B.bottom))}await L({...c,availableWidth:Kt,availableHeight:Nt});const xe=await T.getDimensions(u.floating);return pt!==xe.width||rt!==xe.height?{reset:{rects:!0}}:{}}}};function tv(){return typeof window<"u"}function vm(s){return M2(s)?(s.nodeName||"").toLowerCase():"#document"}function wo(s){var c;return(s==null||(c=s.ownerDocument)==null?void 0:c.defaultView)||window}function Jc(s){var c;return(c=(M2(s)?s.ownerDocument:s.document)||window.document)==null?void 0:c.documentElement}function M2(s){return tv()?s instanceof Node||s instanceof wo(s).Node:!1}function Jl(s){return tv()?s instanceof Element||s instanceof wo(s).Element:!1}function Kc(s){return tv()?s instanceof HTMLElement||s instanceof wo(s).HTMLElement:!1}function M1(s){return!tv()||typeof ShadowRoot>"u"?!1:s instanceof ShadowRoot||s instanceof wo(s).ShadowRoot}const eR=new Set(["inline","contents"]);function ay(s){const{overflow:c,overflowX:p,overflowY:_,display:S}=tc(s);return/auto|scroll|overlay|hidden|clip/.test(c+_+p)&&!eR.has(S)}const nR=new Set(["table","td","th"]);function iR(s){return nR.has(vm(s))}const rR=[":popover-open",":modal"];function ev(s){return rR.some(c=>{try{return s.matches(c)}catch{return!1}})}const sR=["transform","translate","scale","rotate","perspective"],aR=["transform","translate","scale","rotate","perspective","filter"],oR=["paint","layout","strict","content"];function I0(s){const c=z0(),p=Jl(s)?tc(s):s;return sR.some(_=>p[_]?p[_]!=="none":!1)||(p.containerType?p.containerType!=="normal":!1)||!c&&(p.backdropFilter?p.backdropFilter!=="none":!1)||!c&&(p.filter?p.filter!=="none":!1)||aR.some(_=>(p.willChange||"").includes(_))||oR.some(_=>(p.contain||"").includes(_))}function lR(s){let c=gd(s);for(;Kc(c)&&!cm(c);){if(I0(c))return c;if(ev(c))return null;c=gd(c)}return null}function z0(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const cR=new Set(["html","body","#document"]);function cm(s){return cR.has(vm(s))}function tc(s){return wo(s).getComputedStyle(s)}function nv(s){return Jl(s)?{scrollLeft:s.scrollLeft,scrollTop:s.scrollTop}:{scrollLeft:s.scrollX,scrollTop:s.scrollY}}function gd(s){if(vm(s)==="html")return s;const c=s.assignedSlot||s.parentNode||M1(s)&&s.host||Jc(s);return M1(c)?c.host:c}function P2(s){const c=gd(s);return cm(c)?s.ownerDocument?s.ownerDocument.body:s.body:Kc(c)&&ay(c)?c:P2(c)}function Xg(s,c,p){var _;c===void 0&&(c=[]),p===void 0&&(p=!0);const S=P2(s),A=S===((_=s.ownerDocument)==null?void 0:_.body),T=wo(S);if(A){const u=Gx(T);return c.concat(T,T.visualViewport||[],ay(S)?S:[],u&&p?Xg(u):[])}return c.concat(S,Xg(S,[],p))}function Gx(s){return s.parent&&Object.getPrototypeOf(s.parent)?s.frameElement:null}function D2(s){const c=tc(s);let p=parseFloat(c.width)||0,_=parseFloat(c.height)||0;const S=Kc(s),A=S?s.offsetWidth:p,T=S?s.offsetHeight:_,u=z_(p)!==A||z_(_)!==T;return u&&(p=A,_=T),{width:p,height:_,$:u}}function L0(s){return Jl(s)?s:s.contextElement}function rm(s){const c=L0(s);if(!Kc(c))return Hc(1);const p=c.getBoundingClientRect(),{width:_,height:S,$:A}=D2(c);let T=(A?z_(p.width):p.width)/_,u=(A?z_(p.height):p.height)/S;return(!T||!Number.isFinite(T))&&(T=1),(!u||!Number.isFinite(u))&&(u=1),{x:T,y:u}}const uR=Hc(0);function R2(s){const c=wo(s);return!z0()||!c.visualViewport?uR:{x:c.visualViewport.offsetLeft,y:c.visualViewport.offsetTop}}function hR(s,c,p){return c===void 0&&(c=!1),!p||c&&p!==wo(s)?!1:c}function Bf(s,c,p,_){c===void 0&&(c=!1),p===void 0&&(p=!1);const S=s.getBoundingClientRect(),A=L0(s);let T=Hc(1);c&&(_?Jl(_)&&(T=rm(_)):T=rm(s));const u=hR(A,p,_)?R2(A):Hc(0);let L=(S.left+u.x)/T.x,k=(S.top+u.y)/T.y,B=S.width/T.x,H=S.height/T.y;if(A){const W=wo(A),it=_&&Jl(_)?wo(_):_;let pt=W,rt=Gx(pt);for(;rt&&_&&it!==pt;){const J=rm(rt),mt=rt.getBoundingClientRect(),Et=tc(rt),bt=mt.left+(rt.clientLeft+parseFloat(Et.paddingLeft))*J.x,Lt=mt.top+(rt.clientTop+parseFloat(Et.paddingTop))*J.y;L*=J.x,k*=J.y,B*=J.x,H*=J.y,L+=bt,k+=Lt,pt=wo(rt),rt=Gx(pt)}}return k_({width:B,height:H,x:L,y:k})}function iv(s,c){const p=nv(s).scrollLeft;return c?c.left+p:Bf(Jc(s)).left+p}function I2(s,c){const p=s.getBoundingClientRect(),_=p.left+c.scrollLeft-iv(s,p),S=p.top+c.scrollTop;return{x:_,y:S}}function dR(s){let{elements:c,rect:p,offsetParent:_,strategy:S}=s;const A=S==="fixed",T=Jc(_),u=c?ev(c.floating):!1;if(_===T||u&&A)return p;let L={scrollLeft:0,scrollTop:0},k=Hc(1);const B=Hc(0),H=Kc(_);if((H||!H&&!A)&&((vm(_)!=="body"||ay(T))&&(L=nv(_)),Kc(_))){const it=Bf(_);k=rm(_),B.x=it.x+_.clientLeft,B.y=it.y+_.clientTop}const W=T&&!H&&!A?I2(T,L):Hc(0);return{width:p.width*k.x,height:p.height*k.y,x:p.x*k.x-L.scrollLeft*k.x+B.x+W.x,y:p.y*k.y-L.scrollTop*k.y+B.y+W.y}}function fR(s){return Array.from(s.getClientRects())}function pR(s){const c=Jc(s),p=nv(s),_=s.ownerDocument.body,S=xo(c.scrollWidth,c.clientWidth,_.scrollWidth,_.clientWidth),A=xo(c.scrollHeight,c.clientHeight,_.scrollHeight,_.clientHeight);let T=-p.scrollLeft+iv(s);const u=-p.scrollTop;return tc(_).direction==="rtl"&&(T+=xo(c.clientWidth,_.clientWidth)-S),{width:S,height:A,x:T,y:u}}const P1=25;function mR(s,c){const p=wo(s),_=Jc(s),S=p.visualViewport;let A=_.clientWidth,T=_.clientHeight,u=0,L=0;if(S){A=S.width,T=S.height;const B=z0();(!B||B&&c==="fixed")&&(u=S.offsetLeft,L=S.offsetTop)}const k=iv(_);if(k<=0){const B=_.ownerDocument,H=B.body,W=getComputedStyle(H),it=B.compatMode==="CSS1Compat"&&parseFloat(W.marginLeft)+parseFloat(W.marginRight)||0,pt=Math.abs(_.clientWidth-H.clientWidth-it);pt<=P1&&(A-=pt)}else k<=P1&&(A+=k);return{width:A,height:T,x:u,y:L}}const gR=new Set(["absolute","fixed"]);function yR(s,c){const p=Bf(s,!0,c==="fixed"),_=p.top+s.clientTop,S=p.left+s.clientLeft,A=Kc(s)?rm(s):Hc(1),T=s.clientWidth*A.x,u=s.clientHeight*A.y,L=S*A.x,k=_*A.y;return{width:T,height:u,x:L,y:k}}function D1(s,c,p){let _;if(c==="viewport")_=mR(s,p);else if(c==="document")_=pR(Jc(s));else if(Jl(c))_=yR(c,p);else{const S=R2(s);_={x:c.x-S.x,y:c.y-S.y,width:c.width,height:c.height}}return k_(_)}function z2(s,c){const p=gd(s);return p===c||!Jl(p)||cm(p)?!1:tc(p).position==="fixed"||z2(p,c)}function _R(s,c){const p=c.get(s);if(p)return p;let _=Xg(s,[],!1).filter(u=>Jl(u)&&vm(u)!=="body"),S=null;const A=tc(s).position==="fixed";let T=A?gd(s):s;for(;Jl(T)&&!cm(T);){const u=tc(T),L=I0(T);!L&&u.position==="fixed"&&(S=null),(A?!L&&!S:!L&&u.position==="static"&&!!S&&gR.has(S.position)||ay(T)&&!L&&z2(s,T))?_=_.filter(B=>B!==T):S=u,T=gd(T)}return c.set(s,_),_}function vR(s){let{element:c,boundary:p,rootBoundary:_,strategy:S}=s;const T=[...p==="clippingAncestors"?ev(c)?[]:_R(c,this._c):[].concat(p),_],u=T[0],L=T.reduce((k,B)=>{const H=D1(c,B,S);return k.top=xo(H.top,k.top),k.right=md(H.right,k.right),k.bottom=md(H.bottom,k.bottom),k.left=xo(H.left,k.left),k},D1(c,u,S));return{width:L.right-L.left,height:L.bottom-L.top,x:L.left,y:L.top}}function xR(s){const{width:c,height:p}=D2(s);return{width:c,height:p}}function bR(s,c,p){const _=Kc(c),S=Jc(c),A=p==="fixed",T=Bf(s,!0,A,c);let u={scrollLeft:0,scrollTop:0};const L=Hc(0);function k(){L.x=iv(S)}if(_||!_&&!A)if((vm(c)!=="body"||ay(S))&&(u=nv(c)),_){const it=Bf(c,!0,A,c);L.x=it.x+c.clientLeft,L.y=it.y+c.clientTop}else S&&k();A&&!_&&S&&k();const B=S&&!_&&!A?I2(S,u):Hc(0),H=T.left+u.scrollLeft-L.x-B.x,W=T.top+u.scrollTop-L.y-B.y;return{x:H,y:W,width:T.width,height:T.height}}function sx(s){return tc(s).position==="static"}function R1(s,c){if(!Kc(s)||tc(s).position==="fixed")return null;if(c)return c(s);let p=s.offsetParent;return Jc(s)===p&&(p=p.ownerDocument.body),p}function L2(s,c){const p=wo(s);if(ev(s))return p;if(!Kc(s)){let S=gd(s);for(;S&&!cm(S);){if(Jl(S)&&!sx(S))return S;S=gd(S)}return p}let _=R1(s,c);for(;_&&iR(_)&&sx(_);)_=R1(_,c);return _&&cm(_)&&sx(_)&&!I0(_)?p:_||lR(s)||p}const wR=async function(s){const c=this.getOffsetParent||L2,p=this.getDimensions,_=await p(s.floating);return{reference:bR(s.reference,await c(s.floating),s.strategy),floating:{x:0,y:0,width:_.width,height:_.height}}};function TR(s){return tc(s).direction==="rtl"}const SR={convertOffsetParentRelativeRectToViewportRelativeRect:dR,getDocumentElement:Jc,getClippingRect:vR,getOffsetParent:L2,getElementRects:wR,getClientRects:fR,getDimensions:xR,getScale:rm,isElement:Jl,isRTL:TR};function k2(s,c){return s.x===c.x&&s.y===c.y&&s.width===c.width&&s.height===c.height}function ER(s,c){let p=null,_;const S=Jc(s);function A(){var u;clearTimeout(_),(u=p)==null||u.disconnect(),p=null}function T(u,L){u===void 0&&(u=!1),L===void 0&&(L=1),A();const k=s.getBoundingClientRect(),{left:B,top:H,width:W,height:it}=k;if(u||c(),!W||!it)return;const pt=c_(H),rt=c_(S.clientWidth-(B+W)),J=c_(S.clientHeight-(H+it)),mt=c_(B),bt={rootMargin:-pt+"px "+-rt+"px "+-J+"px "+-mt+"px",threshold:xo(0,md(1,L))||1};let Lt=!0;function Ot(ee){const Nt=ee[0].intersectionRatio;if(Nt!==L){if(!Lt)return T();Nt?T(!1,Nt):_=setTimeout(()=>{T(!1,1e-7)},1e3)}Nt===1&&!k2(k,s.getBoundingClientRect())&&T(),Lt=!1}try{p=new IntersectionObserver(Ot,{...bt,root:S.ownerDocument})}catch{p=new IntersectionObserver(Ot,bt)}p.observe(s)}return T(!0),A}function CR(s,c,p,_){_===void 0&&(_={});const{ancestorScroll:S=!0,ancestorResize:A=!0,elementResize:T=typeof ResizeObserver=="function",layoutShift:u=typeof IntersectionObserver=="function",animationFrame:L=!1}=_,k=L0(s),B=S||A?[...k?Xg(k):[],...Xg(c)]:[];B.forEach(mt=>{S&&mt.addEventListener("scroll",p,{passive:!0}),A&&mt.addEventListener("resize",p)});const H=k&&u?ER(k,p):null;let W=-1,it=null;T&&(it=new ResizeObserver(mt=>{let[Et]=mt;Et&&Et.target===k&&it&&(it.unobserve(c),cancelAnimationFrame(W),W=requestAnimationFrame(()=>{var bt;(bt=it)==null||bt.observe(c)})),p()}),k&&!L&&it.observe(k),it.observe(c));let pt,rt=L?Bf(s):null;L&&J();function J(){const mt=Bf(s);rt&&!k2(rt,mt)&&p(),rt=mt,pt=requestAnimationFrame(J)}return p(),()=>{var mt;B.forEach(Et=>{S&&Et.removeEventListener("scroll",p),A&&Et.removeEventListener("resize",p)}),H?.(),(mt=it)==null||mt.disconnect(),it=null,L&&cancelAnimationFrame(pt)}}const AR=KD,MR=QD,PR=XD,DR=tR,RR=YD,I1=HD,IR=JD,zR=(s,c,p)=>{const _=new Map,S={platform:SR,...p},A={...S.platform,_c:_};return $D(s,c,{...S,platform:A})};var LR=typeof document<"u",kR=function(){},w_=LR?Z.useLayoutEffect:kR;function O_(s,c){if(s===c)return!0;if(typeof s!=typeof c)return!1;if(typeof s=="function"&&s.toString()===c.toString())return!0;let p,_,S;if(s&&c&&typeof s=="object"){if(Array.isArray(s)){if(p=s.length,p!==c.length)return!1;for(_=p;_--!==0;)if(!O_(s[_],c[_]))return!1;return!0}if(S=Object.keys(s),p=S.length,p!==Object.keys(c).length)return!1;for(_=p;_--!==0;)if(!{}.hasOwnProperty.call(c,S[_]))return!1;for(_=p;_--!==0;){const A=S[_];if(!(A==="_owner"&&s.$$typeof)&&!O_(s[A],c[A]))return!1}return!0}return s!==s&&c!==c}function O2(s){return typeof window>"u"?1:(s.ownerDocument.defaultView||window).devicePixelRatio||1}function z1(s,c){const p=O2(s);return Math.round(c*p)/p}function ax(s){const c=Z.useRef(s);return w_(()=>{c.current=s}),c}function OR(s){s===void 0&&(s={});const{placement:c="bottom",strategy:p="absolute",middleware:_=[],platform:S,elements:{reference:A,floating:T}={},transform:u=!0,whileElementsMounted:L,open:k}=s,[B,H]=Z.useState({x:0,y:0,strategy:p,placement:c,middlewareData:{},isPositioned:!1}),[W,it]=Z.useState(_);O_(W,_)||it(_);const[pt,rt]=Z.useState(null),[J,mt]=Z.useState(null),Et=Z.useCallback(Gt=>{Gt!==ee.current&&(ee.current=Gt,rt(Gt))},[]),bt=Z.useCallback(Gt=>{Gt!==Nt.current&&(Nt.current=Gt,mt(Gt))},[]),Lt=A||pt,Ot=T||J,ee=Z.useRef(null),Nt=Z.useRef(null),Kt=Z.useRef(B),xe=L!=null,Ae=ax(L),ae=ax(S),ze=ax(k),We=Z.useCallback(()=>{if(!ee.current||!Nt.current)return;const Gt={placement:c,strategy:p,middleware:W};ae.current&&(Gt.platform=ae.current),zR(ee.current,Nt.current,Gt).then(we=>{const He={...we,isPositioned:ze.current!==!1};Ee.current&&!O_(Kt.current,He)&&(Kt.current=He,iy.flushSync(()=>{H(He)}))})},[W,c,p,ae,ze]);w_(()=>{k===!1&&Kt.current.isPositioned&&(Kt.current.isPositioned=!1,H(Gt=>({...Gt,isPositioned:!1})))},[k]);const Ee=Z.useRef(!1);w_(()=>(Ee.current=!0,()=>{Ee.current=!1}),[]),w_(()=>{if(Lt&&(ee.current=Lt),Ot&&(Nt.current=Ot),Lt&&Ot){if(Ae.current)return Ae.current(Lt,Ot,We);We()}},[Lt,Ot,We,Ae,xe]);const me=Z.useMemo(()=>({reference:ee,floating:Nt,setReference:Et,setFloating:bt}),[Et,bt]),jt=Z.useMemo(()=>({reference:Lt,floating:Ot}),[Lt,Ot]),Qt=Z.useMemo(()=>{const Gt={position:p,left:0,top:0};if(!jt.floating)return Gt;const we=z1(jt.floating,B.x),He=z1(jt.floating,B.y);return u?{...Gt,transform:"translate("+we+"px, "+He+"px)",...O2(jt.floating)>=1.5&&{willChange:"transform"}}:{position:p,left:we,top:He}},[p,u,jt.floating,B.x,B.y]);return Z.useMemo(()=>({...B,update:We,refs:me,elements:jt,floatingStyles:Qt}),[B,We,me,jt,Qt])}const NR=s=>{function c(p){return{}.hasOwnProperty.call(p,"current")}return{name:"arrow",options:s,fn(p){const{element:_,padding:S}=typeof s=="function"?s(p):s;return _&&c(_)?_.current!=null?I1({element:_.current,padding:S}).fn(p):{}:_?I1({element:_,padding:S}).fn(p):{}}}},FR=(s,c)=>({...AR(s),options:[s,c]}),jR=(s,c)=>({...MR(s),options:[s,c]}),BR=(s,c)=>({...IR(s),options:[s,c]}),VR=(s,c)=>({...PR(s),options:[s,c]}),UR=(s,c)=>({...DR(s),options:[s,c]}),GR=(s,c)=>({...RR(s),options:[s,c]}),qR=(s,c)=>({...NR(s),options:[s,c]});var ZR="Arrow",N2=Z.forwardRef((s,c)=>{const{children:p,width:_=10,height:S=5,...A}=s;return F.jsx($r.svg,{...A,ref:c,width:_,height:S,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:s.asChild?p:F.jsx("polygon",{points:"0,0 30,0 15,10"})})});N2.displayName=ZR;var $R=N2;function HR(s){const[c,p]=Z.useState(void 0);return Bs(()=>{if(s){p({width:s.offsetWidth,height:s.offsetHeight});const _=new ResizeObserver(S=>{if(!Array.isArray(S)||!S.length)return;const A=S[0];let T,u;if("borderBoxSize"in A){const L=A.borderBoxSize,k=Array.isArray(L)?L[0]:L;T=k.inlineSize,u=k.blockSize}else T=s.offsetWidth,u=s.offsetHeight;p({width:T,height:u})});return _.observe(s,{box:"border-box"}),()=>_.unobserve(s)}else p(void 0)},[s]),c}var F2="Popper",[j2,B2]=pm(F2),[NF,V2]=j2(F2),U2="PopperAnchor",G2=Z.forwardRef((s,c)=>{const{__scopePopper:p,virtualRef:_,...S}=s,A=V2(U2,p),T=Z.useRef(null),u=Ui(c,T),L=Z.useRef(null);return Z.useEffect(()=>{const k=L.current;L.current=_?.current||T.current,k!==L.current&&A.onAnchorChange(L.current)}),_?null:F.jsx($r.div,{...S,ref:u})});G2.displayName=U2;var k0="PopperContent",[XR,YR]=j2(k0),q2=Z.forwardRef((s,c)=>{const{__scopePopper:p,side:_="bottom",sideOffset:S=0,align:A="center",alignOffset:T=0,arrowPadding:u=0,avoidCollisions:L=!0,collisionBoundary:k=[],collisionPadding:B=0,sticky:H="partial",hideWhenDetached:W=!1,updatePositionStrategy:it="optimized",onPlaced:pt,...rt}=s,J=V2(k0,p),[mt,Et]=Z.useState(null),bt=Ui(c,Le=>Et(Le)),[Lt,Ot]=Z.useState(null),ee=HR(Lt),Nt=ee?.width??0,Kt=ee?.height??0,xe=_+(A!=="center"?"-"+A:""),Ae=typeof B=="number"?B:{top:0,right:0,bottom:0,left:0,...B},ae=Array.isArray(k)?k:[k],ze=ae.length>0,We={padding:Ae,boundary:ae.filter(KR),altBoundary:ze},{refs:Ee,floatingStyles:me,placement:jt,isPositioned:Qt,middlewareData:Gt}=OR({strategy:"fixed",placement:xe,whileElementsMounted:(...Le)=>CR(...Le,{animationFrame:it==="always"}),elements:{reference:J.anchor},middleware:[FR({mainAxis:S+Kt,alignmentAxis:T}),L&&jR({mainAxis:!0,crossAxis:!1,limiter:H==="partial"?BR():void 0,...We}),L&&VR({...We}),UR({...We,apply:({elements:Le,rects:yn,availableWidth:Mn,availableHeight:Gi})=>{const{width:br,height:Ci}=yn.reference,Vs=Le.floating.style;Vs.setProperty("--radix-popper-available-width",`${Mn}px`),Vs.setProperty("--radix-popper-available-height",`${Gi}px`),Vs.setProperty("--radix-popper-anchor-width",`${br}px`),Vs.setProperty("--radix-popper-anchor-height",`${Ci}px`)}}),Lt&&qR({element:Lt,padding:u}),QR({arrowWidth:Nt,arrowHeight:Kt}),W&&GR({strategy:"referenceHidden",...We})]}),[we,He]=H2(jt),Rt=cr(pt);Bs(()=>{Qt&&Rt?.()},[Qt,Rt]);const se=Gt.arrow?.x,be=Gt.arrow?.y,Te=Gt.arrow?.centerOffset!==0,[Ze,$e]=Z.useState();return Bs(()=>{mt&&$e(window.getComputedStyle(mt).zIndex)},[mt]),F.jsx("div",{ref:Ee.setFloating,"data-radix-popper-content-wrapper":"",style:{...me,transform:Qt?me.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Ze,"--radix-popper-transform-origin":[Gt.transformOrigin?.x,Gt.transformOrigin?.y].join(" "),...Gt.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:s.dir,children:F.jsx(XR,{scope:p,placedSide:we,onArrowChange:Ot,arrowX:se,arrowY:be,shouldHideArrow:Te,children:F.jsx($r.div,{"data-side":we,"data-align":He,...rt,ref:bt,style:{...rt.style,animation:Qt?void 0:"none"}})})})});q2.displayName=k0;var Z2="PopperArrow",WR={top:"bottom",right:"left",bottom:"top",left:"right"},$2=Z.forwardRef(function(c,p){const{__scopePopper:_,...S}=c,A=YR(Z2,_),T=WR[A.placedSide];return F.jsx("span",{ref:A.onArrowChange,style:{position:"absolute",left:A.arrowX,top:A.arrowY,[T]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[A.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[A.placedSide],visibility:A.shouldHideArrow?"hidden":void 0},children:F.jsx($R,{...S,ref:p,style:{...S.style,display:"block"}})})});$2.displayName=Z2;function KR(s){return s!==null}var QR=s=>({name:"transformOrigin",options:s,fn(c){const{placement:p,rects:_,middlewareData:S}=c,T=S.arrow?.centerOffset!==0,u=T?0:s.arrowWidth,L=T?0:s.arrowHeight,[k,B]=H2(p),H={start:"0%",center:"50%",end:"100%"}[B],W=(S.arrow?.x??0)+u/2,it=(S.arrow?.y??0)+L/2;let pt="",rt="";return k==="bottom"?(pt=T?H:`${W}px`,rt=`${-L}px`):k==="top"?(pt=T?H:`${W}px`,rt=`${_.floating.height+L}px`):k==="right"?(pt=`${-L}px`,rt=T?H:`${it}px`):k==="left"&&(pt=`${_.floating.width+L}px`,rt=T?H:`${it}px`),{data:{x:pt,y:rt}}}});function H2(s){const[c,p="center"]=s.split("-");return[c,p]}var JR=G2,tI=q2,eI=$2,nI="Portal",O0=Z.forwardRef((s,c)=>{const{container:p,..._}=s,[S,A]=Z.useState(!1);Bs(()=>A(!0),[]);const T=p||S&&globalThis?.document?.body;return T?MT.createPortal(F.jsx($r.div,{..._,ref:c}),T):null});O0.displayName=nI;function iI(s,c){return Z.useReducer((p,_)=>c[p][_]??p,s)}var tu=s=>{const{present:c,children:p}=s,_=rI(c),S=typeof p=="function"?p({present:_.isPresent}):Z.Children.only(p),A=Ui(_.ref,sI(S));return typeof p=="function"||_.isPresent?Z.cloneElement(S,{ref:A}):null};tu.displayName="Presence";function rI(s){const[c,p]=Z.useState(),_=Z.useRef(null),S=Z.useRef(s),A=Z.useRef("none"),T=s?"mounted":"unmounted",[u,L]=iI(T,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return Z.useEffect(()=>{const k=u_(_.current);A.current=u==="mounted"?k:"none"},[u]),Bs(()=>{const k=_.current,B=S.current;if(B!==s){const W=A.current,it=u_(k);s?L("MOUNT"):it==="none"||k?.display==="none"?L("UNMOUNT"):L(B&&W!==it?"ANIMATION_OUT":"UNMOUNT"),S.current=s}},[s,L]),Bs(()=>{if(c){let k;const B=c.ownerDocument.defaultView??window,H=it=>{const rt=u_(_.current).includes(CSS.escape(it.animationName));if(it.target===c&&rt&&(L("ANIMATION_END"),!S.current)){const J=c.style.animationFillMode;c.style.animationFillMode="forwards",k=B.setTimeout(()=>{c.style.animationFillMode==="forwards"&&(c.style.animationFillMode=J)})}},W=it=>{it.target===c&&(A.current=u_(_.current))};return c.addEventListener("animationstart",W),c.addEventListener("animationcancel",H),c.addEventListener("animationend",H),()=>{B.clearTimeout(k),c.removeEventListener("animationstart",W),c.removeEventListener("animationcancel",H),c.removeEventListener("animationend",H)}}else L("ANIMATION_END")},[c,L]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:Z.useCallback(k=>{_.current=k?getComputedStyle(k):null,p(k)},[])}}function u_(s){return s?.animationName||"none"}function sI(s){let c=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,p=c&&"isReactWarning"in c&&c.isReactWarning;return p?s.ref:(c=Object.getOwnPropertyDescriptor(s,"ref")?.get,p=c&&"isReactWarning"in c&&c.isReactWarning,p?s.props.ref:s.props.ref||s.ref)}var aI=Symbol("radix.slottable");function oI(s){const c=({children:p})=>F.jsx(F.Fragment,{children:p});return c.displayName=`${s}.Slottable`,c.__radixId=aI,c}var lI=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),cI="VisuallyHidden",X2=Z.forwardRef((s,c)=>F.jsx($r.span,{...s,ref:c,style:{...lI,...s.style}}));X2.displayName=cI;var uI=X2,[rv]=pm("Tooltip",[B2]),N0=B2(),Y2="TooltipProvider",hI=700,L1="tooltip.open",[dI,W2]=rv(Y2),K2=s=>{const{__scopeTooltip:c,delayDuration:p=hI,skipDelayDuration:_=300,disableHoverableContent:S=!1,children:A}=s,T=Z.useRef(!0),u=Z.useRef(!1),L=Z.useRef(0);return Z.useEffect(()=>{const k=L.current;return()=>window.clearTimeout(k)},[]),F.jsx(dI,{scope:c,isOpenDelayedRef:T,delayDuration:p,onOpen:Z.useCallback(()=>{window.clearTimeout(L.current),T.current=!1},[]),onClose:Z.useCallback(()=>{window.clearTimeout(L.current),L.current=window.setTimeout(()=>T.current=!0,_)},[_]),isPointerInTransitRef:u,onPointerInTransitChange:Z.useCallback(k=>{u.current=k},[]),disableHoverableContent:S,children:A})};K2.displayName=Y2;var Q2="Tooltip",[FF,oy]=rv(Q2),qx="TooltipTrigger",fI=Z.forwardRef((s,c)=>{const{__scopeTooltip:p,..._}=s,S=oy(qx,p),A=W2(qx,p),T=N0(p),u=Z.useRef(null),L=Ui(c,u,S.onTriggerChange),k=Z.useRef(!1),B=Z.useRef(!1),H=Z.useCallback(()=>k.current=!1,[]);return Z.useEffect(()=>()=>document.removeEventListener("pointerup",H),[H]),F.jsx(JR,{asChild:!0,...T,children:F.jsx($r.button,{"aria-describedby":S.open?S.contentId:void 0,"data-state":S.stateAttribute,..._,ref:L,onPointerMove:Yp(s.onPointerMove,W=>{W.pointerType!=="touch"&&!B.current&&!A.isPointerInTransitRef.current&&(S.onTriggerEnter(),B.current=!0)}),onPointerLeave:Yp(s.onPointerLeave,()=>{S.onTriggerLeave(),B.current=!1}),onPointerDown:Yp(s.onPointerDown,()=>{S.open&&S.onClose(),k.current=!0,document.addEventListener("pointerup",H,{once:!0})}),onFocus:Yp(s.onFocus,()=>{k.current||S.onOpen()}),onBlur:Yp(s.onBlur,S.onClose),onClick:Yp(s.onClick,S.onClose)})})});fI.displayName=qx;var F0="TooltipPortal",[pI,mI]=rv(F0,{forceMount:void 0}),J2=s=>{const{__scopeTooltip:c,forceMount:p,children:_,container:S}=s,A=oy(F0,c);return F.jsx(pI,{scope:c,forceMount:p,children:F.jsx(tu,{present:p||A.open,children:F.jsx(O0,{asChild:!0,container:S,children:_})})})};J2.displayName=F0;var um="TooltipContent",tS=Z.forwardRef((s,c)=>{const p=mI(um,s.__scopeTooltip),{forceMount:_=p.forceMount,side:S="top",...A}=s,T=oy(um,s.__scopeTooltip);return F.jsx(tu,{present:_||T.open,children:T.disableHoverableContent?F.jsx(eS,{side:S,...A,ref:c}):F.jsx(gI,{side:S,...A,ref:c})})}),gI=Z.forwardRef((s,c)=>{const p=oy(um,s.__scopeTooltip),_=W2(um,s.__scopeTooltip),S=Z.useRef(null),A=Ui(c,S),[T,u]=Z.useState(null),{trigger:L,onClose:k}=p,B=S.current,{onPointerInTransitChange:H}=_,W=Z.useCallback(()=>{u(null),H(!1)},[H]),it=Z.useCallback((pt,rt)=>{const J=pt.currentTarget,mt={x:pt.clientX,y:pt.clientY},Et=bI(mt,J.getBoundingClientRect()),bt=wI(mt,Et),Lt=TI(rt.getBoundingClientRect()),Ot=EI([...bt,...Lt]);u(Ot),H(!0)},[H]);return Z.useEffect(()=>()=>W(),[W]),Z.useEffect(()=>{if(L&&B){const pt=J=>it(J,B),rt=J=>it(J,L);return L.addEventListener("pointerleave",pt),B.addEventListener("pointerleave",rt),()=>{L.removeEventListener("pointerleave",pt),B.removeEventListener("pointerleave",rt)}}},[L,B,it,W]),Z.useEffect(()=>{if(T){const pt=rt=>{const J=rt.target,mt={x:rt.clientX,y:rt.clientY},Et=L?.contains(J)||B?.contains(J),bt=!SI(mt,T);Et?W():bt&&(W(),k())};return document.addEventListener("pointermove",pt),()=>document.removeEventListener("pointermove",pt)}},[L,B,T,k,W]),F.jsx(eS,{...s,ref:A})}),[yI,_I]=rv(Q2,{isInside:!1}),vI=oI("TooltipContent"),eS=Z.forwardRef((s,c)=>{const{__scopeTooltip:p,children:_,"aria-label":S,onEscapeKeyDown:A,onPointerDownOutside:T,...u}=s,L=oy(um,p),k=N0(p),{onClose:B}=L;return Z.useEffect(()=>(document.addEventListener(L1,B),()=>document.removeEventListener(L1,B)),[B]),Z.useEffect(()=>{if(L.trigger){const H=W=>{W.target?.contains(L.trigger)&&B()};return window.addEventListener("scroll",H,{capture:!0}),()=>window.removeEventListener("scroll",H,{capture:!0})}},[L.trigger,B]),F.jsx(M0,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:A,onPointerDownOutside:T,onFocusOutside:H=>H.preventDefault(),onDismiss:B,children:F.jsxs(tI,{"data-state":L.stateAttribute,...k,...u,ref:c,style:{...u.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[F.jsx(vI,{children:_}),F.jsx(yI,{scope:p,isInside:!0,children:F.jsx(uI,{id:L.contentId,role:"tooltip",children:S||_})})]})})});tS.displayName=um;var nS="TooltipArrow",xI=Z.forwardRef((s,c)=>{const{__scopeTooltip:p,..._}=s,S=N0(p);return _I(nS,p).isInside?null:F.jsx(eI,{...S,..._,ref:c})});xI.displayName=nS;function bI(s,c){const p=Math.abs(c.top-s.y),_=Math.abs(c.bottom-s.y),S=Math.abs(c.right-s.x),A=Math.abs(c.left-s.x);switch(Math.min(p,_,S,A)){case A:return"left";case S:return"right";case p:return"top";case _:return"bottom";default:throw new Error("unreachable")}}function wI(s,c,p=5){const _=[];switch(c){case"top":_.push({x:s.x-p,y:s.y+p},{x:s.x+p,y:s.y+p});break;case"bottom":_.push({x:s.x-p,y:s.y-p},{x:s.x+p,y:s.y-p});break;case"left":_.push({x:s.x+p,y:s.y-p},{x:s.x+p,y:s.y+p});break;case"right":_.push({x:s.x-p,y:s.y-p},{x:s.x-p,y:s.y+p});break}return _}function TI(s){const{top:c,right:p,bottom:_,left:S}=s;return[{x:S,y:c},{x:p,y:c},{x:p,y:_},{x:S,y:_}]}function SI(s,c){const{x:p,y:_}=s;let S=!1;for(let A=0,T=c.length-1;A<c.length;T=A++){const u=c[A],L=c[T],k=u.x,B=u.y,H=L.x,W=L.y;B>_!=W>_&&p<(H-k)*(_-B)/(W-B)+k&&(S=!S)}return S}function EI(s){const c=s.slice();return c.sort((p,_)=>p.x<_.x?-1:p.x>_.x?1:p.y<_.y?-1:p.y>_.y?1:0),CI(c)}function CI(s){if(s.length<=1)return s.slice();const c=[];for(let _=0;_<s.length;_++){const S=s[_];for(;c.length>=2;){const A=c[c.length-1],T=c[c.length-2];if((A.x-T.x)*(S.y-T.y)>=(A.y-T.y)*(S.x-T.x))c.pop();else break}c.push(S)}c.pop();const p=[];for(let _=s.length-1;_>=0;_--){const S=s[_];for(;p.length>=2;){const A=p[p.length-1],T=p[p.length-2];if((A.x-T.x)*(S.y-T.y)>=(A.y-T.y)*(S.x-T.x))p.pop();else break}p.push(S)}return p.pop(),c.length===1&&p.length===1&&c[0].x===p[0].x&&c[0].y===p[0].y?c:c.concat(p)}var AI=K2,MI=J2,iS=tS;const PI=AI,DI=Z.forwardRef(({className:s,sideOffset:c=4,...p},_)=>F.jsx(MI,{children:F.jsx(iS,{ref:_,sideOffset:c,className:Rn("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",s),...p})}));DI.displayName=iS.displayName;const Ql=Z.forwardRef(({className:s,...c},p)=>F.jsx("div",{ref:p,className:Rn("rounded-xl border bg-card text-card-foreground shadow",s),...c}));Ql.displayName="Card";const T_=Z.forwardRef(({className:s,...c},p)=>F.jsx("div",{ref:p,className:Rn("flex flex-col space-y-1.5 p-6",s),...c}));T_.displayName="CardHeader";const S_=Z.forwardRef(({className:s,...c},p)=>F.jsx("div",{ref:p,className:Rn("font-semibold leading-none tracking-tight",s),...c}));S_.displayName="CardTitle";const RI=Z.forwardRef(({className:s,...c},p)=>F.jsx("div",{ref:p,className:Rn("text-sm text-muted-foreground",s),...c}));RI.displayName="CardDescription";const sm=Z.forwardRef(({className:s,...c},p)=>F.jsx("div",{ref:p,className:Rn("p-6 pt-0",s),...c}));sm.displayName="CardContent";const II=Z.forwardRef(({className:s,...c},p)=>F.jsx("div",{ref:p,className:Rn("flex items-center p-6 pt-0",s),...c}));II.displayName="CardFooter";function zI(){return F.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:F.jsx(Ql,{className:"w-full max-w-md mx-4",children:F.jsxs(sm,{className:"pt-6",children:[F.jsxs("div",{className:"flex mb-4 gap-2",children:[F.jsx(s2,{className:"h-8 w-8 text-red-500"}),F.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),F.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}const rS=Z.createContext(void 0),k1={name:"",country:"",interests:[],companions:[],currentTripName:"",currentTripId:"",isOnboarded:!1,trips:[]};function LI({children:s}){const[c,p]=Z.useState(k1),[_,S]=Z.useState(null),[A,T]=Z.useState(null);Z.useEffect(()=>{const bt=localStorage.getItem("sessionId"),Lt=localStorage.getItem("user");bt&&Lt&&(T(bt),S(JSON.parse(Lt)))},[]);const u=bt=>{p(Lt=>({...Lt,...bt}))},L=bt=>{p(Lt=>({...Lt,interests:Lt.interests.includes(bt)?Lt.interests.filter(Ot=>Ot!==bt):[...Lt.interests,bt]}))},k=bt=>{p(Lt=>({...Lt,companions:[...Lt.companions,bt]}))},B=bt=>{p(Lt=>({...Lt,companions:Lt.companions.filter((Ot,ee)=>ee!==bt)}))},H=()=>{const bt={id:Math.random().toString(36).substr(2,9),name:c.currentTripName,country:c.country,interests:c.interests,companions:c.companions};p(Lt=>({...Lt,isOnboarded:!0,currentTripId:bt.id,trips:[...Lt.trips,bt]}))},W=()=>{p(bt=>({...bt,name:"",country:"",interests:[],companions:[],currentTripName:"",currentTripId:"",isOnboarded:!1}))},it=bt=>{const Lt=c.trips.find(Ot=>Ot.id===bt);Lt&&p(Ot=>({...Ot,currentTripId:Lt.id,currentTripName:Lt.name,country:Lt.country,interests:Lt.interests,companions:Lt.companions}))},pt=(bt,Lt)=>{T(bt),S(Lt),localStorage.setItem("sessionId",bt),localStorage.setItem("user",JSON.stringify(Lt))},rt=()=>{T(null),S(null),p(k1),localStorage.removeItem("sessionId"),localStorage.removeItem("user")},J=bt=>{p(Lt=>{const Ot=Lt.trips.map(ee=>ee.id===Lt.currentTripId?{...ee,savedPlaces:(ee.savedPlaces||[]).map(Nt=>Nt.id===bt?{...Nt,isFavorite:!Nt.isFavorite}:Nt)}:ee);return{...Lt,trips:Ot}})},mt=bt=>c.trips.find(Ot=>Ot.id===c.currentTripId)?.savedPlaces?.some(Ot=>Ot.id===bt&&Ot.isFavorite)||!1,Et=(bt,Lt)=>{p(Ot=>({...Ot,companions:Ot.companions.map((ee,Nt)=>Nt===bt?Lt:ee)}))};return F.jsx(rS.Provider,{value:{profile:c,user:_,sessionId:A,isAuthenticated:!!A&&!!_,updateProfile:u,toggleInterest:L,addCompanion:k,removeCompanion:B,completeOnboarding:H,createNewTrip:W,loadTrip:it,setSession:pt,logout:rt,toggleFavorite:J,isFavorite:mt,updateCompanion:Et},children:s})}function Vf(){const s=Z.useContext(rS);if(!s)throw new Error("useUser must be used within UserProvider");return s}const j0=Z.createContext({});function B0(s){const c=Z.useRef(null);return c.current===null&&(c.current=s()),c.current}const V0=typeof window<"u",sS=V0?Z.useLayoutEffect:Z.useEffect,sv=Z.createContext(null);function U0(s,c){s.indexOf(c)===-1&&s.push(c)}function G0(s,c){const p=s.indexOf(c);p>-1&&s.splice(p,1)}const ah=(s,c,p)=>p>c?c:p<s?s:p;let q0=()=>{};const oh={},aS=s=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(s);function oS(s){return typeof s=="object"&&s!==null}const lS=s=>/^0[^.\s]+$/u.test(s);function Z0(s){let c;return()=>(c===void 0&&(c=s()),c)}const sl=s=>s,kI=(s,c)=>p=>c(s(p)),ly=(...s)=>s.reduce(kI),Yg=(s,c,p)=>{const _=c-s;return _===0?1:(p-s)/_};class $0{constructor(){this.subscriptions=[]}add(c){return U0(this.subscriptions,c),()=>G0(this.subscriptions,c)}notify(c,p,_){const S=this.subscriptions.length;if(S)if(S===1)this.subscriptions[0](c,p,_);else for(let A=0;A<S;A++){const T=this.subscriptions[A];T&&T(c,p,_)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Xc=s=>s*1e3,rl=s=>s/1e3;function cS(s,c){return c?s*(1e3/c):0}const uS=(s,c,p)=>(((1-3*p+3*c)*s+(3*p-6*c))*s+3*c)*s,OI=1e-7,NI=12;function FI(s,c,p,_,S){let A,T,u=0;do T=c+(p-c)/2,A=uS(T,_,S)-s,A>0?p=T:c=T;while(Math.abs(A)>OI&&++u<NI);return T}function cy(s,c,p,_){if(s===c&&p===_)return sl;const S=A=>FI(A,0,1,s,p);return A=>A===0||A===1?A:uS(S(A),c,_)}const hS=s=>c=>c<=.5?s(2*c)/2:(2-s(2*(1-c)))/2,dS=s=>c=>1-s(1-c),fS=cy(.33,1.53,.69,.99),H0=dS(fS),pS=hS(H0),mS=s=>(s*=2)<1?.5*H0(s):.5*(2-Math.pow(2,-10*(s-1))),X0=s=>1-Math.sin(Math.acos(s)),gS=dS(X0),yS=hS(X0),jI=cy(.42,0,1,1),BI=cy(0,0,.58,1),_S=cy(.42,0,.58,1),VI=s=>Array.isArray(s)&&typeof s[0]!="number",vS=s=>Array.isArray(s)&&typeof s[0]=="number",UI={linear:sl,easeIn:jI,easeInOut:_S,easeOut:BI,circIn:X0,circInOut:yS,circOut:gS,backIn:H0,backInOut:pS,backOut:fS,anticipate:mS},GI=s=>typeof s=="string",O1=s=>{if(vS(s)){q0(s.length===4);const[c,p,_,S]=s;return cy(c,p,_,S)}else if(GI(s))return UI[s];return s},h_=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function qI(s,c){let p=new Set,_=new Set,S=!1,A=!1;const T=new WeakSet;let u={delta:0,timestamp:0,isProcessing:!1};function L(B){T.has(B)&&(k.schedule(B),s()),B(u)}const k={schedule:(B,H=!1,W=!1)=>{const pt=W&&S?p:_;return H&&T.add(B),pt.has(B)||pt.add(B),B},cancel:B=>{_.delete(B),T.delete(B)},process:B=>{if(u=B,S){A=!0;return}S=!0,[p,_]=[_,p],p.forEach(L),p.clear(),S=!1,A&&(A=!1,k.process(B))}};return k}const ZI=40;function xS(s,c){let p=!1,_=!0;const S={delta:0,timestamp:0,isProcessing:!1},A=()=>p=!0,T=h_.reduce((bt,Lt)=>(bt[Lt]=qI(A),bt),{}),{setup:u,read:L,resolveKeyframes:k,preUpdate:B,update:H,preRender:W,render:it,postRender:pt}=T,rt=()=>{const bt=oh.useManualTiming?S.timestamp:performance.now();p=!1,oh.useManualTiming||(S.delta=_?1e3/60:Math.max(Math.min(bt-S.timestamp,ZI),1)),S.timestamp=bt,S.isProcessing=!0,u.process(S),L.process(S),k.process(S),B.process(S),H.process(S),W.process(S),it.process(S),pt.process(S),S.isProcessing=!1,p&&c&&(_=!1,s(rt))},J=()=>{p=!0,_=!0,S.isProcessing||s(rt)};return{schedule:h_.reduce((bt,Lt)=>{const Ot=T[Lt];return bt[Lt]=(ee,Nt=!1,Kt=!1)=>(p||J(),Ot.schedule(ee,Nt,Kt)),bt},{}),cancel:bt=>{for(let Lt=0;Lt<h_.length;Lt++)T[h_[Lt]].cancel(bt)},state:S,steps:T}}const{schedule:Vi,cancel:yd,state:ws,steps:ox}=xS(typeof requestAnimationFrame<"u"?requestAnimationFrame:sl,!0);let E_;function $I(){E_=void 0}const Ua={now:()=>(E_===void 0&&Ua.set(ws.isProcessing||oh.useManualTiming?ws.timestamp:performance.now()),E_),set:s=>{E_=s,queueMicrotask($I)}},bS=s=>c=>typeof c=="string"&&c.startsWith(s),Y0=bS("--"),HI=bS("var(--"),W0=s=>HI(s)?XI.test(s.split("/*")[0].trim()):!1,XI=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,xm={test:s=>typeof s=="number",parse:parseFloat,transform:s=>s},Wg={...xm,transform:s=>ah(0,1,s)},d_={...xm,default:1},Fg=s=>Math.round(s*1e5)/1e5,K0=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function YI(s){return s==null}const WI=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Q0=(s,c)=>p=>!!(typeof p=="string"&&WI.test(p)&&p.startsWith(s)||c&&!YI(p)&&Object.prototype.hasOwnProperty.call(p,c)),wS=(s,c,p)=>_=>{if(typeof _!="string")return _;const[S,A,T,u]=_.match(K0);return{[s]:parseFloat(S),[c]:parseFloat(A),[p]:parseFloat(T),alpha:u!==void 0?parseFloat(u):1}},KI=s=>ah(0,255,s),lx={...xm,transform:s=>Math.round(KI(s))},Lf={test:Q0("rgb","red"),parse:wS("red","green","blue"),transform:({red:s,green:c,blue:p,alpha:_=1})=>"rgba("+lx.transform(s)+", "+lx.transform(c)+", "+lx.transform(p)+", "+Fg(Wg.transform(_))+")"};function QI(s){let c="",p="",_="",S="";return s.length>5?(c=s.substring(1,3),p=s.substring(3,5),_=s.substring(5,7),S=s.substring(7,9)):(c=s.substring(1,2),p=s.substring(2,3),_=s.substring(3,4),S=s.substring(4,5),c+=c,p+=p,_+=_,S+=S),{red:parseInt(c,16),green:parseInt(p,16),blue:parseInt(_,16),alpha:S?parseInt(S,16)/255:1}}const Zx={test:Q0("#"),parse:QI,transform:Lf.transform},uy=s=>({test:c=>typeof c=="string"&&c.endsWith(s)&&c.split(" ").length===1,parse:parseFloat,transform:c=>`${c}${s}`}),fd=uy("deg"),Yc=uy("%"),sn=uy("px"),JI=uy("vh"),tz=uy("vw"),N1={...Yc,parse:s=>Yc.parse(s)/100,transform:s=>Yc.transform(s*100)},Jp={test:Q0("hsl","hue"),parse:wS("hue","saturation","lightness"),transform:({hue:s,saturation:c,lightness:p,alpha:_=1})=>"hsla("+Math.round(s)+", "+Yc.transform(Fg(c))+", "+Yc.transform(Fg(p))+", "+Fg(Wg.transform(_))+")"},Rr={test:s=>Lf.test(s)||Zx.test(s)||Jp.test(s),parse:s=>Lf.test(s)?Lf.parse(s):Jp.test(s)?Jp.parse(s):Zx.parse(s),transform:s=>typeof s=="string"?s:s.hasOwnProperty("red")?Lf.transform(s):Jp.transform(s),getAnimatableNone:s=>{const c=Rr.parse(s);return c.alpha=0,Rr.transform(c)}},ez=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function nz(s){return isNaN(s)&&typeof s=="string"&&(s.match(K0)?.length||0)+(s.match(ez)?.length||0)>0}const TS="number",SS="color",iz="var",rz="var(",F1="${}",sz=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Kg(s){const c=s.toString(),p=[],_={color:[],number:[],var:[]},S=[];let A=0;const u=c.replace(sz,L=>(Rr.test(L)?(_.color.push(A),S.push(SS),p.push(Rr.parse(L))):L.startsWith(rz)?(_.var.push(A),S.push(iz),p.push(L)):(_.number.push(A),S.push(TS),p.push(parseFloat(L))),++A,F1)).split(F1);return{values:p,split:u,indexes:_,types:S}}function ES(s){return Kg(s).values}function CS(s){const{split:c,types:p}=Kg(s),_=c.length;return S=>{let A="";for(let T=0;T<_;T++)if(A+=c[T],S[T]!==void 0){const u=p[T];u===TS?A+=Fg(S[T]):u===SS?A+=Rr.transform(S[T]):A+=S[T]}return A}}const az=s=>typeof s=="number"?0:Rr.test(s)?Rr.getAnimatableNone(s):s;function oz(s){const c=ES(s);return CS(s)(c.map(az))}const _d={test:nz,parse:ES,createTransformer:CS,getAnimatableNone:oz};function cx(s,c,p){return p<0&&(p+=1),p>1&&(p-=1),p<1/6?s+(c-s)*6*p:p<1/2?c:p<2/3?s+(c-s)*(2/3-p)*6:s}function lz({hue:s,saturation:c,lightness:p,alpha:_}){s/=360,c/=100,p/=100;let S=0,A=0,T=0;if(!c)S=A=T=p;else{const u=p<.5?p*(1+c):p+c-p*c,L=2*p-u;S=cx(L,u,s+1/3),A=cx(L,u,s),T=cx(L,u,s-1/3)}return{red:Math.round(S*255),green:Math.round(A*255),blue:Math.round(T*255),alpha:_}}function N_(s,c){return p=>p>0?c:s}const er=(s,c,p)=>s+(c-s)*p,ux=(s,c,p)=>{const _=s*s,S=p*(c*c-_)+_;return S<0?0:Math.sqrt(S)},cz=[Zx,Lf,Jp],uz=s=>cz.find(c=>c.test(s));function j1(s){const c=uz(s);if(!c)return!1;let p=c.parse(s);return c===Jp&&(p=lz(p)),p}const B1=(s,c)=>{const p=j1(s),_=j1(c);if(!p||!_)return N_(s,c);const S={...p};return A=>(S.red=ux(p.red,_.red,A),S.green=ux(p.green,_.green,A),S.blue=ux(p.blue,_.blue,A),S.alpha=er(p.alpha,_.alpha,A),Lf.transform(S))},$x=new Set(["none","hidden"]);function hz(s,c){return $x.has(s)?p=>p<=0?s:c:p=>p>=1?c:s}function dz(s,c){return p=>er(s,c,p)}function J0(s){return typeof s=="number"?dz:typeof s=="string"?W0(s)?N_:Rr.test(s)?B1:mz:Array.isArray(s)?AS:typeof s=="object"?Rr.test(s)?B1:fz:N_}function AS(s,c){const p=[...s],_=p.length,S=s.map((A,T)=>J0(A)(A,c[T]));return A=>{for(let T=0;T<_;T++)p[T]=S[T](A);return p}}function fz(s,c){const p={...s,...c},_={};for(const S in p)s[S]!==void 0&&c[S]!==void 0&&(_[S]=J0(s[S])(s[S],c[S]));return S=>{for(const A in _)p[A]=_[A](S);return p}}function pz(s,c){const p=[],_={color:0,var:0,number:0};for(let S=0;S<c.values.length;S++){const A=c.types[S],T=s.indexes[A][_[A]],u=s.values[T]??0;p[S]=u,_[A]++}return p}const mz=(s,c)=>{const p=_d.createTransformer(c),_=Kg(s),S=Kg(c);return _.indexes.var.length===S.indexes.var.length&&_.indexes.color.length===S.indexes.color.length&&_.indexes.number.length>=S.indexes.number.length?$x.has(s)&&!S.values.length||$x.has(c)&&!_.values.length?hz(s,c):ly(AS(pz(_,S),S.values),p):N_(s,c)};function MS(s,c,p){return typeof s=="number"&&typeof c=="number"&&typeof p=="number"?er(s,c,p):J0(s)(s,c)}const gz=s=>{const c=({timestamp:p})=>s(p);return{start:(p=!0)=>Vi.update(c,p),stop:()=>yd(c),now:()=>ws.isProcessing?ws.timestamp:Ua.now()}},PS=(s,c,p=10)=>{let _="";const S=Math.max(Math.round(c/p),2);for(let A=0;A<S;A++)_+=Math.round(s(A/(S-1))*1e4)/1e4+", ";return`linear(${_.substring(0,_.length-2)})`},F_=2e4;function tb(s){let c=0;const p=50;let _=s.next(c);for(;!_.done&&c<F_;)c+=p,_=s.next(c);return c>=F_?1/0:c}function yz(s,c=100,p){const _=p({...s,keyframes:[0,c]}),S=Math.min(tb(_),F_);return{type:"keyframes",ease:A=>_.next(S*A).value/c,duration:rl(S)}}const _z=5;function DS(s,c,p){const _=Math.max(c-_z,0);return cS(p-s(_),c-_)}const lr={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},hx=.001;function vz({duration:s=lr.duration,bounce:c=lr.bounce,velocity:p=lr.velocity,mass:_=lr.mass}){let S,A,T=1-c;T=ah(lr.minDamping,lr.maxDamping,T),s=ah(lr.minDuration,lr.maxDuration,rl(s)),T<1?(S=k=>{const B=k*T,H=B*s,W=B-p,it=Hx(k,T),pt=Math.exp(-H);return hx-W/it*pt},A=k=>{const H=k*T*s,W=H*p+p,it=Math.pow(T,2)*Math.pow(k,2)*s,pt=Math.exp(-H),rt=Hx(Math.pow(k,2),T);return(-S(k)+hx>0?-1:1)*((W-it)*pt)/rt}):(S=k=>{const B=Math.exp(-k*s),H=(k-p)*s+1;return-hx+B*H},A=k=>{const B=Math.exp(-k*s),H=(p-k)*(s*s);return B*H});const u=5/s,L=bz(S,A,u);if(s=Xc(s),isNaN(L))return{stiffness:lr.stiffness,damping:lr.damping,duration:s};{const k=Math.pow(L,2)*_;return{stiffness:k,damping:T*2*Math.sqrt(_*k),duration:s}}}const xz=12;function bz(s,c,p){let _=p;for(let S=1;S<xz;S++)_=_-s(_)/c(_);return _}function Hx(s,c){return s*Math.sqrt(1-c*c)}const wz=["duration","bounce"],Tz=["stiffness","damping","mass"];function V1(s,c){return c.some(p=>s[p]!==void 0)}function Sz(s){let c={velocity:lr.velocity,stiffness:lr.stiffness,damping:lr.damping,mass:lr.mass,isResolvedFromDuration:!1,...s};if(!V1(s,Tz)&&V1(s,wz))if(s.visualDuration){const p=s.visualDuration,_=2*Math.PI/(p*1.2),S=_*_,A=2*ah(.05,1,1-(s.bounce||0))*Math.sqrt(S);c={...c,mass:lr.mass,stiffness:S,damping:A}}else{const p=vz(s);c={...c,...p,mass:lr.mass},c.isResolvedFromDuration=!0}return c}function j_(s=lr.visualDuration,c=lr.bounce){const p=typeof s!="object"?{visualDuration:s,keyframes:[0,1],bounce:c}:s;let{restSpeed:_,restDelta:S}=p;const A=p.keyframes[0],T=p.keyframes[p.keyframes.length-1],u={done:!1,value:A},{stiffness:L,damping:k,mass:B,duration:H,velocity:W,isResolvedFromDuration:it}=Sz({...p,velocity:-rl(p.velocity||0)}),pt=W||0,rt=k/(2*Math.sqrt(L*B)),J=T-A,mt=rl(Math.sqrt(L/B)),Et=Math.abs(J)<5;_||(_=Et?lr.restSpeed.granular:lr.restSpeed.default),S||(S=Et?lr.restDelta.granular:lr.restDelta.default);let bt;if(rt<1){const Ot=Hx(mt,rt);bt=ee=>{const Nt=Math.exp(-rt*mt*ee);return T-Nt*((pt+rt*mt*J)/Ot*Math.sin(Ot*ee)+J*Math.cos(Ot*ee))}}else if(rt===1)bt=Ot=>T-Math.exp(-mt*Ot)*(J+(pt+mt*J)*Ot);else{const Ot=mt*Math.sqrt(rt*rt-1);bt=ee=>{const Nt=Math.exp(-rt*mt*ee),Kt=Math.min(Ot*ee,300);return T-Nt*((pt+rt*mt*J)*Math.sinh(Kt)+Ot*J*Math.cosh(Kt))/Ot}}const Lt={calculatedDuration:it&&H||null,next:Ot=>{const ee=bt(Ot);if(it)u.done=Ot>=H;else{let Nt=Ot===0?pt:0;rt<1&&(Nt=Ot===0?Xc(pt):DS(bt,Ot,ee));const Kt=Math.abs(Nt)<=_,xe=Math.abs(T-ee)<=S;u.done=Kt&&xe}return u.value=u.done?T:ee,u},toString:()=>{const Ot=Math.min(tb(Lt),F_),ee=PS(Nt=>Lt.next(Ot*Nt).value,Ot,30);return Ot+"ms "+ee},toTransition:()=>{}};return Lt}j_.applyToOptions=s=>{const c=yz(s,100,j_);return s.ease=c.ease,s.duration=Xc(c.duration),s.type="keyframes",s};function Xx({keyframes:s,velocity:c=0,power:p=.8,timeConstant:_=325,bounceDamping:S=10,bounceStiffness:A=500,modifyTarget:T,min:u,max:L,restDelta:k=.5,restSpeed:B}){const H=s[0],W={done:!1,value:H},it=Kt=>u!==void 0&&Kt<u||L!==void 0&&Kt>L,pt=Kt=>u===void 0?L:L===void 0||Math.abs(u-Kt)<Math.abs(L-Kt)?u:L;let rt=p*c;const J=H+rt,mt=T===void 0?J:T(J);mt!==J&&(rt=mt-H);const Et=Kt=>-rt*Math.exp(-Kt/_),bt=Kt=>mt+Et(Kt),Lt=Kt=>{const xe=Et(Kt),Ae=bt(Kt);W.done=Math.abs(xe)<=k,W.value=W.done?mt:Ae};let Ot,ee;const Nt=Kt=>{it(W.value)&&(Ot=Kt,ee=j_({keyframes:[W.value,pt(W.value)],velocity:DS(bt,Kt,W.value),damping:S,stiffness:A,restDelta:k,restSpeed:B}))};return Nt(0),{calculatedDuration:null,next:Kt=>{let xe=!1;return!ee&&Ot===void 0&&(xe=!0,Lt(Kt),Nt(Kt)),Ot!==void 0&&Kt>=Ot?ee.next(Kt-Ot):(!xe&&Lt(Kt),W)}}}function Ez(s,c,p){const _=[],S=p||oh.mix||MS,A=s.length-1;for(let T=0;T<A;T++){let u=S(s[T],s[T+1]);if(c){const L=Array.isArray(c)?c[T]||sl:c;u=ly(L,u)}_.push(u)}return _}function Cz(s,c,{clamp:p=!0,ease:_,mixer:S}={}){const A=s.length;if(q0(A===c.length),A===1)return()=>c[0];if(A===2&&c[0]===c[1])return()=>c[1];const T=s[0]===s[1];s[0]>s[A-1]&&(s=[...s].reverse(),c=[...c].reverse());const u=Ez(c,_,S),L=u.length,k=B=>{if(T&&B<s[0])return c[0];let H=0;if(L>1)for(;H<s.length-2&&!(B<s[H+1]);H++);const W=Yg(s[H],s[H+1],B);return u[H](W)};return p?B=>k(ah(s[0],s[A-1],B)):k}function Az(s,c){const p=s[s.length-1];for(let _=1;_<=c;_++){const S=Yg(0,c,_);s.push(er(p,1,S))}}function Mz(s){const c=[0];return Az(c,s.length-1),c}function Pz(s,c){return s.map(p=>p*c)}function Dz(s,c){return s.map(()=>c||_S).splice(0,s.length-1)}function jg({duration:s=300,keyframes:c,times:p,ease:_="easeInOut"}){const S=VI(_)?_.map(O1):O1(_),A={done:!1,value:c[0]},T=Pz(p&&p.length===c.length?p:Mz(c),s),u=Cz(T,c,{ease:Array.isArray(S)?S:Dz(c,S)});return{calculatedDuration:s,next:L=>(A.value=u(L),A.done=L>=s,A)}}const Rz=s=>s!==null;function eb(s,{repeat:c,repeatType:p="loop"},_,S=1){const A=s.filter(Rz),u=S<0||c&&p!=="loop"&&c%2===1?0:A.length-1;return!u||_===void 0?A[u]:_}const Iz={decay:Xx,inertia:Xx,tween:jg,keyframes:jg,spring:j_};function RS(s){typeof s.type=="string"&&(s.type=Iz[s.type])}class nb{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(c=>{this.resolve=c})}notifyFinished(){this.resolve()}then(c,p){return this.finished.then(c,p)}}const zz=s=>s/100;class ib extends nb{constructor(c){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:p}=this.options;p&&p.updatedAt!==Ua.now()&&this.tick(Ua.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=c,this.initAnimation(),this.play(),c.autoplay===!1&&this.pause()}initAnimation(){const{options:c}=this;RS(c);const{type:p=jg,repeat:_=0,repeatDelay:S=0,repeatType:A,velocity:T=0}=c;let{keyframes:u}=c;const L=p||jg;L!==jg&&typeof u[0]!="number"&&(this.mixKeyframes=ly(zz,MS(u[0],u[1])),u=[0,100]);const k=L({...c,keyframes:u});A==="mirror"&&(this.mirroredGenerator=L({...c,keyframes:[...u].reverse(),velocity:-T})),k.calculatedDuration===null&&(k.calculatedDuration=tb(k));const{calculatedDuration:B}=k;this.calculatedDuration=B,this.resolvedDuration=B+S,this.totalDuration=this.resolvedDuration*(_+1)-S,this.generator=k}updateTime(c){const p=Math.round(c-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=p}tick(c,p=!1){const{generator:_,totalDuration:S,mixKeyframes:A,mirroredGenerator:T,resolvedDuration:u,calculatedDuration:L}=this;if(this.startTime===null)return _.next(0);const{delay:k=0,keyframes:B,repeat:H,repeatType:W,repeatDelay:it,type:pt,onUpdate:rt,finalKeyframe:J}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,c):this.speed<0&&(this.startTime=Math.min(c-S/this.speed,this.startTime)),p?this.currentTime=c:this.updateTime(c);const mt=this.currentTime-k*(this.playbackSpeed>=0?1:-1),Et=this.playbackSpeed>=0?mt<0:mt>S;this.currentTime=Math.max(mt,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=S);let bt=this.currentTime,Lt=_;if(H){const Kt=Math.min(this.currentTime,S)/u;let xe=Math.floor(Kt),Ae=Kt%1;!Ae&&Kt>=1&&(Ae=1),Ae===1&&xe--,xe=Math.min(xe,H+1),!!(xe%2)&&(W==="reverse"?(Ae=1-Ae,it&&(Ae-=it/u)):W==="mirror"&&(Lt=T)),bt=ah(0,1,Ae)*u}const Ot=Et?{done:!1,value:B[0]}:Lt.next(bt);A&&(Ot.value=A(Ot.value));let{done:ee}=Ot;!Et&&L!==null&&(ee=this.playbackSpeed>=0?this.currentTime>=S:this.currentTime<=0);const Nt=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&ee);return Nt&&pt!==Xx&&(Ot.value=eb(B,this.options,J,this.speed)),rt&&rt(Ot.value),Nt&&this.finish(),Ot}then(c,p){return this.finished.then(c,p)}get duration(){return rl(this.calculatedDuration)}get iterationDuration(){const{delay:c=0}=this.options||{};return this.duration+rl(c)}get time(){return rl(this.currentTime)}set time(c){c=Xc(c),this.currentTime=c,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=c:this.driver&&(this.startTime=this.driver.now()-c/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(c){this.updateTime(Ua.now());const p=this.playbackSpeed!==c;this.playbackSpeed=c,p&&(this.time=rl(this.currentTime))}play(){if(this.isStopped)return;const{driver:c=gz,startTime:p}=this.options;this.driver||(this.driver=c(S=>this.tick(S))),this.options.onPlay?.();const _=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=_):this.holdTime!==null?this.startTime=_-this.holdTime:this.startTime||(this.startTime=p??_),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Ua.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(c){return this.startTime=0,this.tick(c,!0)}attachTimeline(c){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),c.observe(this)}}function Lz(s){for(let c=1;c<s.length;c++)s[c]??(s[c]=s[c-1])}const kf=s=>s*180/Math.PI,Yx=s=>{const c=kf(Math.atan2(s[1],s[0]));return Wx(c)},kz={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:s=>(Math.abs(s[0])+Math.abs(s[3]))/2,rotate:Yx,rotateZ:Yx,skewX:s=>kf(Math.atan(s[1])),skewY:s=>kf(Math.atan(s[2])),skew:s=>(Math.abs(s[1])+Math.abs(s[2]))/2},Wx=s=>(s=s%360,s<0&&(s+=360),s),U1=Yx,G1=s=>Math.sqrt(s[0]*s[0]+s[1]*s[1]),q1=s=>Math.sqrt(s[4]*s[4]+s[5]*s[5]),Oz={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:G1,scaleY:q1,scale:s=>(G1(s)+q1(s))/2,rotateX:s=>Wx(kf(Math.atan2(s[6],s[5]))),rotateY:s=>Wx(kf(Math.atan2(-s[2],s[0]))),rotateZ:U1,rotate:U1,skewX:s=>kf(Math.atan(s[4])),skewY:s=>kf(Math.atan(s[1])),skew:s=>(Math.abs(s[1])+Math.abs(s[4]))/2};function Kx(s){return s.includes("scale")?1:0}function Qx(s,c){if(!s||s==="none")return Kx(c);const p=s.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let _,S;if(p)_=Oz,S=p;else{const u=s.match(/^matrix\(([-\d.e\s,]+)\)$/u);_=kz,S=u}if(!S)return Kx(c);const A=_[c],T=S[1].split(",").map(Fz);return typeof A=="function"?A(T):T[A]}const Nz=(s,c)=>{const{transform:p="none"}=getComputedStyle(s);return Qx(p,c)};function Fz(s){return parseFloat(s.trim())}const bm=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],wm=new Set(bm),Z1=s=>s===xm||s===sn,jz=new Set(["x","y","z"]),Bz=bm.filter(s=>!jz.has(s));function Vz(s){const c=[];return Bz.forEach(p=>{const _=s.getValue(p);_!==void 0&&(c.push([p,_.get()]),_.set(p.startsWith("scale")?1:0))}),c}const Of={width:({x:s},{paddingLeft:c="0",paddingRight:p="0"})=>s.max-s.min-parseFloat(c)-parseFloat(p),height:({y:s},{paddingTop:c="0",paddingBottom:p="0"})=>s.max-s.min-parseFloat(c)-parseFloat(p),top:(s,{top:c})=>parseFloat(c),left:(s,{left:c})=>parseFloat(c),bottom:({y:s},{top:c})=>parseFloat(c)+(s.max-s.min),right:({x:s},{left:c})=>parseFloat(c)+(s.max-s.min),x:(s,{transform:c})=>Qx(c,"x"),y:(s,{transform:c})=>Qx(c,"y")};Of.translateX=Of.x;Of.translateY=Of.y;const Nf=new Set;let Jx=!1,t0=!1,e0=!1;function IS(){if(t0){const s=Array.from(Nf).filter(_=>_.needsMeasurement),c=new Set(s.map(_=>_.element)),p=new Map;c.forEach(_=>{const S=Vz(_);S.length&&(p.set(_,S),_.render())}),s.forEach(_=>_.measureInitialState()),c.forEach(_=>{_.render();const S=p.get(_);S&&S.forEach(([A,T])=>{_.getValue(A)?.set(T)})}),s.forEach(_=>_.measureEndState()),s.forEach(_=>{_.suspendedScrollY!==void 0&&window.scrollTo(0,_.suspendedScrollY)})}t0=!1,Jx=!1,Nf.forEach(s=>s.complete(e0)),Nf.clear()}function zS(){Nf.forEach(s=>{s.readKeyframes(),s.needsMeasurement&&(t0=!0)})}function Uz(){e0=!0,zS(),IS(),e0=!1}class rb{constructor(c,p,_,S,A,T=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...c],this.onComplete=p,this.name=_,this.motionValue=S,this.element=A,this.isAsync=T}scheduleResolve(){this.state="scheduled",this.isAsync?(Nf.add(this),Jx||(Jx=!0,Vi.read(zS),Vi.resolveKeyframes(IS))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:c,name:p,element:_,motionValue:S}=this;if(c[0]===null){const A=S?.get(),T=c[c.length-1];if(A!==void 0)c[0]=A;else if(_&&p){const u=_.readValue(p,T);u!=null&&(c[0]=u)}c[0]===void 0&&(c[0]=T),S&&A===void 0&&S.set(c[0])}Lz(c)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(c=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,c),Nf.delete(this)}cancel(){this.state==="scheduled"&&(Nf.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const Gz=s=>s.startsWith("--");function qz(s,c,p){Gz(c)?s.style.setProperty(c,p):s.style[c]=p}const Zz=Z0(()=>window.ScrollTimeline!==void 0),$z={};function Hz(s,c){const p=Z0(s);return()=>$z[c]??p()}const LS=Hz(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Og=([s,c,p,_])=>`cubic-bezier(${s}, ${c}, ${p}, ${_})`,$1={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Og([0,.65,.55,1]),circOut:Og([.55,0,1,.45]),backIn:Og([.31,.01,.66,-.59]),backOut:Og([.33,1.53,.69,.99])};function kS(s,c){if(s)return typeof s=="function"?LS()?PS(s,c):"ease-out":vS(s)?Og(s):Array.isArray(s)?s.map(p=>kS(p,c)||$1.easeOut):$1[s]}function Xz(s,c,p,{delay:_=0,duration:S=300,repeat:A=0,repeatType:T="loop",ease:u="easeOut",times:L}={},k=void 0){const B={[c]:p};L&&(B.offset=L);const H=kS(u,S);Array.isArray(H)&&(B.easing=H);const W={delay:_,duration:S,easing:Array.isArray(H)?"linear":H,fill:"both",iterations:A+1,direction:T==="reverse"?"alternate":"normal"};return k&&(W.pseudoElement=k),s.animate(B,W)}function OS(s){return typeof s=="function"&&"applyToOptions"in s}function Yz({type:s,...c}){return OS(s)&&LS()?s.applyToOptions(c):(c.duration??(c.duration=300),c.ease??(c.ease="easeOut"),c)}class Wz extends nb{constructor(c){if(super(),this.finishedTime=null,this.isStopped=!1,!c)return;const{element:p,name:_,keyframes:S,pseudoElement:A,allowFlatten:T=!1,finalKeyframe:u,onComplete:L}=c;this.isPseudoElement=!!A,this.allowFlatten=T,this.options=c,q0(typeof c.type!="string");const k=Yz(c);this.animation=Xz(p,_,S,k,A),k.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!A){const B=eb(S,this.options,u,this.speed);this.updateMotionValue?this.updateMotionValue(B):qz(p,_,B),this.animation.cancel()}L?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:c}=this;c==="idle"||c==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const c=this.animation.effect?.getComputedTiming?.().duration||0;return rl(Number(c))}get iterationDuration(){const{delay:c=0}=this.options||{};return this.duration+rl(c)}get time(){return rl(Number(this.animation.currentTime)||0)}set time(c){this.finishedTime=null,this.animation.currentTime=Xc(c)}get speed(){return this.animation.playbackRate}set speed(c){c<0&&(this.finishedTime=null),this.animation.playbackRate=c}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(c){this.animation.startTime=c}attachTimeline({timeline:c,observe:p}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,c&&Zz()?(this.animation.timeline=c,sl):p(this)}}const NS={anticipate:mS,backInOut:pS,circInOut:yS};function Kz(s){return s in NS}function Qz(s){typeof s.ease=="string"&&Kz(s.ease)&&(s.ease=NS[s.ease])}const H1=10;class Jz extends Wz{constructor(c){Qz(c),RS(c),super(c),c.startTime&&(this.startTime=c.startTime),this.options=c}updateMotionValue(c){const{motionValue:p,onUpdate:_,onComplete:S,element:A,...T}=this.options;if(!p)return;if(c!==void 0){p.set(c);return}const u=new ib({...T,autoplay:!1}),L=Xc(this.finishedTime??this.time);p.setWithVelocity(u.sample(L-H1).value,u.sample(L).value,H1),u.stop()}}const X1=(s,c)=>c==="zIndex"?!1:!!(typeof s=="number"||Array.isArray(s)||typeof s=="string"&&(_d.test(s)||s==="0")&&!s.startsWith("url("));function tL(s){const c=s[0];if(s.length===1)return!0;for(let p=0;p<s.length;p++)if(s[p]!==c)return!0}function eL(s,c,p,_){const S=s[0];if(S===null)return!1;if(c==="display"||c==="visibility")return!0;const A=s[s.length-1],T=X1(S,c),u=X1(A,c);return!T||!u?!1:tL(s)||(p==="spring"||OS(p))&&_}function n0(s){s.duration=0,s.type="keyframes"}const nL=new Set(["opacity","clipPath","filter","transform"]),iL=Z0(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function rL(s){const{motionValue:c,name:p,repeatDelay:_,repeatType:S,damping:A,type:T}=s;if(!(c?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:L,transformTemplate:k}=c.owner.getProps();return iL()&&p&&nL.has(p)&&(p!=="transform"||!k)&&!L&&!_&&S!=="mirror"&&A!==0&&T!=="inertia"}const sL=40;class aL extends nb{constructor({autoplay:c=!0,delay:p=0,type:_="keyframes",repeat:S=0,repeatDelay:A=0,repeatType:T="loop",keyframes:u,name:L,motionValue:k,element:B,...H}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Ua.now();const W={autoplay:c,delay:p,type:_,repeat:S,repeatDelay:A,repeatType:T,name:L,motionValue:k,element:B,...H},it=B?.KeyframeResolver||rb;this.keyframeResolver=new it(u,(pt,rt,J)=>this.onKeyframesResolved(pt,rt,W,!J),L,k,B),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(c,p,_,S){this.keyframeResolver=void 0;const{name:A,type:T,velocity:u,delay:L,isHandoff:k,onUpdate:B}=_;this.resolvedAt=Ua.now(),eL(c,A,T,u)||((oh.instantAnimations||!L)&&B?.(eb(c,_,p)),c[0]=c[c.length-1],n0(_),_.repeat=0);const W={startTime:S?this.resolvedAt?this.resolvedAt-this.createdAt>sL?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:p,..._,keyframes:c},it=!k&&rL(W)?new Jz({...W,element:W.motionValue.owner.current}):new ib(W);it.finished.then(()=>this.notifyFinished()).catch(sl),this.pendingTimeline&&(this.stopTimeline=it.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=it}get finished(){return this._animation?this.animation.finished:this._finished}then(c,p){return this.finished.finally(c).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),Uz()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(c){this.animation.time=c}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(c){this.animation.speed=c}get startTime(){return this.animation.startTime}attachTimeline(c){return this._animation?this.stopTimeline=this.animation.attachTimeline(c):this.pendingTimeline=c,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const oL=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function lL(s){const c=oL.exec(s);if(!c)return[,];const[,p,_,S]=c;return[`--${p??_}`,S]}function FS(s,c,p=1){const[_,S]=lL(s);if(!_)return;const A=window.getComputedStyle(c).getPropertyValue(_);if(A){const T=A.trim();return aS(T)?parseFloat(T):T}return W0(S)?FS(S,c,p+1):S}function sb(s,c){return s?.[c]??s?.default??s}const jS=new Set(["width","height","top","left","right","bottom",...bm]),cL={test:s=>s==="auto",parse:s=>s},BS=s=>c=>c.test(s),VS=[xm,sn,Yc,fd,tz,JI,cL],Y1=s=>VS.find(BS(s));function uL(s){return typeof s=="number"?s===0:s!==null?s==="none"||s==="0"||lS(s):!0}const hL=new Set(["brightness","contrast","saturate","opacity"]);function dL(s){const[c,p]=s.slice(0,-1).split("(");if(c==="drop-shadow")return s;const[_]=p.match(K0)||[];if(!_)return s;const S=p.replace(_,"");let A=hL.has(c)?1:0;return _!==p&&(A*=100),c+"("+A+S+")"}const fL=/\b([a-z-]*)\(.*?\)/gu,i0={..._d,getAnimatableNone:s=>{const c=s.match(fL);return c?c.map(dL).join(" "):s}},W1={...xm,transform:Math.round},pL={rotate:fd,rotateX:fd,rotateY:fd,rotateZ:fd,scale:d_,scaleX:d_,scaleY:d_,scaleZ:d_,skew:fd,skewX:fd,skewY:fd,distance:sn,translateX:sn,translateY:sn,translateZ:sn,x:sn,y:sn,z:sn,perspective:sn,transformPerspective:sn,opacity:Wg,originX:N1,originY:N1,originZ:sn},ab={borderWidth:sn,borderTopWidth:sn,borderRightWidth:sn,borderBottomWidth:sn,borderLeftWidth:sn,borderRadius:sn,radius:sn,borderTopLeftRadius:sn,borderTopRightRadius:sn,borderBottomRightRadius:sn,borderBottomLeftRadius:sn,width:sn,maxWidth:sn,height:sn,maxHeight:sn,top:sn,right:sn,bottom:sn,left:sn,padding:sn,paddingTop:sn,paddingRight:sn,paddingBottom:sn,paddingLeft:sn,margin:sn,marginTop:sn,marginRight:sn,marginBottom:sn,marginLeft:sn,backgroundPositionX:sn,backgroundPositionY:sn,...pL,zIndex:W1,fillOpacity:Wg,strokeOpacity:Wg,numOctaves:W1},mL={...ab,color:Rr,backgroundColor:Rr,outlineColor:Rr,fill:Rr,stroke:Rr,borderColor:Rr,borderTopColor:Rr,borderRightColor:Rr,borderBottomColor:Rr,borderLeftColor:Rr,filter:i0,WebkitFilter:i0},US=s=>mL[s];function GS(s,c){let p=US(s);return p!==i0&&(p=_d),p.getAnimatableNone?p.getAnimatableNone(c):void 0}const gL=new Set(["auto","none","0"]);function yL(s,c,p){let _=0,S;for(;_<s.length&&!S;){const A=s[_];typeof A=="string"&&!gL.has(A)&&Kg(A).values.length&&(S=s[_]),_++}if(S&&p)for(const A of c)s[A]=GS(p,S)}class _L extends rb{constructor(c,p,_,S,A){super(c,p,_,S,A,!0)}readKeyframes(){const{unresolvedKeyframes:c,element:p,name:_}=this;if(!p||!p.current)return;super.readKeyframes();for(let L=0;L<c.length;L++){let k=c[L];if(typeof k=="string"&&(k=k.trim(),W0(k))){const B=FS(k,p.current);B!==void 0&&(c[L]=B),L===c.length-1&&(this.finalKeyframe=k)}}if(this.resolveNoneKeyframes(),!jS.has(_)||c.length!==2)return;const[S,A]=c,T=Y1(S),u=Y1(A);if(T!==u)if(Z1(T)&&Z1(u))for(let L=0;L<c.length;L++){const k=c[L];typeof k=="string"&&(c[L]=parseFloat(k))}else Of[_]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:c,name:p}=this,_=[];for(let S=0;S<c.length;S++)(c[S]===null||uL(c[S]))&&_.push(S);_.length&&yL(c,_,p)}measureInitialState(){const{element:c,unresolvedKeyframes:p,name:_}=this;if(!c||!c.current)return;_==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Of[_](c.measureViewportBox(),window.getComputedStyle(c.current)),p[0]=this.measuredOrigin;const S=p[p.length-1];S!==void 0&&c.getValue(_,S).jump(S,!1)}measureEndState(){const{element:c,name:p,unresolvedKeyframes:_}=this;if(!c||!c.current)return;const S=c.getValue(p);S&&S.jump(this.measuredOrigin,!1);const A=_.length-1,T=_[A];_[A]=Of[p](c.measureViewportBox(),window.getComputedStyle(c.current)),T!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=T),this.removedTransforms?.length&&this.removedTransforms.forEach(([u,L])=>{c.getValue(u).set(L)}),this.resolveNoneKeyframes()}}function vL(s,c,p){if(s instanceof EventTarget)return[s];if(typeof s=="string"){let _=document;const S=p?.[s]??_.querySelectorAll(s);return S?Array.from(S):[]}return Array.from(s)}const qS=(s,c)=>c&&typeof s=="number"?c.transform(s):s;function ZS(s){return oS(s)&&"offsetHeight"in s}const K1=30,xL=s=>!isNaN(parseFloat(s));class bL{constructor(c,p={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=_=>{const S=Ua.now();if(this.updatedAt!==S&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(_),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const A of this.dependents)A.dirty()},this.hasAnimated=!1,this.setCurrent(c),this.owner=p.owner}setCurrent(c){this.current=c,this.updatedAt=Ua.now(),this.canTrackVelocity===null&&c!==void 0&&(this.canTrackVelocity=xL(this.current))}setPrevFrameValue(c=this.current){this.prevFrameValue=c,this.prevUpdatedAt=this.updatedAt}onChange(c){return this.on("change",c)}on(c,p){this.events[c]||(this.events[c]=new $0);const _=this.events[c].add(p);return c==="change"?()=>{_(),Vi.read(()=>{this.events.change.getSize()||this.stop()})}:_}clearListeners(){for(const c in this.events)this.events[c].clear()}attach(c,p){this.passiveEffect=c,this.stopPassiveEffect=p}set(c){this.passiveEffect?this.passiveEffect(c,this.updateAndNotify):this.updateAndNotify(c)}setWithVelocity(c,p,_){this.set(p),this.prev=void 0,this.prevFrameValue=c,this.prevUpdatedAt=this.updatedAt-_}jump(c,p=!0){this.updateAndNotify(c),this.prev=c,this.prevUpdatedAt=this.prevFrameValue=void 0,p&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(c){this.dependents||(this.dependents=new Set),this.dependents.add(c)}removeDependent(c){this.dependents&&this.dependents.delete(c)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const c=Ua.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||c-this.updatedAt>K1)return 0;const p=Math.min(this.updatedAt-this.prevUpdatedAt,K1);return cS(parseFloat(this.current)-parseFloat(this.prevFrameValue),p)}start(c){return this.stop(),new Promise(p=>{this.hasAnimated=!0,this.animation=c(p),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function hm(s,c){return new bL(s,c)}const{schedule:ob}=xS(queueMicrotask,!1),Wl={x:!1,y:!1};function $S(){return Wl.x||Wl.y}function wL(s){return s==="x"||s==="y"?Wl[s]?null:(Wl[s]=!0,()=>{Wl[s]=!1}):Wl.x||Wl.y?null:(Wl.x=Wl.y=!0,()=>{Wl.x=Wl.y=!1})}function HS(s,c){const p=vL(s),_=new AbortController,S={passive:!0,...c,signal:_.signal};return[p,S,()=>_.abort()]}function Q1(s){return!(s.pointerType==="touch"||$S())}function TL(s,c,p={}){const[_,S,A]=HS(s,p),T=u=>{if(!Q1(u))return;const{target:L}=u,k=c(L,u);if(typeof k!="function"||!L)return;const B=H=>{Q1(H)&&(k(H),L.removeEventListener("pointerleave",B))};L.addEventListener("pointerleave",B,S)};return _.forEach(u=>{u.addEventListener("pointerenter",T,S)}),A}const XS=(s,c)=>c?s===c?!0:XS(s,c.parentElement):!1,lb=s=>s.pointerType==="mouse"?typeof s.button!="number"||s.button<=0:s.isPrimary!==!1,SL=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function EL(s){return SL.has(s.tagName)||s.tabIndex!==-1}const C_=new WeakSet;function J1(s){return c=>{c.key==="Enter"&&s(c)}}function dx(s,c){s.dispatchEvent(new PointerEvent("pointer"+c,{isPrimary:!0,bubbles:!0}))}const CL=(s,c)=>{const p=s.currentTarget;if(!p)return;const _=J1(()=>{if(C_.has(p))return;dx(p,"down");const S=J1(()=>{dx(p,"up")}),A=()=>dx(p,"cancel");p.addEventListener("keyup",S,c),p.addEventListener("blur",A,c)});p.addEventListener("keydown",_,c),p.addEventListener("blur",()=>p.removeEventListener("keydown",_),c)};function tw(s){return lb(s)&&!$S()}function AL(s,c,p={}){const[_,S,A]=HS(s,p),T=u=>{const L=u.currentTarget;if(!tw(u))return;C_.add(L);const k=c(L,u),B=(it,pt)=>{window.removeEventListener("pointerup",H),window.removeEventListener("pointercancel",W),C_.has(L)&&C_.delete(L),tw(it)&&typeof k=="function"&&k(it,{success:pt})},H=it=>{B(it,L===window||L===document||p.useGlobalTarget||XS(L,it.target))},W=it=>{B(it,!1)};window.addEventListener("pointerup",H,S),window.addEventListener("pointercancel",W,S)};return _.forEach(u=>{(p.useGlobalTarget?window:u).addEventListener("pointerdown",T,S),ZS(u)&&(u.addEventListener("focus",k=>CL(k,S)),!EL(u)&&!u.hasAttribute("tabindex")&&(u.tabIndex=0))}),A}function YS(s){return oS(s)&&"ownerSVGElement"in s}function ML(s){return YS(s)&&s.tagName==="svg"}const js=s=>!!(s&&s.getVelocity),PL=[...VS,Rr,_d],DL=s=>PL.find(BS(s)),cb=Z.createContext({transformPagePoint:s=>s,isStatic:!1,reducedMotion:"never"});function ew(s,c){if(typeof s=="function")return s(c);s!=null&&(s.current=c)}function RL(...s){return c=>{let p=!1;const _=s.map(S=>{const A=ew(S,c);return!p&&typeof A=="function"&&(p=!0),A});if(p)return()=>{for(let S=0;S<_.length;S++){const A=_[S];typeof A=="function"?A():ew(s[S],null)}}}}function IL(...s){return Z.useCallback(RL(...s),s)}class zL extends Z.Component{getSnapshotBeforeUpdate(c){const p=this.props.childRef.current;if(p&&c.isPresent&&!this.props.isPresent){const _=p.offsetParent,S=ZS(_)&&_.offsetWidth||0,A=this.props.sizeRef.current;A.height=p.offsetHeight||0,A.width=p.offsetWidth||0,A.top=p.offsetTop,A.left=p.offsetLeft,A.right=S-A.width-A.left}return null}componentDidUpdate(){}render(){return this.props.children}}function LL({children:s,isPresent:c,anchorX:p,root:_}){const S=Z.useId(),A=Z.useRef(null),T=Z.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:u}=Z.useContext(cb),L=IL(A,s?.ref);return Z.useInsertionEffect(()=>{const{width:k,height:B,top:H,left:W,right:it}=T.current;if(c||!A.current||!k||!B)return;const pt=p==="left"?`left: ${W}`:`right: ${it}`;A.current.dataset.motionPopId=S;const rt=document.createElement("style");u&&(rt.nonce=u);const J=_??document.head;return J.appendChild(rt),rt.sheet&&rt.sheet.insertRule(`
          [data-motion-pop-id="${S}"] {
            position: absolute !important;
            width: ${k}px !important;
            height: ${B}px !important;
            ${pt}px !important;
            top: ${H}px !important;
          }
        `),()=>{J.contains(rt)&&J.removeChild(rt)}},[c]),F.jsx(zL,{isPresent:c,childRef:A,sizeRef:T,children:Z.cloneElement(s,{ref:L})})}const kL=({children:s,initial:c,isPresent:p,onExitComplete:_,custom:S,presenceAffectsLayout:A,mode:T,anchorX:u,root:L})=>{const k=B0(OL),B=Z.useId();let H=!0,W=Z.useMemo(()=>(H=!1,{id:B,initial:c,isPresent:p,custom:S,onExitComplete:it=>{k.set(it,!0);for(const pt of k.values())if(!pt)return;_&&_()},register:it=>(k.set(it,!1),()=>k.delete(it))}),[p,k,_]);return A&&H&&(W={...W}),Z.useMemo(()=>{k.forEach((it,pt)=>k.set(pt,!1))},[p]),Z.useEffect(()=>{!p&&!k.size&&_&&_()},[p]),T==="popLayout"&&(s=F.jsx(LL,{isPresent:p,anchorX:u,root:L,children:s})),F.jsx(sv.Provider,{value:W,children:s})};function OL(){return new Map}function WS(s=!0){const c=Z.useContext(sv);if(c===null)return[!0,null];const{isPresent:p,onExitComplete:_,register:S}=c,A=Z.useId();Z.useEffect(()=>{if(s)return S(A)},[s]);const T=Z.useCallback(()=>s&&_&&_(A),[A,_,s]);return!p&&_?[!1,T]:[!0]}const f_=s=>s.key||"";function nw(s){const c=[];return Z.Children.forEach(s,p=>{Z.isValidElement(p)&&c.push(p)}),c}const NL=({children:s,custom:c,initial:p=!0,onExitComplete:_,presenceAffectsLayout:S=!0,mode:A="sync",propagate:T=!1,anchorX:u="left",root:L})=>{const[k,B]=WS(T),H=Z.useMemo(()=>nw(s),[s]),W=T&&!k?[]:H.map(f_),it=Z.useRef(!0),pt=Z.useRef(H),rt=B0(()=>new Map),[J,mt]=Z.useState(H),[Et,bt]=Z.useState(H);sS(()=>{it.current=!1,pt.current=H;for(let ee=0;ee<Et.length;ee++){const Nt=f_(Et[ee]);W.includes(Nt)?rt.delete(Nt):rt.get(Nt)!==!0&&rt.set(Nt,!1)}},[Et,W.length,W.join("-")]);const Lt=[];if(H!==J){let ee=[...H];for(let Nt=0;Nt<Et.length;Nt++){const Kt=Et[Nt],xe=f_(Kt);W.includes(xe)||(ee.splice(Nt,0,Kt),Lt.push(Kt))}return A==="wait"&&Lt.length&&(ee=Lt),bt(nw(ee)),mt(H),null}const{forceRender:Ot}=Z.useContext(j0);return F.jsx(F.Fragment,{children:Et.map(ee=>{const Nt=f_(ee),Kt=T&&!k?!1:H===Et||W.includes(Nt),xe=()=>{if(rt.has(Nt))rt.set(Nt,!0);else return;let Ae=!0;rt.forEach(ae=>{ae||(Ae=!1)}),Ae&&(Ot?.(),bt(pt.current),T&&B?.(),_&&_())};return F.jsx(kL,{isPresent:Kt,initial:!it.current||p?void 0:!1,custom:c,presenceAffectsLayout:S,mode:A,root:L,onExitComplete:Kt?void 0:xe,anchorX:u,children:ee},Nt)})})},KS=Z.createContext({strict:!1}),iw={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},dm={};for(const s in iw)dm[s]={isEnabled:c=>iw[s].some(p=>!!c[p])};function FL(s){for(const c in s)dm[c]={...dm[c],...s[c]}}const jL=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function B_(s){return s.startsWith("while")||s.startsWith("drag")&&s!=="draggable"||s.startsWith("layout")||s.startsWith("onTap")||s.startsWith("onPan")||s.startsWith("onLayout")||jL.has(s)}let QS=s=>!B_(s);function BL(s){typeof s=="function"&&(QS=c=>c.startsWith("on")?!B_(c):s(c))}try{BL(require("@emotion/is-prop-valid").default)}catch{}function VL(s,c,p){const _={};for(const S in s)S==="values"&&typeof s.values=="object"||(QS(S)||p===!0&&B_(S)||!c&&!B_(S)||s.draggable&&S.startsWith("onDrag"))&&(_[S]=s[S]);return _}const av=Z.createContext({});function ov(s){return s!==null&&typeof s=="object"&&typeof s.start=="function"}function Qg(s){return typeof s=="string"||Array.isArray(s)}const ub=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],hb=["initial",...ub];function lv(s){return ov(s.animate)||hb.some(c=>Qg(s[c]))}function JS(s){return!!(lv(s)||s.variants)}function UL(s,c){if(lv(s)){const{initial:p,animate:_}=s;return{initial:p===!1||Qg(p)?p:void 0,animate:Qg(_)?_:void 0}}return s.inherit!==!1?c:{}}function GL(s){const{initial:c,animate:p}=UL(s,Z.useContext(av));return Z.useMemo(()=>({initial:c,animate:p}),[rw(c),rw(p)])}function rw(s){return Array.isArray(s)?s.join(" "):s}const Jg={};function qL(s){for(const c in s)Jg[c]=s[c],Y0(c)&&(Jg[c].isCSSVariable=!0)}function tE(s,{layout:c,layoutId:p}){return wm.has(s)||s.startsWith("origin")||(c||p!==void 0)&&(!!Jg[s]||s==="opacity")}const ZL={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},$L=bm.length;function HL(s,c,p){let _="",S=!0;for(let A=0;A<$L;A++){const T=bm[A],u=s[T];if(u===void 0)continue;let L=!0;if(typeof u=="number"?L=u===(T.startsWith("scale")?1:0):L=parseFloat(u)===0,!L||p){const k=qS(u,ab[T]);if(!L){S=!1;const B=ZL[T]||T;_+=`${B}(${k}) `}p&&(c[T]=k)}}return _=_.trim(),p?_=p(c,S?"":_):S&&(_="none"),_}function db(s,c,p){const{style:_,vars:S,transformOrigin:A}=s;let T=!1,u=!1;for(const L in c){const k=c[L];if(wm.has(L)){T=!0;continue}else if(Y0(L)){S[L]=k;continue}else{const B=qS(k,ab[L]);L.startsWith("origin")?(u=!0,A[L]=B):_[L]=B}}if(c.transform||(T||p?_.transform=HL(c,s.transform,p):_.transform&&(_.transform="none")),u){const{originX:L="50%",originY:k="50%",originZ:B=0}=A;_.transformOrigin=`${L} ${k} ${B}`}}const fb=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function eE(s,c,p){for(const _ in c)!js(c[_])&&!tE(_,p)&&(s[_]=c[_])}function XL({transformTemplate:s},c){return Z.useMemo(()=>{const p=fb();return db(p,c,s),Object.assign({},p.vars,p.style)},[c])}function YL(s,c){const p=s.style||{},_={};return eE(_,p,s),Object.assign(_,XL(s,c)),_}function WL(s,c){const p={},_=YL(s,c);return s.drag&&s.dragListener!==!1&&(p.draggable=!1,_.userSelect=_.WebkitUserSelect=_.WebkitTouchCallout="none",_.touchAction=s.drag===!0?"none":`pan-${s.drag==="x"?"y":"x"}`),s.tabIndex===void 0&&(s.onTap||s.onTapStart||s.whileTap)&&(p.tabIndex=0),p.style=_,p}const KL={offset:"stroke-dashoffset",array:"stroke-dasharray"},QL={offset:"strokeDashoffset",array:"strokeDasharray"};function JL(s,c,p=1,_=0,S=!0){s.pathLength=1;const A=S?KL:QL;s[A.offset]=sn.transform(-_);const T=sn.transform(c),u=sn.transform(p);s[A.array]=`${T} ${u}`}function nE(s,{attrX:c,attrY:p,attrScale:_,pathLength:S,pathSpacing:A=1,pathOffset:T=0,...u},L,k,B){if(db(s,u,k),L){s.style.viewBox&&(s.attrs.viewBox=s.style.viewBox);return}s.attrs=s.style,s.style={};const{attrs:H,style:W}=s;H.transform&&(W.transform=H.transform,delete H.transform),(W.transform||H.transformOrigin)&&(W.transformOrigin=H.transformOrigin??"50% 50%",delete H.transformOrigin),W.transform&&(W.transformBox=B?.transformBox??"fill-box",delete H.transformBox),c!==void 0&&(H.x=c),p!==void 0&&(H.y=p),_!==void 0&&(H.scale=_),S!==void 0&&JL(H,S,A,T,!1)}const iE=()=>({...fb(),attrs:{}}),rE=s=>typeof s=="string"&&s.toLowerCase()==="svg";function tk(s,c,p,_){const S=Z.useMemo(()=>{const A=iE();return nE(A,c,rE(_),s.transformTemplate,s.style),{...A.attrs,style:{...A.style}}},[c]);if(s.style){const A={};eE(A,s.style,s),S.style={...A,...S.style}}return S}const ek=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function pb(s){return typeof s!="string"||s.includes("-")?!1:!!(ek.indexOf(s)>-1||/[A-Z]/u.test(s))}function nk(s,c,p,{latestValues:_},S,A=!1){const u=(pb(s)?tk:WL)(c,_,S,s),L=VL(c,typeof s=="string",A),k=s!==Z.Fragment?{...L,...u,ref:p}:{},{children:B}=c,H=Z.useMemo(()=>js(B)?B.get():B,[B]);return Z.createElement(s,{...k,children:H})}function sw(s){const c=[{},{}];return s?.values.forEach((p,_)=>{c[0][_]=p.get(),c[1][_]=p.getVelocity()}),c}function mb(s,c,p,_){if(typeof c=="function"){const[S,A]=sw(_);c=c(p!==void 0?p:s.custom,S,A)}if(typeof c=="string"&&(c=s.variants&&s.variants[c]),typeof c=="function"){const[S,A]=sw(_);c=c(p!==void 0?p:s.custom,S,A)}return c}function A_(s){return js(s)?s.get():s}function ik({scrapeMotionValuesFromProps:s,createRenderState:c},p,_,S){return{latestValues:rk(p,_,S,s),renderState:c()}}function rk(s,c,p,_){const S={},A=_(s,{});for(const W in A)S[W]=A_(A[W]);let{initial:T,animate:u}=s;const L=lv(s),k=JS(s);c&&k&&!L&&s.inherit!==!1&&(T===void 0&&(T=c.initial),u===void 0&&(u=c.animate));let B=p?p.initial===!1:!1;B=B||T===!1;const H=B?u:T;if(H&&typeof H!="boolean"&&!ov(H)){const W=Array.isArray(H)?H:[H];for(let it=0;it<W.length;it++){const pt=mb(s,W[it]);if(pt){const{transitionEnd:rt,transition:J,...mt}=pt;for(const Et in mt){let bt=mt[Et];if(Array.isArray(bt)){const Lt=B?bt.length-1:0;bt=bt[Lt]}bt!==null&&(S[Et]=bt)}for(const Et in rt)S[Et]=rt[Et]}}}return S}const sE=s=>(c,p)=>{const _=Z.useContext(av),S=Z.useContext(sv),A=()=>ik(s,c,_,S);return p?A():B0(A)};function gb(s,c,p){const{style:_}=s,S={};for(const A in _)(js(_[A])||c.style&&js(c.style[A])||tE(A,s)||p?.getValue(A)?.liveStyle!==void 0)&&(S[A]=_[A]);return S}const sk=sE({scrapeMotionValuesFromProps:gb,createRenderState:fb});function aE(s,c,p){const _=gb(s,c,p);for(const S in s)if(js(s[S])||js(c[S])){const A=bm.indexOf(S)!==-1?"attr"+S.charAt(0).toUpperCase()+S.substring(1):S;_[A]=s[S]}return _}const ak=sE({scrapeMotionValuesFromProps:aE,createRenderState:iE}),ok=Symbol.for("motionComponentSymbol");function tm(s){return s&&typeof s=="object"&&Object.prototype.hasOwnProperty.call(s,"current")}function lk(s,c,p){return Z.useCallback(_=>{_&&s.onMount&&s.onMount(_),c&&(_?c.mount(_):c.unmount()),p&&(typeof p=="function"?p(_):tm(p)&&(p.current=_))},[c])}const yb=s=>s.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),ck="framerAppearId",oE="data-"+yb(ck),lE=Z.createContext({});function uk(s,c,p,_,S){const{visualElement:A}=Z.useContext(av),T=Z.useContext(KS),u=Z.useContext(sv),L=Z.useContext(cb).reducedMotion,k=Z.useRef(null);_=_||T.renderer,!k.current&&_&&(k.current=_(s,{visualState:c,parent:A,props:p,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:L}));const B=k.current,H=Z.useContext(lE);B&&!B.projection&&S&&(B.type==="html"||B.type==="svg")&&hk(k.current,p,S,H);const W=Z.useRef(!1);Z.useInsertionEffect(()=>{B&&W.current&&B.update(p,u)});const it=p[oE],pt=Z.useRef(!!it&&!window.MotionHandoffIsComplete?.(it)&&window.MotionHasOptimisedAnimation?.(it));return sS(()=>{B&&(W.current=!0,window.MotionIsMounted=!0,B.updateFeatures(),B.scheduleRenderMicrotask(),pt.current&&B.animationState&&B.animationState.animateChanges())}),Z.useEffect(()=>{B&&(!pt.current&&B.animationState&&B.animationState.animateChanges(),pt.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(it)}),pt.current=!1),B.enteringChildren=void 0)}),B}function hk(s,c,p,_){const{layoutId:S,layout:A,drag:T,dragConstraints:u,layoutScroll:L,layoutRoot:k,layoutCrossfade:B}=c;s.projection=new p(s.latestValues,c["data-framer-portal-id"]?void 0:cE(s.parent)),s.projection.setOptions({layoutId:S,layout:A,alwaysMeasureLayout:!!T||u&&tm(u),visualElement:s,animationType:typeof A=="string"?A:"both",initialPromotionConfig:_,crossfade:B,layoutScroll:L,layoutRoot:k})}function cE(s){if(s)return s.options.allowProjection!==!1?s.projection:cE(s.parent)}function fx(s,{forwardMotionProps:c=!1}={},p,_){p&&FL(p);const S=pb(s)?ak:sk;function A(u,L){let k;const B={...Z.useContext(cb),...u,layoutId:dk(u)},{isStatic:H}=B,W=GL(u),it=S(u,H);if(!H&&V0){fk();const pt=pk(B);k=pt.MeasureLayout,W.visualElement=uk(s,it,B,_,pt.ProjectionNode)}return F.jsxs(av.Provider,{value:W,children:[k&&W.visualElement?F.jsx(k,{visualElement:W.visualElement,...B}):null,nk(s,u,lk(it,W.visualElement,L),it,H,c)]})}A.displayName=`motion.${typeof s=="string"?s:`create(${s.displayName??s.name??""})`}`;const T=Z.forwardRef(A);return T[ok]=s,T}function dk({layoutId:s}){const c=Z.useContext(j0).id;return c&&s!==void 0?c+"-"+s:s}function fk(s,c){Z.useContext(KS).strict}function pk(s){const{drag:c,layout:p}=dm;if(!c&&!p)return{};const _={...c,...p};return{MeasureLayout:c?.isEnabled(s)||p?.isEnabled(s)?_.MeasureLayout:void 0,ProjectionNode:_.ProjectionNode}}function mk(s,c){if(typeof Proxy>"u")return fx;const p=new Map,_=(A,T)=>fx(A,T,s,c),S=(A,T)=>_(A,T);return new Proxy(S,{get:(A,T)=>T==="create"?_:(p.has(T)||p.set(T,fx(T,void 0,s,c)),p.get(T))})}function uE({top:s,left:c,right:p,bottom:_}){return{x:{min:c,max:p},y:{min:s,max:_}}}function gk({x:s,y:c}){return{top:c.min,right:s.max,bottom:c.max,left:s.min}}function yk(s,c){if(!c)return s;const p=c({x:s.left,y:s.top}),_=c({x:s.right,y:s.bottom});return{top:p.y,left:p.x,bottom:_.y,right:_.x}}function px(s){return s===void 0||s===1}function r0({scale:s,scaleX:c,scaleY:p}){return!px(s)||!px(c)||!px(p)}function zf(s){return r0(s)||hE(s)||s.z||s.rotate||s.rotateX||s.rotateY||s.skewX||s.skewY}function hE(s){return aw(s.x)||aw(s.y)}function aw(s){return s&&s!=="0%"}function V_(s,c,p){const _=s-p,S=c*_;return p+S}function ow(s,c,p,_,S){return S!==void 0&&(s=V_(s,S,_)),V_(s,p,_)+c}function s0(s,c=0,p=1,_,S){s.min=ow(s.min,c,p,_,S),s.max=ow(s.max,c,p,_,S)}function dE(s,{x:c,y:p}){s0(s.x,c.translate,c.scale,c.originPoint),s0(s.y,p.translate,p.scale,p.originPoint)}const lw=.999999999999,cw=1.0000000000001;function _k(s,c,p,_=!1){const S=p.length;if(!S)return;c.x=c.y=1;let A,T;for(let u=0;u<S;u++){A=p[u],T=A.projectionDelta;const{visualElement:L}=A.options;L&&L.props.style&&L.props.style.display==="contents"||(_&&A.options.layoutScroll&&A.scroll&&A!==A.root&&nm(s,{x:-A.scroll.offset.x,y:-A.scroll.offset.y}),T&&(c.x*=T.x.scale,c.y*=T.y.scale,dE(s,T)),_&&zf(A.latestValues)&&nm(s,A.latestValues))}c.x<cw&&c.x>lw&&(c.x=1),c.y<cw&&c.y>lw&&(c.y=1)}function em(s,c){s.min=s.min+c,s.max=s.max+c}function uw(s,c,p,_,S=.5){const A=er(s.min,s.max,S);s0(s,c,p,A,_)}function nm(s,c){uw(s.x,c.x,c.scaleX,c.scale,c.originX),uw(s.y,c.y,c.scaleY,c.scale,c.originY)}function fE(s,c){return uE(yk(s.getBoundingClientRect(),c))}function vk(s,c,p){const _=fE(s,p),{scroll:S}=c;return S&&(em(_.x,S.offset.x),em(_.y,S.offset.y)),_}const hw=()=>({translate:0,scale:1,origin:0,originPoint:0}),im=()=>({x:hw(),y:hw()}),dw=()=>({min:0,max:0}),vr=()=>({x:dw(),y:dw()}),a0={current:null},pE={current:!1};function xk(){if(pE.current=!0,!!V0)if(window.matchMedia){const s=window.matchMedia("(prefers-reduced-motion)"),c=()=>a0.current=s.matches;s.addEventListener("change",c),c()}else a0.current=!1}const bk=new WeakMap;function wk(s,c,p){for(const _ in c){const S=c[_],A=p[_];if(js(S))s.addValue(_,S);else if(js(A))s.addValue(_,hm(S,{owner:s}));else if(A!==S)if(s.hasValue(_)){const T=s.getValue(_);T.liveStyle===!0?T.jump(S):T.hasAnimated||T.set(S)}else{const T=s.getStaticValue(_);s.addValue(_,hm(T!==void 0?T:S,{owner:s}))}}for(const _ in p)c[_]===void 0&&s.removeValue(_);return c}const fw=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Tk{scrapeMotionValuesFromProps(c,p,_){return{}}constructor({parent:c,props:p,presenceContext:_,reducedMotionConfig:S,blockInitialAnimation:A,visualState:T},u={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=rb,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const W=Ua.now();this.renderScheduledAt<W&&(this.renderScheduledAt=W,Vi.render(this.render,!1,!0))};const{latestValues:L,renderState:k}=T;this.latestValues=L,this.baseTarget={...L},this.initialValues=p.initial?{...L}:{},this.renderState=k,this.parent=c,this.props=p,this.presenceContext=_,this.depth=c?c.depth+1:0,this.reducedMotionConfig=S,this.options=u,this.blockInitialAnimation=!!A,this.isControllingVariants=lv(p),this.isVariantNode=JS(p),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(c&&c.current);const{willChange:B,...H}=this.scrapeMotionValuesFromProps(p,{},this);for(const W in H){const it=H[W];L[W]!==void 0&&js(it)&&it.set(L[W])}}mount(c){this.current=c,bk.set(c,this),this.projection&&!this.projection.instance&&this.projection.mount(c),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((p,_)=>this.bindToMotionValue(_,p)),pE.current||xk(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:a0.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),yd(this.notifyUpdate),yd(this.render),this.valueSubscriptions.forEach(c=>c()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const c in this.events)this.events[c].clear();for(const c in this.features){const p=this.features[c];p&&(p.unmount(),p.isMounted=!1)}this.current=null}addChild(c){this.children.add(c),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(c)}removeChild(c){this.children.delete(c),this.enteringChildren&&this.enteringChildren.delete(c)}bindToMotionValue(c,p){this.valueSubscriptions.has(c)&&this.valueSubscriptions.get(c)();const _=wm.has(c);_&&this.onBindTransform&&this.onBindTransform();const S=p.on("change",T=>{this.latestValues[c]=T,this.props.onUpdate&&Vi.preRender(this.notifyUpdate),_&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let A;window.MotionCheckAppearSync&&(A=window.MotionCheckAppearSync(this,c,p)),this.valueSubscriptions.set(c,()=>{S(),A&&A(),p.owner&&p.stop()})}sortNodePosition(c){return!this.current||!this.sortInstanceNodePosition||this.type!==c.type?0:this.sortInstanceNodePosition(this.current,c.current)}updateFeatures(){let c="animation";for(c in dm){const p=dm[c];if(!p)continue;const{isEnabled:_,Feature:S}=p;if(!this.features[c]&&S&&_(this.props)&&(this.features[c]=new S(this)),this.features[c]){const A=this.features[c];A.isMounted?A.update():(A.mount(),A.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):vr()}getStaticValue(c){return this.latestValues[c]}setStaticValue(c,p){this.latestValues[c]=p}update(c,p){(c.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=c,this.prevPresenceContext=this.presenceContext,this.presenceContext=p;for(let _=0;_<fw.length;_++){const S=fw[_];this.propEventSubscriptions[S]&&(this.propEventSubscriptions[S](),delete this.propEventSubscriptions[S]);const A="on"+S,T=c[A];T&&(this.propEventSubscriptions[S]=this.on(S,T))}this.prevMotionValues=wk(this,this.scrapeMotionValuesFromProps(c,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(c){return this.props.variants?this.props.variants[c]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(c){const p=this.getClosestVariantNode();if(p)return p.variantChildren&&p.variantChildren.add(c),()=>p.variantChildren.delete(c)}addValue(c,p){const _=this.values.get(c);p!==_&&(_&&this.removeValue(c),this.bindToMotionValue(c,p),this.values.set(c,p),this.latestValues[c]=p.get())}removeValue(c){this.values.delete(c);const p=this.valueSubscriptions.get(c);p&&(p(),this.valueSubscriptions.delete(c)),delete this.latestValues[c],this.removeValueFromRenderState(c,this.renderState)}hasValue(c){return this.values.has(c)}getValue(c,p){if(this.props.values&&this.props.values[c])return this.props.values[c];let _=this.values.get(c);return _===void 0&&p!==void 0&&(_=hm(p===null?void 0:p,{owner:this}),this.addValue(c,_)),_}readValue(c,p){let _=this.latestValues[c]!==void 0||!this.current?this.latestValues[c]:this.getBaseTargetFromProps(this.props,c)??this.readValueFromInstance(this.current,c,this.options);return _!=null&&(typeof _=="string"&&(aS(_)||lS(_))?_=parseFloat(_):!DL(_)&&_d.test(p)&&(_=GS(c,p)),this.setBaseTarget(c,js(_)?_.get():_)),js(_)?_.get():_}setBaseTarget(c,p){this.baseTarget[c]=p}getBaseTarget(c){const{initial:p}=this.props;let _;if(typeof p=="string"||typeof p=="object"){const A=mb(this.props,p,this.presenceContext?.custom);A&&(_=A[c])}if(p&&_!==void 0)return _;const S=this.getBaseTargetFromProps(this.props,c);return S!==void 0&&!js(S)?S:this.initialValues[c]!==void 0&&_===void 0?void 0:this.baseTarget[c]}on(c,p){return this.events[c]||(this.events[c]=new $0),this.events[c].add(p)}notify(c,...p){this.events[c]&&this.events[c].notify(...p)}scheduleRenderMicrotask(){ob.render(this.render)}}class mE extends Tk{constructor(){super(...arguments),this.KeyframeResolver=_L}sortInstanceNodePosition(c,p){return c.compareDocumentPosition(p)&2?1:-1}getBaseTargetFromProps(c,p){return c.style?c.style[p]:void 0}removeValueFromRenderState(c,{vars:p,style:_}){delete p[c],delete _[c]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:c}=this.props;js(c)&&(this.childSubscription=c.on("change",p=>{this.current&&(this.current.textContent=`${p}`)}))}}function gE(s,{style:c,vars:p},_,S){const A=s.style;let T;for(T in c)A[T]=c[T];S?.applyProjectionStyles(A,_);for(T in p)A.setProperty(T,p[T])}function Sk(s){return window.getComputedStyle(s)}class Ek extends mE{constructor(){super(...arguments),this.type="html",this.renderInstance=gE}readValueFromInstance(c,p){if(wm.has(p))return this.projection?.isProjecting?Kx(p):Nz(c,p);{const _=Sk(c),S=(Y0(p)?_.getPropertyValue(p):_[p])||0;return typeof S=="string"?S.trim():S}}measureInstanceViewportBox(c,{transformPagePoint:p}){return fE(c,p)}build(c,p,_){db(c,p,_.transformTemplate)}scrapeMotionValuesFromProps(c,p,_){return gb(c,p,_)}}const yE=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Ck(s,c,p,_){gE(s,c,void 0,_);for(const S in c.attrs)s.setAttribute(yE.has(S)?S:yb(S),c.attrs[S])}class Ak extends mE{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=vr}getBaseTargetFromProps(c,p){return c[p]}readValueFromInstance(c,p){if(wm.has(p)){const _=US(p);return _&&_.default||0}return p=yE.has(p)?p:yb(p),c.getAttribute(p)}scrapeMotionValuesFromProps(c,p,_){return aE(c,p,_)}build(c,p,_){nE(c,p,this.isSVGTag,_.transformTemplate,_.style)}renderInstance(c,p,_,S){Ck(c,p,_,S)}mount(c){this.isSVGTag=rE(c.tagName),super.mount(c)}}const Mk=(s,c)=>pb(s)?new Ak(c):new Ek(c,{allowProjection:s!==Z.Fragment});function am(s,c,p){const _=s.getProps();return mb(_,c,p!==void 0?p:_.custom,s)}const o0=s=>Array.isArray(s);function Pk(s,c,p){s.hasValue(c)?s.getValue(c).set(p):s.addValue(c,hm(p))}function Dk(s){return o0(s)?s[s.length-1]||0:s}function Rk(s,c){const p=am(s,c);let{transitionEnd:_={},transition:S={},...A}=p||{};A={...A,..._};for(const T in A){const u=Dk(A[T]);Pk(s,T,u)}}function Ik(s){return!!(js(s)&&s.add)}function l0(s,c){const p=s.getValue("willChange");if(Ik(p))return p.add(c);if(!p&&oh.WillChange){const _=new oh.WillChange("auto");s.addValue("willChange",_),_.add(c)}}function _E(s){return s.props[oE]}const zk=s=>s!==null;function Lk(s,{repeat:c,repeatType:p="loop"},_){const S=s.filter(zk),A=c&&p!=="loop"&&c%2===1?0:S.length-1;return S[A]}const kk={type:"spring",stiffness:500,damping:25,restSpeed:10},Ok=s=>({type:"spring",stiffness:550,damping:s===0?2*Math.sqrt(550):30,restSpeed:10}),Nk={type:"keyframes",duration:.8},Fk={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},jk=(s,{keyframes:c})=>c.length>2?Nk:wm.has(s)?s.startsWith("scale")?Ok(c[1]):kk:Fk;function Bk({when:s,delay:c,delayChildren:p,staggerChildren:_,staggerDirection:S,repeat:A,repeatType:T,repeatDelay:u,from:L,elapsed:k,...B}){return!!Object.keys(B).length}const _b=(s,c,p,_={},S,A)=>T=>{const u=sb(_,s)||{},L=u.delay||_.delay||0;let{elapsed:k=0}=_;k=k-Xc(L);const B={keyframes:Array.isArray(p)?p:[null,p],ease:"easeOut",velocity:c.getVelocity(),...u,delay:-k,onUpdate:W=>{c.set(W),u.onUpdate&&u.onUpdate(W)},onComplete:()=>{T(),u.onComplete&&u.onComplete()},name:s,motionValue:c,element:A?void 0:S};Bk(u)||Object.assign(B,jk(s,B)),B.duration&&(B.duration=Xc(B.duration)),B.repeatDelay&&(B.repeatDelay=Xc(B.repeatDelay)),B.from!==void 0&&(B.keyframes[0]=B.from);let H=!1;if((B.type===!1||B.duration===0&&!B.repeatDelay)&&(n0(B),B.delay===0&&(H=!0)),(oh.instantAnimations||oh.skipAnimations)&&(H=!0,n0(B),B.delay=0),B.allowFlatten=!u.type&&!u.ease,H&&!A&&c.get()!==void 0){const W=Lk(B.keyframes,u);if(W!==void 0){Vi.update(()=>{B.onUpdate(W),B.onComplete()});return}}return u.isSync?new ib(B):new aL(B)};function Vk({protectedKeys:s,needsAnimating:c},p){const _=s.hasOwnProperty(p)&&c[p]!==!0;return c[p]=!1,_}function vE(s,c,{delay:p=0,transitionOverride:_,type:S}={}){let{transition:A=s.getDefaultTransition(),transitionEnd:T,...u}=c;_&&(A=_);const L=[],k=S&&s.animationState&&s.animationState.getState()[S];for(const B in u){const H=s.getValue(B,s.latestValues[B]??null),W=u[B];if(W===void 0||k&&Vk(k,B))continue;const it={delay:p,...sb(A||{},B)},pt=H.get();if(pt!==void 0&&!H.isAnimating&&!Array.isArray(W)&&W===pt&&!it.velocity)continue;let rt=!1;if(window.MotionHandoffAnimation){const mt=_E(s);if(mt){const Et=window.MotionHandoffAnimation(mt,B,Vi);Et!==null&&(it.startTime=Et,rt=!0)}}l0(s,B),H.start(_b(B,H,W,s.shouldReduceMotion&&jS.has(B)?{type:!1}:it,s,rt));const J=H.animation;J&&L.push(J)}return T&&Promise.all(L).then(()=>{Vi.update(()=>{T&&Rk(s,T)})}),L}function xE(s,c,p,_=0,S=1){const A=Array.from(s).sort((k,B)=>k.sortNodePosition(B)).indexOf(c),T=s.size,u=(T-1)*_;return typeof p=="function"?p(A,T):S===1?A*_:u-A*_}function c0(s,c,p={}){const _=am(s,c,p.type==="exit"?s.presenceContext?.custom:void 0);let{transition:S=s.getDefaultTransition()||{}}=_||{};p.transitionOverride&&(S=p.transitionOverride);const A=_?()=>Promise.all(vE(s,_,p)):()=>Promise.resolve(),T=s.variantChildren&&s.variantChildren.size?(L=0)=>{const{delayChildren:k=0,staggerChildren:B,staggerDirection:H}=S;return Uk(s,c,L,k,B,H,p)}:()=>Promise.resolve(),{when:u}=S;if(u){const[L,k]=u==="beforeChildren"?[A,T]:[T,A];return L().then(()=>k())}else return Promise.all([A(),T(p.delay)])}function Uk(s,c,p=0,_=0,S=0,A=1,T){const u=[];for(const L of s.variantChildren)L.notify("AnimationStart",c),u.push(c0(L,c,{...T,delay:p+(typeof _=="function"?0:_)+xE(s.variantChildren,L,_,S,A)}).then(()=>L.notify("AnimationComplete",c)));return Promise.all(u)}function Gk(s,c,p={}){s.notify("AnimationStart",c);let _;if(Array.isArray(c)){const S=c.map(A=>c0(s,A,p));_=Promise.all(S)}else if(typeof c=="string")_=c0(s,c,p);else{const S=typeof c=="function"?am(s,c,p.custom):c;_=Promise.all(vE(s,S,p))}return _.then(()=>{s.notify("AnimationComplete",c)})}function bE(s,c){if(!Array.isArray(c))return!1;const p=c.length;if(p!==s.length)return!1;for(let _=0;_<p;_++)if(c[_]!==s[_])return!1;return!0}const qk=hb.length;function wE(s){if(!s)return;if(!s.isControllingVariants){const p=s.parent?wE(s.parent)||{}:{};return s.props.initial!==void 0&&(p.initial=s.props.initial),p}const c={};for(let p=0;p<qk;p++){const _=hb[p],S=s.props[_];(Qg(S)||S===!1)&&(c[_]=S)}return c}const Zk=[...ub].reverse(),$k=ub.length;function Hk(s){return c=>Promise.all(c.map(({animation:p,options:_})=>Gk(s,p,_)))}function Xk(s){let c=Hk(s),p=pw(),_=!0;const S=L=>(k,B)=>{const H=am(s,B,L==="exit"?s.presenceContext?.custom:void 0);if(H){const{transition:W,transitionEnd:it,...pt}=H;k={...k,...pt,...it}}return k};function A(L){c=L(s)}function T(L){const{props:k}=s,B=wE(s.parent)||{},H=[],W=new Set;let it={},pt=1/0;for(let J=0;J<$k;J++){const mt=Zk[J],Et=p[mt],bt=k[mt]!==void 0?k[mt]:B[mt],Lt=Qg(bt),Ot=mt===L?Et.isActive:null;Ot===!1&&(pt=J);let ee=bt===B[mt]&&bt!==k[mt]&&Lt;if(ee&&_&&s.manuallyAnimateOnMount&&(ee=!1),Et.protectedKeys={...it},!Et.isActive&&Ot===null||!bt&&!Et.prevProp||ov(bt)||typeof bt=="boolean")continue;const Nt=Yk(Et.prevProp,bt);let Kt=Nt||mt===L&&Et.isActive&&!ee&&Lt||J>pt&&Lt,xe=!1;const Ae=Array.isArray(bt)?bt:[bt];let ae=Ae.reduce(S(mt),{});Ot===!1&&(ae={});const{prevResolvedValues:ze={}}=Et,We={...ze,...ae},Ee=Qt=>{Kt=!0,W.has(Qt)&&(xe=!0,W.delete(Qt)),Et.needsAnimating[Qt]=!0;const Gt=s.getValue(Qt);Gt&&(Gt.liveStyle=!1)};for(const Qt in We){const Gt=ae[Qt],we=ze[Qt];if(it.hasOwnProperty(Qt))continue;let He=!1;o0(Gt)&&o0(we)?He=!bE(Gt,we):He=Gt!==we,He?Gt!=null?Ee(Qt):W.add(Qt):Gt!==void 0&&W.has(Qt)?Ee(Qt):Et.protectedKeys[Qt]=!0}Et.prevProp=bt,Et.prevResolvedValues=ae,Et.isActive&&(it={...it,...ae}),_&&s.blockInitialAnimation&&(Kt=!1);const me=ee&&Nt;Kt&&(!me||xe)&&H.push(...Ae.map(Qt=>{const Gt={type:mt};if(typeof Qt=="string"&&_&&!me&&s.manuallyAnimateOnMount&&s.parent){const{parent:we}=s,He=am(we,Qt);if(we.enteringChildren&&He){const{delayChildren:Rt}=He.transition||{};Gt.delay=xE(we.enteringChildren,s,Rt)}}return{animation:Qt,options:Gt}}))}if(W.size){const J={};if(typeof k.initial!="boolean"){const mt=am(s,Array.isArray(k.initial)?k.initial[0]:k.initial);mt&&mt.transition&&(J.transition=mt.transition)}W.forEach(mt=>{const Et=s.getBaseTarget(mt),bt=s.getValue(mt);bt&&(bt.liveStyle=!0),J[mt]=Et??null}),H.push({animation:J})}let rt=!!H.length;return _&&(k.initial===!1||k.initial===k.animate)&&!s.manuallyAnimateOnMount&&(rt=!1),_=!1,rt?c(H):Promise.resolve()}function u(L,k){if(p[L].isActive===k)return Promise.resolve();s.variantChildren?.forEach(H=>H.animationState?.setActive(L,k)),p[L].isActive=k;const B=T(L);for(const H in p)p[H].protectedKeys={};return B}return{animateChanges:T,setActive:u,setAnimateFunction:A,getState:()=>p,reset:()=>{p=pw()}}}function Yk(s,c){return typeof c=="string"?c!==s:Array.isArray(c)?!bE(c,s):!1}function If(s=!1){return{isActive:s,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function pw(){return{animate:If(!0),whileInView:If(),whileHover:If(),whileTap:If(),whileDrag:If(),whileFocus:If(),exit:If()}}class vd{constructor(c){this.isMounted=!1,this.node=c}update(){}}class Wk extends vd{constructor(c){super(c),c.animationState||(c.animationState=Xk(c))}updateAnimationControlsSubscription(){const{animate:c}=this.node.getProps();ov(c)&&(this.unmountControls=c.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:c}=this.node.getProps(),{animate:p}=this.node.prevProps||{};c!==p&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let Kk=0;class Qk extends vd{constructor(){super(...arguments),this.id=Kk++}update(){if(!this.node.presenceContext)return;const{isPresent:c,onExitComplete:p}=this.node.presenceContext,{isPresent:_}=this.node.prevPresenceContext||{};if(!this.node.animationState||c===_)return;const S=this.node.animationState.setActive("exit",!c);p&&!c&&S.then(()=>{p(this.id)})}mount(){const{register:c,onExitComplete:p}=this.node.presenceContext||{};p&&p(this.id),c&&(this.unmount=c(this.id))}unmount(){}}const Jk={animation:{Feature:Wk},exit:{Feature:Qk}};function ty(s,c,p,_={passive:!0}){return s.addEventListener(c,p,_),()=>s.removeEventListener(c,p)}function hy(s){return{point:{x:s.pageX,y:s.pageY}}}const tO=s=>c=>lb(c)&&s(c,hy(c));function Bg(s,c,p,_){return ty(s,c,tO(p),_)}const TE=1e-4,eO=1-TE,nO=1+TE,SE=.01,iO=0-SE,rO=0+SE;function ha(s){return s.max-s.min}function sO(s,c,p){return Math.abs(s-c)<=p}function mw(s,c,p,_=.5){s.origin=_,s.originPoint=er(c.min,c.max,s.origin),s.scale=ha(p)/ha(c),s.translate=er(p.min,p.max,s.origin)-s.originPoint,(s.scale>=eO&&s.scale<=nO||isNaN(s.scale))&&(s.scale=1),(s.translate>=iO&&s.translate<=rO||isNaN(s.translate))&&(s.translate=0)}function Vg(s,c,p,_){mw(s.x,c.x,p.x,_?_.originX:void 0),mw(s.y,c.y,p.y,_?_.originY:void 0)}function gw(s,c,p){s.min=p.min+c.min,s.max=s.min+ha(c)}function aO(s,c,p){gw(s.x,c.x,p.x),gw(s.y,c.y,p.y)}function yw(s,c,p){s.min=c.min-p.min,s.max=s.min+ha(c)}function Ug(s,c,p){yw(s.x,c.x,p.x),yw(s.y,c.y,p.y)}function il(s){return[s("x"),s("y")]}const EE=({current:s})=>s?s.ownerDocument.defaultView:null,_w=(s,c)=>Math.abs(s-c);function oO(s,c){const p=_w(s.x,c.x),_=_w(s.y,c.y);return Math.sqrt(p**2+_**2)}class CE{constructor(c,p,{transformPagePoint:_,contextWindow:S=window,dragSnapToOrigin:A=!1,distanceThreshold:T=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const W=gx(this.lastMoveEventInfo,this.history),it=this.startEvent!==null,pt=oO(W.offset,{x:0,y:0})>=this.distanceThreshold;if(!it&&!pt)return;const{point:rt}=W,{timestamp:J}=ws;this.history.push({...rt,timestamp:J});const{onStart:mt,onMove:Et}=this.handlers;it||(mt&&mt(this.lastMoveEvent,W),this.startEvent=this.lastMoveEvent),Et&&Et(this.lastMoveEvent,W)},this.handlePointerMove=(W,it)=>{this.lastMoveEvent=W,this.lastMoveEventInfo=mx(it,this.transformPagePoint),Vi.update(this.updatePoint,!0)},this.handlePointerUp=(W,it)=>{this.end();const{onEnd:pt,onSessionEnd:rt,resumeAnimation:J}=this.handlers;if(this.dragSnapToOrigin&&J&&J(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const mt=gx(W.type==="pointercancel"?this.lastMoveEventInfo:mx(it,this.transformPagePoint),this.history);this.startEvent&&pt&&pt(W,mt),rt&&rt(W,mt)},!lb(c))return;this.dragSnapToOrigin=A,this.handlers=p,this.transformPagePoint=_,this.distanceThreshold=T,this.contextWindow=S||window;const u=hy(c),L=mx(u,this.transformPagePoint),{point:k}=L,{timestamp:B}=ws;this.history=[{...k,timestamp:B}];const{onSessionStart:H}=p;H&&H(c,gx(L,this.history)),this.removeListeners=ly(Bg(this.contextWindow,"pointermove",this.handlePointerMove),Bg(this.contextWindow,"pointerup",this.handlePointerUp),Bg(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(c){this.handlers=c}end(){this.removeListeners&&this.removeListeners(),yd(this.updatePoint)}}function mx(s,c){return c?{point:c(s.point)}:s}function vw(s,c){return{x:s.x-c.x,y:s.y-c.y}}function gx({point:s},c){return{point:s,delta:vw(s,AE(c)),offset:vw(s,lO(c)),velocity:cO(c,.1)}}function lO(s){return s[0]}function AE(s){return s[s.length-1]}function cO(s,c){if(s.length<2)return{x:0,y:0};let p=s.length-1,_=null;const S=AE(s);for(;p>=0&&(_=s[p],!(S.timestamp-_.timestamp>Xc(c)));)p--;if(!_)return{x:0,y:0};const A=rl(S.timestamp-_.timestamp);if(A===0)return{x:0,y:0};const T={x:(S.x-_.x)/A,y:(S.y-_.y)/A};return T.x===1/0&&(T.x=0),T.y===1/0&&(T.y=0),T}function uO(s,{min:c,max:p},_){return c!==void 0&&s<c?s=_?er(c,s,_.min):Math.max(s,c):p!==void 0&&s>p&&(s=_?er(p,s,_.max):Math.min(s,p)),s}function xw(s,c,p){return{min:c!==void 0?s.min+c:void 0,max:p!==void 0?s.max+p-(s.max-s.min):void 0}}function hO(s,{top:c,left:p,bottom:_,right:S}){return{x:xw(s.x,p,S),y:xw(s.y,c,_)}}function bw(s,c){let p=c.min-s.min,_=c.max-s.max;return c.max-c.min<s.max-s.min&&([p,_]=[_,p]),{min:p,max:_}}function dO(s,c){return{x:bw(s.x,c.x),y:bw(s.y,c.y)}}function fO(s,c){let p=.5;const _=ha(s),S=ha(c);return S>_?p=Yg(c.min,c.max-_,s.min):_>S&&(p=Yg(s.min,s.max-S,c.min)),ah(0,1,p)}function pO(s,c){const p={};return c.min!==void 0&&(p.min=c.min-s.min),c.max!==void 0&&(p.max=c.max-s.min),p}const u0=.35;function mO(s=u0){return s===!1?s=0:s===!0&&(s=u0),{x:ww(s,"left","right"),y:ww(s,"top","bottom")}}function ww(s,c,p){return{min:Tw(s,c),max:Tw(s,p)}}function Tw(s,c){return typeof s=="number"?s:s[c]||0}const gO=new WeakMap;class yO{constructor(c){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=vr(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=c}start(c,{snapToCursor:p=!1,distanceThreshold:_}={}){const{presenceContext:S}=this.visualElement;if(S&&S.isPresent===!1)return;const A=H=>{const{dragSnapToOrigin:W}=this.getProps();W?this.pauseAnimation():this.stopAnimation(),p&&this.snapToCursor(hy(H).point)},T=(H,W)=>{const{drag:it,dragPropagation:pt,onDragStart:rt}=this.getProps();if(it&&!pt&&(this.openDragLock&&this.openDragLock(),this.openDragLock=wL(it),!this.openDragLock))return;this.latestPointerEvent=H,this.latestPanInfo=W,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),il(mt=>{let Et=this.getAxisMotionValue(mt).get()||0;if(Yc.test(Et)){const{projection:bt}=this.visualElement;if(bt&&bt.layout){const Lt=bt.layout.layoutBox[mt];Lt&&(Et=ha(Lt)*(parseFloat(Et)/100))}}this.originPoint[mt]=Et}),rt&&Vi.postRender(()=>rt(H,W)),l0(this.visualElement,"transform");const{animationState:J}=this.visualElement;J&&J.setActive("whileDrag",!0)},u=(H,W)=>{this.latestPointerEvent=H,this.latestPanInfo=W;const{dragPropagation:it,dragDirectionLock:pt,onDirectionLock:rt,onDrag:J}=this.getProps();if(!it&&!this.openDragLock)return;const{offset:mt}=W;if(pt&&this.currentDirection===null){this.currentDirection=_O(mt),this.currentDirection!==null&&rt&&rt(this.currentDirection);return}this.updateAxis("x",W.point,mt),this.updateAxis("y",W.point,mt),this.visualElement.render(),J&&J(H,W)},L=(H,W)=>{this.latestPointerEvent=H,this.latestPanInfo=W,this.stop(H,W),this.latestPointerEvent=null,this.latestPanInfo=null},k=()=>il(H=>this.getAnimationState(H)==="paused"&&this.getAxisMotionValue(H).animation?.play()),{dragSnapToOrigin:B}=this.getProps();this.panSession=new CE(c,{onSessionStart:A,onStart:T,onMove:u,onSessionEnd:L,resumeAnimation:k},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:B,distanceThreshold:_,contextWindow:EE(this.visualElement)})}stop(c,p){const _=c||this.latestPointerEvent,S=p||this.latestPanInfo,A=this.isDragging;if(this.cancel(),!A||!S||!_)return;const{velocity:T}=S;this.startAnimation(T);const{onDragEnd:u}=this.getProps();u&&Vi.postRender(()=>u(_,S))}cancel(){this.isDragging=!1;const{projection:c,animationState:p}=this.visualElement;c&&(c.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:_}=this.getProps();!_&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),p&&p.setActive("whileDrag",!1)}updateAxis(c,p,_){const{drag:S}=this.getProps();if(!_||!p_(c,S,this.currentDirection))return;const A=this.getAxisMotionValue(c);let T=this.originPoint[c]+_[c];this.constraints&&this.constraints[c]&&(T=uO(T,this.constraints[c],this.elastic[c])),A.set(T)}resolveConstraints(){const{dragConstraints:c,dragElastic:p}=this.getProps(),_=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,S=this.constraints;c&&tm(c)?this.constraints||(this.constraints=this.resolveRefConstraints()):c&&_?this.constraints=hO(_.layoutBox,c):this.constraints=!1,this.elastic=mO(p),S!==this.constraints&&_&&this.constraints&&!this.hasMutatedConstraints&&il(A=>{this.constraints!==!1&&this.getAxisMotionValue(A)&&(this.constraints[A]=pO(_.layoutBox[A],this.constraints[A]))})}resolveRefConstraints(){const{dragConstraints:c,onMeasureDragConstraints:p}=this.getProps();if(!c||!tm(c))return!1;const _=c.current,{projection:S}=this.visualElement;if(!S||!S.layout)return!1;const A=vk(_,S.root,this.visualElement.getTransformPagePoint());let T=dO(S.layout.layoutBox,A);if(p){const u=p(gk(T));this.hasMutatedConstraints=!!u,u&&(T=uE(u))}return T}startAnimation(c){const{drag:p,dragMomentum:_,dragElastic:S,dragTransition:A,dragSnapToOrigin:T,onDragTransitionEnd:u}=this.getProps(),L=this.constraints||{},k=il(B=>{if(!p_(B,p,this.currentDirection))return;let H=L&&L[B]||{};T&&(H={min:0,max:0});const W=S?200:1e6,it=S?40:1e7,pt={type:"inertia",velocity:_?c[B]:0,bounceStiffness:W,bounceDamping:it,timeConstant:750,restDelta:1,restSpeed:10,...A,...H};return this.startAxisValueAnimation(B,pt)});return Promise.all(k).then(u)}startAxisValueAnimation(c,p){const _=this.getAxisMotionValue(c);return l0(this.visualElement,c),_.start(_b(c,_,0,p,this.visualElement,!1))}stopAnimation(){il(c=>this.getAxisMotionValue(c).stop())}pauseAnimation(){il(c=>this.getAxisMotionValue(c).animation?.pause())}getAnimationState(c){return this.getAxisMotionValue(c).animation?.state}getAxisMotionValue(c){const p=`_drag${c.toUpperCase()}`,_=this.visualElement.getProps(),S=_[p];return S||this.visualElement.getValue(c,(_.initial?_.initial[c]:void 0)||0)}snapToCursor(c){il(p=>{const{drag:_}=this.getProps();if(!p_(p,_,this.currentDirection))return;const{projection:S}=this.visualElement,A=this.getAxisMotionValue(p);if(S&&S.layout){const{min:T,max:u}=S.layout.layoutBox[p];A.set(c[p]-er(T,u,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:c,dragConstraints:p}=this.getProps(),{projection:_}=this.visualElement;if(!tm(p)||!_||!this.constraints)return;this.stopAnimation();const S={x:0,y:0};il(T=>{const u=this.getAxisMotionValue(T);if(u&&this.constraints!==!1){const L=u.get();S[T]=fO({min:L,max:L},this.constraints[T])}});const{transformTemplate:A}=this.visualElement.getProps();this.visualElement.current.style.transform=A?A({},""):"none",_.root&&_.root.updateScroll(),_.updateLayout(),this.resolveConstraints(),il(T=>{if(!p_(T,c,null))return;const u=this.getAxisMotionValue(T),{min:L,max:k}=this.constraints[T];u.set(er(L,k,S[T]))})}addListeners(){if(!this.visualElement.current)return;gO.set(this.visualElement,this);const c=this.visualElement.current,p=Bg(c,"pointerdown",L=>{const{drag:k,dragListener:B=!0}=this.getProps();k&&B&&this.start(L)}),_=()=>{const{dragConstraints:L}=this.getProps();tm(L)&&L.current&&(this.constraints=this.resolveRefConstraints())},{projection:S}=this.visualElement,A=S.addEventListener("measure",_);S&&!S.layout&&(S.root&&S.root.updateScroll(),S.updateLayout()),Vi.read(_);const T=ty(window,"resize",()=>this.scalePositionWithinConstraints()),u=S.addEventListener("didUpdate",(({delta:L,hasLayoutChanged:k})=>{this.isDragging&&k&&(il(B=>{const H=this.getAxisMotionValue(B);H&&(this.originPoint[B]+=L[B].translate,H.set(H.get()+L[B].translate))}),this.visualElement.render())}));return()=>{T(),p(),A(),u&&u()}}getProps(){const c=this.visualElement.getProps(),{drag:p=!1,dragDirectionLock:_=!1,dragPropagation:S=!1,dragConstraints:A=!1,dragElastic:T=u0,dragMomentum:u=!0}=c;return{...c,drag:p,dragDirectionLock:_,dragPropagation:S,dragConstraints:A,dragElastic:T,dragMomentum:u}}}function p_(s,c,p){return(c===!0||c===s)&&(p===null||p===s)}function _O(s,c=10){let p=null;return Math.abs(s.y)>c?p="y":Math.abs(s.x)>c&&(p="x"),p}class vO extends vd{constructor(c){super(c),this.removeGroupControls=sl,this.removeListeners=sl,this.controls=new yO(c)}mount(){const{dragControls:c}=this.node.getProps();c&&(this.removeGroupControls=c.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||sl}unmount(){this.removeGroupControls(),this.removeListeners()}}const Sw=s=>(c,p)=>{s&&Vi.postRender(()=>s(c,p))};class xO extends vd{constructor(){super(...arguments),this.removePointerDownListener=sl}onPointerDown(c){this.session=new CE(c,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:EE(this.node)})}createPanHandlers(){const{onPanSessionStart:c,onPanStart:p,onPan:_,onPanEnd:S}=this.node.getProps();return{onSessionStart:Sw(c),onStart:Sw(p),onMove:_,onEnd:(A,T)=>{delete this.session,S&&Vi.postRender(()=>S(A,T))}}}mount(){this.removePointerDownListener=Bg(this.node.current,"pointerdown",c=>this.onPointerDown(c))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const M_={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Ew(s,c){return c.max===c.min?0:s/(c.max-c.min)*100}const kg={correct:(s,c)=>{if(!c.target)return s;if(typeof s=="string")if(sn.test(s))s=parseFloat(s);else return s;const p=Ew(s,c.target.x),_=Ew(s,c.target.y);return`${p}% ${_}%`}},bO={correct:(s,{treeScale:c,projectionDelta:p})=>{const _=s,S=_d.parse(s);if(S.length>5)return _;const A=_d.createTransformer(s),T=typeof S[0]!="number"?1:0,u=p.x.scale*c.x,L=p.y.scale*c.y;S[0+T]/=u,S[1+T]/=L;const k=er(u,L,.5);return typeof S[2+T]=="number"&&(S[2+T]/=k),typeof S[3+T]=="number"&&(S[3+T]/=k),A(S)}};let yx=!1;class wO extends Z.Component{componentDidMount(){const{visualElement:c,layoutGroup:p,switchLayoutGroup:_,layoutId:S}=this.props,{projection:A}=c;qL(TO),A&&(p.group&&p.group.add(A),_&&_.register&&S&&_.register(A),yx&&A.root.didUpdate(),A.addEventListener("animationComplete",()=>{this.safeToRemove()}),A.setOptions({...A.options,onExitComplete:()=>this.safeToRemove()})),M_.hasEverUpdated=!0}getSnapshotBeforeUpdate(c){const{layoutDependency:p,visualElement:_,drag:S,isPresent:A}=this.props,{projection:T}=_;return T&&(T.isPresent=A,yx=!0,S||c.layoutDependency!==p||p===void 0||c.isPresent!==A?T.willUpdate():this.safeToRemove(),c.isPresent!==A&&(A?T.promote():T.relegate()||Vi.postRender(()=>{const u=T.getStack();(!u||!u.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:c}=this.props.visualElement;c&&(c.root.didUpdate(),ob.postRender(()=>{!c.currentAnimation&&c.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:c,layoutGroup:p,switchLayoutGroup:_}=this.props,{projection:S}=c;yx=!0,S&&(S.scheduleCheckAfterUnmount(),p&&p.group&&p.group.remove(S),_&&_.deregister&&_.deregister(S))}safeToRemove(){const{safeToRemove:c}=this.props;c&&c()}render(){return null}}function ME(s){const[c,p]=WS(),_=Z.useContext(j0);return F.jsx(wO,{...s,layoutGroup:_,switchLayoutGroup:Z.useContext(lE),isPresent:c,safeToRemove:p})}const TO={borderRadius:{...kg,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:kg,borderTopRightRadius:kg,borderBottomLeftRadius:kg,borderBottomRightRadius:kg,boxShadow:bO};function SO(s,c,p){const _=js(s)?s:hm(s);return _.start(_b("",_,c,p)),_.animation}const EO=(s,c)=>s.depth-c.depth;class CO{constructor(){this.children=[],this.isDirty=!1}add(c){U0(this.children,c),this.isDirty=!0}remove(c){G0(this.children,c),this.isDirty=!0}forEach(c){this.isDirty&&this.children.sort(EO),this.isDirty=!1,this.children.forEach(c)}}function AO(s,c){const p=Ua.now(),_=({timestamp:S})=>{const A=S-p;A>=c&&(yd(_),s(A-c))};return Vi.setup(_,!0),()=>yd(_)}const PE=["TopLeft","TopRight","BottomLeft","BottomRight"],MO=PE.length,Cw=s=>typeof s=="string"?parseFloat(s):s,Aw=s=>typeof s=="number"||sn.test(s);function PO(s,c,p,_,S,A){S?(s.opacity=er(0,p.opacity??1,DO(_)),s.opacityExit=er(c.opacity??1,0,RO(_))):A&&(s.opacity=er(c.opacity??1,p.opacity??1,_));for(let T=0;T<MO;T++){const u=`border${PE[T]}Radius`;let L=Mw(c,u),k=Mw(p,u);if(L===void 0&&k===void 0)continue;L||(L=0),k||(k=0),L===0||k===0||Aw(L)===Aw(k)?(s[u]=Math.max(er(Cw(L),Cw(k),_),0),(Yc.test(k)||Yc.test(L))&&(s[u]+="%")):s[u]=k}(c.rotate||p.rotate)&&(s.rotate=er(c.rotate||0,p.rotate||0,_))}function Mw(s,c){return s[c]!==void 0?s[c]:s.borderRadius}const DO=DE(0,.5,gS),RO=DE(.5,.95,sl);function DE(s,c,p){return _=>_<s?0:_>c?1:p(Yg(s,c,_))}function Pw(s,c){s.min=c.min,s.max=c.max}function nl(s,c){Pw(s.x,c.x),Pw(s.y,c.y)}function Dw(s,c){s.translate=c.translate,s.scale=c.scale,s.originPoint=c.originPoint,s.origin=c.origin}function Rw(s,c,p,_,S){return s-=c,s=V_(s,1/p,_),S!==void 0&&(s=V_(s,1/S,_)),s}function IO(s,c=0,p=1,_=.5,S,A=s,T=s){if(Yc.test(c)&&(c=parseFloat(c),c=er(T.min,T.max,c/100)-T.min),typeof c!="number")return;let u=er(A.min,A.max,_);s===A&&(u-=c),s.min=Rw(s.min,c,p,u,S),s.max=Rw(s.max,c,p,u,S)}function Iw(s,c,[p,_,S],A,T){IO(s,c[p],c[_],c[S],c.scale,A,T)}const zO=["x","scaleX","originX"],LO=["y","scaleY","originY"];function zw(s,c,p,_){Iw(s.x,c,zO,p?p.x:void 0,_?_.x:void 0),Iw(s.y,c,LO,p?p.y:void 0,_?_.y:void 0)}function Lw(s){return s.translate===0&&s.scale===1}function RE(s){return Lw(s.x)&&Lw(s.y)}function kw(s,c){return s.min===c.min&&s.max===c.max}function kO(s,c){return kw(s.x,c.x)&&kw(s.y,c.y)}function Ow(s,c){return Math.round(s.min)===Math.round(c.min)&&Math.round(s.max)===Math.round(c.max)}function IE(s,c){return Ow(s.x,c.x)&&Ow(s.y,c.y)}function Nw(s){return ha(s.x)/ha(s.y)}function Fw(s,c){return s.translate===c.translate&&s.scale===c.scale&&s.originPoint===c.originPoint}class OO{constructor(){this.members=[]}add(c){U0(this.members,c),c.scheduleRender()}remove(c){if(G0(this.members,c),c===this.prevLead&&(this.prevLead=void 0),c===this.lead){const p=this.members[this.members.length-1];p&&this.promote(p)}}relegate(c){const p=this.members.findIndex(S=>c===S);if(p===0)return!1;let _;for(let S=p;S>=0;S--){const A=this.members[S];if(A.isPresent!==!1){_=A;break}}return _?(this.promote(_),!0):!1}promote(c,p){const _=this.lead;if(c!==_&&(this.prevLead=_,this.lead=c,c.show(),_)){_.instance&&_.scheduleRender(),c.scheduleRender(),c.resumeFrom=_,p&&(c.resumeFrom.preserveOpacity=!0),_.snapshot&&(c.snapshot=_.snapshot,c.snapshot.latestValues=_.animationValues||_.latestValues),c.root&&c.root.isUpdating&&(c.isLayoutDirty=!0);const{crossfade:S}=c.options;S===!1&&_.hide()}}exitAnimationComplete(){this.members.forEach(c=>{const{options:p,resumingFrom:_}=c;p.onExitComplete&&p.onExitComplete(),_&&_.options.onExitComplete&&_.options.onExitComplete()})}scheduleRender(){this.members.forEach(c=>{c.instance&&c.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function NO(s,c,p){let _="";const S=s.x.translate/c.x,A=s.y.translate/c.y,T=p?.z||0;if((S||A||T)&&(_=`translate3d(${S}px, ${A}px, ${T}px) `),(c.x!==1||c.y!==1)&&(_+=`scale(${1/c.x}, ${1/c.y}) `),p){const{transformPerspective:k,rotate:B,rotateX:H,rotateY:W,skewX:it,skewY:pt}=p;k&&(_=`perspective(${k}px) ${_}`),B&&(_+=`rotate(${B}deg) `),H&&(_+=`rotateX(${H}deg) `),W&&(_+=`rotateY(${W}deg) `),it&&(_+=`skewX(${it}deg) `),pt&&(_+=`skewY(${pt}deg) `)}const u=s.x.scale*c.x,L=s.y.scale*c.y;return(u!==1||L!==1)&&(_+=`scale(${u}, ${L})`),_||"none"}const _x=["","X","Y","Z"],FO=1e3;let jO=0;function vx(s,c,p,_){const{latestValues:S}=c;S[s]&&(p[s]=S[s],c.setStaticValue(s,0),_&&(_[s]=0))}function zE(s){if(s.hasCheckedOptimisedAppear=!0,s.root===s)return;const{visualElement:c}=s.options;if(!c)return;const p=_E(c);if(window.MotionHasOptimisedAnimation(p,"transform")){const{layout:S,layoutId:A}=s.options;window.MotionCancelOptimisedAnimation(p,"transform",Vi,!(S||A))}const{parent:_}=s;_&&!_.hasCheckedOptimisedAppear&&zE(_)}function LE({attachResizeListener:s,defaultParent:c,measureScroll:p,checkIsScrollRoot:_,resetTransform:S}){return class{constructor(T={},u=c?.()){this.id=jO++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(UO),this.nodes.forEach($O),this.nodes.forEach(HO),this.nodes.forEach(GO)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=T,this.root=u?u.root||u:this,this.path=u?[...u.path,u]:[],this.parent=u,this.depth=u?u.depth+1:0;for(let L=0;L<this.path.length;L++)this.path[L].shouldResetTransform=!0;this.root===this&&(this.nodes=new CO)}addEventListener(T,u){return this.eventHandlers.has(T)||this.eventHandlers.set(T,new $0),this.eventHandlers.get(T).add(u)}notifyListeners(T,...u){const L=this.eventHandlers.get(T);L&&L.notify(...u)}hasListeners(T){return this.eventHandlers.has(T)}mount(T){if(this.instance)return;this.isSVG=YS(T)&&!ML(T),this.instance=T;const{layoutId:u,layout:L,visualElement:k}=this.options;if(k&&!k.current&&k.mount(T),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(L||u)&&(this.isLayoutDirty=!0),s){let B,H=0;const W=()=>this.root.updateBlockedByResize=!1;Vi.read(()=>{H=window.innerWidth}),s(T,()=>{const it=window.innerWidth;it!==H&&(H=it,this.root.updateBlockedByResize=!0,B&&B(),B=AO(W,250),M_.hasAnimatedSinceResize&&(M_.hasAnimatedSinceResize=!1,this.nodes.forEach(Vw)))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&k&&(u||L)&&this.addEventListener("didUpdate",({delta:B,hasLayoutChanged:H,hasRelativeLayoutChanged:W,layout:it})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const pt=this.options.transition||k.getDefaultTransition()||QO,{onLayoutAnimationStart:rt,onLayoutAnimationComplete:J}=k.getProps(),mt=!this.targetLayout||!IE(this.targetLayout,it),Et=!H&&W;if(this.options.layoutRoot||this.resumeFrom||Et||H&&(mt||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const bt={...sb(pt,"layout"),onPlay:rt,onComplete:J};(k.shouldReduceMotion||this.options.layoutRoot)&&(bt.delay=0,bt.type=!1),this.startAnimation(bt),this.setAnimationOrigin(B,Et)}else H||Vw(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=it})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const T=this.getStack();T&&T.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),yd(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(XO),this.animationId++)}getTransformTemplate(){const{visualElement:T}=this.options;return T&&T.getProps().transformTemplate}willUpdate(T=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&zE(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let B=0;B<this.path.length;B++){const H=this.path[B];H.shouldResetTransform=!0,H.updateScroll("snapshot"),H.options.layoutRoot&&H.willUpdate(!1)}const{layoutId:u,layout:L}=this.options;if(u===void 0&&!L)return;const k=this.getTransformTemplate();this.prevTransformTemplateValue=k?k(this.latestValues,""):void 0,this.updateSnapshot(),T&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(jw);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(Bw);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(ZO),this.nodes.forEach(BO),this.nodes.forEach(VO)):this.nodes.forEach(Bw),this.clearAllSnapshots();const u=Ua.now();ws.delta=ah(0,1e3/60,u-ws.timestamp),ws.timestamp=u,ws.isProcessing=!0,ox.update.process(ws),ox.preRender.process(ws),ox.render.process(ws),ws.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,ob.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(qO),this.sharedNodes.forEach(YO)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Vi.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Vi.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ha(this.snapshot.measuredBox.x)&&!ha(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let L=0;L<this.path.length;L++)this.path[L].updateScroll();const T=this.layout;this.layout=this.measure(!1),this.layoutCorrected=vr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:u}=this.options;u&&u.notify("LayoutMeasure",this.layout.layoutBox,T?T.layoutBox:void 0)}updateScroll(T="measure"){let u=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===T&&(u=!1),u&&this.instance){const L=_(this.instance);this.scroll={animationId:this.root.animationId,phase:T,isRoot:L,offset:p(this.instance),wasRoot:this.scroll?this.scroll.isRoot:L}}}resetTransform(){if(!S)return;const T=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,u=this.projectionDelta&&!RE(this.projectionDelta),L=this.getTransformTemplate(),k=L?L(this.latestValues,""):void 0,B=k!==this.prevTransformTemplateValue;T&&this.instance&&(u||zf(this.latestValues)||B)&&(S(this.instance,k),this.shouldResetTransform=!1,this.scheduleRender())}measure(T=!0){const u=this.measurePageBox();let L=this.removeElementScroll(u);return T&&(L=this.removeTransform(L)),JO(L),{animationId:this.root.animationId,measuredBox:u,layoutBox:L,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:T}=this.options;if(!T)return vr();const u=T.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(t3))){const{scroll:k}=this.root;k&&(em(u.x,k.offset.x),em(u.y,k.offset.y))}return u}removeElementScroll(T){const u=vr();if(nl(u,T),this.scroll?.wasRoot)return u;for(let L=0;L<this.path.length;L++){const k=this.path[L],{scroll:B,options:H}=k;k!==this.root&&B&&H.layoutScroll&&(B.wasRoot&&nl(u,T),em(u.x,B.offset.x),em(u.y,B.offset.y))}return u}applyTransform(T,u=!1){const L=vr();nl(L,T);for(let k=0;k<this.path.length;k++){const B=this.path[k];!u&&B.options.layoutScroll&&B.scroll&&B!==B.root&&nm(L,{x:-B.scroll.offset.x,y:-B.scroll.offset.y}),zf(B.latestValues)&&nm(L,B.latestValues)}return zf(this.latestValues)&&nm(L,this.latestValues),L}removeTransform(T){const u=vr();nl(u,T);for(let L=0;L<this.path.length;L++){const k=this.path[L];if(!k.instance||!zf(k.latestValues))continue;r0(k.latestValues)&&k.updateSnapshot();const B=vr(),H=k.measurePageBox();nl(B,H),zw(u,k.latestValues,k.snapshot?k.snapshot.layoutBox:void 0,B)}return zf(this.latestValues)&&zw(u,this.latestValues),u}setTargetDelta(T){this.targetDelta=T,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(T){this.options={...this.options,...T,crossfade:T.crossfade!==void 0?T.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ws.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(T=!1){const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const L=!!this.resumingFrom||this!==u;if(!(T||L&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:B,layoutId:H}=this.options;if(!(!this.layout||!(B||H))){if(this.resolvedRelativeTargetAt=ws.timestamp,!this.targetDelta&&!this.relativeTarget){const W=this.getClosestProjectingParent();W&&W.layout&&this.animationProgress!==1?(this.relativeParent=W,this.forceRelativeParentToResolveTarget(),this.relativeTarget=vr(),this.relativeTargetOrigin=vr(),Ug(this.relativeTargetOrigin,this.layout.layoutBox,W.layout.layoutBox),nl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=vr(),this.targetWithTransforms=vr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),aO(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):nl(this.target,this.layout.layoutBox),dE(this.target,this.targetDelta)):nl(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const W=this.getClosestProjectingParent();W&&!!W.resumingFrom==!!this.resumingFrom&&!W.options.layoutScroll&&W.target&&this.animationProgress!==1?(this.relativeParent=W,this.forceRelativeParentToResolveTarget(),this.relativeTarget=vr(),this.relativeTargetOrigin=vr(),Ug(this.relativeTargetOrigin,this.target,W.target),nl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||r0(this.parent.latestValues)||hE(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const T=this.getLead(),u=!!this.resumingFrom||this!==T;let L=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(L=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(L=!1),this.resolvedRelativeTargetAt===ws.timestamp&&(L=!1),L)return;const{layout:k,layoutId:B}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(k||B))return;nl(this.layoutCorrected,this.layout.layoutBox);const H=this.treeScale.x,W=this.treeScale.y;_k(this.layoutCorrected,this.treeScale,this.path,u),T.layout&&!T.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(T.target=T.layout.layoutBox,T.targetWithTransforms=vr());const{target:it}=T;if(!it){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Dw(this.prevProjectionDelta.x,this.projectionDelta.x),Dw(this.prevProjectionDelta.y,this.projectionDelta.y)),Vg(this.projectionDelta,this.layoutCorrected,it,this.latestValues),(this.treeScale.x!==H||this.treeScale.y!==W||!Fw(this.projectionDelta.x,this.prevProjectionDelta.x)||!Fw(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",it))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(T=!0){if(this.options.visualElement?.scheduleRender(),T){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=im(),this.projectionDelta=im(),this.projectionDeltaWithTransform=im()}setAnimationOrigin(T,u=!1){const L=this.snapshot,k=L?L.latestValues:{},B={...this.latestValues},H=im();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!u;const W=vr(),it=L?L.source:void 0,pt=this.layout?this.layout.source:void 0,rt=it!==pt,J=this.getStack(),mt=!J||J.members.length<=1,Et=!!(rt&&!mt&&this.options.crossfade===!0&&!this.path.some(KO));this.animationProgress=0;let bt;this.mixTargetDelta=Lt=>{const Ot=Lt/1e3;Uw(H.x,T.x,Ot),Uw(H.y,T.y,Ot),this.setTargetDelta(H),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ug(W,this.layout.layoutBox,this.relativeParent.layout.layoutBox),WO(this.relativeTarget,this.relativeTargetOrigin,W,Ot),bt&&kO(this.relativeTarget,bt)&&(this.isProjectionDirty=!1),bt||(bt=vr()),nl(bt,this.relativeTarget)),rt&&(this.animationValues=B,PO(B,k,this.latestValues,Ot,Et,mt)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=Ot},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(T){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(yd(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Vi.update(()=>{M_.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=hm(0)),this.currentAnimation=SO(this.motionValue,[0,1e3],{...T,velocity:0,isSync:!0,onUpdate:u=>{this.mixTargetDelta(u),T.onUpdate&&T.onUpdate(u)},onStop:()=>{},onComplete:()=>{T.onComplete&&T.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const T=this.getStack();T&&T.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(FO),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const T=this.getLead();let{targetWithTransforms:u,target:L,layout:k,latestValues:B}=T;if(!(!u||!L||!k)){if(this!==T&&this.layout&&k&&kE(this.options.animationType,this.layout.layoutBox,k.layoutBox)){L=this.target||vr();const H=ha(this.layout.layoutBox.x);L.x.min=T.target.x.min,L.x.max=L.x.min+H;const W=ha(this.layout.layoutBox.y);L.y.min=T.target.y.min,L.y.max=L.y.min+W}nl(u,L),nm(u,B),Vg(this.projectionDeltaWithTransform,this.layoutCorrected,u,B)}}registerSharedNode(T,u){this.sharedNodes.has(T)||this.sharedNodes.set(T,new OO),this.sharedNodes.get(T).add(u);const k=u.options.initialPromotionConfig;u.promote({transition:k?k.transition:void 0,preserveFollowOpacity:k&&k.shouldPreserveFollowOpacity?k.shouldPreserveFollowOpacity(u):void 0})}isLead(){const T=this.getStack();return T?T.lead===this:!0}getLead(){const{layoutId:T}=this.options;return T?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:T}=this.options;return T?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:T}=this.options;if(T)return this.root.sharedNodes.get(T)}promote({needsReset:T,transition:u,preserveFollowOpacity:L}={}){const k=this.getStack();k&&k.promote(this,L),T&&(this.projectionDelta=void 0,this.needsReset=!0),u&&this.setOptions({transition:u})}relegate(){const T=this.getStack();return T?T.relegate(this):!1}resetSkewAndRotation(){const{visualElement:T}=this.options;if(!T)return;let u=!1;const{latestValues:L}=T;if((L.z||L.rotate||L.rotateX||L.rotateY||L.rotateZ||L.skewX||L.skewY)&&(u=!0),!u)return;const k={};L.z&&vx("z",T,k,this.animationValues);for(let B=0;B<_x.length;B++)vx(`rotate${_x[B]}`,T,k,this.animationValues),vx(`skew${_x[B]}`,T,k,this.animationValues);T.render();for(const B in k)T.setStaticValue(B,k[B]),this.animationValues&&(this.animationValues[B]=k[B]);T.scheduleRender()}applyProjectionStyles(T,u){if(!this.instance||this.isSVG)return;if(!this.isVisible){T.visibility="hidden";return}const L=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,T.visibility="",T.opacity="",T.pointerEvents=A_(u?.pointerEvents)||"",T.transform=L?L(this.latestValues,""):"none";return}const k=this.getLead();if(!this.projectionDelta||!this.layout||!k.target){this.options.layoutId&&(T.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,T.pointerEvents=A_(u?.pointerEvents)||""),this.hasProjected&&!zf(this.latestValues)&&(T.transform=L?L({},""):"none",this.hasProjected=!1);return}T.visibility="";const B=k.animationValues||k.latestValues;this.applyTransformsToTarget();let H=NO(this.projectionDeltaWithTransform,this.treeScale,B);L&&(H=L(B,H)),T.transform=H;const{x:W,y:it}=this.projectionDelta;T.transformOrigin=`${W.origin*100}% ${it.origin*100}% 0`,k.animationValues?T.opacity=k===this?B.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:B.opacityExit:T.opacity=k===this?B.opacity!==void 0?B.opacity:"":B.opacityExit!==void 0?B.opacityExit:0;for(const pt in Jg){if(B[pt]===void 0)continue;const{correct:rt,applyTo:J,isCSSVariable:mt}=Jg[pt],Et=H==="none"?B[pt]:rt(B[pt],k);if(J){const bt=J.length;for(let Lt=0;Lt<bt;Lt++)T[J[Lt]]=Et}else mt?this.options.visualElement.renderState.vars[pt]=Et:T[pt]=Et}this.options.layoutId&&(T.pointerEvents=k===this?A_(u?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(T=>T.currentAnimation?.stop()),this.root.nodes.forEach(jw),this.root.sharedNodes.clear()}}}function BO(s){s.updateLayout()}function VO(s){const c=s.resumeFrom?.snapshot||s.snapshot;if(s.isLead()&&s.layout&&c&&s.hasListeners("didUpdate")){const{layoutBox:p,measuredBox:_}=s.layout,{animationType:S}=s.options,A=c.source!==s.layout.source;S==="size"?il(B=>{const H=A?c.measuredBox[B]:c.layoutBox[B],W=ha(H);H.min=p[B].min,H.max=H.min+W}):kE(S,c.layoutBox,p)&&il(B=>{const H=A?c.measuredBox[B]:c.layoutBox[B],W=ha(p[B]);H.max=H.min+W,s.relativeTarget&&!s.currentAnimation&&(s.isProjectionDirty=!0,s.relativeTarget[B].max=s.relativeTarget[B].min+W)});const T=im();Vg(T,p,c.layoutBox);const u=im();A?Vg(u,s.applyTransform(_,!0),c.measuredBox):Vg(u,p,c.layoutBox);const L=!RE(T);let k=!1;if(!s.resumeFrom){const B=s.getClosestProjectingParent();if(B&&!B.resumeFrom){const{snapshot:H,layout:W}=B;if(H&&W){const it=vr();Ug(it,c.layoutBox,H.layoutBox);const pt=vr();Ug(pt,p,W.layoutBox),IE(it,pt)||(k=!0),B.options.layoutRoot&&(s.relativeTarget=pt,s.relativeTargetOrigin=it,s.relativeParent=B)}}}s.notifyListeners("didUpdate",{layout:p,snapshot:c,delta:u,layoutDelta:T,hasLayoutChanged:L,hasRelativeLayoutChanged:k})}else if(s.isLead()){const{onExitComplete:p}=s.options;p&&p()}s.options.transition=void 0}function UO(s){s.parent&&(s.isProjecting()||(s.isProjectionDirty=s.parent.isProjectionDirty),s.isSharedProjectionDirty||(s.isSharedProjectionDirty=!!(s.isProjectionDirty||s.parent.isProjectionDirty||s.parent.isSharedProjectionDirty)),s.isTransformDirty||(s.isTransformDirty=s.parent.isTransformDirty))}function GO(s){s.isProjectionDirty=s.isSharedProjectionDirty=s.isTransformDirty=!1}function qO(s){s.clearSnapshot()}function jw(s){s.clearMeasurements()}function Bw(s){s.isLayoutDirty=!1}function ZO(s){const{visualElement:c}=s.options;c&&c.getProps().onBeforeLayoutMeasure&&c.notify("BeforeLayoutMeasure"),s.resetTransform()}function Vw(s){s.finishAnimation(),s.targetDelta=s.relativeTarget=s.target=void 0,s.isProjectionDirty=!0}function $O(s){s.resolveTargetDelta()}function HO(s){s.calcProjection()}function XO(s){s.resetSkewAndRotation()}function YO(s){s.removeLeadSnapshot()}function Uw(s,c,p){s.translate=er(c.translate,0,p),s.scale=er(c.scale,1,p),s.origin=c.origin,s.originPoint=c.originPoint}function Gw(s,c,p,_){s.min=er(c.min,p.min,_),s.max=er(c.max,p.max,_)}function WO(s,c,p,_){Gw(s.x,c.x,p.x,_),Gw(s.y,c.y,p.y,_)}function KO(s){return s.animationValues&&s.animationValues.opacityExit!==void 0}const QO={duration:.45,ease:[.4,0,.1,1]},qw=s=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(s),Zw=qw("applewebkit/")&&!qw("chrome/")?Math.round:sl;function $w(s){s.min=Zw(s.min),s.max=Zw(s.max)}function JO(s){$w(s.x),$w(s.y)}function kE(s,c,p){return s==="position"||s==="preserve-aspect"&&!sO(Nw(c),Nw(p),.2)}function t3(s){return s!==s.root&&s.scroll?.wasRoot}const e3=LE({attachResizeListener:(s,c)=>ty(s,"resize",c),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),xx={current:void 0},OE=LE({measureScroll:s=>({x:s.scrollLeft,y:s.scrollTop}),defaultParent:()=>{if(!xx.current){const s=new e3({});s.mount(window),s.setOptions({layoutScroll:!0}),xx.current=s}return xx.current},resetTransform:(s,c)=>{s.style.transform=c!==void 0?c:"none"},checkIsScrollRoot:s=>window.getComputedStyle(s).position==="fixed"}),n3={pan:{Feature:xO},drag:{Feature:vO,ProjectionNode:OE,MeasureLayout:ME}};function Hw(s,c,p){const{props:_}=s;s.animationState&&_.whileHover&&s.animationState.setActive("whileHover",p==="Start");const S="onHover"+p,A=_[S];A&&Vi.postRender(()=>A(c,hy(c)))}class i3 extends vd{mount(){const{current:c}=this.node;c&&(this.unmount=TL(c,(p,_)=>(Hw(this.node,_,"Start"),S=>Hw(this.node,S,"End"))))}unmount(){}}class r3 extends vd{constructor(){super(...arguments),this.isActive=!1}onFocus(){let c=!1;try{c=this.node.current.matches(":focus-visible")}catch{c=!0}!c||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ly(ty(this.node.current,"focus",()=>this.onFocus()),ty(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Xw(s,c,p){const{props:_}=s;if(s.current instanceof HTMLButtonElement&&s.current.disabled)return;s.animationState&&_.whileTap&&s.animationState.setActive("whileTap",p==="Start");const S="onTap"+(p==="End"?"":p),A=_[S];A&&Vi.postRender(()=>A(c,hy(c)))}class s3 extends vd{mount(){const{current:c}=this.node;c&&(this.unmount=AL(c,(p,_)=>(Xw(this.node,_,"Start"),(S,{success:A})=>Xw(this.node,S,A?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const h0=new WeakMap,bx=new WeakMap,a3=s=>{const c=h0.get(s.target);c&&c(s)},o3=s=>{s.forEach(a3)};function l3({root:s,...c}){const p=s||document;bx.has(p)||bx.set(p,{});const _=bx.get(p),S=JSON.stringify(c);return _[S]||(_[S]=new IntersectionObserver(o3,{root:s,...c})),_[S]}function c3(s,c,p){const _=l3(c);return h0.set(s,p),_.observe(s),()=>{h0.delete(s),_.unobserve(s)}}const u3={some:0,all:1};class h3 extends vd{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:c={}}=this.node.getProps(),{root:p,margin:_,amount:S="some",once:A}=c,T={root:p?p.current:void 0,rootMargin:_,threshold:typeof S=="number"?S:u3[S]},u=L=>{const{isIntersecting:k}=L;if(this.isInView===k||(this.isInView=k,A&&!k&&this.hasEnteredView))return;k&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",k);const{onViewportEnter:B,onViewportLeave:H}=this.node.getProps(),W=k?B:H;W&&W(L)};return c3(this.node.current,T,u)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:c,prevProps:p}=this.node;["amount","margin","root"].some(d3(c,p))&&this.startObserver()}unmount(){}}function d3({viewport:s={}},{viewport:c={}}={}){return p=>s[p]!==c[p]}const f3={inView:{Feature:h3},tap:{Feature:s3},focus:{Feature:r3},hover:{Feature:i3}},p3={layout:{ProjectionNode:OE,MeasureLayout:ME}},m3={...Jk,...f3,...n3,...p3},Wc=mk(m3,Mk);var g3=Symbol.for("react.lazy"),U_=H_[" use ".trim().toString()];function y3(s){return typeof s=="object"&&s!==null&&"then"in s}function NE(s){return s!=null&&typeof s=="object"&&"$$typeof"in s&&s.$$typeof===g3&&"_payload"in s&&y3(s._payload)}function vb(s){const c=v3(s),p=Z.forwardRef((_,S)=>{let{children:A,...T}=_;NE(A)&&typeof U_=="function"&&(A=U_(A._payload));const u=Z.Children.toArray(A),L=u.find(b3);if(L){const k=L.props.children,B=u.map(H=>H===L?Z.Children.count(k)>1?Z.Children.only(null):Z.isValidElement(k)?k.props.children:null:H);return F.jsx(c,{...T,ref:S,children:Z.isValidElement(k)?Z.cloneElement(k,void 0,B):null})}return F.jsx(c,{...T,ref:S,children:A})});return p.displayName=`${s}.Slot`,p}var _3=vb("Slot");function v3(s){const c=Z.forwardRef((p,_)=>{let{children:S,...A}=p;if(NE(S)&&typeof U_=="function"&&(S=U_(S._payload)),Z.isValidElement(S)){const T=T3(S),u=w3(A,S.props);return S.type!==Z.Fragment&&(u.ref=_?ry(_,T):T),Z.cloneElement(S,u)}return Z.Children.count(S)>1?Z.Children.only(null):null});return c.displayName=`${s}.SlotClone`,c}var x3=Symbol("radix.slottable");function b3(s){return Z.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===x3}function w3(s,c){const p={...c};for(const _ in c){const S=s[_],A=c[_];/^on[A-Z]/.test(_)?S&&A?p[_]=(...u)=>{const L=A(...u);return S(...u),L}:S&&(p[_]=S):_==="style"?p[_]={...S,...A}:_==="className"&&(p[_]=[S,A].filter(Boolean).join(" "))}return{...s,...p}}function T3(s){let c=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,p=c&&"isReactWarning"in c&&c.isReactWarning;return p?s.ref:(c=Object.getOwnPropertyDescriptor(s,"ref")?.get,p=c&&"isReactWarning"in c&&c.isReactWarning,p?s.props.ref:s.props.ref||s.ref)}const S3=sy("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover-elevate active-elevate-2",{variants:{variant:{default:"bg-primary text-primary-foreground border border-primary-border",destructive:"bg-destructive text-destructive-foreground shadow-sm border-destructive-border",outline:" border [border-color:var(--button-outline)] shadow-xs active:shadow-none ",secondary:"border bg-secondary text-secondary-foreground border border-secondary-border ",ghost:"border border-transparent",link:"text-primary underline-offset-4 hover:underline"},size:{default:"min-h-9 px-4 py-2",sm:"min-h-8 rounded-md px-3 text-xs",lg:"min-h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),xr=Z.forwardRef(({className:s,variant:c,size:p,asChild:_=!1,...S},A)=>{const T=_?_3:"button";return F.jsx(T,{className:Rn(S3({variant:c,size:p,className:s})),ref:A,...S})});xr.displayName="Button";const ua=Z.forwardRef(({className:s,type:c,...p},_)=>F.jsx("input",{type:c,className:Rn("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:_,...p}));ua.displayName="Input";var E3=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],C3=E3.reduce((s,c)=>{const p=vb(`Primitive.${c}`),_=Z.forwardRef((S,A)=>{const{asChild:T,...u}=S,L=T?p:c;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),F.jsx(L,{...u,ref:A})});return _.displayName=`Primitive.${c}`,{...s,[c]:_}},{}),A3="Label",FE=Z.forwardRef((s,c)=>F.jsx(C3.label,{...s,ref:c,onMouseDown:p=>{p.target.closest("button, input, select, textarea")||(s.onMouseDown?.(p),!p.defaultPrevented&&p.detail>1&&p.preventDefault())}}));FE.displayName=A3;var jE=FE;const M3=sy("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Va=Z.forwardRef(({className:s,...c},p)=>F.jsx(jE,{ref:p,className:Rn(M3(),s),...c}));Va.displayName=jE.displayName;function Gg(s,c,{checkForDefaultPrevented:p=!0}={}){return function(S){if(s?.(S),p===!1||!S.defaultPrevented)return c?.(S)}}var P3=H_[" useInsertionEffect ".trim().toString()]||Bs;function D3({prop:s,defaultProp:c,onChange:p=()=>{},caller:_}){const[S,A,T]=R3({defaultProp:c,onChange:p}),u=s!==void 0,L=u?s:S;{const B=Z.useRef(s!==void 0);Z.useEffect(()=>{const H=B.current;H!==u&&console.warn(`${_} is changing from ${H?"controlled":"uncontrolled"} to ${u?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),B.current=u},[u,_])}const k=Z.useCallback(B=>{if(u){const H=I3(B)?B(s):B;H!==s&&T.current?.(H)}else A(B)},[u,s,A,T]);return[L,k]}function R3({defaultProp:s,onChange:c}){const[p,_]=Z.useState(s),S=Z.useRef(p),A=Z.useRef(c);return P3(()=>{A.current=c},[c]),Z.useEffect(()=>{S.current!==p&&(A.current?.(p),S.current=p)},[p,S]),[p,_,A]}function I3(s){return typeof s=="function"}var wx="focusScope.autoFocusOnMount",Tx="focusScope.autoFocusOnUnmount",Yw={bubbles:!1,cancelable:!0},z3="FocusScope",BE=Z.forwardRef((s,c)=>{const{loop:p=!1,trapped:_=!1,onMountAutoFocus:S,onUnmountAutoFocus:A,...T}=s,[u,L]=Z.useState(null),k=cr(S),B=cr(A),H=Z.useRef(null),W=Ui(c,rt=>L(rt)),it=Z.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;Z.useEffect(()=>{if(_){let rt=function(bt){if(it.paused||!u)return;const Lt=bt.target;u.contains(Lt)?H.current=Lt:pd(H.current,{select:!0})},J=function(bt){if(it.paused||!u)return;const Lt=bt.relatedTarget;Lt!==null&&(u.contains(Lt)||pd(H.current,{select:!0}))},mt=function(bt){if(document.activeElement===document.body)for(const Ot of bt)Ot.removedNodes.length>0&&pd(u)};document.addEventListener("focusin",rt),document.addEventListener("focusout",J);const Et=new MutationObserver(mt);return u&&Et.observe(u,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",rt),document.removeEventListener("focusout",J),Et.disconnect()}}},[_,u,it.paused]),Z.useEffect(()=>{if(u){Kw.add(it);const rt=document.activeElement;if(!u.contains(rt)){const mt=new CustomEvent(wx,Yw);u.addEventListener(wx,k),u.dispatchEvent(mt),mt.defaultPrevented||(L3(j3(VE(u)),{select:!0}),document.activeElement===rt&&pd(u))}return()=>{u.removeEventListener(wx,k),setTimeout(()=>{const mt=new CustomEvent(Tx,Yw);u.addEventListener(Tx,B),u.dispatchEvent(mt),mt.defaultPrevented||pd(rt??document.body,{select:!0}),u.removeEventListener(Tx,B),Kw.remove(it)},0)}}},[u,k,B,it]);const pt=Z.useCallback(rt=>{if(!p&&!_||it.paused)return;const J=rt.key==="Tab"&&!rt.altKey&&!rt.ctrlKey&&!rt.metaKey,mt=document.activeElement;if(J&&mt){const Et=rt.currentTarget,[bt,Lt]=k3(Et);bt&&Lt?!rt.shiftKey&&mt===Lt?(rt.preventDefault(),p&&pd(bt,{select:!0})):rt.shiftKey&&mt===bt&&(rt.preventDefault(),p&&pd(Lt,{select:!0})):mt===Et&&rt.preventDefault()}},[p,_,it.paused]);return F.jsx($r.div,{tabIndex:-1,...T,ref:W,onKeyDown:pt})});BE.displayName=z3;function L3(s,{select:c=!1}={}){const p=document.activeElement;for(const _ of s)if(pd(_,{select:c}),document.activeElement!==p)return}function k3(s){const c=VE(s),p=Ww(c,s),_=Ww(c.reverse(),s);return[p,_]}function VE(s){const c=[],p=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:_=>{const S=_.tagName==="INPUT"&&_.type==="hidden";return _.disabled||_.hidden||S?NodeFilter.FILTER_SKIP:_.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;p.nextNode();)c.push(p.currentNode);return c}function Ww(s,c){for(const p of s)if(!O3(p,{upTo:c}))return p}function O3(s,{upTo:c}){if(getComputedStyle(s).visibility==="hidden")return!0;for(;s;){if(c!==void 0&&s===c)return!1;if(getComputedStyle(s).display==="none")return!0;s=s.parentElement}return!1}function N3(s){return s instanceof HTMLInputElement&&"select"in s}function pd(s,{select:c=!1}={}){if(s&&s.focus){const p=document.activeElement;s.focus({preventScroll:!0}),s!==p&&N3(s)&&c&&s.select()}}var Kw=F3();function F3(){let s=[];return{add(c){const p=s[0];c!==p&&p?.pause(),s=Qw(s,c),s.unshift(c)},remove(c){s=Qw(s,c),s[0]?.resume()}}}function Qw(s,c){const p=[...s],_=p.indexOf(c);return _!==-1&&p.splice(_,1),p}function j3(s){return s.filter(c=>c.tagName!=="A")}var Sx=0;function B3(){Z.useEffect(()=>{const s=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",s[0]??Jw()),document.body.insertAdjacentElement("beforeend",s[1]??Jw()),Sx++,()=>{Sx===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(c=>c.remove()),Sx--}},[])}function Jw(){const s=document.createElement("span");return s.setAttribute("data-radix-focus-guard",""),s.tabIndex=0,s.style.outline="none",s.style.opacity="0",s.style.position="fixed",s.style.pointerEvents="none",s}var Zc=function(){return Zc=Object.assign||function(c){for(var p,_=1,S=arguments.length;_<S;_++){p=arguments[_];for(var A in p)Object.prototype.hasOwnProperty.call(p,A)&&(c[A]=p[A])}return c},Zc.apply(this,arguments)};function UE(s,c){var p={};for(var _ in s)Object.prototype.hasOwnProperty.call(s,_)&&c.indexOf(_)<0&&(p[_]=s[_]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var S=0,_=Object.getOwnPropertySymbols(s);S<_.length;S++)c.indexOf(_[S])<0&&Object.prototype.propertyIsEnumerable.call(s,_[S])&&(p[_[S]]=s[_[S]]);return p}function V3(s,c,p){if(p||arguments.length===2)for(var _=0,S=c.length,A;_<S;_++)(A||!(_ in c))&&(A||(A=Array.prototype.slice.call(c,0,_)),A[_]=c[_]);return s.concat(A||Array.prototype.slice.call(c))}var P_="right-scroll-bar-position",D_="width-before-scroll-bar",U3="with-scroll-bars-hidden",G3="--removed-body-scroll-bar-size";function Ex(s,c){return typeof s=="function"?s(c):s&&(s.current=c),s}function q3(s,c){var p=Z.useState(function(){return{value:s,callback:c,facade:{get current(){return p.value},set current(_){var S=p.value;S!==_&&(p.value=_,p.callback(_,S))}}}})[0];return p.callback=c,p.facade}var Z3=typeof window<"u"?Z.useLayoutEffect:Z.useEffect,tT=new WeakMap;function $3(s,c){var p=q3(null,function(_){return s.forEach(function(S){return Ex(S,_)})});return Z3(function(){var _=tT.get(p);if(_){var S=new Set(_),A=new Set(s),T=p.current;S.forEach(function(u){A.has(u)||Ex(u,null)}),A.forEach(function(u){S.has(u)||Ex(u,T)})}tT.set(p,s)},[s]),p}function H3(s){return s}function X3(s,c){c===void 0&&(c=H3);var p=[],_=!1,S={read:function(){if(_)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return p.length?p[p.length-1]:s},useMedium:function(A){var T=c(A,_);return p.push(T),function(){p=p.filter(function(u){return u!==T})}},assignSyncMedium:function(A){for(_=!0;p.length;){var T=p;p=[],T.forEach(A)}p={push:function(u){return A(u)},filter:function(){return p}}},assignMedium:function(A){_=!0;var T=[];if(p.length){var u=p;p=[],u.forEach(A),T=p}var L=function(){var B=T;T=[],B.forEach(A)},k=function(){return Promise.resolve().then(L)};k(),p={push:function(B){T.push(B),k()},filter:function(B){return T=T.filter(B),p}}}};return S}function Y3(s){s===void 0&&(s={});var c=X3(null);return c.options=Zc({async:!0,ssr:!1},s),c}var GE=function(s){var c=s.sideCar,p=UE(s,["sideCar"]);if(!c)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var _=c.read();if(!_)throw new Error("Sidecar medium not found");return Z.createElement(_,Zc({},p))};GE.isSideCarExport=!0;function W3(s,c){return s.useMedium(c),GE}var qE=Y3(),Cx=function(){},cv=Z.forwardRef(function(s,c){var p=Z.useRef(null),_=Z.useState({onScrollCapture:Cx,onWheelCapture:Cx,onTouchMoveCapture:Cx}),S=_[0],A=_[1],T=s.forwardProps,u=s.children,L=s.className,k=s.removeScrollBar,B=s.enabled,H=s.shards,W=s.sideCar,it=s.noIsolation,pt=s.inert,rt=s.allowPinchZoom,J=s.as,mt=J===void 0?"div":J,Et=s.gapMode,bt=UE(s,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),Lt=W,Ot=$3([p,c]),ee=Zc(Zc({},bt),S);return Z.createElement(Z.Fragment,null,B&&Z.createElement(Lt,{sideCar:qE,removeScrollBar:k,shards:H,noIsolation:it,inert:pt,setCallbacks:A,allowPinchZoom:!!rt,lockRef:p,gapMode:Et}),T?Z.cloneElement(Z.Children.only(u),Zc(Zc({},ee),{ref:Ot})):Z.createElement(mt,Zc({},ee,{className:L,ref:Ot}),u))});cv.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};cv.classNames={fullWidth:D_,zeroRight:P_};var K3=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Q3(){if(!document)return null;var s=document.createElement("style");s.type="text/css";var c=K3();return c&&s.setAttribute("nonce",c),s}function J3(s,c){s.styleSheet?s.styleSheet.cssText=c:s.appendChild(document.createTextNode(c))}function tN(s){var c=document.head||document.getElementsByTagName("head")[0];c.appendChild(s)}var eN=function(){var s=0,c=null;return{add:function(p){s==0&&(c=Q3())&&(J3(c,p),tN(c)),s++},remove:function(){s--,!s&&c&&(c.parentNode&&c.parentNode.removeChild(c),c=null)}}},nN=function(){var s=eN();return function(c,p){Z.useEffect(function(){return s.add(c),function(){s.remove()}},[c&&p])}},ZE=function(){var s=nN(),c=function(p){var _=p.styles,S=p.dynamic;return s(_,S),null};return c},iN={left:0,top:0,right:0,gap:0},Ax=function(s){return parseInt(s||"",10)||0},rN=function(s){var c=window.getComputedStyle(document.body),p=c[s==="padding"?"paddingLeft":"marginLeft"],_=c[s==="padding"?"paddingTop":"marginTop"],S=c[s==="padding"?"paddingRight":"marginRight"];return[Ax(p),Ax(_),Ax(S)]},sN=function(s){if(s===void 0&&(s="margin"),typeof window>"u")return iN;var c=rN(s),p=document.documentElement.clientWidth,_=window.innerWidth;return{left:c[0],top:c[1],right:c[2],gap:Math.max(0,_-p+c[2]-c[0])}},aN=ZE(),om="data-scroll-locked",oN=function(s,c,p,_){var S=s.left,A=s.top,T=s.right,u=s.gap;return p===void 0&&(p="margin"),`
  .`.concat(U3,` {
   overflow: hidden `).concat(_,`;
   padding-right: `).concat(u,"px ").concat(_,`;
  }
  body[`).concat(om,`] {
    overflow: hidden `).concat(_,`;
    overscroll-behavior: contain;
    `).concat([c&&"position: relative ".concat(_,";"),p==="margin"&&`
    padding-left: `.concat(S,`px;
    padding-top: `).concat(A,`px;
    padding-right: `).concat(T,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(u,"px ").concat(_,`;
    `),p==="padding"&&"padding-right: ".concat(u,"px ").concat(_,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(P_,` {
    right: `).concat(u,"px ").concat(_,`;
  }
  
  .`).concat(D_,` {
    margin-right: `).concat(u,"px ").concat(_,`;
  }
  
  .`).concat(P_," .").concat(P_,` {
    right: 0 `).concat(_,`;
  }
  
  .`).concat(D_," .").concat(D_,` {
    margin-right: 0 `).concat(_,`;
  }
  
  body[`).concat(om,`] {
    `).concat(G3,": ").concat(u,`px;
  }
`)},eT=function(){var s=parseInt(document.body.getAttribute(om)||"0",10);return isFinite(s)?s:0},lN=function(){Z.useEffect(function(){return document.body.setAttribute(om,(eT()+1).toString()),function(){var s=eT()-1;s<=0?document.body.removeAttribute(om):document.body.setAttribute(om,s.toString())}},[])},cN=function(s){var c=s.noRelative,p=s.noImportant,_=s.gapMode,S=_===void 0?"margin":_;lN();var A=Z.useMemo(function(){return sN(S)},[S]);return Z.createElement(aN,{styles:oN(A,!c,S,p?"":"!important")})},d0=!1;if(typeof window<"u")try{var m_=Object.defineProperty({},"passive",{get:function(){return d0=!0,!0}});window.addEventListener("test",m_,m_),window.removeEventListener("test",m_,m_)}catch{d0=!1}var Wp=d0?{passive:!1}:!1,uN=function(s){return s.tagName==="TEXTAREA"},$E=function(s,c){if(!(s instanceof Element))return!1;var p=window.getComputedStyle(s);return p[c]!=="hidden"&&!(p.overflowY===p.overflowX&&!uN(s)&&p[c]==="visible")},hN=function(s){return $E(s,"overflowY")},dN=function(s){return $E(s,"overflowX")},nT=function(s,c){var p=c.ownerDocument,_=c;do{typeof ShadowRoot<"u"&&_ instanceof ShadowRoot&&(_=_.host);var S=HE(s,_);if(S){var A=XE(s,_),T=A[1],u=A[2];if(T>u)return!0}_=_.parentNode}while(_&&_!==p.body);return!1},fN=function(s){var c=s.scrollTop,p=s.scrollHeight,_=s.clientHeight;return[c,p,_]},pN=function(s){var c=s.scrollLeft,p=s.scrollWidth,_=s.clientWidth;return[c,p,_]},HE=function(s,c){return s==="v"?hN(c):dN(c)},XE=function(s,c){return s==="v"?fN(c):pN(c)},mN=function(s,c){return s==="h"&&c==="rtl"?-1:1},gN=function(s,c,p,_,S){var A=mN(s,window.getComputedStyle(c).direction),T=A*_,u=p.target,L=c.contains(u),k=!1,B=T>0,H=0,W=0;do{var it=XE(s,u),pt=it[0],rt=it[1],J=it[2],mt=rt-J-A*pt;(pt||mt)&&HE(s,u)&&(H+=mt,W+=pt),u instanceof ShadowRoot?u=u.host:u=u.parentNode}while(!L&&u!==document.body||L&&(c.contains(u)||c===u));return(B&&Math.abs(H)<1||!B&&Math.abs(W)<1)&&(k=!0),k},g_=function(s){return"changedTouches"in s?[s.changedTouches[0].clientX,s.changedTouches[0].clientY]:[0,0]},iT=function(s){return[s.deltaX,s.deltaY]},rT=function(s){return s&&"current"in s?s.current:s},yN=function(s,c){return s[0]===c[0]&&s[1]===c[1]},_N=function(s){return`
  .block-interactivity-`.concat(s,` {pointer-events: none;}
  .allow-interactivity-`).concat(s,` {pointer-events: all;}
`)},vN=0,Kp=[];function xN(s){var c=Z.useRef([]),p=Z.useRef([0,0]),_=Z.useRef(),S=Z.useState(vN++)[0],A=Z.useState(ZE)[0],T=Z.useRef(s);Z.useEffect(function(){T.current=s},[s]),Z.useEffect(function(){if(s.inert){document.body.classList.add("block-interactivity-".concat(S));var rt=V3([s.lockRef.current],(s.shards||[]).map(rT),!0).filter(Boolean);return rt.forEach(function(J){return J.classList.add("allow-interactivity-".concat(S))}),function(){document.body.classList.remove("block-interactivity-".concat(S)),rt.forEach(function(J){return J.classList.remove("allow-interactivity-".concat(S))})}}},[s.inert,s.lockRef.current,s.shards]);var u=Z.useCallback(function(rt,J){if("touches"in rt&&rt.touches.length===2||rt.type==="wheel"&&rt.ctrlKey)return!T.current.allowPinchZoom;var mt=g_(rt),Et=p.current,bt="deltaX"in rt?rt.deltaX:Et[0]-mt[0],Lt="deltaY"in rt?rt.deltaY:Et[1]-mt[1],Ot,ee=rt.target,Nt=Math.abs(bt)>Math.abs(Lt)?"h":"v";if("touches"in rt&&Nt==="h"&&ee.type==="range")return!1;var Kt=nT(Nt,ee);if(!Kt)return!0;if(Kt?Ot=Nt:(Ot=Nt==="v"?"h":"v",Kt=nT(Nt,ee)),!Kt)return!1;if(!_.current&&"changedTouches"in rt&&(bt||Lt)&&(_.current=Ot),!Ot)return!0;var xe=_.current||Ot;return gN(xe,J,rt,xe==="h"?bt:Lt)},[]),L=Z.useCallback(function(rt){var J=rt;if(!(!Kp.length||Kp[Kp.length-1]!==A)){var mt="deltaY"in J?iT(J):g_(J),Et=c.current.filter(function(Ot){return Ot.name===J.type&&(Ot.target===J.target||J.target===Ot.shadowParent)&&yN(Ot.delta,mt)})[0];if(Et&&Et.should){J.cancelable&&J.preventDefault();return}if(!Et){var bt=(T.current.shards||[]).map(rT).filter(Boolean).filter(function(Ot){return Ot.contains(J.target)}),Lt=bt.length>0?u(J,bt[0]):!T.current.noIsolation;Lt&&J.cancelable&&J.preventDefault()}}},[]),k=Z.useCallback(function(rt,J,mt,Et){var bt={name:rt,delta:J,target:mt,should:Et,shadowParent:bN(mt)};c.current.push(bt),setTimeout(function(){c.current=c.current.filter(function(Lt){return Lt!==bt})},1)},[]),B=Z.useCallback(function(rt){p.current=g_(rt),_.current=void 0},[]),H=Z.useCallback(function(rt){k(rt.type,iT(rt),rt.target,u(rt,s.lockRef.current))},[]),W=Z.useCallback(function(rt){k(rt.type,g_(rt),rt.target,u(rt,s.lockRef.current))},[]);Z.useEffect(function(){return Kp.push(A),s.setCallbacks({onScrollCapture:H,onWheelCapture:H,onTouchMoveCapture:W}),document.addEventListener("wheel",L,Wp),document.addEventListener("touchmove",L,Wp),document.addEventListener("touchstart",B,Wp),function(){Kp=Kp.filter(function(rt){return rt!==A}),document.removeEventListener("wheel",L,Wp),document.removeEventListener("touchmove",L,Wp),document.removeEventListener("touchstart",B,Wp)}},[]);var it=s.removeScrollBar,pt=s.inert;return Z.createElement(Z.Fragment,null,pt?Z.createElement(A,{styles:_N(S)}):null,it?Z.createElement(cN,{gapMode:s.gapMode}):null)}function bN(s){for(var c=null;s!==null;)s instanceof ShadowRoot&&(c=s.host,s=s.host),s=s.parentNode;return c}const wN=W3(qE,xN);var YE=Z.forwardRef(function(s,c){return Z.createElement(cv,Zc({},s,{ref:c,sideCar:wN}))});YE.classNames=cv.classNames;var TN=function(s){if(typeof document>"u")return null;var c=Array.isArray(s)?s[0]:s;return c.ownerDocument.body},Qp=new WeakMap,y_=new WeakMap,__={},Mx=0,WE=function(s){return s&&(s.host||WE(s.parentNode))},SN=function(s,c){return c.map(function(p){if(s.contains(p))return p;var _=WE(p);return _&&s.contains(_)?_:(console.error("aria-hidden",p,"in not contained inside",s,". Doing nothing"),null)}).filter(function(p){return!!p})},EN=function(s,c,p,_){var S=SN(c,Array.isArray(s)?s:[s]);__[p]||(__[p]=new WeakMap);var A=__[p],T=[],u=new Set,L=new Set(S),k=function(H){!H||u.has(H)||(u.add(H),k(H.parentNode))};S.forEach(k);var B=function(H){!H||L.has(H)||Array.prototype.forEach.call(H.children,function(W){if(u.has(W))B(W);else try{var it=W.getAttribute(_),pt=it!==null&&it!=="false",rt=(Qp.get(W)||0)+1,J=(A.get(W)||0)+1;Qp.set(W,rt),A.set(W,J),T.push(W),rt===1&&pt&&y_.set(W,!0),J===1&&W.setAttribute(p,"true"),pt||W.setAttribute(_,"true")}catch(mt){console.error("aria-hidden: cannot operate on ",W,mt)}})};return B(c),u.clear(),Mx++,function(){T.forEach(function(H){var W=Qp.get(H)-1,it=A.get(H)-1;Qp.set(H,W),A.set(H,it),W||(y_.has(H)||H.removeAttribute(_),y_.delete(H)),it||H.removeAttribute(p)}),Mx--,Mx||(Qp=new WeakMap,Qp=new WeakMap,y_=new WeakMap,__={})}},CN=function(s,c,p){p===void 0&&(p="data-aria-hidden");var _=Array.from(Array.isArray(s)?s:[s]),S=TN(s);return S?(_.push.apply(_,Array.from(S.querySelectorAll("[aria-live]"))),EN(_,S,p,"aria-hidden")):function(){return null}};function AN(s){const c=MN(s),p=Z.forwardRef((_,S)=>{const{children:A,...T}=_,u=Z.Children.toArray(A),L=u.find(DN);if(L){const k=L.props.children,B=u.map(H=>H===L?Z.Children.count(k)>1?Z.Children.only(null):Z.isValidElement(k)?k.props.children:null:H);return F.jsx(c,{...T,ref:S,children:Z.isValidElement(k)?Z.cloneElement(k,void 0,B):null})}return F.jsx(c,{...T,ref:S,children:A})});return p.displayName=`${s}.Slot`,p}function MN(s){const c=Z.forwardRef((p,_)=>{const{children:S,...A}=p;if(Z.isValidElement(S)){const T=IN(S),u=RN(A,S.props);return S.type!==Z.Fragment&&(u.ref=_?ry(_,T):T),Z.cloneElement(S,u)}return Z.Children.count(S)>1?Z.Children.only(null):null});return c.displayName=`${s}.SlotClone`,c}var PN=Symbol("radix.slottable");function DN(s){return Z.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===PN}function RN(s,c){const p={...c};for(const _ in c){const S=s[_],A=c[_];/^on[A-Z]/.test(_)?S&&A?p[_]=(...u)=>{const L=A(...u);return S(...u),L}:S&&(p[_]=S):_==="style"?p[_]={...S,...A}:_==="className"&&(p[_]=[S,A].filter(Boolean).join(" "))}return{...s,...p}}function IN(s){let c=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,p=c&&"isReactWarning"in c&&c.isReactWarning;return p?s.ref:(c=Object.getOwnPropertyDescriptor(s,"ref")?.get,p=c&&"isReactWarning"in c&&c.isReactWarning,p?s.props.ref:s.props.ref||s.ref)}var uv="Dialog",[KE]=pm(uv),[zN,ec]=KE(uv),QE=s=>{const{__scopeDialog:c,children:p,open:_,defaultOpen:S,onOpenChange:A,modal:T=!0}=s,u=Z.useRef(null),L=Z.useRef(null),[k,B]=D3({prop:_,defaultProp:S??!1,onChange:A,caller:uv});return F.jsx(zN,{scope:c,triggerRef:u,contentRef:L,contentId:rx(),titleId:rx(),descriptionId:rx(),open:k,onOpenChange:B,onOpenToggle:Z.useCallback(()=>B(H=>!H),[B]),modal:T,children:p})};QE.displayName=uv;var JE="DialogTrigger",tC=Z.forwardRef((s,c)=>{const{__scopeDialog:p,..._}=s,S=ec(JE,p),A=Ui(c,S.triggerRef);return F.jsx($r.button,{type:"button","aria-haspopup":"dialog","aria-expanded":S.open,"aria-controls":S.contentId,"data-state":wb(S.open),..._,ref:A,onClick:Gg(s.onClick,S.onOpenToggle)})});tC.displayName=JE;var xb="DialogPortal",[LN,eC]=KE(xb,{forceMount:void 0}),nC=s=>{const{__scopeDialog:c,forceMount:p,children:_,container:S}=s,A=ec(xb,c);return F.jsx(LN,{scope:c,forceMount:p,children:Z.Children.map(_,T=>F.jsx(tu,{present:p||A.open,children:F.jsx(O0,{asChild:!0,container:S,children:T})}))})};nC.displayName=xb;var G_="DialogOverlay",iC=Z.forwardRef((s,c)=>{const p=eC(G_,s.__scopeDialog),{forceMount:_=p.forceMount,...S}=s,A=ec(G_,s.__scopeDialog);return A.modal?F.jsx(tu,{present:_||A.open,children:F.jsx(ON,{...S,ref:c})}):null});iC.displayName=G_;var kN=AN("DialogOverlay.RemoveScroll"),ON=Z.forwardRef((s,c)=>{const{__scopeDialog:p,..._}=s,S=ec(G_,p);return F.jsx(YE,{as:kN,allowPinchZoom:!0,shards:[S.contentRef],children:F.jsx($r.div,{"data-state":wb(S.open),..._,ref:c,style:{pointerEvents:"auto",..._.style}})})}),Uf="DialogContent",rC=Z.forwardRef((s,c)=>{const p=eC(Uf,s.__scopeDialog),{forceMount:_=p.forceMount,...S}=s,A=ec(Uf,s.__scopeDialog);return F.jsx(tu,{present:_||A.open,children:A.modal?F.jsx(NN,{...S,ref:c}):F.jsx(FN,{...S,ref:c})})});rC.displayName=Uf;var NN=Z.forwardRef((s,c)=>{const p=ec(Uf,s.__scopeDialog),_=Z.useRef(null),S=Ui(c,p.contentRef,_);return Z.useEffect(()=>{const A=_.current;if(A)return CN(A)},[]),F.jsx(sC,{...s,ref:S,trapFocus:p.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Gg(s.onCloseAutoFocus,A=>{A.preventDefault(),p.triggerRef.current?.focus()}),onPointerDownOutside:Gg(s.onPointerDownOutside,A=>{const T=A.detail.originalEvent,u=T.button===0&&T.ctrlKey===!0;(T.button===2||u)&&A.preventDefault()}),onFocusOutside:Gg(s.onFocusOutside,A=>A.preventDefault())})}),FN=Z.forwardRef((s,c)=>{const p=ec(Uf,s.__scopeDialog),_=Z.useRef(!1),S=Z.useRef(!1);return F.jsx(sC,{...s,ref:c,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:A=>{s.onCloseAutoFocus?.(A),A.defaultPrevented||(_.current||p.triggerRef.current?.focus(),A.preventDefault()),_.current=!1,S.current=!1},onInteractOutside:A=>{s.onInteractOutside?.(A),A.defaultPrevented||(_.current=!0,A.detail.originalEvent.type==="pointerdown"&&(S.current=!0));const T=A.target;p.triggerRef.current?.contains(T)&&A.preventDefault(),A.detail.originalEvent.type==="focusin"&&S.current&&A.preventDefault()}})}),sC=Z.forwardRef((s,c)=>{const{__scopeDialog:p,trapFocus:_,onOpenAutoFocus:S,onCloseAutoFocus:A,...T}=s,u=ec(Uf,p),L=Z.useRef(null),k=Ui(c,L);return B3(),F.jsxs(F.Fragment,{children:[F.jsx(BE,{asChild:!0,loop:!0,trapped:_,onMountAutoFocus:S,onUnmountAutoFocus:A,children:F.jsx(M0,{role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":wb(u.open),...T,ref:k,onDismiss:()=>u.onOpenChange(!1)})}),F.jsxs(F.Fragment,{children:[F.jsx(jN,{titleId:u.titleId}),F.jsx(VN,{contentRef:L,descriptionId:u.descriptionId})]})]})}),bb="DialogTitle",aC=Z.forwardRef((s,c)=>{const{__scopeDialog:p,..._}=s,S=ec(bb,p);return F.jsx($r.h2,{id:S.titleId,..._,ref:c})});aC.displayName=bb;var oC="DialogDescription",lC=Z.forwardRef((s,c)=>{const{__scopeDialog:p,..._}=s,S=ec(oC,p);return F.jsx($r.p,{id:S.descriptionId,..._,ref:c})});lC.displayName=oC;var cC="DialogClose",uC=Z.forwardRef((s,c)=>{const{__scopeDialog:p,..._}=s,S=ec(cC,p);return F.jsx($r.button,{type:"button",..._,ref:c,onClick:Gg(s.onClick,()=>S.onOpenChange(!1))})});uC.displayName=cC;function wb(s){return s?"open":"closed"}var hC="DialogTitleWarning",[BF,dC]=mM(hC,{contentName:Uf,titleName:bb,docsSlug:"dialog"}),jN=({titleId:s})=>{const c=dC(hC),p=`\`${c.contentName}\` requires a \`${c.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${c.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${c.docsSlug}`;return Z.useEffect(()=>{s&&(document.getElementById(s)||console.error(p))},[p,s]),null},BN="DialogDescriptionWarning",VN=({contentRef:s,descriptionId:c})=>{const _=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${dC(BN).contentName}}.`;return Z.useEffect(()=>{const S=s.current?.getAttribute("aria-describedby");c&&S&&(document.getElementById(c)||console.warn(_))},[_,s,c]),null},fC=QE,pC=tC,mC=nC,hv=iC,dv=rC,fv=aC,pv=lC,gC=uC;const Tb=fC,Sb=pC,UN=mC,yC=Z.forwardRef(({className:s,...c},p)=>F.jsx(hv,{ref:p,className:Rn("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...c}));yC.displayName=hv.displayName;const mv=Z.forwardRef(({className:s,children:c,...p},_)=>F.jsxs(UN,{children:[F.jsx(yC,{}),F.jsxs(dv,{ref:_,className:Rn("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...p,children:[c,F.jsxs(gC,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[F.jsx(mm,{className:"h-4 w-4"}),F.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));mv.displayName=dv.displayName;const gv=({className:s,...c})=>F.jsx("div",{className:Rn("flex flex-col space-y-1.5 text-center sm:text-left",s),...c});gv.displayName="DialogHeader";const _C=({className:s,...c})=>F.jsx("div",{className:Rn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...c});_C.displayName="DialogFooter";const yv=Z.forwardRef(({className:s,...c},p)=>F.jsx(fv,{ref:p,className:Rn("text-lg font-semibold leading-none tracking-tight",s),...c}));yv.displayName=fv.displayName;const GN=Z.forwardRef(({className:s,...c},p)=>F.jsx(pv,{ref:p,className:Rn("text-sm text-muted-foreground",s),...c}));GN.displayName=pv.displayName;function vC({value:s,onChange:c,placeholder:p="Search for a city or country...",className:_}){const[S,A]=Z.useState(!1),[T,u]=Z.useState([]),[L,k]=Z.useState(!1),[B,H]=Z.useState(s),W=Z.useRef(null),it=Z.useRef(null),pt=async mt=>{if(mt.length<2){u([]);return}k(!0);try{const Et=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(mt)}&limit=10&addressdetails=1`,{headers:{Accept:"application/json"}});if(Et.ok){const Lt=(await Et.json()).map(Ot=>({name:Ot.name,displayName:Ot.display_name,lat:parseFloat(Ot.lat),lon:parseFloat(Ot.lon)}));u(Lt),A(!0)}}catch(Et){console.error("Location search error:",Et),u([])}finally{k(!1)}},rt=mt=>{const Et=mt.target.value;H(Et),it.current&&clearTimeout(it.current),Et.length>=2?it.current=setTimeout(()=>{pt(Et)},300):(u([]),A(!1))},J=mt=>{H(mt.displayName),c(mt.displayName),A(!1),u([])};return Z.useEffect(()=>{const mt=Et=>{W.current&&!W.current.contains(Et.target)&&A(!1)};return document.addEventListener("mousedown",mt),()=>{document.removeEventListener("mousedown",mt),it.current&&clearTimeout(it.current)}},[]),F.jsxs("div",{ref:W,className:"relative w-full",children:[F.jsxs("div",{className:"relative",children:[F.jsx(l2,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground pointer-events-none"}),F.jsx(ua,{type:"text",placeholder:p,value:B,onChange:rt,onFocus:()=>T.length>0&&A(!0),className:Rn("pl-9 h-12",_)}),L&&F.jsx(a2,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-primary animate-spin"})]}),S&&T.length>0&&F.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border border-border rounded-lg shadow-lg z-50 max-h-64 overflow-y-auto",children:T.map((mt,Et)=>F.jsxs("button",{onClick:()=>J(mt),className:"w-full text-left px-4 py-3 hover:bg-secondary transition-colors border-b last:border-b-0 flex items-start gap-3",children:[F.jsx(lm,{className:"w-4 h-4 text-primary mt-0.5 flex-shrink-0"}),F.jsxs("div",{className:"flex-1 min-w-0",children:[F.jsx("p",{className:"font-medium text-sm truncate",children:mt.name}),F.jsx("p",{className:"text-xs text-muted-foreground truncate",children:mt.displayName})]})]},Et))}),S&&T.length===0&&!L&&B.length>=2&&F.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border border-border rounded-lg shadow-lg z-50 p-4 text-center text-sm text-muted-foreground",children:"No locations found. Try a different search."})]})}const sT=["Fine Dining","Street Food","Hiking","Museums","Nightlife","Coffee","Shopping","Photography","Live Music","History","Architecture","Nature","Family Friendly","For Kids","Parks & Playgrounds"];function qN(){const{profile:s,updateProfile:c,toggleInterest:p,addCompanion:_,removeCompanion:S,completeOnboarding:A}=Vf(),[,T]=ny(),[u,L]=Z.useState(1),[k,B]=Z.useState(!1),[H,W]=Z.useState(""),[it,pt]=Z.useState(!1),[rt,J]=Z.useState(""),[mt,Et]=Z.useState([]),[bt,Lt]=Z.useState(),[Ot,ee]=Z.useState(!1),[Nt,Kt]=Z.useState([]),{sessionId:xe}=Vf(),Ae=me=>{c({country:me}),W("")},ae=()=>{rt.trim()&&(_({name:rt.trim(),interests:mt,age:bt,familyFriendly:Ot,kidsAge:Nt}),J(""),Et([]),Lt(void 0),ee(!1),Kt([]),pt(!1))},ze=me=>{mt.includes(me)?Et(jt=>jt.filter(Qt=>Qt!==me)):Et(jt=>[...jt,me])},We=async()=>{if(u===1){if(!s.country||s.country.trim().length<3){W("Please select a valid location");return}L(u+1)}else if(u<4)L(u+1);else{B(!0);try{(await fetch("/api/trips",{method:"POST",headers:{"Content-Type":"application/json","x-session-id":xe||""},body:JSON.stringify({name:s.currentTripName,location:s.country,interests:s.interests,companions:s.companions})})).ok?(A(),T("/dashboard")):(console.error("Failed to save trip"),B(!1))}catch(me){console.error("Error saving trip:",me),B(!1)}}},Ee={enter:{opacity:0,x:20,filter:"blur(10px)"},center:{opacity:1,x:0,filter:"blur(0px)"},exit:{opacity:0,x:-20,filter:"blur(10px)"}};return k?F.jsxs("div",{className:"min-h-screen w-full bg-background flex flex-col items-center justify-center p-4 overflow-hidden relative",children:[F.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,var(--tw-gradient-stops))] from-primary/5 via-background to-background"}),F.jsxs(Wc.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"relative z-10 flex flex-col items-center text-center max-w-md",children:[F.jsxs("div",{className:"w-24 h-24 mb-8 relative",children:[F.jsx("div",{className:"absolute inset-0 bg-primary/20 rounded-full animate-ping"}),F.jsx("div",{className:"absolute inset-2 bg-primary/30 rounded-full animate-pulse"}),F.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:F.jsx($g,{className:"w-10 h-10 text-primary animate-spin"})})]}),F.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Creating your trip..."}),F.jsxs("p",{className:"text-muted-foreground animate-pulse",children:["Setting up ",s.currentTripName," in ",s.country,"..."]}),F.jsx("div",{className:"mt-8 flex gap-2 flex-wrap justify-center opacity-50",children:s.interests.slice(0,5).map(me=>F.jsx("span",{className:"text-xs border rounded-full px-2 py-1",children:me},me))})]})]}):F.jsxs("div",{className:"min-h-screen w-full bg-background flex items-center justify-center p-4 overflow-hidden relative",children:[F.jsx("div",{className:"absolute top-[-10%] right-[-5%] w-96 h-96 bg-primary/10 rounded-full blur-3xl animate-pulse"}),F.jsx("div",{className:"absolute bottom-[-10%] left-[-5%] w-96 h-96 bg-blue-500/10 rounded-full blur-3xl animate-pulse delay-1000"}),F.jsxs("div",{className:"w-full max-w-xl relative z-10",children:[F.jsx("div",{className:"mb-8 flex justify-center space-x-2",children:[1,2,3,4].map(me=>F.jsx("div",{className:Rn("h-1.5 rounded-full transition-all duration-500 ease-out",me===u?"w-8 bg-primary":me<u?"w-8 bg-primary/30":"w-2 bg-muted")},me))}),F.jsx(NL,{mode:"wait",children:F.jsx(Wc.div,{variants:Ee,initial:"enter",animate:"center",exit:"exit",transition:{duration:.4,ease:"circOut"},children:F.jsxs(Ql,{className:"p-8 shadow-xl border-none bg-white/80 backdrop-blur-xl",children:[u===1&&F.jsxs("div",{className:"space-y-6",children:[F.jsxs("div",{className:"text-center space-y-2",children:[F.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4 text-primary",children:F.jsx(lm,{className:"w-6 h-6"})}),F.jsx("h1",{className:"text-3xl font-bold tracking-tight text-foreground",children:"Let's get started"}),F.jsx("p",{className:"text-muted-foreground",children:"Tell us about yourself and where you're headed."})]}),F.jsxs("div",{className:"space-y-4 mt-8",children:[F.jsxs("div",{className:"space-y-2",children:[F.jsx(Va,{htmlFor:"name",className:"text-base",children:"What's your name?"}),F.jsx(ua,{id:"name",placeholder:"Jane Doe",value:s.name,onChange:me=>c({name:me.target.value}),className:"h-12 text-lg bg-background/50 border-border/50 focus:border-primary/50","data-testid":"input-name"})]}),F.jsxs("div",{className:"space-y-2",children:[F.jsx(Va,{htmlFor:"age",className:"text-base",children:"Your age"}),F.jsx(ua,{id:"age",type:"number",placeholder:"25",value:s.age||"",onChange:me=>c({age:me.target.value?parseInt(me.target.value):void 0}),className:"h-12 text-lg bg-background/50 border-border/50 focus:border-primary/50",min:"0",max:"120"})]}),F.jsxs("div",{className:"space-y-2",children:[F.jsx(Va,{htmlFor:"location",className:"text-base",children:"Where are you exploring?"}),F.jsx(vC,{value:s.country,onChange:Ae,placeholder:"Search for a city or country...",className:"h-12 text-lg bg-background/50 border-border/50 focus:border-primary/50"}),H&&F.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600 mt-2",children:[F.jsx(s2,{className:"w-4 h-4"}),H]})]})]})]}),u===2&&F.jsxs("div",{className:"space-y-6",children:[F.jsxs("div",{className:"text-center space-y-2",children:[F.jsx("div",{className:"w-12 h-12 bg-orange-500/10 rounded-full flex items-center justify-center mx-auto mb-4 text-orange-500",children:F.jsx(C0,{className:"w-6 h-6"})}),F.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"What do you love?"}),F.jsx("p",{className:"text-muted-foreground",children:"Pick a few things so we can tailor your recommendations."})]}),F.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3 mt-6",children:sT.map(me=>F.jsx("button",{onClick:()=>p(me),className:Rn("px-4 py-3 rounded-xl text-sm font-medium transition-all duration-200 border flex items-center justify-center gap-2",s.interests.includes(me)?"bg-primary text-primary-foreground border-primary shadow-md scale-105":"bg-background hover:bg-muted border-border hover:border-primary/30 text-muted-foreground hover:text-foreground"),"data-testid":`btn-interest-${me}`,children:me},me))})]}),u===3&&F.jsxs("div",{className:"space-y-6",children:[F.jsxs("div",{className:"text-center space-y-2",children:[F.jsx("div",{className:"w-12 h-12 bg-blue-500/10 rounded-full flex items-center justify-center mx-auto mb-4 text-blue-500",children:F.jsx(J_,{className:"w-6 h-6"})}),F.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Who's coming with?"}),F.jsx("p",{className:"text-muted-foreground",children:"Add your travel buddies to plan together."})]}),F.jsx("div",{className:"flex justify-center mt-6",children:F.jsxs(Tb,{open:it,onOpenChange:pt,children:[F.jsx(Sb,{asChild:!0,children:F.jsxs(xr,{variant:"outline",className:"h-12 border-dashed border-2 w-full text-muted-foreground hover:text-primary hover:border-primary/50",children:[F.jsx(o2,{className:"w-4 h-4 mr-2"})," Add a Companion"]})}),F.jsxs(mv,{className:"sm:max-w-[500px] max-h-[90vh] overflow-y-auto",children:[F.jsxs(gv,{children:[F.jsx(yv,{children:"Add Travel Buddy"}),F.jsx("p",{className:"text-sm text-muted-foreground",children:"Add their name and what they like so we can find spots everyone enjoys."})]}),F.jsxs("div",{className:"grid gap-4 py-4",children:[F.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[F.jsxs("div",{className:"space-y-2",children:[F.jsx(Va,{htmlFor:"buddy-name",children:"Name"}),F.jsx(ua,{id:"buddy-name",placeholder:"e.g. Alex",value:rt,onChange:me=>J(me.target.value),className:"h-11"})]}),F.jsxs("div",{className:"space-y-2",children:[F.jsx(Va,{htmlFor:"buddy-age",children:"Age"}),F.jsx(ua,{id:"buddy-age",type:"number",placeholder:"Age",value:bt||"",onChange:me=>Lt(me.target.value?parseInt(me.target.value):void 0),className:"h-11",min:"0",max:"120"})]})]}),F.jsxs("div",{className:"space-y-2",children:[F.jsx(Va,{className:"text-sm",children:"Family travel"}),F.jsx("button",{onClick:()=>ee(!Ot),className:`h-10 rounded-lg font-medium text-sm transition-all flex items-center justify-center gap-2 ${Ot?"bg-primary text-white shadow-lg shadow-primary/25":"bg-secondary border border-border/50 text-muted-foreground hover:border-primary/30 hover:text-foreground"}`,children:Ot?" With kids":" Solo/Adults"})]}),Ot&&F.jsxs("div",{className:"space-y-2",children:[F.jsx(Va,{children:"Kids' ages"}),F.jsx("div",{className:"flex flex-wrap gap-2",children:[3,5,8,12,16].map(me=>F.jsxs("button",{onClick:()=>{Kt(jt=>jt.includes(me)?jt.filter(Qt=>Qt!==me):[...jt,me])},className:`px-3 py-1.5 rounded-full text-sm font-medium transition-all ${Nt.includes(me)?"bg-primary text-white":"bg-secondary text-muted-foreground hover:bg-secondary/80"}`,children:[me," yrs"]},me))})]}),F.jsxs("div",{className:"space-y-3",children:[F.jsx(Va,{children:"Their Interests (Optional)"}),F.jsx("div",{className:"grid grid-cols-3 gap-2 max-h-[200px] overflow-y-auto pr-1",children:sT.map(me=>F.jsx("button",{onClick:()=>ze(me),className:Rn("px-2 py-2 rounded-lg text-xs font-medium transition-all border flex items-center justify-center text-center",mt.includes(me)?"bg-primary text-primary-foreground border-primary shadow-sm":"bg-secondary text-muted-foreground border-transparent hover:bg-secondary/80 hover:text-foreground"),children:me},me))})]})]}),F.jsx(_C,{children:F.jsx(xr,{onClick:ae,disabled:!rt.trim(),className:"w-full sm:w-auto",children:"Add to Trip"})})]})]})}),F.jsx("div",{className:"space-y-2 min-h-[150px]",children:s.companions.length===0?F.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground/50 py-8 border-2 border-dashed rounded-xl border-muted/50",children:[F.jsx("p",{children:"Just me, myself, and I"}),F.jsx("span",{className:"text-xs mt-1",children:"(For now)"})]}):F.jsx("div",{className:"grid gap-2",children:s.companions.map((me,jt)=>F.jsxs(Wc.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0},className:"bg-secondary/50 border border-border p-3 rounded-xl flex items-center justify-between group",children:[F.jsxs("div",{className:"flex items-center gap-3",children:[F.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold text-sm",children:me.name.charAt(0)}),F.jsxs("div",{children:[F.jsx("p",{className:"text-sm font-bold leading-none",children:me.name}),F.jsxs("div",{className:"flex flex-wrap gap-1 mt-1.5",children:[me.interests.length>0?me.interests.slice(0,3).map(Qt=>F.jsx("span",{className:"text-[10px] bg-white px-1.5 py-0.5 rounded-md border text-muted-foreground",children:Qt},Qt)):F.jsx("span",{className:"text-xs text-muted-foreground italic",children:"Up for anything"}),me.interests.length>3&&F.jsxs("span",{className:"text-[10px] text-muted-foreground px-1",children:["+",me.interests.length-3]})]})]})]}),F.jsx("button",{onClick:()=>S(jt),className:"h-8 w-8 rounded-full hover:bg-destructive/10 hover:text-destructive flex items-center justify-center transition-colors opacity-0 group-hover:opacity-100",children:F.jsx(mm,{className:"w-4 h-4"})})]},me.name+jt))})})]}),u===4&&F.jsxs("div",{className:"space-y-6",children:[F.jsxs("div",{className:"text-center space-y-2",children:[F.jsx("div",{className:"w-12 h-12 bg-purple-500/10 rounded-full flex items-center justify-center mx-auto mb-4 text-purple-500",children:F.jsx(pP,{className:"w-6 h-6"})}),F.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Name your trip"}),F.jsx("p",{className:"text-muted-foreground",children:"Give this adventure a memorable name."})]}),F.jsx("div",{className:"space-y-4 mt-8",children:F.jsxs("div",{className:"space-y-2",children:[F.jsx(Va,{htmlFor:"tripName",className:"text-base",children:"Trip Name"}),F.jsx(ua,{id:"tripName",placeholder:"e.g. Summer in Tokyo 2025",value:s.currentTripName,onChange:me=>c({currentTripName:me.target.value}),className:"h-14 text-xl bg-background/50 border-border/50 focus:border-primary/50 text-center font-bold placeholder:font-normal",autoFocus:!0,"data-testid":"input-tripname"})]})})]}),F.jsxs("div",{className:"pt-8 mt-4 flex justify-between items-center",children:[u>1?F.jsx(xr,{variant:"ghost",onClick:()=>L(u-1),className:"text-muted-foreground hover:text-foreground",children:"Back"}):F.jsx("div",{}),F.jsxs(xr,{onClick:We,size:"lg",className:"rounded-xl px-8 shadow-lg shadow-primary/20",disabled:u===1&&(!s.name||!s.country)||u===4&&!s.currentTripName,"data-testid":"btn-next",children:[u===4?"Generate Plan":"Continue",u<4&&F.jsx(E0,{className:"ml-2 w-4 h-4"}),u===4&&F.jsx($g,{className:"ml-2 w-4 h-4"})]})]})]})},u)})]})]})}function ZN(s,c=[]){let p=[];function _(A,T){const u=Z.createContext(T);u.displayName=A+"Context";const L=p.length;p=[...p,T];const k=H=>{const{scope:W,children:it,...pt}=H,rt=W?.[s]?.[L]||u,J=Z.useMemo(()=>pt,Object.values(pt));return F.jsx(rt.Provider,{value:J,children:it})};k.displayName=A+"Provider";function B(H,W){const it=W?.[s]?.[L]||u,pt=Z.useContext(it);if(pt)return pt;if(T!==void 0)return T;throw new Error(`\`${H}\` must be used within \`${A}\``)}return[k,B]}const S=()=>{const A=p.map(T=>Z.createContext(T));return function(u){const L=u?.[s]||A;return Z.useMemo(()=>({[`__scope${s}`]:{...u,[s]:L}}),[u,L])}};return S.scopeName=s,[_,$N(S,...c)]}function $N(...s){const c=s[0];if(s.length===1)return c;const p=()=>{const _=s.map(S=>({useScope:S(),scopeName:S.scopeName}));return function(A){const T=_.reduce((u,{useScope:L,scopeName:k})=>{const H=L(A)[`__scope${k}`];return{...u,...H}},{});return Z.useMemo(()=>({[`__scope${c.scopeName}`]:T}),[T])}};return p.scopeName=c.scopeName,p}var HN=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Eb=HN.reduce((s,c)=>{const p=vb(`Primitive.${c}`),_=Z.forwardRef((S,A)=>{const{asChild:T,...u}=S,L=T?p:c;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),F.jsx(L,{...u,ref:A})});return _.displayName=`Primitive.${c}`,{...s,[c]:_}},{});function XN(){return hT.useSyncExternalStore(YN,()=>!0,()=>!1)}function YN(){return()=>{}}var Cb="Avatar",[WN]=ZN(Cb),[KN,xC]=WN(Cb),bC=Z.forwardRef((s,c)=>{const{__scopeAvatar:p,..._}=s,[S,A]=Z.useState("idle");return F.jsx(KN,{scope:p,imageLoadingStatus:S,onImageLoadingStatusChange:A,children:F.jsx(Eb.span,{..._,ref:c})})});bC.displayName=Cb;var wC="AvatarImage",TC=Z.forwardRef((s,c)=>{const{__scopeAvatar:p,src:_,onLoadingStatusChange:S=()=>{},...A}=s,T=xC(wC,p),u=QN(_,A),L=cr(k=>{S(k),T.onImageLoadingStatusChange(k)});return Bs(()=>{u!=="idle"&&L(u)},[u,L]),u==="loaded"?F.jsx(Eb.img,{...A,ref:c,src:_}):null});TC.displayName=wC;var SC="AvatarFallback",EC=Z.forwardRef((s,c)=>{const{__scopeAvatar:p,delayMs:_,...S}=s,A=xC(SC,p),[T,u]=Z.useState(_===void 0);return Z.useEffect(()=>{if(_!==void 0){const L=window.setTimeout(()=>u(!0),_);return()=>window.clearTimeout(L)}},[_]),T&&A.imageLoadingStatus!=="loaded"?F.jsx(Eb.span,{...S,ref:c}):null});EC.displayName=SC;function aT(s,c){return s?c?(s.src!==c&&(s.src=c),s.complete&&s.naturalWidth>0?"loaded":"loading"):"error":"idle"}function QN(s,{referrerPolicy:c,crossOrigin:p}){const _=XN(),S=Z.useRef(null),A=_?(S.current||(S.current=new window.Image),S.current):null,[T,u]=Z.useState(()=>aT(A,s));return Bs(()=>{u(aT(A,s))},[A,s]),Bs(()=>{const L=H=>()=>{u(H)};if(!A)return;const k=L("loaded"),B=L("error");return A.addEventListener("load",k),A.addEventListener("error",B),c&&(A.referrerPolicy=c),typeof p=="string"&&(A.crossOrigin=p),()=>{A.removeEventListener("load",k),A.removeEventListener("error",B)}},[A,p,c]),T}var CC=bC,AC=TC,MC=EC;const f0=Z.forwardRef(({className:s,...c},p)=>F.jsx(CC,{ref:p,className:Rn("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...c}));f0.displayName=CC.displayName;const PC=Z.forwardRef(({className:s,...c},p)=>F.jsx(AC,{ref:p,className:Rn("aspect-square h-full w-full",s),...c}));PC.displayName=AC.displayName;const p0=Z.forwardRef(({className:s,...c},p)=>F.jsx(MC,{ref:p,className:Rn("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...c}));p0.displayName=MC.displayName;var JN=Z.createContext(void 0);function tF(s){const c=Z.useContext(JN);return s||c||"ltr"}function eF(s,[c,p]){return Math.min(p,Math.max(c,s))}function Ff(s,c,{checkForDefaultPrevented:p=!0}={}){return function(S){if(s?.(S),p===!1||!S.defaultPrevented)return c?.(S)}}function nF(s,c){return Z.useReducer((p,_)=>c[p][_]??p,s)}var Ab="ScrollArea",[DC]=pm(Ab),[iF,al]=DC(Ab),RC=Z.forwardRef((s,c)=>{const{__scopeScrollArea:p,type:_="hover",dir:S,scrollHideDelay:A=600,...T}=s,[u,L]=Z.useState(null),[k,B]=Z.useState(null),[H,W]=Z.useState(null),[it,pt]=Z.useState(null),[rt,J]=Z.useState(null),[mt,Et]=Z.useState(0),[bt,Lt]=Z.useState(0),[Ot,ee]=Z.useState(!1),[Nt,Kt]=Z.useState(!1),xe=Ui(c,ae=>L(ae)),Ae=tF(S);return F.jsx(iF,{scope:p,type:_,dir:Ae,scrollHideDelay:A,scrollArea:u,viewport:k,onViewportChange:B,content:H,onContentChange:W,scrollbarX:it,onScrollbarXChange:pt,scrollbarXEnabled:Ot,onScrollbarXEnabledChange:ee,scrollbarY:rt,onScrollbarYChange:J,scrollbarYEnabled:Nt,onScrollbarYEnabledChange:Kt,onCornerWidthChange:Et,onCornerHeightChange:Lt,children:F.jsx($r.div,{dir:Ae,...T,ref:xe,style:{position:"relative","--radix-scroll-area-corner-width":mt+"px","--radix-scroll-area-corner-height":bt+"px",...s.style}})})});RC.displayName=Ab;var IC="ScrollAreaViewport",zC=Z.forwardRef((s,c)=>{const{__scopeScrollArea:p,children:_,nonce:S,...A}=s,T=al(IC,p),u=Z.useRef(null),L=Ui(c,u,T.onViewportChange);return F.jsxs(F.Fragment,{children:[F.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:S}),F.jsx($r.div,{"data-radix-scroll-area-viewport":"",...A,ref:L,style:{overflowX:T.scrollbarXEnabled?"scroll":"hidden",overflowY:T.scrollbarYEnabled?"scroll":"hidden",...s.style},children:F.jsx("div",{ref:T.onContentChange,style:{minWidth:"100%",display:"table"},children:_})})]})});zC.displayName=IC;var eu="ScrollAreaScrollbar",Mb=Z.forwardRef((s,c)=>{const{forceMount:p,..._}=s,S=al(eu,s.__scopeScrollArea),{onScrollbarXEnabledChange:A,onScrollbarYEnabledChange:T}=S,u=s.orientation==="horizontal";return Z.useEffect(()=>(u?A(!0):T(!0),()=>{u?A(!1):T(!1)}),[u,A,T]),S.type==="hover"?F.jsx(rF,{..._,ref:c,forceMount:p}):S.type==="scroll"?F.jsx(sF,{..._,ref:c,forceMount:p}):S.type==="auto"?F.jsx(LC,{..._,ref:c,forceMount:p}):S.type==="always"?F.jsx(Pb,{..._,ref:c}):null});Mb.displayName=eu;var rF=Z.forwardRef((s,c)=>{const{forceMount:p,..._}=s,S=al(eu,s.__scopeScrollArea),[A,T]=Z.useState(!1);return Z.useEffect(()=>{const u=S.scrollArea;let L=0;if(u){const k=()=>{window.clearTimeout(L),T(!0)},B=()=>{L=window.setTimeout(()=>T(!1),S.scrollHideDelay)};return u.addEventListener("pointerenter",k),u.addEventListener("pointerleave",B),()=>{window.clearTimeout(L),u.removeEventListener("pointerenter",k),u.removeEventListener("pointerleave",B)}}},[S.scrollArea,S.scrollHideDelay]),F.jsx(tu,{present:p||A,children:F.jsx(LC,{"data-state":A?"visible":"hidden",..._,ref:c})})}),sF=Z.forwardRef((s,c)=>{const{forceMount:p,..._}=s,S=al(eu,s.__scopeScrollArea),A=s.orientation==="horizontal",T=vv(()=>L("SCROLL_END"),100),[u,L]=nF("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return Z.useEffect(()=>{if(u==="idle"){const k=window.setTimeout(()=>L("HIDE"),S.scrollHideDelay);return()=>window.clearTimeout(k)}},[u,S.scrollHideDelay,L]),Z.useEffect(()=>{const k=S.viewport,B=A?"scrollLeft":"scrollTop";if(k){let H=k[B];const W=()=>{const it=k[B];H!==it&&(L("SCROLL"),T()),H=it};return k.addEventListener("scroll",W),()=>k.removeEventListener("scroll",W)}},[S.viewport,A,L,T]),F.jsx(tu,{present:p||u!=="hidden",children:F.jsx(Pb,{"data-state":u==="hidden"?"hidden":"visible",..._,ref:c,onPointerEnter:Ff(s.onPointerEnter,()=>L("POINTER_ENTER")),onPointerLeave:Ff(s.onPointerLeave,()=>L("POINTER_LEAVE"))})})}),LC=Z.forwardRef((s,c)=>{const p=al(eu,s.__scopeScrollArea),{forceMount:_,...S}=s,[A,T]=Z.useState(!1),u=s.orientation==="horizontal",L=vv(()=>{if(p.viewport){const k=p.viewport.offsetWidth<p.viewport.scrollWidth,B=p.viewport.offsetHeight<p.viewport.scrollHeight;T(u?k:B)}},10);return fm(p.viewport,L),fm(p.content,L),F.jsx(tu,{present:_||A,children:F.jsx(Pb,{"data-state":A?"visible":"hidden",...S,ref:c})})}),Pb=Z.forwardRef((s,c)=>{const{orientation:p="vertical",..._}=s,S=al(eu,s.__scopeScrollArea),A=Z.useRef(null),T=Z.useRef(0),[u,L]=Z.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),k=jC(u.viewport,u.content),B={..._,sizes:u,onSizesChange:L,hasThumb:k>0&&k<1,onThumbChange:W=>A.current=W,onThumbPointerUp:()=>T.current=0,onThumbPointerDown:W=>T.current=W};function H(W,it){return hF(W,T.current,u,it)}return p==="horizontal"?F.jsx(aF,{...B,ref:c,onThumbPositionChange:()=>{if(S.viewport&&A.current){const W=S.viewport.scrollLeft,it=oT(W,u,S.dir);A.current.style.transform=`translate3d(${it}px, 0, 0)`}},onWheelScroll:W=>{S.viewport&&(S.viewport.scrollLeft=W)},onDragScroll:W=>{S.viewport&&(S.viewport.scrollLeft=H(W,S.dir))}}):p==="vertical"?F.jsx(oF,{...B,ref:c,onThumbPositionChange:()=>{if(S.viewport&&A.current){const W=S.viewport.scrollTop,it=oT(W,u);A.current.style.transform=`translate3d(0, ${it}px, 0)`}},onWheelScroll:W=>{S.viewport&&(S.viewport.scrollTop=W)},onDragScroll:W=>{S.viewport&&(S.viewport.scrollTop=H(W))}}):null}),aF=Z.forwardRef((s,c)=>{const{sizes:p,onSizesChange:_,...S}=s,A=al(eu,s.__scopeScrollArea),[T,u]=Z.useState(),L=Z.useRef(null),k=Ui(c,L,A.onScrollbarXChange);return Z.useEffect(()=>{L.current&&u(getComputedStyle(L.current))},[L]),F.jsx(OC,{"data-orientation":"horizontal",...S,ref:k,sizes:p,style:{bottom:0,left:A.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:A.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":_v(p)+"px",...s.style},onThumbPointerDown:B=>s.onThumbPointerDown(B.x),onDragScroll:B=>s.onDragScroll(B.x),onWheelScroll:(B,H)=>{if(A.viewport){const W=A.viewport.scrollLeft+B.deltaX;s.onWheelScroll(W),VC(W,H)&&B.preventDefault()}},onResize:()=>{L.current&&A.viewport&&T&&_({content:A.viewport.scrollWidth,viewport:A.viewport.offsetWidth,scrollbar:{size:L.current.clientWidth,paddingStart:Z_(T.paddingLeft),paddingEnd:Z_(T.paddingRight)}})}})}),oF=Z.forwardRef((s,c)=>{const{sizes:p,onSizesChange:_,...S}=s,A=al(eu,s.__scopeScrollArea),[T,u]=Z.useState(),L=Z.useRef(null),k=Ui(c,L,A.onScrollbarYChange);return Z.useEffect(()=>{L.current&&u(getComputedStyle(L.current))},[L]),F.jsx(OC,{"data-orientation":"vertical",...S,ref:k,sizes:p,style:{top:0,right:A.dir==="ltr"?0:void 0,left:A.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":_v(p)+"px",...s.style},onThumbPointerDown:B=>s.onThumbPointerDown(B.y),onDragScroll:B=>s.onDragScroll(B.y),onWheelScroll:(B,H)=>{if(A.viewport){const W=A.viewport.scrollTop+B.deltaY;s.onWheelScroll(W),VC(W,H)&&B.preventDefault()}},onResize:()=>{L.current&&A.viewport&&T&&_({content:A.viewport.scrollHeight,viewport:A.viewport.offsetHeight,scrollbar:{size:L.current.clientHeight,paddingStart:Z_(T.paddingTop),paddingEnd:Z_(T.paddingBottom)}})}})}),[lF,kC]=DC(eu),OC=Z.forwardRef((s,c)=>{const{__scopeScrollArea:p,sizes:_,hasThumb:S,onThumbChange:A,onThumbPointerUp:T,onThumbPointerDown:u,onThumbPositionChange:L,onDragScroll:k,onWheelScroll:B,onResize:H,...W}=s,it=al(eu,p),[pt,rt]=Z.useState(null),J=Ui(c,xe=>rt(xe)),mt=Z.useRef(null),Et=Z.useRef(""),bt=it.viewport,Lt=_.content-_.viewport,Ot=cr(B),ee=cr(L),Nt=vv(H,10);function Kt(xe){if(mt.current){const Ae=xe.clientX-mt.current.left,ae=xe.clientY-mt.current.top;k({x:Ae,y:ae})}}return Z.useEffect(()=>{const xe=Ae=>{const ae=Ae.target;pt?.contains(ae)&&Ot(Ae,Lt)};return document.addEventListener("wheel",xe,{passive:!1}),()=>document.removeEventListener("wheel",xe,{passive:!1})},[bt,pt,Lt,Ot]),Z.useEffect(ee,[_,ee]),fm(pt,Nt),fm(it.content,Nt),F.jsx(lF,{scope:p,scrollbar:pt,hasThumb:S,onThumbChange:cr(A),onThumbPointerUp:cr(T),onThumbPositionChange:ee,onThumbPointerDown:cr(u),children:F.jsx($r.div,{...W,ref:J,style:{position:"absolute",...W.style},onPointerDown:Ff(s.onPointerDown,xe=>{xe.button===0&&(xe.target.setPointerCapture(xe.pointerId),mt.current=pt.getBoundingClientRect(),Et.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",it.viewport&&(it.viewport.style.scrollBehavior="auto"),Kt(xe))}),onPointerMove:Ff(s.onPointerMove,Kt),onPointerUp:Ff(s.onPointerUp,xe=>{const Ae=xe.target;Ae.hasPointerCapture(xe.pointerId)&&Ae.releasePointerCapture(xe.pointerId),document.body.style.webkitUserSelect=Et.current,it.viewport&&(it.viewport.style.scrollBehavior=""),mt.current=null})})})}),q_="ScrollAreaThumb",NC=Z.forwardRef((s,c)=>{const{forceMount:p,..._}=s,S=kC(q_,s.__scopeScrollArea);return F.jsx(tu,{present:p||S.hasThumb,children:F.jsx(cF,{ref:c,..._})})}),cF=Z.forwardRef((s,c)=>{const{__scopeScrollArea:p,style:_,...S}=s,A=al(q_,p),T=kC(q_,p),{onThumbPositionChange:u}=T,L=Ui(c,H=>T.onThumbChange(H)),k=Z.useRef(void 0),B=vv(()=>{k.current&&(k.current(),k.current=void 0)},100);return Z.useEffect(()=>{const H=A.viewport;if(H){const W=()=>{if(B(),!k.current){const it=dF(H,u);k.current=it,u()}};return u(),H.addEventListener("scroll",W),()=>H.removeEventListener("scroll",W)}},[A.viewport,B,u]),F.jsx($r.div,{"data-state":T.hasThumb?"visible":"hidden",...S,ref:L,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",..._},onPointerDownCapture:Ff(s.onPointerDownCapture,H=>{const it=H.target.getBoundingClientRect(),pt=H.clientX-it.left,rt=H.clientY-it.top;T.onThumbPointerDown({x:pt,y:rt})}),onPointerUp:Ff(s.onPointerUp,T.onThumbPointerUp)})});NC.displayName=q_;var Db="ScrollAreaCorner",FC=Z.forwardRef((s,c)=>{const p=al(Db,s.__scopeScrollArea),_=!!(p.scrollbarX&&p.scrollbarY);return p.type!=="scroll"&&_?F.jsx(uF,{...s,ref:c}):null});FC.displayName=Db;var uF=Z.forwardRef((s,c)=>{const{__scopeScrollArea:p,..._}=s,S=al(Db,p),[A,T]=Z.useState(0),[u,L]=Z.useState(0),k=!!(A&&u);return fm(S.scrollbarX,()=>{const B=S.scrollbarX?.offsetHeight||0;S.onCornerHeightChange(B),L(B)}),fm(S.scrollbarY,()=>{const B=S.scrollbarY?.offsetWidth||0;S.onCornerWidthChange(B),T(B)}),k?F.jsx($r.div,{..._,ref:c,style:{width:A,height:u,position:"absolute",right:S.dir==="ltr"?0:void 0,left:S.dir==="rtl"?0:void 0,bottom:0,...s.style}}):null});function Z_(s){return s?parseInt(s,10):0}function jC(s,c){const p=s/c;return isNaN(p)?0:p}function _v(s){const c=jC(s.viewport,s.content),p=s.scrollbar.paddingStart+s.scrollbar.paddingEnd,_=(s.scrollbar.size-p)*c;return Math.max(_,18)}function hF(s,c,p,_="ltr"){const S=_v(p),A=S/2,T=c||A,u=S-T,L=p.scrollbar.paddingStart+T,k=p.scrollbar.size-p.scrollbar.paddingEnd-u,B=p.content-p.viewport,H=_==="ltr"?[0,B]:[B*-1,0];return BC([L,k],H)(s)}function oT(s,c,p="ltr"){const _=_v(c),S=c.scrollbar.paddingStart+c.scrollbar.paddingEnd,A=c.scrollbar.size-S,T=c.content-c.viewport,u=A-_,L=p==="ltr"?[0,T]:[T*-1,0],k=eF(s,L);return BC([0,T],[0,u])(k)}function BC(s,c){return p=>{if(s[0]===s[1]||c[0]===c[1])return c[0];const _=(c[1]-c[0])/(s[1]-s[0]);return c[0]+_*(p-s[0])}}function VC(s,c){return s>0&&s<c}var dF=(s,c=()=>{})=>{let p={left:s.scrollLeft,top:s.scrollTop},_=0;return(function S(){const A={left:s.scrollLeft,top:s.scrollTop},T=p.left!==A.left,u=p.top!==A.top;(T||u)&&c(),p=A,_=window.requestAnimationFrame(S)})(),()=>window.cancelAnimationFrame(_)};function vv(s,c){const p=cr(s),_=Z.useRef(0);return Z.useEffect(()=>()=>window.clearTimeout(_.current),[]),Z.useCallback(()=>{window.clearTimeout(_.current),_.current=window.setTimeout(p,c)},[p,c])}function fm(s,c){const p=cr(c);Bs(()=>{let _=0;if(s){const S=new ResizeObserver(()=>{cancelAnimationFrame(_),_=window.requestAnimationFrame(p)});return S.observe(s),()=>{window.cancelAnimationFrame(_),S.unobserve(s)}}},[s,p])}var UC=RC,fF=zC,pF=FC;const xv=Z.forwardRef(({className:s,children:c,...p},_)=>F.jsxs(UC,{ref:_,className:Rn("relative overflow-hidden",s),...p,children:[F.jsx(fF,{className:"h-full w-full rounded-[inherit]",children:c}),F.jsx(Rb,{}),F.jsx(pF,{})]}));xv.displayName=UC.displayName;const Rb=Z.forwardRef(({className:s,orientation:c="vertical",...p},_)=>F.jsx(Mb,{ref:_,orientation:c,className:Rn("flex touch-none select-none transition-colors",c==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",c==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...p,children:F.jsx(NC,{className:"relative flex-1 rounded-full bg-border"})}));Rb.displayName=Mb.displayName;const mF=sy("whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 hover-elevate ",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow-xs",secondary:"border-transparent bg-secondary text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground shadow-xs",outline:"text-foreground border [border-color:var(--badge-outline)]"}},defaultVariants:{variant:"default"}});function jf({className:s,variant:c,...p}){return F.jsx("div",{className:Rn(mF({variant:c}),s),...p})}const gF=fC,yF=pC,_F=mC,GC=Z.forwardRef(({className:s,...c},p)=>F.jsx(hv,{className:Rn("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...c,ref:p}));GC.displayName=hv.displayName;const vF=sy("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),qC=Z.forwardRef(({side:s="right",className:c,children:p,..._},S)=>F.jsxs(_F,{children:[F.jsx(GC,{}),F.jsxs(dv,{ref:S,className:Rn(vF({side:s}),c),..._,children:[F.jsxs(gC,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[F.jsx(mm,{className:"h-4 w-4"}),F.jsx("span",{className:"sr-only",children:"Close"})]}),p]})]}));qC.displayName=dv.displayName;const ZC=({className:s,...c})=>F.jsx("div",{className:Rn("flex flex-col space-y-2 text-center sm:text-left",s),...c});ZC.displayName="SheetHeader";const $C=Z.forwardRef(({className:s,...c},p)=>F.jsx(fv,{ref:p,className:Rn("text-lg font-semibold text-foreground",s),...c}));$C.displayName=fv.displayName;const xF=Z.forwardRef(({className:s,...c},p)=>F.jsx(pv,{ref:p,className:Rn("text-sm text-muted-foreground",s),...c}));xF.displayName=pv.displayName;const bF=["Fine Dining","Street Food","Hiking","Museums","Nightlife","Coffee","Shopping","Photography","Live Music","History","Architecture","Nature","Family Friendly","For Kids","Parks & Playgrounds"];function wF(){const{profile:s,addCompanion:c,removeCompanion:p,updateCompanion:_}=Vf(),[S,A]=Z.useState(!1),[T,u]=Z.useState(null),[L,k]=Z.useState({name:"",interests:[],age:void 0,familyFriendly:!1,kidsAge:[]}),B=()=>{L.name.trim()&&(T!==null?(_(T,L),u(null)):c(L),k({name:"",interests:[]}))},H=J=>{k(s.companions[J]),u(J)},W=J=>{p(J),T===J&&(u(null),k({name:"",interests:[],age:void 0,familyFriendly:!1,kidsAge:[]}))},it=J=>{k(mt=>({...mt,interests:mt.interests.includes(J)?mt.interests.filter(Et=>Et!==J):[...mt.interests,J]}))},pt=()=>{A(!1),u(null),k({name:"",interests:[],age:void 0,familyFriendly:!1,kidsAge:[]})},rt=J=>{k(mt=>({...mt,kidsAge:(mt.kidsAge||[]).includes(J)?(mt.kidsAge||[]).filter(Et=>Et!==J):[...mt.kidsAge||[],J]}))};return F.jsxs(Tb,{open:S,onOpenChange:A,children:[F.jsx(Sb,{asChild:!0,children:F.jsxs(xr,{variant:"outline",className:"gap-2",children:[F.jsx(kx,{className:"w-4 h-4"})," Manage Friends"]})}),F.jsxs(mv,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[F.jsx(gv,{children:F.jsxs(yv,{className:"flex items-center gap-2",children:[F.jsx(J_,{className:"w-5 h-5"}),"Manage Travel Buddies"]})}),F.jsxs("div",{className:"space-y-6",children:[F.jsxs("div",{className:"space-y-4 p-4 bg-secondary/30 rounded-lg",children:[F.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[F.jsxs("div",{children:[F.jsx("label",{className:"text-sm font-medium",children:"Friend's Name"}),F.jsx(ua,{placeholder:"Enter name",value:L.name,onChange:J=>k(mt=>({...mt,name:J.target.value})),className:"mt-1"})]}),F.jsxs("div",{children:[F.jsx("label",{className:"text-sm font-medium",children:"Age"}),F.jsx(ua,{type:"number",placeholder:"Age",value:L.age||"",onChange:J=>k(mt=>({...mt,age:J.target.value?parseInt(J.target.value):void 0})),className:"mt-1",min:"0",max:"120"})]})]}),F.jsxs("div",{children:[F.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Their Interests"}),F.jsx("div",{className:"flex flex-wrap gap-2",children:bF.map(J=>F.jsx(jf,{variant:L.interests.includes(J)?"default":"outline",className:"cursor-pointer",onClick:()=>it(J),children:J},J))})]}),L.interests.includes("For Kids")&&F.jsxs("div",{children:[F.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Kids' Ages"}),F.jsx("div",{className:"flex flex-wrap gap-2",children:[3,5,8,12,16].map(J=>F.jsxs(jf,{variant:(L.kidsAge||[]).includes(J)?"default":"outline",className:"cursor-pointer",onClick:()=>rt(J),children:[J," yrs"]},J))})]}),F.jsxs("div",{children:[F.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Family travel"}),F.jsx("button",{onClick:()=>k(J=>({...J,familyFriendly:!J.familyFriendly})),className:`w-full h-10 rounded-lg font-medium text-sm transition-all flex items-center justify-center gap-2 ${L.familyFriendly?"bg-primary text-white shadow-lg shadow-primary/25":"bg-secondary border border-border/50 text-muted-foreground hover:border-primary/30 hover:text-foreground"}`,children:L.familyFriendly?" With kids":" Solo/Adults"})]}),F.jsxs("div",{className:"flex gap-2",children:[F.jsx(xr,{onClick:B,disabled:!L.name.trim(),className:"flex-1",children:T!==null?"Update Friend":"Add Friend"}),T!==null&&F.jsx(xr,{variant:"outline",onClick:()=>{u(null),k({name:"",interests:[],age:void 0,familyFriendly:!1,kidsAge:[]})},children:"Cancel"})]})]}),F.jsxs("div",{children:[F.jsxs("h3",{className:"font-semibold mb-3",children:["Your Travel Buddies (",s.companions.length,")"]}),F.jsx(xv,{className:"h-[300px] pr-4",children:s.companions.length===0?F.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[F.jsx("p",{children:"No friends added yet"}),F.jsx("p",{className:"text-sm",children:"Add friends to personalize recommendations"})]}):F.jsx("div",{className:"space-y-3",children:s.companions.map((J,mt)=>F.jsxs("div",{className:"p-3 border rounded-lg hover:bg-secondary/50 transition-colors",children:[F.jsxs("div",{className:"flex items-start justify-between mb-2",children:[F.jsxs("div",{children:[F.jsxs("p",{className:"font-medium",children:[J.name," ",J.age?`(${J.age})`:""]}),F.jsx("p",{className:"text-xs text-muted-foreground",children:J.interests.length>0?J.interests.join(", "):"No interests specified"}),J.familyFriendly&&F.jsx("p",{className:"text-xs text-primary mt-1",children:" Traveling with family"}),J.kidsAge&&J.kidsAge.length>0&&F.jsxs("p",{className:"text-xs text-primary",children:[" Kids: ",J.kidsAge.join(", ")," yrs"]})]}),F.jsxs("div",{className:"flex gap-2",children:[F.jsx(xr,{size:"sm",variant:"ghost",onClick:()=>H(mt),children:F.jsx(kx,{className:"w-3 h-3"})}),F.jsx(xr,{size:"sm",variant:"ghost",onClick:()=>W(mt),children:F.jsx(mm,{className:"w-3 h-3"})})]})]}),J.interests.length>0&&F.jsx("div",{className:"flex flex-wrap gap-1",children:J.interests.map(Et=>F.jsx(jf,{variant:"secondary",className:"text-xs",children:Et},Et))})]},mt))})})]}),F.jsx(xr,{onClick:pt,className:"w-full",children:"Done"})]})]})]})}var R_={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.13.0/LICENSE.txt
 */var TF=R_.exports,lT;function SF(){return lT||(lT=1,(function(s,c){(function(p,_){s.exports=_()})(TF,(function(){var p={},_={};function S(T,u,L){if(_[T]=L,T==="index"){var k="var sharedModule = {}; ("+_.shared+")(sharedModule); ("+_.worker+")(sharedModule);",B={};return _.shared(B),_.index(p,B),typeof window<"u"&&p.setWorkerUrl(window.URL.createObjectURL(new Blob([k],{type:"text/javascript"}))),p}}S("shared",["exports"],(function(T){function u(r,t,n,l){return new(n||(n=Promise))((function(h,m){function y(D){try{C(l.next(D))}catch(z){m(z)}}function w(D){try{C(l.throw(D))}catch(z){m(z)}}function C(D){var z;D.done?h(D.value):(z=D.value,z instanceof n?z:new n((function(N){N(z)}))).then(y,w)}C((l=l.apply(r,t||[])).next())}))}function L(r,t){this.x=r,this.y=t}function k(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var B,H;typeof SuppressedError=="function"&&SuppressedError,L.prototype={clone(){return new L(this.x,this.y)},add(r){return this.clone()._add(r)},sub(r){return this.clone()._sub(r)},multByPoint(r){return this.clone()._multByPoint(r)},divByPoint(r){return this.clone()._divByPoint(r)},mult(r){return this.clone()._mult(r)},div(r){return this.clone()._div(r)},rotate(r){return this.clone()._rotate(r)},rotateAround(r,t){return this.clone()._rotateAround(r,t)},matMult(r){return this.clone()._matMult(r)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(r){return this.x===r.x&&this.y===r.y},dist(r){return Math.sqrt(this.distSqr(r))},distSqr(r){const t=r.x-this.x,n=r.y-this.y;return t*t+n*n},angle(){return Math.atan2(this.y,this.x)},angleTo(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith(r){return this.angleWithSep(r.x,r.y)},angleWithSep(r,t){return Math.atan2(this.x*t-this.y*r,this.x*r+this.y*t)},_matMult(r){const t=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=t,this},_add(r){return this.x+=r.x,this.y+=r.y,this},_sub(r){return this.x-=r.x,this.y-=r.y,this},_mult(r){return this.x*=r,this.y*=r,this},_div(r){return this.x/=r,this.y/=r,this},_multByPoint(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint(r){return this.x/=r.x,this.y/=r.y,this},_unit(){return this._div(this.mag()),this},_perp(){const r=this.y;return this.y=this.x,this.x=-r,this},_rotate(r){const t=Math.cos(r),n=Math.sin(r),l=n*this.x+t*this.y;return this.x=t*this.x-n*this.y,this.y=l,this},_rotateAround(r,t){const n=Math.cos(r),l=Math.sin(r),h=t.y+l*(this.x-t.x)+n*(this.y-t.y);return this.x=t.x+n*(this.x-t.x)-l*(this.y-t.y),this.y=h,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:L},L.convert=function(r){if(r instanceof L)return r;if(Array.isArray(r))return new L(+r[0],+r[1]);if(r.x!==void 0&&r.y!==void 0)return new L(+r.x,+r.y);throw new Error("Expected [x, y] or {x, y} point format")};var W=(function(){if(H)return B;function r(t,n,l,h){this.cx=3*t,this.bx=3*(l-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(h-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=l,this.p2y=h}return H=1,B=r,r.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,n){if(n===void 0&&(n=1e-6),t<0)return 0;if(t>1)return 1;for(var l=t,h=0;h<8;h++){var m=this.sampleCurveX(l)-t;if(Math.abs(m)<n)return l;var y=this.sampleCurveDerivativeX(l);if(Math.abs(y)<1e-6)break;l-=m/y}var w=0,C=1;for(l=t,h=0;h<20&&(m=this.sampleCurveX(l),!(Math.abs(m-t)<n));h++)t>m?w=l:C=l,l=.5*(C-w)+w;return l},solve:function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))}},B})(),it=k(W);let pt,rt;function J(){return pt==null&&(pt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),pt}function mt(){if(rt==null&&(rt=!1,J())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let l=0;l<25;l++){const h=4*l;t.fillStyle=`rgb(${h},${h+1},${h+2})`,t.fillRect(l%5,Math.floor(l/5),1,1)}const n=t.getImageData(0,0,5,5).data;for(let l=0;l<100;l++)if(l%4!=3&&n[l]!==l){rt=!0;break}}}return rt||!1}var Et=1e-6,bt=typeof Float32Array<"u"?Float32Array:Array;function Lt(){var r=new bt(9);return bt!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function Ot(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function ee(){var r=new bt(3);return bt!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function Nt(r){var t=r[0],n=r[1],l=r[2];return Math.sqrt(t*t+n*n+l*l)}function Kt(r,t,n){var l=new bt(3);return l[0]=r,l[1]=t,l[2]=n,l}function xe(r,t,n){return r[0]=t[0]+n[0],r[1]=t[1]+n[1],r[2]=t[2]+n[2],r}function Ae(r,t,n){return r[0]=t[0]*n,r[1]=t[1]*n,r[2]=t[2]*n,r}function ae(r,t,n){var l=t[0],h=t[1],m=t[2],y=n[0],w=n[1],C=n[2];return r[0]=h*C-m*w,r[1]=m*y-l*C,r[2]=l*w-h*y,r}var ze,We=Nt;function Ee(r,t,n){var l=t[0],h=t[1],m=t[2],y=t[3];return r[0]=n[0]*l+n[4]*h+n[8]*m+n[12]*y,r[1]=n[1]*l+n[5]*h+n[9]*m+n[13]*y,r[2]=n[2]*l+n[6]*h+n[10]*m+n[14]*y,r[3]=n[3]*l+n[7]*h+n[11]*m+n[15]*y,r}function me(){var r=new bt(4);return bt!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function jt(r,t,n,l){var h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",m=Math.PI/360;t*=m,l*=m,n*=m;var y=Math.sin(t),w=Math.cos(t),C=Math.sin(n),D=Math.cos(n),z=Math.sin(l),N=Math.cos(l);switch(h){case"xyz":r[0]=y*D*N+w*C*z,r[1]=w*C*N-y*D*z,r[2]=w*D*z+y*C*N,r[3]=w*D*N-y*C*z;break;case"xzy":r[0]=y*D*N-w*C*z,r[1]=w*C*N-y*D*z,r[2]=w*D*z+y*C*N,r[3]=w*D*N+y*C*z;break;case"yxz":r[0]=y*D*N+w*C*z,r[1]=w*C*N-y*D*z,r[2]=w*D*z-y*C*N,r[3]=w*D*N+y*C*z;break;case"yzx":r[0]=y*D*N+w*C*z,r[1]=w*C*N+y*D*z,r[2]=w*D*z-y*C*N,r[3]=w*D*N-y*C*z;break;case"zxy":r[0]=y*D*N-w*C*z,r[1]=w*C*N+y*D*z,r[2]=w*D*z+y*C*N,r[3]=w*D*N-y*C*z;break;case"zyx":r[0]=y*D*N-w*C*z,r[1]=w*C*N+y*D*z,r[2]=w*D*z-y*C*N,r[3]=w*D*N+y*C*z;break;default:throw new Error("Unknown angle order "+h)}return r}function Qt(){var r=new bt(2);return bt!=Float32Array&&(r[0]=0,r[1]=0),r}function Gt(r,t){var n=new bt(2);return n[0]=r,n[1]=t,n}ee(),ze=new bt(4),bt!=Float32Array&&(ze[0]=0,ze[1]=0,ze[2]=0,ze[3]=0),ee(),Kt(1,0,0),Kt(0,1,0),me(),me(),Lt(),Qt();const we=8192;function He(r,t,n){return t*(we/(r.tileSize*Math.pow(2,n-r.tileID.overscaledZ)))}function Rt(r,t){return(r%t+t)%t}function se(r,t,n){return r*(1-n)+t*n}function be(r){if(r<=0)return 0;if(r>=1)return 1;const t=r*r,n=t*r;return 4*(r<.5?n:3*(r-t)+n-.75)}function Te(r,t,n,l){const h=new it(r,t,n,l);return m=>h.solve(m)}const Ze=Te(.25,.1,.25,1);function $e(r,t,n){return Math.min(n,Math.max(t,r))}function Le(r,t,n){const l=n-t,h=((r-t)%l+l)%l+t;return h===t?n:h}function yn(r,...t){for(const n of t)for(const l in n)r[l]=n[l];return r}let Mn=1;function Gi(r,t,n){const l={};for(const h in r)l[h]=t.call(this,r[h],h,r);return l}function br(r,t,n){const l={};for(const h in r)t.call(this,r[h],h,r)&&(l[h]=r[h]);return l}function Ci(r){return Array.isArray(r)?r.map(Ci):typeof r=="object"&&r?Gi(r,Ci):r}const Vs={};function Nn(r){Vs[r]||(typeof console<"u"&&console.warn(r),Vs[r]=!0)}function os(r,t,n){return(n.y-r.y)*(t.x-r.x)>(t.y-r.y)*(n.x-r.x)}function Ts(r){return typeof WorkerGlobalScope<"u"&&r!==void 0&&r instanceof WorkerGlobalScope}let ui=null;function Us(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const Ss="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function To(r,t,n,l,h){return u(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const m=new VideoFrame(r,{timestamp:0});try{const y=m?.format;if(!y||!y.startsWith("BGR")&&!y.startsWith("RGB"))throw new Error(`Unrecognized format ${y}`);const w=y.startsWith("BGR"),C=new Uint8ClampedArray(l*h*4);if(yield m.copyTo(C,(function(D,z,N,V,U){const G=4*Math.max(-z,0),Y=(Math.max(0,N)-N)*V*4+G,tt=4*V,at=Math.max(0,z),yt=Math.max(0,N);return{rect:{x:at,y:yt,width:Math.min(D.width,z+V)-at,height:Math.min(D.height,N+U)-yt},layout:[{offset:Y,stride:tt}]}})(r,t,n,l,h)),w)for(let D=0;D<C.length;D+=4){const z=C[D];C[D]=C[D+2],C[D+2]=z}return C}finally{m.close()}}))}let da,fa;function So(r,t,n,l){return r.addEventListener(t,n,l),{unsubscribe:()=>{r.removeEventListener(t,n,l)}}}function qi(r){return r*Math.PI/180}function Hr(r){return r/Math.PI*180}const nc={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},ic={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},pa="AbortError";function rc(){return new Error(pa)}const Ga={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function sc(r){return Ga.REGISTERED_PROTOCOLS[r.substring(0,r.indexOf("://"))]}const ol="global-dispatcher";class Ir extends Error{constructor(t,n,l,h){super(`AJAXError: ${n} (${t}): ${l}`),this.status=t,this.statusText=n,this.url=l,this.body=h}}const ri=()=>Ts(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ct=function(r,t){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){const l=sc(r.url);if(l)return l(r,t);if(Ts(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,targetMapId:ol},t)}if(!(/^file:/.test(n=r.url)||/^file:/.test(ri())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(l,h){return u(this,void 0,void 0,(function*(){const m=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,cache:l.cache,referrer:ri(),signal:h.signal});let y,w;l.type!=="json"||m.headers.has("Accept")||m.headers.set("Accept","application/json");try{y=yield fetch(m)}catch(D){throw new Ir(0,D.message,l.url,new Blob)}if(!y.ok){const D=yield y.blob();throw new Ir(y.status,y.statusText,l.url,D)}w=l.type==="arrayBuffer"||l.type==="image"?y.arrayBuffer():l.type==="json"?y.json():y.text();const C=yield w;if(h.signal.aborted)throw rc();return{data:C,cacheControl:y.headers.get("Cache-Control"),expires:y.headers.get("Expires")}}))})(r,t);if(Ts(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,mustQueue:!0,targetMapId:ol},t)}var n;return(function(l,h){return new Promise(((m,y)=>{var w;const C=new XMLHttpRequest;C.open(l.method||"GET",l.url,!0),l.type!=="arrayBuffer"&&l.type!=="image"||(C.responseType="arraybuffer");for(const D in l.headers)C.setRequestHeader(D,l.headers[D]);l.type==="json"&&(C.responseType="text",!((w=l.headers)===null||w===void 0)&&w.Accept||C.setRequestHeader("Accept","application/json")),C.withCredentials=l.credentials==="include",C.onerror=()=>{y(new Error(C.statusText))},C.onload=()=>{if(!h.signal.aborted)if((C.status>=200&&C.status<300||C.status===0)&&C.response!==null){let D=C.response;if(l.type==="json")try{D=JSON.parse(C.response)}catch(z){return void y(z)}m({data:D,cacheControl:C.getResponseHeader("Cache-Control"),expires:C.getResponseHeader("Expires")})}else{const D=new Blob([C.response],{type:C.getResponseHeader("Content-Type")});y(new Ir(C.status,C.statusText,l.url,D))}},h.signal.addEventListener("abort",(()=>{C.abort(),y(rc())})),C.send(l.body)}))})(r,t)};function K(r){if(!r||r.indexOf("://")<=0||r.indexOf("data:image/")===0||r.indexOf("blob:")===0)return!0;const t=new URL(r),n=window.location;return t.protocol===n.protocol&&t.host===n.host}function et(r,t,n){n[r]&&n[r].indexOf(t)!==-1||(n[r]=n[r]||[],n[r].push(t))}function st(r,t,n){if(n&&n[r]){const l=n[r].indexOf(t);l!==-1&&n[r].splice(l,1)}}class vt{constructor(t,n={}){yn(this,n),this.type=t}}class wt extends vt{constructor(t,n={}){super("error",yn({error:t},n))}}class Ft{on(t,n){return this._listeners=this._listeners||{},et(t,n,this._listeners),{unsubscribe:()=>{this.off(t,n)}}}off(t,n){return st(t,n,this._listeners),st(t,n,this._oneTimeListeners),this}once(t,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},et(t,n,this._oneTimeListeners),this):new Promise((l=>this.once(t,l)))}fire(t,n){typeof t=="string"&&(t=new vt(t,n||{}));const l=t.type;if(this.listens(l)){t.target=this;const h=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const w of h)w.call(this,t);const m=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const w of m)st(l,w,this._oneTimeListeners),w.call(this,t);const y=this._eventedParent;y&&(yn(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(t))}else t instanceof wt&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,n){return this._eventedParent=t,this._eventedParentData=n,this}}var ht={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const It=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Xt(r,t){const n={};for(const l in r)l!=="ref"&&(n[l]=r[l]);return It.forEach((l=>{l in t&&(n[l]=t[l])})),n}function Wt(r,t){if(Array.isArray(r)){if(!Array.isArray(t)||r.length!==t.length)return!1;for(let n=0;n<r.length;n++)if(!Wt(r[n],t[n]))return!1;return!0}if(typeof r=="object"&&r!==null&&t!==null){if(typeof t!="object"||Object.keys(r).length!==Object.keys(t).length)return!1;for(const n in r)if(!Wt(r[n],t[n]))return!1;return!0}return r===t}function te(r,t){r.push(t)}function Pe(r,t,n){te(n,{command:"addSource",args:[r,t[r]]})}function Oe(r,t,n){te(t,{command:"removeSource",args:[r]}),n[r]=!0}function Qe(r,t,n,l){Oe(r,n,l),Pe(r,t,n)}function mi(r,t,n){let l;for(l in r[n])if(Object.prototype.hasOwnProperty.call(r[n],l)&&l!=="data"&&!Wt(r[n][l],t[n][l]))return!1;for(l in t[n])if(Object.prototype.hasOwnProperty.call(t[n],l)&&l!=="data"&&!Wt(r[n][l],t[n][l]))return!1;return!0}function ln(r,t,n,l,h,m){r=r||{},t=t||{};for(const y in r)Object.prototype.hasOwnProperty.call(r,y)&&(Wt(r[y],t[y])||n.push({command:m,args:[l,y,t[y],h]}));for(const y in t)Object.prototype.hasOwnProperty.call(t,y)&&!Object.prototype.hasOwnProperty.call(r,y)&&(Wt(r[y],t[y])||n.push({command:m,args:[l,y,t[y],h]}))}function En(r){return r.id}function Un(r,t){return r[t.id]=t,r}class pe{constructor(t,n,l,h){this.message=(t?`${t}: `:"")+l,h&&(this.identifier=h),n!=null&&n.__line__&&(this.line=n.__line__)}}function Gn(r,...t){for(const n of t)for(const l in n)r[l]=n[l];return r}class qn extends Error{constructor(t,n){super(n),this.message=n,this.key=t}}class Ai{constructor(t,n=[]){this.parent=t,this.bindings={};for(const[l,h]of n)this.bindings[l]=h}concat(t){return new Ai(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Cn={kind:"null"},ce={kind:"number"},Ce={kind:"string"},Ne={kind:"boolean"},wr={kind:"color"},ll={kind:"projectionDefinition"},nr={kind:"object"},Ye={kind:"value"},ls={kind:"collator"},Eo={kind:"formatted"},Gs={kind:"padding"},Tr={kind:"colorArray"},qs={kind:"numberArray"},Zs={kind:"resolvedImage"},gi={kind:"variableAnchorOffsetCollection"};function Xr(r,t){return{kind:"array",itemType:r,N:t}}function Zn(r){if(r.kind==="array"){const t=Zn(r.itemType);return typeof r.N=="number"?`array<${t}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${t}>`}return r.kind}const cl=[Cn,ce,Ce,Ne,wr,ll,Eo,nr,Xr(Ye),Gs,qs,Tr,Zs,gi];function zr(r,t){if(t.kind==="error")return null;if(r.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!zr(r.itemType,t.itemType))&&(typeof r.N!="number"||r.N===t.N))return null}else{if(r.kind===t.kind)return null;if(r.kind==="value"){for(const n of cl)if(!zr(n,t))return null}}return`Expected ${Zn(r)} but found ${Zn(t)} instead.`}function nu(r,t){return t.some((n=>n.kind===r.kind))}function si(r,t){return t.some((n=>n==="null"?r===null:n==="array"?Array.isArray(r):n==="object"?r&&!Array.isArray(r)&&typeof r=="object":n===typeof r))}function qa(r,t){return r.kind==="array"&&t.kind==="array"?r.itemType.kind===t.itemType.kind&&typeof r.N=="number":r.kind===t.kind}const xd=.96422,Za=.82521,ac=4/29,Yr=6/29,cs=3*Yr*Yr,bd=Yr*Yr*Yr,Tm=Math.PI/180,lh=180/Math.PI;function wd(r){return(r%=360)<0&&(r+=360),r}function iu([r,t,n,l]){let h,m;const y=Wr((.2225045*(r=Td(r))+.7168786*(t=Td(t))+.0606169*(n=Td(n)))/1);r===t&&t===n?h=m=y:(h=Wr((.4360747*r+.3850649*t+.1430804*n)/xd),m=Wr((.0139322*r+.0971045*t+.7141733*n)/Za));const w=116*y-16;return[w<0?0:w,500*(h-y),200*(y-m),l]}function Td(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Wr(r){return r>bd?Math.pow(r,1/3):r/cs+ac}function ch([r,t,n,l]){let h=(r+16)/116,m=isNaN(t)?h:h+t/500,y=isNaN(n)?h:h-n/200;return h=1*ru(h),m=xd*ru(m),y=Za*ru(y),[uh(3.1338561*m-1.6168667*h-.4906146*y),uh(-.9787684*m+1.9161415*h+.033454*y),uh(.0719453*m-.2289914*h+1.4052427*y),l]}function uh(r){return(r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055)<0?0:r>1?1:r}function ru(r){return r>Yr?r*r*r:cs*(r-ac)}const ul=Object.hasOwn||function(r,t){return Object.prototype.hasOwnProperty.call(r,t)};function ma(r,t){return ul(r,t)?r[t]:void 0}function su(r){return parseInt(r.padEnd(2,r),16)/255}function hl(r,t){return ga(t?r/100:r,0,1)}function ga(r,t,n){return Math.min(Math.max(t,r),n)}function Sd(r){return!r.some(Number.isNaN)}const Gf={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function ya(r,t,n){return r+n*(t-r)}function dl(r,t,n){return r.map(((l,h)=>ya(l,t[h],n)))}class hn{constructor(t,n,l,h=1,m=!0){this.r=t,this.g=n,this.b=l,this.a=h,m||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[t,n,l,h]))}static parse(t){if(t instanceof hn)return t;if(typeof t!="string")return;const n=(function(l){if((l=l.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=ma(Gf,l);if(h){const[y,w,C]=h;return[y/255,w/255,C/255,1]}if(l.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(l)){const y=l.length<6?1:2;let w=1;return[su(l.slice(w,w+=y)),su(l.slice(w,w+=y)),su(l.slice(w,w+=y)),su(l.slice(w,w+y)||"ff")]}if(l.startsWith("rgb")){const y=l.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[w,C,D,z,N,V,U,G,Y,tt,at,yt]=y,ct=[z||" ",U||" ",tt].join("");if(ct==="  "||ct==="  /"||ct===",,"||ct===",,,"){const dt=[D,V,Y].join(""),Pt=dt==="%%%"?100:dt===""?255:0;if(Pt){const Dt=[ga(+C/Pt,0,1),ga(+N/Pt,0,1),ga(+G/Pt,0,1),at?hl(+at,yt):1];if(Sd(Dt))return Dt}}return}}const m=l.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(m){const[y,w,C,D,z,N,V,U,G]=m,Y=[C||" ",z||" ",V].join("");if(Y==="  "||Y==="  /"||Y===",,"||Y===",,,"){const tt=[+w,ga(+D,0,100),ga(+N,0,100),U?hl(+U,G):1];if(Sd(tt))return(function([at,yt,ct,dt]){function Pt(Dt){const Zt=(Dt+at/30)%12,ue=yt*Math.min(ct,1-ct);return ct-ue*Math.max(-1,Math.min(Zt-3,9-Zt,1))}return at=wd(at),yt/=100,ct/=100,[Pt(0),Pt(8),Pt(4),dt]})(tt)}}})(t);return n?new hn(...n,!1):void 0}get rgb(){const{r:t,g:n,b:l,a:h}=this,m=h||1/0;return this.overwriteGetter("rgb",[t/m,n/m,l/m,h])}get hcl(){return this.overwriteGetter("hcl",(function(t){const[n,l,h,m]=iu(t),y=Math.sqrt(l*l+h*h);return[Math.round(1e4*y)?wd(Math.atan2(h,l)*lh):NaN,y,n,m]})(this.rgb))}get lab(){return this.overwriteGetter("lab",iu(this.rgb))}overwriteGetter(t,n){return Object.defineProperty(this,t,{value:n}),n}toString(){const[t,n,l,h]=this.rgb;return`rgba(${[t,n,l].map((m=>Math.round(255*m))).join(",")},${h})`}static interpolate(t,n,l,h="rgb"){switch(h){case"rgb":{const[m,y,w,C]=dl(t.rgb,n.rgb,l);return new hn(m,y,w,C,!1)}case"hcl":{const[m,y,w,C]=t.hcl,[D,z,N,V]=n.hcl;let U,G;if(isNaN(m)||isNaN(D))isNaN(m)?isNaN(D)?U=NaN:(U=D,w!==1&&w!==0||(G=z)):(U=m,N!==1&&N!==0||(G=y));else{let ct=D-m;D>m&&ct>180?ct-=360:D<m&&m-D>180&&(ct+=360),U=m+l*ct}const[Y,tt,at,yt]=(function([ct,dt,Pt,Dt]){return ct=isNaN(ct)?0:ct*Tm,ch([Pt,Math.cos(ct)*dt,Math.sin(ct)*dt,Dt])})([U,G??ya(y,z,l),ya(w,N,l),ya(C,V,l)]);return new hn(Y,tt,at,yt,!1)}case"lab":{const[m,y,w,C]=ch(dl(t.lab,n.lab,l));return new hn(m,y,w,C,!1)}}}}hn.black=new hn(0,0,0,1),hn.white=new hn(1,1,1,1),hn.transparent=new hn(0,0,0,0),hn.red=new hn(1,0,0,1);class Lr{constructor(t,n,l){this.sensitivity=t?n?"variant":"case":n?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,n){return this.collator.compare(t,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const rn=["bottom","center","top"];class _a{constructor(t,n,l,h,m,y){this.text=t,this.image=n,this.scale=l,this.fontStack=h,this.textColor=m,this.verticalAlign=y}}class bi{constructor(t){this.sections=t}static fromString(t){return new bi([new _a(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((t=>t.text.length!==0||t.image&&t.image.name.length!==0))}static factory(t){return t instanceof bi?t:bi.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map((t=>t.text)).join("")}}class Mi{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Mi)return t;if(typeof t=="number")return new Mi([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const n of t)if(typeof n!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Mi(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,l){return new Mi(dl(t.values,n.values,l))}}class Pi{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Pi)return t;if(typeof t=="number")return new Pi([t]);if(Array.isArray(t)){for(const n of t)if(typeof n!="number")return;return new Pi(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,l){return new Pi(dl(t.values,n.values,l))}}class Li{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Li)return t;if(typeof t=="string"){const l=hn.parse(t);return l?new Li([l]):void 0}if(!Array.isArray(t))return;const n=[];for(const l of t){if(typeof l!="string")return;const h=hn.parse(l);if(!h)return;n.push(h)}return new Li(n)}toString(){return JSON.stringify(this.values)}static interpolate(t,n,l,h="rgb"){const m=[];if(t.values.length!=n.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${n.values.length}), cannot interpolate.`);for(let y=0;y<t.values.length;y++)m.push(hn.interpolate(t.values[y],n.values[y],l,h));return new Li(m)}}class Bn extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}const au=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Zi{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Zi)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let n=0;n<t.length;n+=2){const l=t[n],h=t[n+1];if(typeof l!="string"||!au.has(l)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new Zi(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,l){const h=t.values,m=n.values;if(h.length!==m.length)throw new Bn(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${n.toString()}`);const y=[];for(let w=0;w<h.length;w+=2){if(h[w]!==m[w])throw new Bn(`Cannot interpolate values containing mismatched anchors. from[${w}]: ${h[w]}, to[${w}]: ${m[w]}`);y.push(h[w]);const[C,D]=h[w+1],[z,N]=m[w+1];y.push([ya(C,z,l),ya(D,N,l)])}return new Zi(y)}}class wi{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new wi({name:t,available:!1}):null}}class ir{constructor(t,n,l){this.from=t,this.to=n,this.transition=l}static interpolate(t,n,l){return new ir(t,n,l)}static parse(t){return t instanceof ir?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new ir(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new ir(t.from,t.to,t.transition):typeof t=="string"?new ir(t,t,1):void 0}}function oc(r,t,n,l){return typeof r=="number"&&r>=0&&r<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof n=="number"&&n>=0&&n<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[r,t,n,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[r,t,n,l]:[r,t,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function kr(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof ir||r instanceof hn||r instanceof Lr||r instanceof bi||r instanceof Mi||r instanceof Pi||r instanceof Li||r instanceof Zi||r instanceof wi)return!0;if(Array.isArray(r)){for(const t of r)if(!kr(t))return!1;return!0}if(typeof r=="object"){for(const t in r)if(!kr(r[t]))return!1;return!0}return!1}function $n(r){if(r===null)return Cn;if(typeof r=="string")return Ce;if(typeof r=="boolean")return Ne;if(typeof r=="number")return ce;if(r instanceof hn)return wr;if(r instanceof ir)return ll;if(r instanceof Lr)return ls;if(r instanceof bi)return Eo;if(r instanceof Mi)return Gs;if(r instanceof Pi)return qs;if(r instanceof Li)return Tr;if(r instanceof Zi)return gi;if(r instanceof wi)return Zs;if(Array.isArray(r)){const t=r.length;let n;for(const l of r){const h=$n(l);if(n){if(n===h)continue;n=Ye;break}n=h}return Xr(n||Ye,t)}return nr}function $a(r){const t=typeof r;return r===null?"":t==="string"||t==="number"||t==="boolean"?String(r):r instanceof hn||r instanceof ir||r instanceof bi||r instanceof Mi||r instanceof Pi||r instanceof Li||r instanceof Zi||r instanceof wi?r.toString():JSON.stringify(r)}class Ha{constructor(t,n){this.type=t,this.value=n}static parse(t,n){if(t.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!kr(t[1]))return n.error("invalid value");const l=t[1];let h=$n(l);const m=n.expectedType;return h.kind!=="array"||h.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(h=m),new Ha(h,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Co={string:Ce,number:ce,boolean:Ne,object:nr};class ur{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let l,h=1;const m=t[0];if(m==="array"){let w,C;if(t.length>2){const D=t[1];if(typeof D!="string"||!(D in Co)||D==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);w=Co[D],h++}else w=Ye;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return n.error('The length argument to "array" must be a positive integer literal',2);C=t[2],h++}l=Xr(w,C)}else{if(!Co[m])throw new Error(`Types doesn't contain name = ${m}`);l=Co[m]}const y=[];for(;h<t.length;h++){const w=n.parse(t[h],h,Ye);if(!w)return null;y.push(w)}return new ur(l,y)}evaluate(t){for(let n=0;n<this.args.length;n++){const l=this.args[n].evaluate(t);if(!zr(this.type,$n(l)))return l;if(n===this.args.length-1)throw new Bn(`Expected value to be of type ${Zn(this.type)}, but found ${Zn($n(l))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const Qn={"to-boolean":Ne,"to-color":wr,"to-number":ce,"to-string":Ce};class yi{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const l=t[0];if(!Qn[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&t.length!==2)return n.error("Expected one argument.");const h=Qn[l],m=[];for(let y=1;y<t.length;y++){const w=n.parse(t[y],y,Ye);if(!w)return null;m.push(w)}return new yi(h,m)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let n,l;for(const h of this.args){if(n=h.evaluate(t),l=null,n instanceof hn)return n;if(typeof n=="string"){const m=t.parseColor(n);if(m)return m}else if(Array.isArray(n)&&(l=n.length<3||n.length>4?`Invalid rgba value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:oc(n[0],n[1],n[2],n[3]),!l))return new hn(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new Bn(l||`Could not parse color from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"padding":{let n;for(const l of this.args){n=l.evaluate(t);const h=Mi.parse(n);if(h)return h}throw new Bn(`Could not parse padding from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"numberArray":{let n;for(const l of this.args){n=l.evaluate(t);const h=Pi.parse(n);if(h)return h}throw new Bn(`Could not parse numberArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"colorArray":{let n;for(const l of this.args){n=l.evaluate(t);const h=Li.parse(n);if(h)return h}throw new Bn(`Could not parse colorArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"variableAnchorOffsetCollection":{let n;for(const l of this.args){n=l.evaluate(t);const h=Zi.parse(n);if(h)return h}throw new Bn(`Could not parse variableAnchorOffsetCollection from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"number":{let n=null;for(const l of this.args){if(n=l.evaluate(t),n===null)return 0;const h=Number(n);if(!isNaN(h))return h}throw new Bn(`Could not convert ${JSON.stringify(n)} to number.`)}case"formatted":return bi.fromString($a(this.args[0].evaluate(t)));case"resolvedImage":return wi.fromString($a(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return $a(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const cn=["Unknown","Point","LineString","Polygon"];class en{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?cn[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let n=this._parseColorCache.get(t);return n||(n=hn.parse(t),this._parseColorCache.set(t,n)),n}}class va{constructor(t,n,l=[],h,m=new Ai,y=[]){this.registry=t,this.path=l,this.key=l.map((w=>`[${w}]`)).join(""),this.scope=m,this.errors=y,this.expectedType=h,this._isConstant=n}parse(t,n,l,h,m={}){return n?this.concat(n,l,h)._parse(t,m):this._parse(t,m)}_parse(t,n){function l(h,m,y){return y==="assert"?new ur(m,[h]):y==="coerce"?new yi(m,[h]):h}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=t[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[h];if(m){let y=m.parse(t,this);if(!y)return null;if(this.expectedType){const w=this.expectedType,C=y.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||C.kind!=="value"){if(w.kind==="projectionDefinition"&&["string","array"].includes(C.kind)||["color","formatted","resolvedImage"].includes(w.kind)&&["value","string"].includes(C.kind)||["padding","numberArray"].includes(w.kind)&&["value","number","array"].includes(C.kind)||w.kind==="colorArray"&&["value","string","array"].includes(C.kind)||w.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(C.kind))y=l(y,w,n.typeAnnotation||"coerce");else if(this.checkSubtype(w,C))return null}else y=l(y,w,n.typeAnnotation||"assert")}if(!(y instanceof Ha)&&y.type.kind!=="resolvedImage"&&this._isConstant(y)){const w=new en;try{y=new Ha(y.type,y.evaluate(w))}catch(C){return this.error(C.message),null}}return y}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,n,l){const h=typeof t=="number"?this.path.concat(t):this.path,m=l?this.scope.concat(l):this.scope;return new va(this.registry,this._isConstant,h,n||null,m,this.errors)}error(t,...n){const l=`${this.key}${n.map((h=>`[${h}]`)).join("")}`;this.errors.push(new qn(l,t))}checkSubtype(t,n){const l=zr(t,n);return l&&this.error(l),l}}class gn{constructor(t,n){this.type=n.type,this.bindings=[].concat(t),this.result=n}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const n of this.bindings)t(n[1]);t(this.result)}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const l=[];for(let m=1;m<t.length-1;m+=2){const y=t[m];if(typeof y!="string")return n.error(`Expected string, but found ${typeof y} instead.`,m);if(/[^a-zA-Z0-9_]/.test(y))return n.error("Variable names must contain only alphanumeric characters or '_'.",m);const w=n.parse(t[m+1],m+1);if(!w)return null;l.push([y,w])}const h=n.parse(t[t.length-1],t.length-1,n.expectedType,l);return h?new gn(l,h):null}outputDefined(){return this.result.outputDefined()}}class Ao{constructor(t,n){this.type=n.type,this.name=t,this.boundExpression=n}static parse(t,n){if(t.length!==2||typeof t[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const l=t[1];return n.scope.has(l)?new Ao(l,n.scope.get(l)):n.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class us{constructor(t,n,l){this.type=t,this.index=n,this.input=l}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=n.parse(t[1],1,ce),h=n.parse(t[2],2,Xr(n.expectedType||Ye));return l&&h?new us(h.type.itemType,l,h):null}evaluate(t){const n=this.index.evaluate(t),l=this.input.evaluate(t);if(n<0)throw new Bn(`Array index out of bounds: ${n} < 0.`);if(n>=l.length)throw new Bn(`Array index out of bounds: ${n} > ${l.length-1}.`);if(n!==Math.floor(n))throw new Bn(`Array index must be an integer, but found ${n} instead.`);return l[n]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Xa{constructor(t,n){this.type=Ne,this.needle=t,this.haystack=n}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=n.parse(t[1],1,Ye),h=n.parse(t[2],2,Ye);return l&&h?nu(l.type,[Ne,Ce,ce,Cn,Ye])?new Xa(l,h):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Zn(l.type)} instead`):null}evaluate(t){const n=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!l)return!1;if(!si(n,["boolean","string","number","null"]))throw new Bn(`Expected first argument to be of type boolean, string, number or null, but found ${Zn($n(n))} instead.`);if(!si(l,["string","array"]))throw new Bn(`Expected second argument to be of type array or string, but found ${Zn($n(l))} instead.`);return l.indexOf(n)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class xa{constructor(t,n,l){this.type=ce,this.needle=t,this.haystack=n,this.fromIndex=l}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 2 or 3 arguments, but found ${t.length-1} instead.`);const l=n.parse(t[1],1,Ye),h=n.parse(t[2],2,Ye);if(!l||!h)return null;if(!nu(l.type,[Ne,Ce,ce,Cn,Ye]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Zn(l.type)} instead`);if(t.length===4){const m=n.parse(t[3],3,ce);return m?new xa(l,h,m):null}return new xa(l,h)}evaluate(t){const n=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!si(n,["boolean","string","number","null"]))throw new Bn(`Expected first argument to be of type boolean, string, number or null, but found ${Zn($n(n))} instead.`);let h;if(this.fromIndex&&(h=this.fromIndex.evaluate(t)),si(l,["string"])){const m=l.indexOf(n,h);return m===-1?-1:[...l.slice(0,m)].length}if(si(l,["array"]))return l.indexOf(n,h);throw new Bn(`Expected second argument to be of type array or string, but found ${Zn($n(l))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class ou{constructor(t,n,l,h,m,y){this.inputType=t,this.type=n,this.input=l,this.cases=h,this.outputs=m,this.otherwise=y}static parse(t,n){if(t.length<5)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return n.error("Expected an even number of arguments.");let l,h;n.expectedType&&n.expectedType.kind!=="value"&&(h=n.expectedType);const m={},y=[];for(let D=2;D<t.length-1;D+=2){let z=t[D];const N=t[D+1];Array.isArray(z)||(z=[z]);const V=n.concat(D);if(z.length===0)return V.error("Expected at least one branch label.");for(const G of z){if(typeof G!="number"&&typeof G!="string")return V.error("Branch labels must be numbers or strings.");if(typeof G=="number"&&Math.abs(G)>Number.MAX_SAFE_INTEGER)return V.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof G=="number"&&Math.floor(G)!==G)return V.error("Numeric branch labels must be integer values.");if(l){if(V.checkSubtype(l,$n(G)))return null}else l=$n(G);if(m[String(G)]!==void 0)return V.error("Branch labels must be unique.");m[String(G)]=y.length}const U=n.parse(N,D,h);if(!U)return null;h=h||U.type,y.push(U)}const w=n.parse(t[1],1,Ye);if(!w)return null;const C=n.parse(t[t.length-1],t.length-1,h);return C?w.type.kind!=="value"&&n.concat(1).checkSubtype(l,w.type)?null:new ou(l,h,w,m,y,C):null}evaluate(t){const n=this.input.evaluate(t);return($n(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}}class lu{constructor(t,n,l){this.type=t,this.branches=n,this.otherwise=l}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return n.error("Expected an odd number of arguments.");let l;n.expectedType&&n.expectedType.kind!=="value"&&(l=n.expectedType);const h=[];for(let y=1;y<t.length-1;y+=2){const w=n.parse(t[y],y,Ne);if(!w)return null;const C=n.parse(t[y+1],y+1,l);if(!C)return null;h.push([w,C]),l=l||C.type}const m=n.parse(t[t.length-1],t.length-1,l);if(!m)return null;if(!l)throw new Error("Can't infer output type");return new lu(l,h,m)}evaluate(t){for(const[n,l]of this.branches)if(n.evaluate(t))return l.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[n,l]of this.branches)t(n),t(l);t(this.otherwise)}outputDefined(){return this.branches.every((([t,n])=>n.outputDefined()))&&this.otherwise.outputDefined()}}class cu{constructor(t,n,l,h){this.type=t,this.input=n,this.beginIndex=l,this.endIndex=h}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 2 or 3 arguments, but found ${t.length-1} instead.`);const l=n.parse(t[1],1,Ye),h=n.parse(t[2],2,ce);if(!l||!h)return null;if(!nu(l.type,[Xr(Ye),Ce,Ye]))return n.error(`Expected first argument to be of type array or string, but found ${Zn(l.type)} instead`);if(t.length===4){const m=n.parse(t[3],3,ce);return m?new cu(l.type,l,h,m):null}return new cu(l.type,l,h)}evaluate(t){const n=this.input.evaluate(t),l=this.beginIndex.evaluate(t);let h;if(this.endIndex&&(h=this.endIndex.evaluate(t)),si(n,["string"]))return[...n].slice(l,h).join("");if(si(n,["array"]))return n.slice(l,h);throw new Bn(`Expected first argument to be of type array or string, but found ${Zn($n(n))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function hh(r,t){const n=r.length-1;let l,h,m=0,y=n,w=0;for(;m<=y;)if(w=Math.floor((m+y)/2),l=r[w],h=r[w+1],l<=t){if(w===n||t<h)return w;m=w+1}else{if(!(l>t))throw new Bn("Input is not a number.");y=w-1}return 0}class Mo{constructor(t,n,l){this.type=t,this.input=n,this.labels=[],this.outputs=[];for(const[h,m]of l)this.labels.push(h),this.outputs.push(m)}static parse(t,n){if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");const l=n.parse(t[1],1,ce);if(!l)return null;const h=[];let m=null;n.expectedType&&n.expectedType.kind!=="value"&&(m=n.expectedType);for(let y=1;y<t.length;y+=2){const w=y===1?-1/0:t[y],C=t[y+1],D=y,z=y+1;if(typeof w!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(h.length&&h[h.length-1][0]>=w)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',D);const N=n.parse(C,z,m);if(!N)return null;m=m||N.type,h.push([w,N])}return new Mo(m,l,h)}evaluate(t){const n=this.labels,l=this.outputs;if(n.length===1)return l[0].evaluate(t);const h=this.input.evaluate(t);if(h<=n[0])return l[0].evaluate(t);const m=n.length;return h>=n[m-1]?l[m-1].evaluate(t):l[hh(n,h)].evaluate(t)}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function qf(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var ba,hr,dh=(function(){if(hr)return ba;function r(t,n,l,h){this.cx=3*t,this.bx=3*(l-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(h-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=l,this.p2y=h}return hr=1,ba=r,r.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,n){if(n===void 0&&(n=1e-6),t<0)return 0;if(t>1)return 1;for(var l=t,h=0;h<8;h++){var m=this.sampleCurveX(l)-t;if(Math.abs(m)<n)return l;var y=this.sampleCurveDerivativeX(l);if(Math.abs(y)<1e-6)break;l-=m/y}var w=0,C=1;for(l=t,h=0;h<20&&(m=this.sampleCurveX(l),!(Math.abs(m-t)<n));h++)t>m?w=l:C=l,l=.5*(C-w)+w;return l},solve:function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))}},ba})(),Zf=qf(dh);class rr{constructor(t,n,l,h,m){this.type=t,this.operator=n,this.interpolation=l,this.input=h,this.labels=[],this.outputs=[];for(const[y,w]of m)this.labels.push(y),this.outputs.push(w)}static interpolationFactor(t,n,l,h){let m=0;if(t.name==="exponential")m=ki(n,t.base,l,h);else if(t.name==="linear")m=ki(n,1,l,h);else if(t.name==="cubic-bezier"){const y=t.controlPoints;m=new Zf(y[0],y[1],y[2],y[3]).solve(ki(n,1,l,h))}return m}static parse(t,n){let[l,h,m,...y]=t;if(!Array.isArray(h)||h.length===0)return n.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const D=h[1];if(typeof D!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:D}}else{if(h[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const D=h.slice(1);if(D.length!==4||D.some((z=>typeof z!="number"||z<0||z>1)))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:D}}}if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(m=n.parse(m,2,ce),!m)return null;const w=[];let C=null;l!=="interpolate-hcl"&&l!=="interpolate-lab"||n.expectedType==Tr?n.expectedType&&n.expectedType.kind!=="value"&&(C=n.expectedType):C=wr;for(let D=0;D<y.length;D+=2){const z=y[D],N=y[D+1],V=D+3,U=D+4;if(typeof z!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(w.length&&w[w.length-1][0]>=z)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',V);const G=n.parse(N,U,C);if(!G)return null;C=C||G.type,w.push([z,G])}return qa(C,ce)||qa(C,ll)||qa(C,wr)||qa(C,Gs)||qa(C,qs)||qa(C,Tr)||qa(C,gi)||qa(C,Xr(ce))?new rr(C,l,h,m,w):n.error(`Type ${Zn(C)} is not interpolatable.`)}evaluate(t){const n=this.labels,l=this.outputs;if(n.length===1)return l[0].evaluate(t);const h=this.input.evaluate(t);if(h<=n[0])return l[0].evaluate(t);const m=n.length;if(h>=n[m-1])return l[m-1].evaluate(t);const y=hh(n,h),w=rr.interpolationFactor(this.interpolation,h,n[y],n[y+1]),C=l[y].evaluate(t),D=l[y+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return ya(C,D,w);case"color":return hn.interpolate(C,D,w);case"padding":return Mi.interpolate(C,D,w);case"colorArray":return Li.interpolate(C,D,w);case"numberArray":return Pi.interpolate(C,D,w);case"variableAnchorOffsetCollection":return Zi.interpolate(C,D,w);case"array":return dl(C,D,w);case"projectionDefinition":return ir.interpolate(C,D,w)}case"interpolate-hcl":switch(this.type.kind){case"color":return hn.interpolate(C,D,w,"hcl");case"colorArray":return Li.interpolate(C,D,w,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return hn.interpolate(C,D,w,"lab");case"colorArray":return Li.interpolate(C,D,w,"lab")}}}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function ki(r,t,n,l){const h=l-n,m=r-n;return h===0?0:t===1?m/h:(Math.pow(t,m)-1)/(Math.pow(t,h)-1)}const $s={color:hn.interpolate,number:ya,padding:Mi.interpolate,numberArray:Pi.interpolate,colorArray:Li.interpolate,variableAnchorOffsetCollection:Zi.interpolate,array:dl};class lc{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let l=null;const h=n.expectedType;h&&h.kind!=="value"&&(l=h);const m=[];for(const w of t.slice(1)){const C=n.parse(w,1+m.length,l,void 0,{typeAnnotation:"omit"});if(!C)return null;l=l||C.type,m.push(C)}if(!l)throw new Error("No output type");const y=h&&m.some((w=>zr(h,w.type)));return new lc(y?Ye:l,m)}evaluate(t){let n,l=null,h=0;for(const m of this.args)if(h++,l=m.evaluate(t),l&&l instanceof wi&&!l.available&&(n||(n=l.name),l=null,h===this.args.length&&(l=n)),l!==null)break;return l}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}function Ed(r,t){return r==="=="||r==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function fh(r,t,n,l){return l.compare(t,n)===0}function Hs(r,t,n){const l=r!=="=="&&r!=="!=";return class HC{constructor(m,y,w){this.type=Ne,this.lhs=m,this.rhs=y,this.collator=w,this.hasUntypedArgument=m.type.kind==="value"||y.type.kind==="value"}static parse(m,y){if(m.length!==3&&m.length!==4)return y.error("Expected two or three arguments.");const w=m[0];let C=y.parse(m[1],1,Ye);if(!C)return null;if(!Ed(w,C.type))return y.concat(1).error(`"${w}" comparisons are not supported for type '${Zn(C.type)}'.`);let D=y.parse(m[2],2,Ye);if(!D)return null;if(!Ed(w,D.type))return y.concat(2).error(`"${w}" comparisons are not supported for type '${Zn(D.type)}'.`);if(C.type.kind!==D.type.kind&&C.type.kind!=="value"&&D.type.kind!=="value")return y.error(`Cannot compare types '${Zn(C.type)}' and '${Zn(D.type)}'.`);l&&(C.type.kind==="value"&&D.type.kind!=="value"?C=new ur(D.type,[C]):C.type.kind!=="value"&&D.type.kind==="value"&&(D=new ur(C.type,[D])));let z=null;if(m.length===4){if(C.type.kind!=="string"&&D.type.kind!=="string"&&C.type.kind!=="value"&&D.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(z=y.parse(m[3],3,ls),!z)return null}return new HC(C,D,z)}evaluate(m){const y=this.lhs.evaluate(m),w=this.rhs.evaluate(m);if(l&&this.hasUntypedArgument){const C=$n(y),D=$n(w);if(C.kind!==D.kind||C.kind!=="string"&&C.kind!=="number")throw new Bn(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${C.kind}, ${D.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const C=$n(y),D=$n(w);if(C.kind!=="string"||D.kind!=="string")return t(m,y,w)}return this.collator?n(m,y,w,this.collator.evaluate(m)):t(m,y,w)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const ph=Hs("==",(function(r,t,n){return t===n}),fh),Cd=Hs("!=",(function(r,t,n){return t!==n}),(function(r,t,n,l){return!fh(0,t,n,l)})),$f=Hs("<",(function(r,t,n){return t<n}),(function(r,t,n,l){return l.compare(t,n)<0})),Hf=Hs(">",(function(r,t,n){return t>n}),(function(r,t,n,l){return l.compare(t,n)>0})),mh=Hs("<=",(function(r,t,n){return t<=n}),(function(r,t,n,l){return l.compare(t,n)<=0})),gh=Hs(">=",(function(r,t,n){return t>=n}),(function(r,t,n,l){return l.compare(t,n)>=0}));class Kr{constructor(t,n,l){this.type=ls,this.locale=l,this.caseSensitive=t,this.diacriticSensitive=n}static parse(t,n){if(t.length!==2)return n.error("Expected one argument.");const l=t[1];if(typeof l!="object"||Array.isArray(l))return n.error("Collator options argument must be an object.");const h=n.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,Ne);if(!h)return null;const m=n.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,Ne);if(!m)return null;let y=null;return l.locale&&(y=n.parse(l.locale,1,Ce),!y)?null:new Kr(h,m,y)}evaluate(t){return new Lr(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class yh{constructor(t,n,l,h,m){this.type=Ce,this.number=t,this.locale=n,this.currency=l,this.minFractionDigits=h,this.maxFractionDigits=m}static parse(t,n){if(t.length!==3)return n.error("Expected two arguments.");const l=n.parse(t[1],1,ce);if(!l)return null;const h=t[2];if(typeof h!="object"||Array.isArray(h))return n.error("NumberFormat options argument must be an object.");let m=null;if(h.locale&&(m=n.parse(h.locale,1,Ce),!m))return null;let y=null;if(h.currency&&(y=n.parse(h.currency,1,Ce),!y))return null;let w=null;if(h["min-fraction-digits"]&&(w=n.parse(h["min-fraction-digits"],1,ce),!w))return null;let C=null;return h["max-fraction-digits"]&&(C=n.parse(h["max-fraction-digits"],1,ce),!C)?null:new yh(l,m,y,w,C)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class fl{constructor(t){this.type=Eo,this.sections=t}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const l=t[1];if(!Array.isArray(l)&&typeof l=="object")return n.error("First argument must be an image or text section.");const h=[];let m=!1;for(let y=1;y<=t.length-1;++y){const w=t[y];if(m&&typeof w=="object"&&!Array.isArray(w)){m=!1;let C=null;if(w["font-scale"]&&(C=n.parse(w["font-scale"],1,ce),!C))return null;let D=null;if(w["text-font"]&&(D=n.parse(w["text-font"],1,Xr(Ce)),!D))return null;let z=null;if(w["text-color"]&&(z=n.parse(w["text-color"],1,wr),!z))return null;let N=null;if(w["vertical-align"]){if(typeof w["vertical-align"]=="string"&&!rn.includes(w["vertical-align"]))return n.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${w["vertical-align"]}' instead.`);if(N=n.parse(w["vertical-align"],1,Ce),!N)return null}const V=h[h.length-1];V.scale=C,V.font=D,V.textColor=z,V.verticalAlign=N}else{const C=n.parse(t[y],1,Ye);if(!C)return null;const D=C.type.kind;if(D!=="string"&&D!=="value"&&D!=="null"&&D!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,h.push({content:C,scale:null,font:null,textColor:null,verticalAlign:null})}}return new fl(h)}evaluate(t){return new bi(this.sections.map((n=>{const l=n.content.evaluate(t);return $n(l)===Zs?new _a("",l,null,null,null,n.verticalAlign?n.verticalAlign.evaluate(t):null):new _a($a(l),null,n.scale?n.scale.evaluate(t):null,n.font?n.font.evaluate(t).join(","):null,n.textColor?n.textColor.evaluate(t):null,n.verticalAlign?n.verticalAlign.evaluate(t):null)})))}eachChild(t){for(const n of this.sections)t(n.content),n.scale&&t(n.scale),n.font&&t(n.font),n.textColor&&t(n.textColor),n.verticalAlign&&t(n.verticalAlign)}outputDefined(){return!1}}class Ad{constructor(t){this.type=Zs,this.input=t}static parse(t,n){if(t.length!==2)return n.error("Expected two arguments.");const l=n.parse(t[1],1,Ce);return l?new Ad(l):n.error("No image name provided.")}evaluate(t){const n=this.input.evaluate(t),l=wi.fromString(n);return l&&t.availableImages&&(l.available=t.availableImages.indexOf(n)>-1),l}eachChild(t){t(this.input)}outputDefined(){return!1}}class uu{constructor(t){this.type=ce,this.input=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=n.parse(t[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${Zn(l.type)} instead.`):new uu(l):null}evaluate(t){const n=this.input.evaluate(t);if(typeof n=="string")return[...n].length;if(Array.isArray(n))return n.length;throw new Bn(`Expected value to be of type string or array, but found ${Zn($n(n))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const wa=8192;function Md(r,t){const n=(180+r[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(n*h*wa),Math.round(l*h*wa)]}function pl(r,t){const n=Math.pow(2,t.z);return[(h=(r[0]/wa+t.x)/n,360*h-180),(l=(r[1]/wa+t.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,h}function hu(r,t){r[0]=Math.min(r[0],t[0]),r[1]=Math.min(r[1],t[1]),r[2]=Math.max(r[2],t[0]),r[3]=Math.max(r[3],t[1])}function Ya(r,t){return!(r[0]<=t[0]||r[2]>=t[2]||r[1]<=t[1]||r[3]>=t[3])}function Xf(r,t,n){const l=r[0]-t[0],h=r[1]-t[1],m=r[0]-n[0],y=r[1]-n[1];return l*y-m*h==0&&l*m<=0&&h*y<=0}function cc(r,t,n,l){return(h=[l[0]-n[0],l[1]-n[1]])[0]*(m=[t[0]-r[0],t[1]-r[1]])[1]-h[1]*m[0]!=0&&!(!Wf(r,t,n,l)||!Wf(n,l,r,t));var h,m}function Pd(r,t,n){for(const l of n)for(let h=0;h<l.length-1;++h)if(cc(r,t,l[h],l[h+1]))return!0;return!1}function ml(r,t,n=!1){let l=!1;for(const w of t)for(let C=0;C<w.length-1;C++){if(Xf(r,w[C],w[C+1]))return n;(m=w[C])[1]>(h=r)[1]!=(y=w[C+1])[1]>h[1]&&h[0]<(y[0]-m[0])*(h[1]-m[1])/(y[1]-m[1])+m[0]&&(l=!l)}var h,m,y;return l}function gl(r,t){for(const n of t)if(ml(r,n))return!0;return!1}function Yf(r,t){for(const n of r)if(!ml(n,t))return!1;for(let n=0;n<r.length-1;++n)if(Pd(r[n],r[n+1],t))return!1;return!0}function Sm(r,t){for(const n of t)if(Yf(r,n))return!0;return!1}function Wf(r,t,n,l){const h=l[0]-n[0],m=l[1]-n[1],y=(r[0]-n[0])*m-h*(r[1]-n[1]),w=(t[0]-n[0])*m-h*(t[1]-n[1]);return y>0&&w<0||y<0&&w>0}function _h(r,t,n){const l=[];for(let h=0;h<r.length;h++){const m=[];for(let y=0;y<r[h].length;y++){const w=Md(r[h][y],n);hu(t,w),m.push(w)}l.push(m)}return l}function Dd(r,t,n){const l=[];for(let h=0;h<r.length;h++){const m=_h(r[h],t,n);l.push(m)}return l}function yl(r,t,n,l){if(r[0]<n[0]||r[0]>n[2]){const h=.5*l;let m=r[0]-n[0]>h?-l:n[0]-r[0]>h?l:0;m===0&&(m=r[0]-n[2]>h?-l:n[2]-r[0]>h?l:0),r[0]+=m}hu(t,r)}function _l(r,t,n,l){const h=Math.pow(2,l.z)*wa,m=[l.x*wa,l.y*wa],y=[];for(const w of r)for(const C of w){const D=[C.x+m[0],C.y+m[1]];yl(D,t,n,h),y.push(D)}return y}function Rd(r,t,n,l){const h=Math.pow(2,l.z)*wa,m=[l.x*wa,l.y*wa],y=[];for(const C of r){const D=[];for(const z of C){const N=[z.x+m[0],z.y+m[1]];hu(t,N),D.push(N)}y.push(D)}if(t[2]-t[0]<=h/2){(w=t)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const C of y)for(const D of C)yl(D,t,n,h)}var w;return y}class Ta{constructor(t,n){this.type=Ne,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(kr(t[1])){const l=t[1];if(l.type==="FeatureCollection"){const h=[];for(const m of l.features){const{type:y,coordinates:w}=m.geometry;y==="Polygon"&&h.push(w),y==="MultiPolygon"&&h.push(...w)}if(h.length)return new Ta(l,{type:"MultiPolygon",coordinates:h})}else if(l.type==="Feature"){const h=l.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Ta(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new Ta(l,l)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return(function(n,l){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=n.canonicalID();if(l.type==="Polygon"){const w=_h(l.coordinates,m,y),C=_l(n.geometry(),h,m,y);if(!Ya(h,m))return!1;for(const D of C)if(!ml(D,w))return!1}if(l.type==="MultiPolygon"){const w=Dd(l.coordinates,m,y),C=_l(n.geometry(),h,m,y);if(!Ya(h,m))return!1;for(const D of C)if(!gl(D,w))return!1}return!0})(t,this.geometries);if(t.geometryType()==="LineString")return(function(n,l){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=n.canonicalID();if(l.type==="Polygon"){const w=_h(l.coordinates,m,y),C=Rd(n.geometry(),h,m,y);if(!Ya(h,m))return!1;for(const D of C)if(!Yf(D,w))return!1}if(l.type==="MultiPolygon"){const w=Dd(l.coordinates,m,y),C=Rd(n.geometry(),h,m,y);if(!Ya(h,m))return!1;for(const D of C)if(!Sm(D,w))return!1}return!0})(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Id=class{constructor(r=[],t=(n,l)=>n<l?-1:n>l?1:0){if(this.data=r,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:t,compare:n}=this,l=t[r];for(;r>0;){const h=r-1>>1,m=t[h];if(n(l,m)>=0)break;t[r]=m,r=h}t[r]=l}_down(r){const{data:t,compare:n}=this,l=this.length>>1,h=t[r];for(;r<l;){let m=1+(r<<1);const y=m+1;if(y<this.length&&n(t[y],t[m])<0&&(m=y),n(t[m],h)>=0)break;t[r]=t[m],r=m}t[r]=h}};function zd(r,t,n=0,l=r.length-1,h=uc){for(;l>n;){if(l-n>600){const C=l-n+1,D=t-n+1,z=Math.log(C),N=.5*Math.exp(2*z/3),V=.5*Math.sqrt(z*N*(C-N)/C)*(D-C/2<0?-1:1);zd(r,t,Math.max(n,Math.floor(t-D*N/C+V)),Math.min(l,Math.floor(t+(C-D)*N/C+V)),h)}const m=r[t];let y=n,w=l;for(vl(r,n,t),h(r[l],m)>0&&vl(r,n,l);y<w;){for(vl(r,y,w),y++,w--;h(r[y],m)<0;)y++;for(;h(r[w],m)>0;)w--}h(r[n],m)===0?vl(r,n,w):(w++,vl(r,w,l)),w<=t&&(n=w+1),t<=w&&(l=w-1)}}function vl(r,t,n){const l=r[t];r[t]=r[n],r[n]=l}function uc(r,t){return r<t?-1:r>t?1:0}function hc(r,t){if(r.length<=1)return[r];const n=[];let l,h;for(const m of r){const y=Qf(m);y!==0&&(m.area=Math.abs(y),h===void 0&&(h=y<0),h===y<0?(l&&n.push(l),l=[m]):l.push(m))}if(l&&n.push(l),t>1)for(let m=0;m<n.length;m++)n[m].length<=t||(zd(n[m],t,1,n[m].length-1,Kf),n[m]=n[m].slice(0,t));return n}function Kf(r,t){return t.area-r.area}function Qf(r){let t=0;for(let n,l,h=0,m=r.length,y=m-1;h<m;y=h++)n=r[h],l=r[y],t+=(l.x-n.x)*(n.y+l.y);return t}const Jf=1/298.257223563,vh=Jf*(2-Jf),Ld=Math.PI/180;class kd{constructor(t){const n=6378.137*Ld*1e3,l=Math.cos(t*Ld),h=1/(1-vh*(1-l*l)),m=Math.sqrt(h);this.kx=n*m*l,this.ky=n*m*h*(1-vh)}distance(t,n){const l=this.wrap(t[0]-n[0])*this.kx,h=(t[1]-n[1])*this.ky;return Math.sqrt(l*l+h*h)}pointOnLine(t,n){let l,h,m,y,w=1/0;for(let C=0;C<t.length-1;C++){let D=t[C][0],z=t[C][1],N=this.wrap(t[C+1][0]-D)*this.kx,V=(t[C+1][1]-z)*this.ky,U=0;N===0&&V===0||(U=(this.wrap(n[0]-D)*this.kx*N+(n[1]-z)*this.ky*V)/(N*N+V*V),U>1?(D=t[C+1][0],z=t[C+1][1]):U>0&&(D+=N/this.kx*U,z+=V/this.ky*U)),N=this.wrap(n[0]-D)*this.kx,V=(n[1]-z)*this.ky;const G=N*N+V*V;G<w&&(w=G,l=D,h=z,m=C,y=U)}return{point:[l,h],index:m,t:Math.max(0,Math.min(1,y))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function tp(r,t){return t[0]-r[0]}function dr(r){return r[1]-r[0]+1}function Qr(r,t){return r[1]>=r[0]&&r[1]<t}function xh(r,t){if(r[0]>r[1])return[null,null];const n=dr(r);if(t){if(n===2)return[r,null];const h=Math.floor(n/2);return[[r[0],r[0]+h],[r[0]+h,r[1]]]}if(n===1)return[r,null];const l=Math.floor(n/2)-1;return[[r[0],r[0]+l],[r[0]+l+1,r[1]]]}function bh(r,t){if(!Qr(t,r.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let l=t[0];l<=t[1];++l)hu(n,r[l]);return n}function wh(r){const t=[1/0,1/0,-1/0,-1/0];for(const n of r)for(const l of n)hu(t,l);return t}function Th(r){return r[0]!==-1/0&&r[1]!==-1/0&&r[2]!==1/0&&r[3]!==1/0}function du(r,t,n){if(!Th(r)||!Th(t))return NaN;let l=0,h=0;return r[2]<t[0]&&(l=t[0]-r[2]),r[0]>t[2]&&(l=r[0]-t[2]),r[1]>t[3]&&(h=r[1]-t[3]),r[3]<t[1]&&(h=t[1]-r[3]),n.distance([0,0],[l,h])}function xl(r,t,n){const l=n.pointOnLine(t,r);return n.distance(r,l.point)}function Po(r,t,n,l,h){const m=Math.min(xl(r,[n,l],h),xl(t,[n,l],h)),y=Math.min(xl(n,[r,t],h),xl(l,[r,t],h));return Math.min(m,y)}function Od(r,t,n,l,h){if(!Qr(t,r.length)||!Qr(l,n.length))return 1/0;let m=1/0;for(let y=t[0];y<t[1];++y){const w=r[y],C=r[y+1];for(let D=l[0];D<l[1];++D){const z=n[D],N=n[D+1];if(cc(w,C,z,N))return 0;m=Math.min(m,Po(w,C,z,N,h))}}return m}function _n(r,t,n,l,h){if(!Qr(t,r.length)||!Qr(l,n.length))return NaN;let m=1/0;for(let y=t[0];y<=t[1];++y)for(let w=l[0];w<=l[1];++w)if(m=Math.min(m,h.distance(r[y],n[w])),m===0)return m;return m}function Nd(r,t,n){if(ml(r,t,!0))return 0;let l=1/0;for(const h of t){const m=h[0],y=h[h.length-1];if(m!==y&&(l=Math.min(l,xl(r,[y,m],n)),l===0))return l;const w=n.pointOnLine(h,r);if(l=Math.min(l,n.distance(r,w.point)),l===0)return l}return l}function ep(r,t,n,l){if(!Qr(t,r.length))return NaN;for(let m=t[0];m<=t[1];++m)if(ml(r[m],n,!0))return 0;let h=1/0;for(let m=t[0];m<t[1];++m){const y=r[m],w=r[m+1];for(const C of n)for(let D=0,z=C.length,N=z-1;D<z;N=D++){const V=C[N],U=C[D];if(cc(y,w,V,U))return 0;h=Math.min(h,Po(y,w,V,U,l))}}return h}function Do(r,t){for(const n of r)for(const l of n)if(ml(l,t,!0))return!0;return!1}function dc(r,t,n,l=1/0){const h=wh(r),m=wh(t);if(l!==1/0&&du(h,m,n)>=l)return l;if(Ya(h,m)){if(Do(r,t))return 0}else if(Do(t,r))return 0;let y=1/0;for(const w of r)for(let C=0,D=w.length,z=D-1;C<D;z=C++){const N=w[z],V=w[C];for(const U of t)for(let G=0,Y=U.length,tt=Y-1;G<Y;tt=G++){const at=U[tt],yt=U[G];if(cc(N,V,at,yt))return 0;y=Math.min(y,Po(N,V,at,yt,n))}}return y}function Sh(r,t,n,l,h,m){if(!m)return;const y=du(bh(l,m),h,n);y<t&&r.push([y,m,[0,0]])}function fu(r,t,n,l,h,m,y){if(!m||!y)return;const w=du(bh(l,m),bh(h,y),n);w<t&&r.push([w,m,y])}function Sa(r,t,n,l,h=1/0){let m=Math.min(l.distance(r[0],n[0][0]),h);if(m===0)return m;const y=new Id([[0,[0,r.length-1],[0,0]]],tp),w=wh(n);for(;y.length>0;){const C=y.pop();if(C[0]>=m)continue;const D=C[1],z=t?50:100;if(dr(D)<=z){if(!Qr(D,r.length))return NaN;if(t){const N=ep(r,D,n,l);if(isNaN(N)||N===0)return N;m=Math.min(m,N)}else for(let N=D[0];N<=D[1];++N){const V=Nd(r[N],n,l);if(m=Math.min(m,V),m===0)return 0}}else{const N=xh(D,t);Sh(y,m,l,r,w,N[0]),Sh(y,m,l,r,w,N[1])}}return m}function pu(r,t,n,l,h,m=1/0){let y=Math.min(m,h.distance(r[0],n[0]));if(y===0)return y;const w=new Id([[0,[0,r.length-1],[0,n.length-1]]],tp);for(;w.length>0;){const C=w.pop();if(C[0]>=y)continue;const D=C[1],z=C[2],N=t?50:100,V=l?50:100;if(dr(D)<=N&&dr(z)<=V){if(!Qr(D,r.length)&&Qr(z,n.length))return NaN;let U;if(t&&l)U=Od(r,D,n,z,h),y=Math.min(y,U);else if(t&&!l){const G=r.slice(D[0],D[1]+1);for(let Y=z[0];Y<=z[1];++Y)if(U=xl(n[Y],G,h),y=Math.min(y,U),y===0)return y}else if(!t&&l){const G=n.slice(z[0],z[1]+1);for(let Y=D[0];Y<=D[1];++Y)if(U=xl(r[Y],G,h),y=Math.min(y,U),y===0)return y}else U=_n(r,D,n,z,h),y=Math.min(y,U)}else{const U=xh(D,t),G=xh(z,l);fu(w,y,h,r,n,U[0],G[0]),fu(w,y,h,r,n,U[0],G[1]),fu(w,y,h,r,n,U[1],G[0]),fu(w,y,h,r,n,U[1],G[1])}}return y}function Eh(r){return r.type==="MultiPolygon"?r.coordinates.map((t=>({type:"Polygon",coordinates:t}))):r.type==="MultiLineString"?r.coordinates.map((t=>({type:"LineString",coordinates:t}))):r.type==="MultiPoint"?r.coordinates.map((t=>({type:"Point",coordinates:t}))):[r]}class Ro{constructor(t,n){this.type=ce,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(kr(t[1])){const l=t[1];if(l.type==="FeatureCollection")return new Ro(l,l.features.map((h=>Eh(h.geometry))).flat());if(l.type==="Feature")return new Ro(l,Eh(l.geometry));if("type"in l&&"coordinates"in l)return new Ro(l,Eh(l))}return n.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return(function(n,l){const h=n.geometry(),m=h.flat().map((C=>pl([C.x,C.y],n.canonical)));if(h.length===0)return NaN;const y=new kd(m[0][1]);let w=1/0;for(const C of l){switch(C.type){case"Point":w=Math.min(w,pu(m,!1,[C.coordinates],!1,y,w));break;case"LineString":w=Math.min(w,pu(m,!1,C.coordinates,!0,y,w));break;case"Polygon":w=Math.min(w,Sa(m,!1,C.coordinates,y,w))}if(w===0)return w}return w})(t,this.geometries);if(t.geometryType()==="LineString")return(function(n,l){const h=n.geometry(),m=h.flat().map((C=>pl([C.x,C.y],n.canonical)));if(h.length===0)return NaN;const y=new kd(m[0][1]);let w=1/0;for(const C of l){switch(C.type){case"Point":w=Math.min(w,pu(m,!0,[C.coordinates],!1,y,w));break;case"LineString":w=Math.min(w,pu(m,!0,C.coordinates,!0,y,w));break;case"Polygon":w=Math.min(w,Sa(m,!0,C.coordinates,y,w))}if(w===0)return w}return w})(t,this.geometries);if(t.geometryType()==="Polygon")return(function(n,l){const h=n.geometry();if(h.length===0||h[0].length===0)return NaN;const m=hc(h,0).map((C=>C.map((D=>D.map((z=>pl([z.x,z.y],n.canonical))))))),y=new kd(m[0][0][0][1]);let w=1/0;for(const C of l)for(const D of m){switch(C.type){case"Point":w=Math.min(w,Sa([C.coordinates],!1,D,y,w));break;case"LineString":w=Math.min(w,Sa(C.coordinates,!0,D,y,w));break;case"Polygon":w=Math.min(w,dc(D,C.coordinates,y,w))}if(w===0)return w}return w})(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class mu{constructor(t){this.type=Ye,this.key=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=t[1];return l==null?n.error("Global state property must be defined."):typeof l!="string"?n.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new mu(l)}evaluate(t){var n;const l=(n=t.globals)===null||n===void 0?void 0:n.globalState;return l&&Object.keys(l).length!==0?ma(l,this.key):null}eachChild(){}outputDefined(){return!1}}const fc={"==":ph,"!=":Cd,">":Hf,"<":$f,">=":gh,"<=":mh,array:ur,at:us,boolean:ur,case:lu,coalesce:lc,collator:Kr,format:fl,image:Ad,in:Xa,"index-of":xa,interpolate:rr,"interpolate-hcl":rr,"interpolate-lab":rr,length:uu,let:gn,literal:Ha,match:ou,number:ur,"number-format":yh,object:ur,slice:cu,step:Mo,string:ur,"to-boolean":yi,"to-color":yi,"to-number":yi,"to-string":yi,var:Ao,within:Ta,distance:Ro,"global-state":mu};class Es{constructor(t,n,l,h){this.name=t,this.type=n,this._evaluate=l,this.args=h}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,n){const l=t[0],h=Es.definitions[l];if(!h)return n.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(h)?h[0]:h.type,y=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,w=y.filter((([D])=>!Array.isArray(D)||D.length===t.length-1));let C=null;for(const[D,z]of w){C=new va(n.registry,bl,n.path,null,n.scope);const N=[];let V=!1;for(let U=1;U<t.length;U++){const G=t[U],Y=Array.isArray(D)?D[U-1]:D.type,tt=C.parse(G,1+N.length,Y);if(!tt){V=!0;break}N.push(tt)}if(!V)if(Array.isArray(D)&&D.length!==N.length)C.error(`Expected ${D.length} arguments, but found ${N.length} instead.`);else{for(let U=0;U<N.length;U++){const G=Array.isArray(D)?D[U]:D.type,Y=N[U];C.concat(U+1).checkSubtype(G,Y.type)}if(C.errors.length===0)return new Es(l,m,z,N)}}if(w.length===1)n.errors.push(...C.errors);else{const D=(w.length?w:y).map((([N])=>{return V=N,Array.isArray(V)?`(${V.map(Zn).join(", ")})`:`(${Zn(V.type)}...)`;var V})).join(" | "),z=[];for(let N=1;N<t.length;N++){const V=n.parse(t[N],1+z.length);if(!V)return null;z.push(Zn(V.type))}n.error(`Expected arguments of type ${D}, but found (${z.join(", ")}) instead.`)}return null}static register(t,n){Es.definitions=n;for(const l in n)t[l]=Es}}function Fd(r,[t,n,l,h]){t=t.evaluate(r),n=n.evaluate(r),l=l.evaluate(r);const m=h?h.evaluate(r):1,y=oc(t,n,l,m);if(y)throw new Bn(y);return new hn(t/255,n/255,l/255,m,!1)}function jd(r,t){return r in t}function gu(r,t){const n=t[r];return n===void 0?null:n}function fr(r){return{type:r}}function bl(r){if(r instanceof Ao)return bl(r.boundExpression);if(r instanceof Es&&r.name==="error"||r instanceof Kr||r instanceof Ta||r instanceof Ro||r instanceof mu)return!1;const t=r instanceof yi||r instanceof ur;let n=!0;return r.eachChild((l=>{n=t?n&&bl(l):n&&l instanceof Ha})),!!n&&Or(r)&&pc(r,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Or(r){if(r instanceof Es&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof Ta||r instanceof Ro)return!1;let t=!0;return r.eachChild((n=>{t&&!Or(n)&&(t=!1)})),t}function Ea(r){if(r instanceof Es&&r.name==="feature-state")return!1;let t=!0;return r.eachChild((n=>{t&&!Ea(n)&&(t=!1)})),t}function pc(r,t){if(r instanceof Es&&t.indexOf(r.name)>=0)return!1;let n=!0;return r.eachChild((l=>{n&&!pc(l,t)&&(n=!1)})),n}function yu(r){return{result:"success",value:r}}function Wa(r){return{result:"error",value:r}}function Io(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function zo(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function Ch(r){return!!r.expression&&r.expression.interpolated}function an(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function Ka(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&$n(r)===nr}function Em(r){return r}function Jr(r,t){const n=r.stops&&typeof r.stops[0][0]=="object",l=n||!(n||r.property!==void 0),h=r.type||(Ch(t)?"exponential":"interval"),m=(function(z){switch(z.type){case"color":return hn.parse;case"padding":return Mi.parse;case"numberArray":return Pi.parse;case"colorArray":return Li.parse;default:return null}})(t);if(m&&((r=Gn({},r)).stops&&(r.stops=r.stops.map((z=>[z[0],m(z[1])]))),r.default=m(r.default?r.default:t.default)),r.colorSpace&&(y=r.colorSpace)!=="rgb"&&y!=="hcl"&&y!=="lab")throw new Error(`Unknown color space: "${r.colorSpace}"`);var y;const w=(function(z){switch(z){case"exponential":return _u;case"interval":return np;case"categorical":return Xs;case"identity":return Tl;default:throw new Error(`Unknown function type "${z}"`)}})(h);let C,D;if(h==="categorical"){C=Object.create(null);for(const z of r.stops)C[z[0]]=z[1];D=typeof r.stops[0][0]}if(n){const z={},N=[];for(let G=0;G<r.stops.length;G++){const Y=r.stops[G],tt=Y[0].zoom;z[tt]===void 0&&(z[tt]={zoom:tt,type:r.type,property:r.property,default:r.default,stops:[]},N.push(tt)),z[tt].stops.push([Y[0].value,Y[1]])}const V=[];for(const G of N)V.push([z[G].zoom,Jr(z[G],t)]);const U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:rr.interpolationFactor.bind(void 0,U),zoomStops:V.map((G=>G[0])),evaluate:({zoom:G},Y)=>_u({stops:V,base:r.base},t,G).evaluate(G,Y)}}if(l){const z=h==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:z,interpolationFactor:rr.interpolationFactor.bind(void 0,z),zoomStops:r.stops.map((N=>N[0])),evaluate:({zoom:N})=>w(r,t,N,C,D)}}return{kind:"source",evaluate(z,N){const V=N&&N.properties?N.properties[r.property]:void 0;return V===void 0?wl(r.default,t.default):w(r,t,V,C,D)}}}function wl(r,t,n){return r!==void 0?r:t!==void 0?t:n!==void 0?n:void 0}function Xs(r,t,n,l,h){return wl(typeof n===h?l[n]:void 0,r.default,t.default)}function np(r,t,n){if(an(n)!=="number")return wl(r.default,t.default);const l=r.stops.length;if(l===1||n<=r.stops[0][0])return r.stops[0][1];if(n>=r.stops[l-1][0])return r.stops[l-1][1];const h=hh(r.stops.map((m=>m[0])),n);return r.stops[h][1]}function _u(r,t,n){const l=r.base!==void 0?r.base:1;if(an(n)!=="number")return wl(r.default,t.default);const h=r.stops.length;if(h===1||n<=r.stops[0][0])return r.stops[0][1];if(n>=r.stops[h-1][0])return r.stops[h-1][1];const m=hh(r.stops.map((z=>z[0])),n),y=(function(z,N,V,U){const G=U-V,Y=z-V;return G===0?0:N===1?Y/G:(Math.pow(N,Y)-1)/(Math.pow(N,G)-1)})(n,l,r.stops[m][0],r.stops[m+1][0]),w=r.stops[m][1],C=r.stops[m+1][1],D=$s[t.type]||Em;return typeof w.evaluate=="function"?{evaluate(...z){const N=w.evaluate.apply(void 0,z),V=C.evaluate.apply(void 0,z);if(N!==void 0&&V!==void 0)return D(N,V,y,r.colorSpace)}}:D(w,C,y,r.colorSpace)}function Tl(r,t,n){switch(t.type){case"color":n=hn.parse(n);break;case"formatted":n=bi.fromString(n.toString());break;case"resolvedImage":n=wi.fromString(n.toString());break;case"padding":n=Mi.parse(n);break;case"colorArray":n=Li.parse(n);break;case"numberArray":n=Pi.parse(n);break;default:an(n)===t.type||t.type==="enum"&&t.values[n]||(n=void 0)}return wl(n,r.default,t.default)}Es.register(fc,{error:[{kind:"error"},[Ce],(r,[t])=>{throw new Bn(t.evaluate(r))}],typeof:[Ce,[Ye],(r,[t])=>Zn($n(t.evaluate(r)))],"to-rgba":[Xr(ce,4),[wr],(r,[t])=>{const[n,l,h,m]=t.evaluate(r).rgb;return[255*n,255*l,255*h,m]}],rgb:[wr,[ce,ce,ce],Fd],rgba:[wr,[ce,ce,ce,ce],Fd],has:{type:Ne,overloads:[[[Ce],(r,[t])=>jd(t.evaluate(r),r.properties())],[[Ce,nr],(r,[t,n])=>jd(t.evaluate(r),n.evaluate(r))]]},get:{type:Ye,overloads:[[[Ce],(r,[t])=>gu(t.evaluate(r),r.properties())],[[Ce,nr],(r,[t,n])=>gu(t.evaluate(r),n.evaluate(r))]]},"feature-state":[Ye,[Ce],(r,[t])=>gu(t.evaluate(r),r.featureState||{})],properties:[nr,[],r=>r.properties()],"geometry-type":[Ce,[],r=>r.geometryType()],id:[Ye,[],r=>r.id()],zoom:[ce,[],r=>r.globals.zoom],"heatmap-density":[ce,[],r=>r.globals.heatmapDensity||0],elevation:[ce,[],r=>r.globals.elevation||0],"line-progress":[ce,[],r=>r.globals.lineProgress||0],accumulated:[Ye,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[ce,fr(ce),(r,t)=>{let n=0;for(const l of t)n+=l.evaluate(r);return n}],"*":[ce,fr(ce),(r,t)=>{let n=1;for(const l of t)n*=l.evaluate(r);return n}],"-":{type:ce,overloads:[[[ce,ce],(r,[t,n])=>t.evaluate(r)-n.evaluate(r)],[[ce],(r,[t])=>-t.evaluate(r)]]},"/":[ce,[ce,ce],(r,[t,n])=>t.evaluate(r)/n.evaluate(r)],"%":[ce,[ce,ce],(r,[t,n])=>t.evaluate(r)%n.evaluate(r)],ln2:[ce,[],()=>Math.LN2],pi:[ce,[],()=>Math.PI],e:[ce,[],()=>Math.E],"^":[ce,[ce,ce],(r,[t,n])=>Math.pow(t.evaluate(r),n.evaluate(r))],sqrt:[ce,[ce],(r,[t])=>Math.sqrt(t.evaluate(r))],log10:[ce,[ce],(r,[t])=>Math.log(t.evaluate(r))/Math.LN10],ln:[ce,[ce],(r,[t])=>Math.log(t.evaluate(r))],log2:[ce,[ce],(r,[t])=>Math.log(t.evaluate(r))/Math.LN2],sin:[ce,[ce],(r,[t])=>Math.sin(t.evaluate(r))],cos:[ce,[ce],(r,[t])=>Math.cos(t.evaluate(r))],tan:[ce,[ce],(r,[t])=>Math.tan(t.evaluate(r))],asin:[ce,[ce],(r,[t])=>Math.asin(t.evaluate(r))],acos:[ce,[ce],(r,[t])=>Math.acos(t.evaluate(r))],atan:[ce,[ce],(r,[t])=>Math.atan(t.evaluate(r))],min:[ce,fr(ce),(r,t)=>Math.min(...t.map((n=>n.evaluate(r))))],max:[ce,fr(ce),(r,t)=>Math.max(...t.map((n=>n.evaluate(r))))],abs:[ce,[ce],(r,[t])=>Math.abs(t.evaluate(r))],round:[ce,[ce],(r,[t])=>{const n=t.evaluate(r);return n<0?-Math.round(-n):Math.round(n)}],floor:[ce,[ce],(r,[t])=>Math.floor(t.evaluate(r))],ceil:[ce,[ce],(r,[t])=>Math.ceil(t.evaluate(r))],"filter-==":[Ne,[Ce,Ye],(r,[t,n])=>r.properties()[t.value]===n.value],"filter-id-==":[Ne,[Ye],(r,[t])=>r.id()===t.value],"filter-type-==":[Ne,[Ce],(r,[t])=>r.geometryType()===t.value],"filter-<":[Ne,[Ce,Ye],(r,[t,n])=>{const l=r.properties()[t.value],h=n.value;return typeof l==typeof h&&l<h}],"filter-id-<":[Ne,[Ye],(r,[t])=>{const n=r.id(),l=t.value;return typeof n==typeof l&&n<l}],"filter->":[Ne,[Ce,Ye],(r,[t,n])=>{const l=r.properties()[t.value],h=n.value;return typeof l==typeof h&&l>h}],"filter-id->":[Ne,[Ye],(r,[t])=>{const n=r.id(),l=t.value;return typeof n==typeof l&&n>l}],"filter-<=":[Ne,[Ce,Ye],(r,[t,n])=>{const l=r.properties()[t.value],h=n.value;return typeof l==typeof h&&l<=h}],"filter-id-<=":[Ne,[Ye],(r,[t])=>{const n=r.id(),l=t.value;return typeof n==typeof l&&n<=l}],"filter->=":[Ne,[Ce,Ye],(r,[t,n])=>{const l=r.properties()[t.value],h=n.value;return typeof l==typeof h&&l>=h}],"filter-id->=":[Ne,[Ye],(r,[t])=>{const n=r.id(),l=t.value;return typeof n==typeof l&&n>=l}],"filter-has":[Ne,[Ye],(r,[t])=>t.value in r.properties()],"filter-has-id":[Ne,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[Ne,[Xr(Ce)],(r,[t])=>t.value.indexOf(r.geometryType())>=0],"filter-id-in":[Ne,[Xr(Ye)],(r,[t])=>t.value.indexOf(r.id())>=0],"filter-in-small":[Ne,[Ce,Xr(Ye)],(r,[t,n])=>n.value.indexOf(r.properties()[t.value])>=0],"filter-in-large":[Ne,[Ce,Xr(Ye)],(r,[t,n])=>(function(l,h,m,y){for(;m<=y;){const w=m+y>>1;if(h[w]===l)return!0;h[w]>l?y=w-1:m=w+1}return!1})(r.properties()[t.value],n.value,0,n.value.length-1)],all:{type:Ne,overloads:[[[Ne,Ne],(r,[t,n])=>t.evaluate(r)&&n.evaluate(r)],[fr(Ne),(r,t)=>{for(const n of t)if(!n.evaluate(r))return!1;return!0}]]},any:{type:Ne,overloads:[[[Ne,Ne],(r,[t,n])=>t.evaluate(r)||n.evaluate(r)],[fr(Ne),(r,t)=>{for(const n of t)if(n.evaluate(r))return!0;return!1}]]},"!":[Ne,[Ne],(r,[t])=>!t.evaluate(r)],"is-supported-script":[Ne,[Ce],(r,[t])=>{const n=r.globals&&r.globals.isSupportedScript;return!n||n(t.evaluate(r))}],upcase:[Ce,[Ce],(r,[t])=>t.evaluate(r).toUpperCase()],downcase:[Ce,[Ce],(r,[t])=>t.evaluate(r).toLowerCase()],concat:[Ce,fr(Ye),(r,t)=>t.map((n=>$a(n.evaluate(r)))).join("")],"resolved-locale":[Ce,[ls],(r,[t])=>t.evaluate(r).resolvedLocale()]});class mc{constructor(t,n,l){this.expression=t,this._warningHistory={},this._evaluator=new en,this._defaultValue=n?(function(h){if(h.type==="color"&&Ka(h.default))return new hn(0,0,0,0);switch(h.type){case"color":return hn.parse(h.default)||null;case"padding":return Mi.parse(h.default)||null;case"numberArray":return Pi.parse(h.default)||null;case"colorArray":return Li.parse(h.default)||null;case"variableAnchorOffsetCollection":return Zi.parse(h.default)||null;case"projectionDefinition":return ir.parse(h.default)||null;default:return h.default===void 0?null:h.default}})(n):null,this._enumValues=n&&n.type==="enum"?n.values:null,this._globalState=l}evaluateWithoutErrorHandling(t,n,l,h,m,y){return this._globalState&&(t=pr(t,this._globalState)),this._evaluator.globals=t,this._evaluator.feature=n,this._evaluator.featureState=l,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(t,n,l,h,m,y){this._globalState&&(t=pr(t,this._globalState)),this._evaluator.globals=t,this._evaluator.feature=n||null,this._evaluator.featureState=l||null,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y||null;try{const w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new Bn(`Expected value to be one of ${Object.keys(this._enumValues).map((C=>JSON.stringify(C))).join(", ")}, but found ${JSON.stringify(w)} instead.`);return w}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}}}function vu(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in fc}function gc(r,t,n){const l=new va(fc,bl,[],t?(function(m){const y={color:wr,string:Ce,number:ce,enum:Ce,boolean:Ne,formatted:Eo,padding:Gs,numberArray:qs,colorArray:Tr,projectionDefinition:ll,resolvedImage:Zs,variableAnchorOffsetCollection:gi};return m.type==="array"?Xr(y[m.value]||Ye,m.length):y[m.type]})(t):void 0),h=l.parse(r,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?yu(new mc(h,t,n)):Wa(l.errors)}class Lo{constructor(t,n,l){this.kind=t,this._styleExpression=n,this.isStateDependent=t!=="constant"&&!Ea(n.expression),this.globalStateRefs=ko(n.expression),this._globalState=l}evaluateWithoutErrorHandling(t,n,l,h,m,y){return this._globalState&&(t=pr(t,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(t,n,l,h,m,y)}evaluate(t,n,l,h,m,y){return this._globalState&&(t=pr(t,this._globalState)),this._styleExpression.evaluate(t,n,l,h,m,y)}}class Nr{constructor(t,n,l,h,m){this.kind=t,this.zoomStops=l,this._styleExpression=n,this.isStateDependent=t!=="camera"&&!Ea(n.expression),this.globalStateRefs=ko(n.expression),this.interpolationType=h,this._globalState=m}evaluateWithoutErrorHandling(t,n,l,h,m,y){return this._globalState&&(t=pr(t,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(t,n,l,h,m,y)}evaluate(t,n,l,h,m,y){return this._globalState&&(t=pr(t,this._globalState)),this._styleExpression.evaluate(t,n,l,h,m,y)}interpolationFactor(t,n,l){return this.interpolationType?rr.interpolationFactor(this.interpolationType,t,n,l):0}}function Sl(r,t,n){const l=gc(r,t,n);if(l.result==="error")return l;const h=l.value.expression,m=Or(h);if(!m&&!Io(t))return Wa([new qn("","data expressions not supported")]);const y=pc(h,["zoom"]);if(!y&&!zo(t))return Wa([new qn("","zoom expressions not supported")]);const w=El(h);return w||y?w instanceof qn?Wa([w]):w instanceof rr&&!Ch(t)?Wa([new qn("",'"interpolate" expressions cannot be used with this property')]):yu(w?new Nr(m?"camera":"composite",l.value,w.labels,w instanceof rr?w.interpolation:void 0,n):new Lo(m?"constant":"source",l.value,n)):Wa([new qn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Qa{constructor(t,n){this._parameters=t,this._specification=n,Gn(this,Jr(this._parameters,this._specification))}static deserialize(t){return new Qa(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function El(r){let t=null;if(r instanceof gn)t=El(r.result);else if(r instanceof lc){for(const n of r.args)if(t=El(n),t)break}else(r instanceof Mo||r instanceof rr)&&r.input instanceof Es&&r.input.name==="zoom"&&(t=r);return t instanceof qn||r.eachChild((n=>{const l=El(n);l instanceof qn?t=l:!t&&l?t=new qn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&l&&t!==l&&(t=new qn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}function ko(r,t=new Set){return r instanceof mu&&t.add(r.key),r.eachChild((n=>{ko(n,t)})),t}function pr(r,t){const{zoom:n,heatmapDensity:l,elevation:h,lineProgress:m,isSupportedScript:y,accumulated:w}=r??{};return{zoom:n,heatmapDensity:l,elevation:h,lineProgress:m,isSupportedScript:y,accumulated:w,globalState:t}}function Fr(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const t of r.slice(1))if(!Fr(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Ja={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ts(r,t){if(r==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Fr(r)||(r=yc(r));const n=gc(r,Ja,t);if(n.result==="error")throw new Error(n.value.map((l=>`${l.key}: ${l.message}`)).join(", "));return{filter:(l,h,m)=>n.value.evaluate(l,h,{},m),needGeometry:Ys(r),getGlobalStateRefs:()=>ko(n.value.expression)}}function Ca(r,t){return r<t?-1:r>t?1:0}function Ys(r){if(!Array.isArray(r))return!1;if(r[0]==="within"||r[0]==="distance")return!0;for(let t=1;t<r.length;t++)if(Ys(r[t]))return!0;return!1}function yc(r){if(!r)return!0;const t=r[0];return r.length<=1?t!=="any":t==="=="?_c(r[1],r[2],"=="):t==="!="?Oi(_c(r[1],r[2],"==")):t==="<"||t===">"||t==="<="||t===">="?_c(r[1],r[2],t):t==="any"?(n=r.slice(1),["any"].concat(n.map(yc))):t==="all"?["all"].concat(r.slice(1).map(yc)):t==="none"?["all"].concat(r.slice(1).map(yc).map(Oi)):t==="in"?Ah(r[1],r.slice(2)):t==="!in"?Oi(Ah(r[1],r.slice(2))):t==="has"?Bd(r[1]):t!=="!has"||Oi(Bd(r[1]));var n}function _c(r,t,n){switch(r){case"$type":return[`filter-type-${n}`,t];case"$id":return[`filter-id-${n}`,t];default:return[`filter-${n}`,r,t]}}function Ah(r,t){if(t.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((n=>typeof n!=typeof t[0]))?["filter-in-large",r,["literal",t.sort(Ca)]]:["filter-in-small",r,["literal",t]]}}function Bd(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Oi(r){return["!",r]}function Jn(r){const t=typeof r;if(t==="number"||t==="boolean"||t==="string"||r==null)return JSON.stringify(r);if(Array.isArray(r)){let h="[";for(const m of r)h+=`${Jn(m)},`;return`${h}]`}const n=Object.keys(r).sort();let l="{";for(let h=0;h<n.length;h++)l+=`${JSON.stringify(n[h])}:${Jn(r[n[h]])},`;return`${l}}`}function vn(r){let t="";for(const n of It)t+=`/${Jn(r[n])}`;return t}function Aa(r){const t=r.value;return t?[new pe(r.key,t,"constants have been deprecated as of v8")]:[]}function wn(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function Ws(r){if(Array.isArray(r))return r.map(Ws);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const t={};for(const n in r)t[n]=Ws(r[n]);return t}return wn(r)}function Di(r){const t=r.key,n=r.value,l=r.valueSpec||{},h=r.objectElementValidators||{},m=r.style,y=r.styleSpec,w=r.validateSpec;let C=[];const D=an(n);if(D!=="object")return[new pe(t,n,`object expected, ${D} found`)];for(const z in n){const N=z.split(".")[0],V=ma(l,N)||l["*"];let U;if(ma(h,N))U=h[N];else if(ma(l,N))U=w;else if(h["*"])U=h["*"];else{if(!l["*"]){C.push(new pe(t,n[z],`unknown property "${z}"`));continue}U=w}C=C.concat(U({key:(t&&`${t}.`)+z,value:n[z],valueSpec:V,style:m,styleSpec:y,object:n,objectKey:z,validateSpec:w},n))}for(const z in l)h[z]||l[z].required&&l[z].default===void 0&&n[z]===void 0&&C.push(new pe(t,n,`missing required property "${z}"`));return C}function vc(r){const t=r.value,n=r.valueSpec,l=r.style,h=r.styleSpec,m=r.key,y=r.arrayElementValidator||r.validateSpec;if(an(t)!=="array")return[new pe(m,t,`array expected, ${an(t)} found`)];if(n.length&&t.length!==n.length)return[new pe(m,t,`array length ${n.length} expected, length ${t.length} found`)];if(n["min-length"]&&t.length<n["min-length"])return[new pe(m,t,`array length at least ${n["min-length"]} expected, length ${t.length} found`)];let w={type:n.value,values:n.values};h.$version<7&&(w.function=n.function),an(n.value)==="object"&&(w=n.value);let C=[];for(let D=0;D<t.length;D++)C=C.concat(y({array:t,arrayIndex:D,value:t[D],valueSpec:w,validateSpec:r.validateSpec,style:l,styleSpec:h,key:`${m}[${D}]`}));return C}function Oo(r){const t=r.key,n=r.value,l=r.valueSpec;let h=an(n);return h==="number"&&n!=n&&(h="NaN"),h!=="number"?[new pe(t,n,`number expected, ${h} found`)]:"minimum"in l&&n<l.minimum?[new pe(t,n,`${n} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&n>l.maximum?[new pe(t,n,`${n} is greater than the maximum value ${l.maximum}`)]:[]}function Cl(r){const t=r.valueSpec,n=wn(r.value.type);let l,h,m,y={};const w=n!=="categorical"&&r.value.property===void 0,C=!w,D=an(r.value.stops)==="array"&&an(r.value.stops[0])==="array"&&an(r.value.stops[0][0])==="object",z=Di({key:r.key,value:r.value,valueSpec:r.styleSpec.function,validateSpec:r.validateSpec,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(U){if(n==="identity")return[new pe(U.key,U.value,'identity function may not have a "stops" property')];let G=[];const Y=U.value;return G=G.concat(vc({key:U.key,value:Y,valueSpec:U.valueSpec,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec,arrayElementValidator:N})),an(Y)==="array"&&Y.length===0&&G.push(new pe(U.key,Y,"array must have at least one stop")),G},default:function(U){return U.validateSpec({key:U.key,value:U.value,valueSpec:t,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec})}}});return n==="identity"&&w&&z.push(new pe(r.key,r.value,'missing required property "property"')),n==="identity"||r.value.stops||z.push(new pe(r.key,r.value,'missing required property "stops"')),n==="exponential"&&r.valueSpec.expression&&!Ch(r.valueSpec)&&z.push(new pe(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(C&&!Io(r.valueSpec)?z.push(new pe(r.key,r.value,"property functions not supported")):w&&!zo(r.valueSpec)&&z.push(new pe(r.key,r.value,"zoom functions not supported"))),n!=="categorical"&&!D||r.value.property!==void 0||z.push(new pe(r.key,r.value,'"property" property is required')),z;function N(U){let G=[];const Y=U.value,tt=U.key;if(an(Y)!=="array")return[new pe(tt,Y,`array expected, ${an(Y)} found`)];if(Y.length!==2)return[new pe(tt,Y,`array length 2 expected, length ${Y.length} found`)];if(D){if(an(Y[0])!=="object")return[new pe(tt,Y,`object expected, ${an(Y[0])} found`)];if(Y[0].zoom===void 0)return[new pe(tt,Y,"object stop key must have zoom")];if(Y[0].value===void 0)return[new pe(tt,Y,"object stop key must have value")];if(m&&m>wn(Y[0].zoom))return[new pe(tt,Y[0].zoom,"stop zoom values must appear in ascending order")];wn(Y[0].zoom)!==m&&(m=wn(Y[0].zoom),h=void 0,y={}),G=G.concat(Di({key:`${tt}[0]`,value:Y[0],valueSpec:{zoom:{}},validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec,objectElementValidators:{zoom:Oo,value:V}}))}else G=G.concat(V({key:`${tt}[0]`,value:Y[0],validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec},Y));return vu(Ws(Y[1]))?G.concat([new pe(`${tt}[1]`,Y[1],"expressions are not allowed in function stops.")]):G.concat(U.validateSpec({key:`${tt}[1]`,value:Y[1],valueSpec:t,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec}))}function V(U,G){const Y=an(U.value),tt=wn(U.value),at=U.value!==null?U.value:G;if(l){if(Y!==l)return[new pe(U.key,at,`${Y} stop domain type must match previous stop domain type ${l}`)]}else l=Y;if(Y!=="number"&&Y!=="string"&&Y!=="boolean")return[new pe(U.key,at,"stop domain value must be a number, string, or boolean")];if(Y!=="number"&&n!=="categorical"){let yt=`number expected, ${Y} found`;return Io(t)&&n===void 0&&(yt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new pe(U.key,at,yt)]}return n!=="categorical"||Y!=="number"||isFinite(tt)&&Math.floor(tt)===tt?n!=="categorical"&&Y==="number"&&h!==void 0&&tt<h?[new pe(U.key,at,"stop domain values must appear in ascending order")]:(h=tt,n==="categorical"&&tt in y?[new pe(U.key,at,"stop domain values must be unique")]:(y[tt]=!0,[])):[new pe(U.key,at,`integer expected, found ${tt}`)]}}function Cs(r){const t=(r.expressionContext==="property"?Sl:gc)(Ws(r.value),r.valueSpec);if(t.result==="error")return t.value.map((l=>new pe(`${r.key}${l.key}`,r.value,l.message)));const n=t.value.expression||t.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!n.outputDefined())return[new pe(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!Ea(n))return[new pe(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!Ea(n))return[new pe(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!pc(n,["zoom","feature-state"]))return[new pe(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!Or(n))return[new pe(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function xu(r){const t=r.key,n=r.value,l=an(n);return l!=="string"?[new pe(t,n,`color expected, ${l} found`)]:hn.parse(String(n))?[]:[new pe(t,n,`color expected, "${n}" found`)]}function to(r){const t=r.key,n=r.value,l=r.valueSpec,h=[];return Array.isArray(l.values)?l.values.indexOf(wn(n))===-1&&h.push(new pe(t,n,`expected one of [${l.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(l.values).indexOf(wn(n))===-1&&h.push(new pe(t,n,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(n)} found`)),h}function bu(r){return Fr(Ws(r.value))?Cs(Gn({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):No(r)}function No(r){const t=r.value,n=r.key;if(an(t)!=="array")return[new pe(n,t,`array expected, ${an(t)} found`)];const l=r.styleSpec;let h,m=[];if(t.length<1)return[new pe(n,t,"filter array must have at least 1 element")];switch(m=m.concat(to({key:`${n}[0]`,value:t[0],valueSpec:l.filter_operator,style:r.style,styleSpec:r.styleSpec})),wn(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&wn(t[1])==="$type"&&m.push(new pe(n,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&m.push(new pe(n,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(h=an(t[1]),h!=="string"&&m.push(new pe(`${n}[1]`,t[1],`string expected, ${h} found`)));for(let y=2;y<t.length;y++)h=an(t[y]),wn(t[1])==="$type"?m=m.concat(to({key:`${n}[${y}]`,value:t[y],valueSpec:l.geometry_type,style:r.style,styleSpec:r.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&m.push(new pe(`${n}[${y}]`,t[y],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let y=1;y<t.length;y++)m=m.concat(No({key:`${n}[${y}]`,value:t[y],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":h=an(t[1]),t.length!==2?m.push(new pe(n,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="string"&&m.push(new pe(`${n}[1]`,t[1],`string expected, ${h} found`))}return m}function Ks(r,t){const n=r.key,l=r.validateSpec,h=r.style,m=r.styleSpec,y=r.value,w=r.objectKey,C=m[`${t}_${r.layerType}`];if(!C)return[];const D=w.match(/^(.*)-transition$/);if(t==="paint"&&D&&C[D[1]]&&C[D[1]].transition)return l({key:n,value:y,valueSpec:m.transition,style:h,styleSpec:m});const z=r.valueSpec||C[w];if(!z)return[new pe(n,y,`unknown property "${w}"`)];let N;if(an(y)==="string"&&Io(z)&&!z.tokens&&(N=/^{([^}]+)}$/.exec(y)))return[new pe(n,y,`"${w}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(N[1])} }\`.`)];const V=[];return r.layerType==="symbol"&&w==="text-font"&&Ka(Ws(y))&&wn(y.type)==="identity"&&V.push(new pe(n,y,'"text-font" does not support identity functions')),V.concat(l({key:r.key,value:y,valueSpec:z,style:h,styleSpec:m,expressionContext:"property",propertyType:t,propertyKey:w}))}function Ma(r){return Ks(r,"paint")}function hs(r){return Ks(r,"layout")}function Mh(r){let t=[];const n=r.value,l=r.key,h=r.style,m=r.styleSpec;if(an(n)!=="object")return[new pe(l,n,`object expected, ${an(n)} found`)];n.type||n.ref||t.push(new pe(l,n,'either "type" or "ref" is required'));let y=wn(n.type);const w=wn(n.ref);if(n.id){const C=wn(n.id);for(let D=0;D<r.arrayIndex;D++){const z=h.layers[D];wn(z.id)===C&&t.push(new pe(l,n.id,`duplicate layer id "${n.id}", previously used at line ${z.id.__line__}`))}}if("ref"in n){let C;["type","source","source-layer","filter","layout"].forEach((D=>{D in n&&t.push(new pe(l,n[D],`"${D}" is prohibited for ref layers`))})),h.layers.forEach((D=>{wn(D.id)===w&&(C=D)})),C?C.ref?t.push(new pe(l,n.ref,"ref cannot reference another ref layer")):y=wn(C.type):t.push(new pe(l,n.ref,`ref layer "${w}" not found`))}else if(y!=="background")if(n.source){const C=h.sources&&h.sources[n.source],D=C&&wn(C.type);C?D==="vector"&&y==="raster"?t.push(new pe(l,n.source,`layer "${n.id}" requires a raster source`)):D!=="raster-dem"&&y==="hillshade"||D!=="raster-dem"&&y==="color-relief"?t.push(new pe(l,n.source,`layer "${n.id}" requires a raster-dem source`)):D==="raster"&&y!=="raster"?t.push(new pe(l,n.source,`layer "${n.id}" requires a vector source`)):D!=="vector"||n["source-layer"]?D==="raster-dem"&&y!=="hillshade"&&y!=="color-relief"?t.push(new pe(l,n.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):y!=="line"||!n.paint||!n.paint["line-gradient"]||D==="geojson"&&C.lineMetrics||t.push(new pe(l,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new pe(l,n,`layer "${n.id}" must specify a "source-layer"`)):t.push(new pe(l,n.source,`source "${n.source}" not found`))}else t.push(new pe(l,n,'missing required property "source"'));return t=t.concat(Di({key:l,value:n,valueSpec:m.layer,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,objectElementValidators:{"*":()=>[],type:()=>r.validateSpec({key:`${l}.type`,value:n.type,valueSpec:m.layer.type,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,object:n,objectKey:"type"}),filter:bu,layout:C=>Di({layer:n,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*":D=>hs(Gn({layerType:y},D))}}),paint:C=>Di({layer:n,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*":D=>Ma(Gn({layerType:y},D))}})}})),t}function Pa(r){const t=r.value,n=r.key,l=an(t);return l!=="string"?[new pe(n,t,`string expected, ${l} found`)]:[]}const Fo={promoteId:function({key:r,value:t}){if(an(t)==="string")return Pa({key:r,value:t});{const n=[];for(const l in t)n.push(...Pa({key:`${r}.${l}`,value:t[l]}));return n}}};function wu(r){const t=r.value,n=r.key,l=r.styleSpec,h=r.style,m=r.validateSpec;if(!t.type)return[new pe(n,t,'"type" is required')];const y=wn(t.type);let w;switch(y){case"vector":case"raster":return w=Di({key:n,value:t,valueSpec:l[`source_${y.replace("-","_")}`],style:r.style,styleSpec:l,objectElementValidators:Fo,validateSpec:m}),w;case"raster-dem":return w=(function(C){var D;const z=(D=C.sourceName)!==null&&D!==void 0?D:"",N=C.value,V=C.styleSpec,U=V.source_raster_dem,G=C.style;let Y=[];const tt=an(N);if(N===void 0)return Y;if(tt!=="object")return Y.push(new pe("source_raster_dem",N,`object expected, ${tt} found`)),Y;const at=wn(N.encoding)==="custom",yt=["redFactor","greenFactor","blueFactor","baseShift"],ct=C.value.encoding?`"${C.value.encoding}"`:"Default";for(const dt in N)!at&&yt.includes(dt)?Y.push(new pe(dt,N[dt],`In "${z}": "${dt}" is only valid when "encoding" is set to "custom". ${ct} encoding found`)):U[dt]?Y=Y.concat(C.validateSpec({key:dt,value:N[dt],valueSpec:U[dt],validateSpec:C.validateSpec,style:G,styleSpec:V})):Y.push(new pe(dt,N[dt],`unknown property "${dt}"`));return Y})({sourceName:n,value:t,style:r.style,styleSpec:l,validateSpec:m}),w;case"geojson":if(w=Di({key:n,value:t,valueSpec:l.source_geojson,style:h,styleSpec:l,validateSpec:m,objectElementValidators:Fo}),t.cluster)for(const C in t.clusterProperties){const[D,z]=t.clusterProperties[C],N=typeof D=="string"?[D,["accumulated"],["get",C]]:D;w.push(...Cs({key:`${n}.${C}.map`,value:z,expressionContext:"cluster-map"})),w.push(...Cs({key:`${n}.${C}.reduce`,value:N,expressionContext:"cluster-reduce"}))}return w;case"video":return Di({key:n,value:t,valueSpec:l.source_video,style:h,validateSpec:m,styleSpec:l});case"image":return Di({key:n,value:t,valueSpec:l.source_image,style:h,validateSpec:m,styleSpec:l});case"canvas":return[new pe(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return to({key:`${n}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function eo(r){const t=r.value,n=r.styleSpec,l=n.light,h=r.style;let m=[];const y=an(t);if(t===void 0)return m;if(y!=="object")return m=m.concat([new pe("light",t,`object expected, ${y} found`)]),m;for(const w in t){const C=w.match(/^(.*)-transition$/);m=m.concat(C&&l[C[1]]&&l[C[1]].transition?r.validateSpec({key:w,value:t[w],valueSpec:n.transition,validateSpec:r.validateSpec,style:h,styleSpec:n}):l[w]?r.validateSpec({key:w,value:t[w],valueSpec:l[w],validateSpec:r.validateSpec,style:h,styleSpec:n}):[new pe(w,t[w],`unknown property "${w}"`)])}return m}function $i(r){const t=r.value,n=r.styleSpec,l=n.sky,h=r.style,m=an(t);if(t===void 0)return[];if(m!=="object")return[new pe("sky",t,`object expected, ${m} found`)];let y=[];for(const w in t)y=y.concat(l[w]?r.validateSpec({key:w,value:t[w],valueSpec:l[w],style:h,styleSpec:n}):[new pe(w,t[w],`unknown property "${w}"`)]);return y}function no(r){const t=r.value,n=r.styleSpec,l=n.terrain,h=r.style;let m=[];const y=an(t);if(t===void 0)return m;if(y!=="object")return m=m.concat([new pe("terrain",t,`object expected, ${y} found`)]),m;for(const w in t)m=m.concat(l[w]?r.validateSpec({key:w,value:t[w],valueSpec:l[w],validateSpec:r.validateSpec,style:h,styleSpec:n}):[new pe(w,t[w],`unknown property "${w}"`)]);return m}function Vd(r){let t=[];const n=r.value,l=r.key;if(Array.isArray(n)){const h=[],m=[];for(const y in n)n[y].id&&h.includes(n[y].id)&&t.push(new pe(l,n,`all the sprites' ids must be unique, but ${n[y].id} is duplicated`)),h.push(n[y].id),n[y].url&&m.includes(n[y].url)&&t.push(new pe(l,n,`all the sprites' URLs must be unique, but ${n[y].url} is duplicated`)),m.push(n[y].url),t=t.concat(Di({key:`${l}[${y}]`,value:n[y],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:r.validateSpec}));return t}return Pa({key:l,value:n})}function ip(r){return t=r.value,t&&t.constructor===Object?[]:[new pe(r.key,r.value,`object expected, ${an(r.value)} found`)];var t}const rp={"*":()=>[],array:vc,boolean:function(r){const t=r.value,n=r.key,l=an(t);return l!=="boolean"?[new pe(n,t,`boolean expected, ${l} found`)]:[]},number:Oo,color:xu,constants:Aa,enum:to,filter:bu,function:Cl,layer:Mh,object:Di,source:wu,light:eo,sky:$i,terrain:no,projection:function(r){const t=r.value,n=r.styleSpec,l=n.projection,h=r.style,m=an(t);if(t===void 0)return[];if(m!=="object")return[new pe("projection",t,`object expected, ${m} found`)];let y=[];for(const w in t)y=y.concat(l[w]?r.validateSpec({key:w,value:t[w],valueSpec:l[w],style:h,styleSpec:n}):[new pe(w,t[w],`unknown property "${w}"`)]);return y},projectionDefinition:function(r){const t=r.key;let n=r.value;n=n instanceof String?n.valueOf():n;const l=an(n);return l!=="array"||(function(h){return Array.isArray(h)&&h.length===3&&typeof h[0]=="string"&&typeof h[1]=="string"&&typeof h[2]=="number"})(n)||(function(h){return!!["interpolate","step","literal"].includes(h[0])})(n)?["array","string"].includes(l)?[]:[new pe(t,n,`projection expected, invalid type "${l}" found`)]:[new pe(t,n,`projection expected, invalid array ${JSON.stringify(n)} found`)]},string:Pa,formatted:function(r){return Pa(r).length===0?[]:Cs(r)},resolvedImage:function(r){return Pa(r).length===0?[]:Cs(r)},padding:function(r){const t=r.key,n=r.value;if(an(n)==="array"){if(n.length<1||n.length>4)return[new pe(t,n,`padding requires 1 to 4 values; ${n.length} values found`)];const l={type:"number"};let h=[];for(let m=0;m<n.length;m++)h=h.concat(r.validateSpec({key:`${t}[${m}]`,value:n[m],validateSpec:r.validateSpec,valueSpec:l}));return h}return Oo({key:t,value:n,valueSpec:{}})},numberArray:function(r){const t=r.key,n=r.value;if(an(n)==="array"){const l={type:"number"};if(n.length<1)return[new pe(t,n,"array length at least 1 expected, length 0 found")];let h=[];for(let m=0;m<n.length;m++)h=h.concat(r.validateSpec({key:`${t}[${m}]`,value:n[m],validateSpec:r.validateSpec,valueSpec:l}));return h}return Oo({key:t,value:n,valueSpec:{}})},colorArray:function(r){const t=r.key,n=r.value;if(an(n)==="array"){if(n.length<1)return[new pe(t,n,"array length at least 1 expected, length 0 found")];let l=[];for(let h=0;h<n.length;h++)l=l.concat(xu({key:`${t}[${h}]`,value:n[h]}));return l}return xu({key:t,value:n})},variableAnchorOffsetCollection:function(r){const t=r.key,n=r.value,l=an(n),h=r.styleSpec;if(l!=="array"||n.length<1||n.length%2!=0)return[new pe(t,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let m=[];for(let y=0;y<n.length;y+=2)m=m.concat(to({key:`${t}[${y}]`,value:n[y],valueSpec:h.layout_symbol["text-anchor"]})),m=m.concat(vc({key:`${t}[${y+1}]`,value:n[y+1],valueSpec:{length:2,value:"number"},validateSpec:r.validateSpec,style:r.style,styleSpec:h}));return m},sprite:Vd,state:ip};function Ph(r){const t=r.value,n=r.valueSpec,l=r.styleSpec;return r.validateSpec=Ph,n.expression&&Ka(wn(t))?Cl(r):n.expression&&vu(Ws(t))?Cs(r):n.type&&rp[n.type]?rp[n.type](r):Di(Gn({},r,{valueSpec:n.type?l[n.type]:n}))}function Ri(r){const t=r.value,n=r.key,l=Pa(r);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new pe(n,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new pe(n,t,'"glyphs" url must include a "{range}" token'))),l}function es(r,t=ht){let n=[];return n=n.concat(Ph({key:"",value:r,valueSpec:t.$root,styleSpec:t,style:r,validateSpec:Ph,objectElementValidators:{glyphs:Ri,"*":()=>[]}})),r.constants&&(n=n.concat(Aa({key:"constants",value:r.constants}))),Da(n)}function Hi(r){return function(t){return r(Object.assign({},t,{validateSpec:Ph}))}}function Da(r){return[].concat(r).sort(((t,n)=>t.line-n.line))}function ai(r){return function(...t){return Da(r.apply(this,t))}}es.source=ai(Hi(wu)),es.sprite=ai(Hi(Vd)),es.glyphs=ai(Hi(Ri)),es.light=ai(Hi(eo)),es.sky=ai(Hi($i)),es.terrain=ai(Hi(no)),es.state=ai(Hi(ip)),es.layer=ai(Hi(Mh)),es.filter=ai(Hi(bu)),es.paintProperty=ai(Hi(Ma)),es.layoutProperty=ai(Hi(hs));const Ra=ht,As=es,Cm=As.light,sp=As.sky,Tu=As.paintProperty,Ud=As.layoutProperty;function Ia(r,t){let n=!1;if(t&&t.length)for(const l of t)r.fire(new wt(new Error(l.message))),n=!0;return n}class Al{constructor(t,n,l){const h=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const y=new Int32Array(this.arrayBuffer);t=y[0],this.d=(n=y[1])+2*(l=y[2]);for(let C=0;C<this.d*this.d;C++){const D=y[3+C],z=y[3+C+1];h.push(D===z?null:y.subarray(D,z))}const w=y[3+h.length+1];this.keys=y.subarray(y[3+h.length],w),this.bboxes=y.subarray(w),this.insert=this._insertReadonly}else{this.d=n+2*l;for(let y=0;y<this.d*this.d;y++)h.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=t,this.padding=l,this.scale=n/t,this.uid=0;const m=l/n*t;this.min=-m,this.max=t+m}insert(t,n,l,h,m){this._forEachCell(n,l,h,m,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(h),this.bboxes.push(m)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,n,l,h,m,y){this.cells[m].push(y)}query(t,n,l,h,m){const y=this.min,w=this.max;if(t<=y&&n<=y&&w<=l&&w<=h&&!m)return Array.prototype.slice.call(this.keys);{const C=[];return this._forEachCell(t,n,l,h,this._queryCell,C,{},m),C}}_queryCell(t,n,l,h,m,y,w,C){const D=this.cells[m];if(D!==null){const z=this.keys,N=this.bboxes;for(let V=0;V<D.length;V++){const U=D[V];if(w[U]===void 0){const G=4*U;(C?C(N[G+0],N[G+1],N[G+2],N[G+3]):t<=N[G+2]&&n<=N[G+3]&&l>=N[G+0]&&h>=N[G+1])?(w[U]=!0,y.push(z[U])):w[U]=!1}}}}_forEachCell(t,n,l,h,m,y,w,C){const D=this._convertToCellCoord(t),z=this._convertToCellCoord(n),N=this._convertToCellCoord(l),V=this._convertToCellCoord(h);for(let U=D;U<=N;U++)for(let G=z;G<=V;G++){const Y=this.d*G+U;if((!C||C(this._convertFromCellCoord(U),this._convertFromCellCoord(G),this._convertFromCellCoord(U+1),this._convertFromCellCoord(G+1)))&&m.call(this,t,n,l,h,Y,y,w,C))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,n=3+this.cells.length+1+1;let l=0;for(let y=0;y<this.cells.length;y++)l+=this.cells[y].length;const h=new Int32Array(n+l+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let m=n;for(let y=0;y<t.length;y++){const w=t[y];h[3+y]=m,h.set(w,m),m+=w.length}return h[3+t.length]=m,h.set(this.keys,m),m+=this.keys.length,h[3+t.length+1]=m,h.set(this.bboxes,m),m+=this.bboxes.length,h.buffer}static serialize(t,n){const l=t.toArrayBuffer();return n&&n.push(l),{buffer:l}}static deserialize(t){return new Al(t.buffer)}}const ns={};function Me(r,t,n={}){if(ns[r])throw new Error(`${r} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:r,writeable:!1}),ns[r]={klass:t,omit:n.omit||[],shallow:n.shallow||[]}}Me("Object",Object),Me("Set",Set),Me("TransferableGridIndex",Al),Me("Color",hn),Me("Error",Error),Me("AJAXError",Ir),Me("ResolvedImage",wi),Me("StylePropertyFunction",Qa),Me("StyleExpression",mc,{omit:["_evaluator"]}),Me("ZoomDependentExpression",Nr),Me("ZoomConstantExpression",Lo),Me("CompoundExpression",Es,{omit:["_evaluate"]});for(const r in fc)fc[r]._classRegistryKey||Me(`Expression_${r}`,fc[r]);function Qs(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function Su(r){return r.$name||r.constructor._classRegistryKey}function Eu(r){return!(function(t){if(t===null||typeof t!="object")return!1;const n=Su(t);return!(!n||n==="Object")})(r)&&(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||r instanceof Error||Qs(r)||Us(r)||ArrayBuffer.isView(r)||r instanceof ImageData)}function jo(r,t){if(Eu(r))return(Qs(r)||Us(r))&&t&&t.push(r),ArrayBuffer.isView(r)&&t&&t.push(r.buffer),r instanceof ImageData&&t&&t.push(r.data.buffer),r;if(Array.isArray(r)){const m=[];for(const y of r)m.push(jo(y,t));return m}if(typeof r!="object")throw new Error("can't serialize object of type "+typeof r);const n=Su(r);if(!n)throw new Error(`can't serialize object of unregistered class ${r.constructor.name}`);if(!ns[n])throw new Error(`${n} is not registered.`);const{klass:l}=ns[n],h=l.serialize?l.serialize(r,t):{};if(l.serialize){if(t&&h===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const m in r){if(!r.hasOwnProperty(m)||ns[n].omit.indexOf(m)>=0)continue;const y=r[m];h[m]=ns[n].shallow.indexOf(m)>=0?y:jo(y,t)}r instanceof Error&&(h.message=r.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(h.$name=n),h}function za(r){if(Eu(r))return r;if(Array.isArray(r))return r.map(za);if(typeof r!="object")throw new Error("can't deserialize object of type "+typeof r);const t=Su(r)||"Object";if(!ns[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:n}=ns[t];if(!n)throw new Error(`can't deserialize unregistered class ${t}`);if(n.deserialize)return n.deserialize(r);const l=Object.create(n.prototype);for(const h of Object.keys(r)){if(h==="$name")continue;const m=r[h];l[h]=ns[t].shallow.indexOf(h)>=0?m:za(m)}return l}class Dh{constructor(){this.first=!0}update(t,n){const l=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=n),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=l,!0))}}function Ml(r){return/[\u02EA\u02EB\u2E80-\u2FDF\u2FF0-\u303F\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FD-\u30FF\u3105-\u312F\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(r))}function Ms(r){return/[\u02EA\u02EB\u1100-\u11FF\u1400-\u167F\u18B0-\u18F5\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303F\u3041-\u3096\u309D-\u30FB\u30FD-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE48\uFE50-\uFE57\uFE5F-\uFE62\uFE67-\uFE6F\uFF00-\uFF07\uFF0A-\uFF0C\uFF0E-\uFF19\uFF1F-\uFF3A\uFF3C\uFF3E\uFF40-\uFF5A\uFFE0-\uFFE2\uFFE4-\uFFE7]|\uD802[\uDD80-\uDD9F]|\uD805[\uDD80-\uDDFF]|\uD806[\uDE00-\uDEBF]|\uD811[\uDC00-\uDE7F]|\uD81B[\uDFE0-\uDFE4\uDFF0-\uDFF6]|[\uD81C-\uD822\uD83D\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD30-\uDEFB]|\uD833[\uDEC0-\uDFCF]|\uD834[\uDC00-\uDDFF\uDEE0-\uDF7F]|\uD836[\uDC00-\uDEAF]|\uD83C[\uDC00-\uDE00\uDF00-\uDFFF]|\uD83E[\uDD00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(r))}function Gd(r){return/\s/u.test(String.fromCodePoint(r))}function xc(r){for(const t of r)if(Ms(t.codePointAt(0)))return!0;return!1}function io(r){for(const t of r)if(!bc(t.codePointAt(0)))return!1;return!0}function Pl(r){const t=r.map((n=>{try{return new RegExp(`\\p{sc=${n}}`,"u").source}catch{return null}})).filter((n=>n));return new RegExp(t.join("|"),"u")}const Cu=Pl(["Arab","Dupl","Mong","Ougr","Syrc"]);function bc(r){return!Cu.test(String.fromCodePoint(r))}function wc(r){return!(Ms(r)||(t=r,/[\xA7\xA9\xAE\xB1\xBC-\xBE\xD7\xF7\u2016\u2020\u2021\u2030\u2031\u203B\u203C\u2042\u2047-\u2049\u2051\u2100-\u218F\u221E\u2234\u2235\u2300-\u2307\u230C-\u231F\u2324-\u2328\u232B\u237D-\u239A\u23BE-\u23CD\u23CF\u23D1-\u23DB\u23E2-\u2422\u2424-\u24FF\u25A0-\u2619\u2620-\u2767\u2776-\u2793\u2B12-\u2B2F\u2B50-\u2B59\u2BB8-\u2BEB\u3000-\u303F\u30A0-\u30FF\uE000-\uF8FF\uFE30-\uFE6F\uFF00-\uFFEF\uFFFC\uFFFD]|[\uDB80-\uDBFF][\uDC00-\uDFFF]/gim.test(String.fromCodePoint(t))));var t}const Rh=Pl(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function ro(r){return Rh.test(String.fromCodePoint(r))}function ap(r,t){return!(!t&&ro(r)||/[\u0900-\u0DFF\u0F00-\u109F\u1780-\u17FF]/gim.test(String.fromCodePoint(r)))}function so(r){for(const t of r)if(ro(t.codePointAt(0)))return!0;return!1}const La=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(r){this.pluginStatus=r.pluginStatus,this.pluginURL=r.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(r){if(La.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=r.applyArabicShaping,this.processBidirectionalText=r.processBidirectionalText,this.processStyledBidirectionalText=r.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(r,t){return u(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(r.pluginStatus!=="loading")return this.setState(r),r;const n=r.pluginURL,l=new Promise((m=>{this.loadScriptResolve=m}));t(n);const h=new Promise((m=>setTimeout((()=>m()),this.TIMEOUT)));if(yield Promise.race([l,h]),this.isParsed()){const m={pluginStatus:"loaded",pluginURL:n};return this.setState(m),m}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${n}`)}))}};class kn{constructor(t,n){this.isSupportedScript=Bo,this.zoom=t,n?(this.now=n.now||0,this.fadeDuration=n.fadeDuration||0,this.zoomHistory=n.zoomHistory||new Dh,this.transition=n.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Dh,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,n=t-Math.floor(t),l=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*n}}}function Bo(r){return(function(t,n){for(const l of t)if(!ap(l.codePointAt(0),n))return!1;return!0})(r,La.getRTLTextPluginStatus()==="loaded")}const Ps="-transition";class ao{constructor(t,n,l){this.property=t,this.value=n,this.expression=(function(h,m,y){if(Ka(h))return new Qa(h,m);if(vu(h)){const w=Sl(h,m,y);if(w.result==="error")throw new Error(w.value.map((C=>`${C.key}: ${C.message}`)).join(", "));return w.value}{let w=h;return m.type==="color"&&typeof h=="string"?w=hn.parse(h):m.type!=="padding"||typeof h!="number"&&!Array.isArray(h)?m.type!=="numberArray"||typeof h!="number"&&!Array.isArray(h)?m.type!=="colorArray"||typeof h!="string"&&!Array.isArray(h)?m.type==="variableAnchorOffsetCollection"&&Array.isArray(h)?w=Zi.parse(h):m.type==="projectionDefinition"&&typeof h=="string"&&(w=ir.parse(h)):w=Li.parse(h):w=Pi.parse(h):w=Mi.parse(h),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>w}}})(n===void 0?t.specification.default:n,t.specification,l)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(t,n,l){return this.property.possiblyEvaluate(this,t,n,l)}}class Au{constructor(t,n){this.property=t,this.value=new ao(t,void 0,n)}transitioned(t,n){return new Dl(this.property,this.value,n,yn({},t.transition,this.transition),t.now)}untransitioned(){return new Dl(this.property,this.value,null,{},0)}}class Ih{constructor(t,n){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._globalState=n}getValue(t){return Ci(this._values[t].value.value)}setValue(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Au(this._values[t].property,this._globalState)),this._values[t].value=new ao(this._values[t].property,n===null?void 0:Ci(n),this._globalState)}getTransition(t){return Ci(this._values[t].transition)}setTransition(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Au(this._values[t].property,this._globalState)),this._values[t].transition=Ci(n)||void 0}serialize(){const t={};for(const n of Object.keys(this._values)){const l=this.getValue(n);l!==void 0&&(t[n]=l);const h=this.getTransition(n);h!==void 0&&(t[`${n}${Ps}`]=h)}return t}transitioned(t,n){const l=new Rl(this._properties);for(const h of Object.keys(this._values))l._values[h]=this._values[h].transitioned(t,n._values[h]);return l}untransitioned(){const t=new Rl(this._properties);for(const n of Object.keys(this._values))t._values[n]=this._values[n].untransitioned();return t}}class Dl{constructor(t,n,l,h,m){this.property=t,this.value=n,this.begin=m+h.delay||0,this.end=this.begin+h.duration||0,t.specification.transition&&(h.delay||h.duration)&&(this.prior=l)}possiblyEvaluate(t,n,l){const h=t.now||0,m=this.value.possiblyEvaluate(t,n,l),y=this.prior;if(y){if(h>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(h<this.begin)return y.possiblyEvaluate(t,n,l);{const w=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(t,n,l),m,be(w))}}return m}}class Rl{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,n,l){const h=new Rs(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,n,l);return h}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class qd{constructor(t,n){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._globalState=n}hasValue(t){return this._values[t].value!==void 0}getValue(t){return Ci(this._values[t].value)}setValue(t,n){this._values[t]=new ao(this._values[t].property,n===null?void 0:Ci(n),this._globalState)}serialize(){const t={};for(const n of Object.keys(this._values)){const l=this.getValue(n);l!==void 0&&(t[n]=l)}return t}possiblyEvaluate(t,n,l){const h=new Rs(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,n,l);return h}}class Ds{constructor(t,n,l){this.property=t,this.value=n,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,n,l,h){return this.property.evaluate(this.value,this.parameters,t,n,l,h)}}class Rs{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Re{constructor(t){this.specification=t}possiblyEvaluate(t,n){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(n)}interpolate(t,n,l){const h=$s[this.specification.type];return h?h(t,n,l):t}}class Ve{constructor(t,n){this.specification=t,this.overrides=n}possiblyEvaluate(t,n,l,h){return new Ds(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(n,null,{},l,h)}:t.expression,n)}interpolate(t,n,l){if(t.value.kind!=="constant"||n.value.kind!=="constant")return t;if(t.value.value===void 0||n.value.value===void 0)return new Ds(this,{kind:"constant",value:void 0},t.parameters);const h=$s[this.specification.type];if(h){const m=h(t.value.value,n.value.value,l);return new Ds(this,{kind:"constant",value:m},t.parameters)}return t}evaluate(t,n,l,h,m,y){return t.kind==="constant"?t.value:t.evaluate(n,l,h,m,y)}}class Il extends Ve{possiblyEvaluate(t,n,l,h){if(t.value===void 0)return new Ds(this,{kind:"constant",value:void 0},n);if(t.expression.kind==="constant"){const m=t.expression.evaluate(n,null,{},l,h),y=t.property.specification.type==="resolvedImage"&&typeof m!="string"?m.name:m,w=this._calculate(y,y,y,n);return new Ds(this,{kind:"constant",value:w},n)}if(t.expression.kind==="camera"){const m=this._calculate(t.expression.evaluate({zoom:n.zoom-1}),t.expression.evaluate({zoom:n.zoom}),t.expression.evaluate({zoom:n.zoom+1}),n);return new Ds(this,{kind:"constant",value:m},n)}return new Ds(this,t.expression,n)}evaluate(t,n,l,h,m,y){if(t.kind==="source"){const w=t.evaluate(n,l,h,m,y);return this._calculate(w,w,w,n)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(n.zoom)-1},l,h),t.evaluate({zoom:Math.floor(n.zoom)},l,h),t.evaluate({zoom:Math.floor(n.zoom)+1},l,h),n):t.value}_calculate(t,n,l,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:l,to:n}}interpolate(t){return t}}class zh{constructor(t){this.specification=t}possiblyEvaluate(t,n,l,h){if(t.value!==void 0){if(t.expression.kind==="constant"){const m=t.expression.evaluate(n,null,{},l,h);return this._calculate(m,m,m,n)}return this._calculate(t.expression.evaluate(new kn(Math.floor(n.zoom-1),n)),t.expression.evaluate(new kn(Math.floor(n.zoom),n)),t.expression.evaluate(new kn(Math.floor(n.zoom+1),n)),n)}}_calculate(t,n,l,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:l,to:n}}interpolate(t){return t}}class mr{constructor(t){this.specification=t}possiblyEvaluate(t,n,l,h){return!!t.expression.evaluate(n,null,{},l,h)}interpolate(){return!1}}class ti{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in t){const l=t[n];l.specification.overridable&&this.overridableProperties.push(n);const h=this.defaultPropertyValues[n]=new ao(l,void 0,void 0),m=this.defaultTransitionablePropertyValues[n]=new Au(l,void 0);this.defaultTransitioningPropertyValues[n]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=h.possiblyEvaluate({})}}}Me("DataDrivenProperty",Ve),Me("DataConstantProperty",Re),Me("CrossFadedDataDrivenProperty",Il),Me("CrossFadedProperty",zh),Me("ColorRampProperty",mr);class Xi extends Ft{constructor(t,n,l){if(super(),this.id=t.id,this.type=t.type,this._globalState=l,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter,this._featureFilter=ts(t.filter,l)),n.layout&&(this._unevaluatedLayout=new qd(n.layout,l)),n.paint)){this._transitionablePaint=new Ih(n.paint,l);for(const h in t.paint)this.setPaintProperty(h,t.paint[h],{validate:!1});for(const h in t.layout)this.setLayoutProperty(h,t.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Rs(n.paint)}}setFilter(t){this.filter=t,this._featureFilter=ts(t,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}getLayoutAffectingGlobalStateRefs(){const t=new Set;if(this._unevaluatedLayout)for(const n in this._unevaluatedLayout._values){const l=this._unevaluatedLayout._values[n];for(const h of l.getGlobalStateRefs())t.add(h)}for(const n of this._featureFilter.getGlobalStateRefs())t.add(n);return t}getPaintAffectingGlobalStateRefs(){var t;const n=new globalThis.Map;if(this._transitionablePaint)for(const l in this._transitionablePaint._values){const h=this._transitionablePaint._values[l].value;for(const m of h.getGlobalStateRefs()){const y=(t=n.get(m))!==null&&t!==void 0?t:[];y.push({name:l,value:h.value}),n.set(m,y)}}return n}setLayoutProperty(t,n,l={}){n!=null&&this._validate(Ud,`layers.${this.id}.layout.${t}`,t,n,l)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,n):this.visibility=n)}getPaintProperty(t){return t.endsWith(Ps)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,n,l={}){if(n!=null&&this._validate(Tu,`layers.${this.id}.paint.${t}`,t,n,l))return!1;if(t.endsWith(Ps))return this._transitionablePaint.setTransition(t.slice(0,-11),n||void 0),!1;{const h=this._transitionablePaint._values[t],m=h.property.specification["property-type"]==="cross-faded-data-driven",y=h.value.isDataDriven(),w=h.value;this._transitionablePaint.setValue(t,n),this._handleSpecialPaintPropertyUpdate(t);const C=this._transitionablePaint._values[t].value;return C.isDataDriven()||y||m||this._handleOverridablePaintPropertyUpdate(t,w,C)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,n,l){return!1}isHidden(t,n=!1){return!!(this.minzoom&&t<(n?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,n){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,n)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),br(t,((n,l)=>!(n===void 0||l==="layout"&&!Object.keys(n).length||l==="paint"&&!Object.keys(n).length)))}_validate(t,n,l,h,m={}){return(!m||m.validate!==!1)&&Ia(this,t.call(As,{key:n,layerType:this.type,objectKey:l,value:h,styleSpec:ht,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const n=this.paint.get(t);if(n instanceof Ds&&Io(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}}let Lh;var op={get paint(){return Lh=Lh||new ti({"raster-opacity":new Re(ht.paint_raster["raster-opacity"]),"raster-hue-rotate":new Re(ht.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Re(ht.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Re(ht.paint_raster["raster-brightness-max"]),"raster-saturation":new Re(ht.paint_raster["raster-saturation"]),"raster-contrast":new Re(ht.paint_raster["raster-contrast"]),"raster-resampling":new Re(ht.paint_raster["raster-resampling"]),"raster-fade-duration":new Re(ht.paint_raster["raster-fade-duration"])})}};class Vo extends Xi{constructor(t,n){super(t,op,n)}}const ds={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class oi{constructor(t,n){this._structArray=t,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class In{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,n){return t._trim(),n&&(t.isTransferred=!0,n.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const n=Object.create(this.prototype);return n.arrayBuffer=t.arrayBuffer,n.length=t.length,n.capacity=t.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Fn(r,t=1){let n=0,l=0;return{members:r.map((h=>{const m=ds[h.type].BYTES_PER_ELEMENT,y=n=on(n,Math.max(t,m)),w=h.components||1;return l=Math.max(l,m),n+=m*w,{name:h.name,type:h.type,components:w,offset:y}})),size:on(n,Math.max(l,t)),alignment:t}}function on(r,t){return Math.ceil(r/t)*t}class zn extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n){const l=this.length;return this.resize(l+1),this.emplace(l,t,n)}emplace(t,n,l){const h=2*t;return this.int16[h+0]=n,this.int16[h+1]=l,t}}zn.prototype.bytesPerElement=4,Me("StructArrayLayout2i4",zn);class hi extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,l)}emplace(t,n,l,h){const m=3*t;return this.int16[m+0]=n,this.int16[m+1]=l,this.int16[m+2]=h,t}}hi.prototype.bytesPerElement=6,Me("StructArrayLayout3i6",hi);class Tc extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,n,l,h)}emplace(t,n,l,h,m){const y=4*t;return this.int16[y+0]=n,this.int16[y+1]=l,this.int16[y+2]=h,this.int16[y+3]=m,t}}Tc.prototype.bytesPerElement=8,Me("StructArrayLayout4i8",Tc);class Uo extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m,y){const w=this.length;return this.resize(w+1),this.emplace(w,t,n,l,h,m,y)}emplace(t,n,l,h,m,y,w){const C=6*t;return this.int16[C+0]=n,this.int16[C+1]=l,this.int16[C+2]=h,this.int16[C+3]=m,this.int16[C+4]=y,this.int16[C+5]=w,t}}Uo.prototype.bytesPerElement=12,Me("StructArrayLayout2i4i12",Uo);class jr extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m,y){const w=this.length;return this.resize(w+1),this.emplace(w,t,n,l,h,m,y)}emplace(t,n,l,h,m,y,w){const C=4*t,D=8*t;return this.int16[C+0]=n,this.int16[C+1]=l,this.uint8[D+4]=h,this.uint8[D+5]=m,this.uint8[D+6]=y,this.uint8[D+7]=w,t}}jr.prototype.bytesPerElement=8,Me("StructArrayLayout2i4ub8",jr);class oo extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n){const l=this.length;return this.resize(l+1),this.emplace(l,t,n)}emplace(t,n,l){const h=2*t;return this.float32[h+0]=n,this.float32[h+1]=l,t}}oo.prototype.bytesPerElement=8,Me("StructArrayLayout2f8",oo);class lo extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m,y,w,C,D,z){const N=this.length;return this.resize(N+1),this.emplace(N,t,n,l,h,m,y,w,C,D,z)}emplace(t,n,l,h,m,y,w,C,D,z,N){const V=10*t;return this.uint16[V+0]=n,this.uint16[V+1]=l,this.uint16[V+2]=h,this.uint16[V+3]=m,this.uint16[V+4]=y,this.uint16[V+5]=w,this.uint16[V+6]=C,this.uint16[V+7]=D,this.uint16[V+8]=z,this.uint16[V+9]=N,t}}lo.prototype.bytesPerElement=20,Me("StructArrayLayout10ui20",lo);class co extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m,y,w,C){const D=this.length;return this.resize(D+1),this.emplace(D,t,n,l,h,m,y,w,C)}emplace(t,n,l,h,m,y,w,C,D){const z=8*t;return this.uint16[z+0]=n,this.uint16[z+1]=l,this.uint16[z+2]=h,this.uint16[z+3]=m,this.uint16[z+4]=y,this.uint16[z+5]=w,this.uint16[z+6]=C,this.uint16[z+7]=D,t}}co.prototype.bytesPerElement=16,Me("StructArrayLayout8ui16",co);class Mu extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m,y,w,C,D,z,N,V){const U=this.length;return this.resize(U+1),this.emplace(U,t,n,l,h,m,y,w,C,D,z,N,V)}emplace(t,n,l,h,m,y,w,C,D,z,N,V,U){const G=12*t;return this.int16[G+0]=n,this.int16[G+1]=l,this.int16[G+2]=h,this.int16[G+3]=m,this.uint16[G+4]=y,this.uint16[G+5]=w,this.uint16[G+6]=C,this.uint16[G+7]=D,this.int16[G+8]=z,this.int16[G+9]=N,this.int16[G+10]=V,this.int16[G+11]=U,t}}Mu.prototype.bytesPerElement=24,Me("StructArrayLayout4i4ui4i24",Mu);class di extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,l)}emplace(t,n,l,h){const m=3*t;return this.float32[m+0]=n,this.float32[m+1]=l,this.float32[m+2]=h,t}}di.prototype.bytesPerElement=12,Me("StructArrayLayout3f12",di);class Go extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint32[1*t+0]=n,t}}Go.prototype.bytesPerElement=4,Me("StructArrayLayout1ul4",Go);class uo extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m,y,w,C,D){const z=this.length;return this.resize(z+1),this.emplace(z,t,n,l,h,m,y,w,C,D)}emplace(t,n,l,h,m,y,w,C,D,z){const N=10*t,V=5*t;return this.int16[N+0]=n,this.int16[N+1]=l,this.int16[N+2]=h,this.int16[N+3]=m,this.int16[N+4]=y,this.int16[N+5]=w,this.uint32[V+3]=C,this.uint16[N+8]=D,this.uint16[N+9]=z,t}}uo.prototype.bytesPerElement=20,Me("StructArrayLayout6i1ul2ui20",uo);class kh extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m,y){const w=this.length;return this.resize(w+1),this.emplace(w,t,n,l,h,m,y)}emplace(t,n,l,h,m,y,w){const C=6*t;return this.int16[C+0]=n,this.int16[C+1]=l,this.int16[C+2]=h,this.int16[C+3]=m,this.int16[C+4]=y,this.int16[C+5]=w,t}}kh.prototype.bytesPerElement=12,Me("StructArrayLayout2i2i2i12",kh);class Pu extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,t,n,l,h,m)}emplace(t,n,l,h,m,y){const w=4*t,C=8*t;return this.float32[w+0]=n,this.float32[w+1]=l,this.float32[w+2]=h,this.int16[C+6]=m,this.int16[C+7]=y,t}}Pu.prototype.bytesPerElement=16,Me("StructArrayLayout2f1f2i16",Pu);class zl extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m,y){const w=this.length;return this.resize(w+1),this.emplace(w,t,n,l,h,m,y)}emplace(t,n,l,h,m,y,w){const C=16*t,D=4*t,z=8*t;return this.uint8[C+0]=n,this.uint8[C+1]=l,this.float32[D+1]=h,this.float32[D+2]=m,this.int16[z+6]=y,this.int16[z+7]=w,t}}zl.prototype.bytesPerElement=16,Me("StructArrayLayout2ub2f2i16",zl);class Sc extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,l)}emplace(t,n,l,h){const m=3*t;return this.uint16[m+0]=n,this.uint16[m+1]=l,this.uint16[m+2]=h,t}}Sc.prototype.bytesPerElement=6,Me("StructArrayLayout3ui6",Sc);class Du extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m,y,w,C,D,z,N,V,U,G,Y,tt,at){const yt=this.length;return this.resize(yt+1),this.emplace(yt,t,n,l,h,m,y,w,C,D,z,N,V,U,G,Y,tt,at)}emplace(t,n,l,h,m,y,w,C,D,z,N,V,U,G,Y,tt,at,yt){const ct=24*t,dt=12*t,Pt=48*t;return this.int16[ct+0]=n,this.int16[ct+1]=l,this.uint16[ct+2]=h,this.uint16[ct+3]=m,this.uint32[dt+2]=y,this.uint32[dt+3]=w,this.uint32[dt+4]=C,this.uint16[ct+10]=D,this.uint16[ct+11]=z,this.uint16[ct+12]=N,this.float32[dt+7]=V,this.float32[dt+8]=U,this.uint8[Pt+36]=G,this.uint8[Pt+37]=Y,this.uint8[Pt+38]=tt,this.uint32[dt+10]=at,this.int16[ct+22]=yt,t}}Du.prototype.bytesPerElement=48,Me("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Du);class Ec extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m,y,w,C,D,z,N,V,U,G,Y,tt,at,yt,ct,dt,Pt,Dt,Zt,ue,ie,de,Se,_e){const ve=this.length;return this.resize(ve+1),this.emplace(ve,t,n,l,h,m,y,w,C,D,z,N,V,U,G,Y,tt,at,yt,ct,dt,Pt,Dt,Zt,ue,ie,de,Se,_e)}emplace(t,n,l,h,m,y,w,C,D,z,N,V,U,G,Y,tt,at,yt,ct,dt,Pt,Dt,Zt,ue,ie,de,Se,_e,ve){const re=32*t,je=16*t;return this.int16[re+0]=n,this.int16[re+1]=l,this.int16[re+2]=h,this.int16[re+3]=m,this.int16[re+4]=y,this.int16[re+5]=w,this.int16[re+6]=C,this.int16[re+7]=D,this.uint16[re+8]=z,this.uint16[re+9]=N,this.uint16[re+10]=V,this.uint16[re+11]=U,this.uint16[re+12]=G,this.uint16[re+13]=Y,this.uint16[re+14]=tt,this.uint16[re+15]=at,this.uint16[re+16]=yt,this.uint16[re+17]=ct,this.uint16[re+18]=dt,this.uint16[re+19]=Pt,this.uint16[re+20]=Dt,this.uint16[re+21]=Zt,this.uint16[re+22]=ue,this.uint32[je+12]=ie,this.float32[je+13]=de,this.float32[je+14]=Se,this.uint16[re+30]=_e,this.uint16[re+31]=ve,t}}Ec.prototype.bytesPerElement=64,Me("StructArrayLayout8i15ui1ul2f2ui64",Ec);class sr extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.float32[1*t+0]=n,t}}sr.prototype.bytesPerElement=4,Me("StructArrayLayout1f4",sr);class v extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,l)}emplace(t,n,l,h){const m=3*t;return this.uint16[6*t+0]=n,this.float32[m+1]=l,this.float32[m+2]=h,t}}v.prototype.bytesPerElement=12,Me("StructArrayLayout1ui2f12",v);class e extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,l)}emplace(t,n,l,h){const m=4*t;return this.uint32[2*t+0]=n,this.uint16[m+2]=l,this.uint16[m+3]=h,t}}e.prototype.bytesPerElement=8,Me("StructArrayLayout1ul2ui8",e);class a extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n){const l=this.length;return this.resize(l+1),this.emplace(l,t,n)}emplace(t,n,l){const h=2*t;return this.uint16[h+0]=n,this.uint16[h+1]=l,t}}a.prototype.bytesPerElement=4,Me("StructArrayLayout2ui4",a);class d extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint16[1*t+0]=n,t}}d.prototype.bytesPerElement=2,Me("StructArrayLayout1ui2",d);class g extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,n,l,h)}emplace(t,n,l,h,m){const y=4*t;return this.float32[y+0]=n,this.float32[y+1]=l,this.float32[y+2]=h,this.float32[y+3]=m,t}}g.prototype.bytesPerElement=16,Me("StructArrayLayout4f16",g);class x extends oi{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new L(this.anchorPointX,this.anchorPointY)}}x.prototype.size=20;class E extends uo{get(t){return new x(this,t)}}Me("CollisionBoxArray",E);class P extends oi{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}P.prototype.size=48;class R extends Du{get(t){return new P(this,t)}}Me("PlacedSymbolArray",R);class O extends oi{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}O.prototype.size=64;class j extends Ec{get(t){return new O(this,t)}}Me("SymbolInstanceArray",j);class $ extends sr{getoffsetX(t){return this.float32[1*t+0]}}Me("GlyphOffsetArray",$);class q extends hi{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Me("SymbolLineVertexArray",q);class Q extends oi{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Q.prototype.size=12;class nt extends v{get(t){return new Q(this,t)}}Me("TextAnchorOffsetArray",nt);class lt extends oi{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}lt.prototype.size=8;class ut extends e{get(t){return new lt(this,t)}}Me("FeatureIndexArray",ut);class ft extends zn{}class _t extends zn{}class Tt extends zn{}class gt extends Uo{}class St extends jr{}class At extends oo{}class xt extends lo{}class zt extends co{}class $t extends Mu{}class Vt extends di{}class Ut extends Go{}class qt extends kh{}class ge extends zl{}class ye extends Sc{}class oe extends a{}const De=Fn([{name:"a_pos",components:2,type:"Int16"}],4),{members:tn}=De;class Ke{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,n,l,h){const m=this.segments[this.segments.length-1];return t>Ke.MAX_VERTEX_ARRAY_LENGTH&&Nn(`Max vertices per segment is ${Ke.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Ke.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!m||m.vertexLength+t>Ke.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==h?this.createNewSegment(n,l,h):m}createNewSegment(t,n,l){const h={vertexOffset:t.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0,vaos:{}};return l!==void 0&&(h.sortKey=l),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(h),h}getOrCreateLatestSegment(t,n,l){return this.prepareSegment(0,t,n,l)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const n in t.vaos)t.vaos[n].destroy()}static simpleSegment(t,n,l,h){return new Ke([{vertexOffset:t,primitiveOffset:n,vertexLength:l,primitiveLength:h,vaos:{},sortKey:0}])}}function ei(r,t){return 256*(r=$e(Math.floor(r),0,255))+$e(Math.floor(t),0,255)}Ke.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Me("SegmentVector",Ke);const Hn=Fn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),li=Fn([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var Vn,Ii,ii,_i={exports:{}},vi={exports:{}},Ti={exports:{}},Sr=(function(){if(ii)return _i.exports;ii=1;var r=(Vn||(Vn=1,vi.exports=function(n,l){var h,m,y,w,C,D,z,N;for(m=n.length-(h=3&n.length),y=l,C=3432918353,D=461845907,N=0;N<m;)z=255&n.charCodeAt(N)|(255&n.charCodeAt(++N))<<8|(255&n.charCodeAt(++N))<<16|(255&n.charCodeAt(++N))<<24,++N,y=27492+(65535&(w=5*(65535&(y=(y^=z=(65535&(z=(z=(65535&z)*C+(((z>>>16)*C&65535)<<16)&4294967295)<<15|z>>>17))*D+(((z>>>16)*D&65535)<<16)&4294967295)<<13|y>>>19))+((5*(y>>>16)&65535)<<16)&4294967295))+((58964+(w>>>16)&65535)<<16);switch(z=0,h){case 3:z^=(255&n.charCodeAt(N+2))<<16;case 2:z^=(255&n.charCodeAt(N+1))<<8;case 1:y^=z=(65535&(z=(z=(65535&(z^=255&n.charCodeAt(N)))*C+(((z>>>16)*C&65535)<<16)&4294967295)<<15|z>>>17))*D+(((z>>>16)*D&65535)<<16)&4294967295}return y^=n.length,y=2246822507*(65535&(y^=y>>>16))+((2246822507*(y>>>16)&65535)<<16)&4294967295,y=3266489909*(65535&(y^=y>>>13))+((3266489909*(y>>>16)&65535)<<16)&4294967295,(y^=y>>>16)>>>0}),vi.exports),t=(Ii||(Ii=1,Ti.exports=function(n,l){for(var h,m=n.length,y=l^m,w=0;m>=4;)h=1540483477*(65535&(h=255&n.charCodeAt(w)|(255&n.charCodeAt(++w))<<8|(255&n.charCodeAt(++w))<<16|(255&n.charCodeAt(++w))<<24))+((1540483477*(h>>>16)&65535)<<16),y=1540483477*(65535&y)+((1540483477*(y>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),m-=4,++w;switch(m){case 3:y^=(255&n.charCodeAt(w+2))<<16;case 2:y^=(255&n.charCodeAt(w+1))<<8;case 1:y=1540483477*(65535&(y^=255&n.charCodeAt(w)))+((1540483477*(y>>>16)&65535)<<16)}return y=1540483477*(65535&(y^=y>>>13))+((1540483477*(y>>>16)&65535)<<16),(y^=y>>>15)>>>0}),Ti.exports);return _i.exports=r,_i.exports.murmur3=r,_i.exports.murmur2=t,_i.exports})(),ka=k(Sr);class Js{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,n,l,h){this.ids.push(qo(t)),this.positions.push(n,l,h)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const n=qo(t);let l=0,h=this.ids.length-1;for(;l<h;){const y=l+h>>1;this.ids[y]>=n?h=y:l=y+1}const m=[];for(;this.ids[l]===n;)m.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return m}static serialize(t,n){const l=new Float64Array(t.ids),h=new Uint32Array(t.positions);return Oa(l,h,0,l.length-1),n&&n.push(l.buffer,h.buffer),{ids:l,positions:h}}static deserialize(t){const n=new Js;return n.ids=t.ids,n.positions=t.positions,n.indexed=!0,n}}function qo(r){const t=+r;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:ka(String(r))}function Oa(r,t,n,l){for(;n<l;){const h=r[n+l>>1];let m=n-1,y=l+1;for(;;){do m++;while(r[m]<h);do y--;while(r[y]>h);if(m>=y)break;Zo(r,m,y),Zo(t,3*m,3*y),Zo(t,3*m+1,3*y+1),Zo(t,3*m+2,3*y+2)}y-n<l-y?(Oa(r,t,n,y),n=y+1):(Oa(r,t,y+1,l),l=y)}}function Zo(r,t,n){const l=r[t];r[t]=r[n],r[n]=l}Me("FeaturePositionMap",Js);class fs{constructor(t,n){this.gl=t.gl,this.location=n}}class ta extends fs{constructor(t,n){super(t,n),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class is extends fs{constructor(t,n){super(t,n),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Na extends fs{constructor(t,n){super(t,n),this.current=hn.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const Ll=new Float32Array(16);function kl(r){return[ei(255*r.r,255*r.g),ei(255*r.b,255*r.a)]}class fi{constructor(t,n,l){this.value=t,this.uniformNames=n.map((h=>`u_${h}`)),this.type=l}setUniform(t,n,l){t.set(l.constantOr(this.value))}getBinding(t,n,l){return this.type==="color"?new Na(t,n):new ta(t,n)}}class Xn{constructor(t,n){this.uniformNames=n.map((l=>`u_${l}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=t.tlbr}setConstantDashPositions(t,n){this.dashTo=[0,t.y,t.height,t.width],this.dashFrom=[0,n.y,n.height,n.width]}setUniform(t,n,l,h){let m=null;h==="u_pattern_to"?m=this.patternTo:h==="u_pattern_from"?m=this.patternFrom:h==="u_dasharray_to"?m=this.dashTo:h==="u_dasharray_from"?m=this.dashFrom:h==="u_pixel_ratio_to"?m=this.pixelRatioTo:h==="u_pixel_ratio_from"&&(m=this.pixelRatioFrom),m!==null&&t.set(m)}getBinding(t,n,l){return l.substr(0,9)==="u_pattern"||l.substr(0,12)==="u_dasharray_"?new is(t,n):new ta(t,n)}}class Si{constructor(t,n,l,h){this.expression=t,this.type=l,this.maxValue=0,this.paintVertexAttributes=n.map((m=>({name:`a_${m}`,type:"Float32",components:l==="color"?2:1,offset:0}))),this.paintVertexArray=new h}populatePaintArray(t,n,l){const h=this.paintVertexArray.length,m=this.expression.evaluate(new kn(0,l),n,{},l.canonical,[],l.formattedSection);this.paintVertexArray.resize(t),this._setPaintValue(h,t,m)}updatePaintArray(t,n,l,h,m){const y=this.expression.evaluate(new kn(0,m),l,h);this._setPaintValue(t,n,y)}_setPaintValue(t,n,l){if(this.type==="color"){const h=kl(l);for(let m=t;m<n;m++)this.paintVertexArray.emplace(m,h[0],h[1])}else{for(let h=t;h<n;h++)this.paintVertexArray.emplace(h,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class On{constructor(t,n,l,h,m,y){this.expression=t,this.uniformNames=n.map((w=>`u_${w}_t`)),this.type=l,this.useIntegerZoom=h,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=n.map((w=>({name:`a_${w}`,type:"Float32",components:l==="color"?4:2,offset:0}))),this.paintVertexArray=new y}populatePaintArray(t,n,l){const h=this.expression.evaluate(new kn(this.zoom,l),n,{},l.canonical,[],l.formattedSection),m=this.expression.evaluate(new kn(this.zoom+1,l),n,{},l.canonical,[],l.formattedSection),y=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(y,t,h,m)}updatePaintArray(t,n,l,h,m){const y=this.expression.evaluate(new kn(this.zoom,m),l,h),w=this.expression.evaluate(new kn(this.zoom+1,m),l,h);this._setPaintValue(t,n,y,w)}_setPaintValue(t,n,l,h){if(this.type==="color"){const m=kl(l),y=kl(h);for(let w=t;w<n;w++)this.paintVertexArray.emplace(w,m[0],m[1],y[0],y[1])}else{for(let m=t;m<n;m++)this.paintVertexArray.emplace(m,l,h);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,n){const l=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,h=$e(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);t.set(h)}getBinding(t,n,l){return new ta(t,n)}}class ho{constructor(t,n,l,h,m,y){this.expression=t,this.type=n,this.useIntegerZoom=l,this.zoom=h,this.layerId=y,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(t,n,l){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(h,t,this.getPositionIds(n),l)}updatePaintArray(t,n,l,h,m){this._setPaintValues(t,n,this.getPositionIds(l),m)}_setPaintValues(t,n,l,h){const m=this.getPositions(h);if(!m||!l)return;const y=m[l.min],w=m[l.mid],C=m[l.max];if(y&&w&&C)for(let D=t;D<n;D++)this.emplace(this.zoomInPaintVertexArray,D,w,y),this.emplace(this.zoomOutPaintVertexArray,D,w,C)}upload(t){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const n=this.getVertexAttributes();this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,n,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,n,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Zd extends ho{getPositions(t){return t.imagePositions}getPositionIds(t){return t.patterns&&t.patterns[this.layerId]}getVertexAttributes(){return Hn.members}emplace(t,n,l,h){t.emplace(n,l.tlbr[0],l.tlbr[1],l.tlbr[2],l.tlbr[3],h.tlbr[0],h.tlbr[1],h.tlbr[2],h.tlbr[3],l.pixelRatio,h.pixelRatio)}}class Cc extends ho{getPositions(t){return t.dashPositions}getPositionIds(t){return t.dashes&&t.dashes[this.layerId]}getVertexAttributes(){return li.members}emplace(t,n,l,h){t.emplace(n,0,l.y,l.height,l.width,0,h.y,h.height,h.width)}}class $d{constructor(t,n,l){this.binders={},this._buffers=[];const h=[];for(const m in t.paint._values){if(!l(m))continue;const y=t.paint.get(m);if(!(y instanceof Ds&&Io(y.property.specification)))continue;const w=lp(m,t.type),C=y.value,D=y.property.specification.type,z=y.property.useIntegerZoom,N=y.property.specification["property-type"],V=N==="cross-faded"||N==="cross-faded-data-driven";if(C.kind==="constant")this.binders[m]=V?new Xn(C.value,w):new fi(C.value,w,D),h.push(`/u_${m}`);else if(C.kind==="source"||V){const U=Fa(m,D,"source");this.binders[m]=V?m==="line-dasharray"?new Cc(C,D,z,n,U,t.id):new Zd(C,D,z,n,U,t.id):new Si(C,w,D,U),h.push(`/a_${m}`)}else{const U=Fa(m,D,"composite");this.binders[m]=new On(C,w,D,z,n,U),h.push(`/z_${m}`)}}this.cacheKey=h.sort().join("")}getMaxValue(t){const n=this.binders[t];return n instanceof Si||n instanceof On?n.maxValue:0}populatePaintArrays(t,n,l){for(const h in this.binders){const m=this.binders[h];(m instanceof Si||m instanceof On||m instanceof ho)&&m.populatePaintArray(t,n,l)}}setConstantPatternPositions(t,n){for(const l in this.binders){const h=this.binders[l];h instanceof Xn&&h.setConstantPatternPositions(t,n)}}setConstantDashPositions(t,n){for(const l in this.binders){const h=this.binders[l];h instanceof Xn&&h.setConstantDashPositions(t,n)}}updatePaintArrays(t,n,l,h,m){let y=!1;for(const w in t){const C=n.getPositions(w);for(const D of C){const z=l.feature(D.index);for(const N in this.binders){const V=this.binders[N];if((V instanceof Si||V instanceof On||V instanceof ho)&&V.expression.isStateDependent===!0){const U=h.paint.get(N);V.expression=U.value,V.updatePaintArray(D.start,D.end,z,t[w],m),y=!0}}}}return y}defines(){const t=[];for(const n in this.binders){const l=this.binders[n];(l instanceof fi||l instanceof Xn)&&t.push(...l.uniformNames.map((h=>`#define HAS_UNIFORM_${h}`)))}return t}getBinderAttributes(){const t=[];for(const n in this.binders){const l=this.binders[n];if(l instanceof Si||l instanceof On)for(let h=0;h<l.paintVertexAttributes.length;h++)t.push(l.paintVertexAttributes[h].name);else if(l instanceof ho){const h=l.getVertexAttributes();for(const m of h)t.push(m.name)}}return t}getBinderUniforms(){const t=[];for(const n in this.binders){const l=this.binders[n];if(l instanceof fi||l instanceof Xn||l instanceof On)for(const h of l.uniformNames)t.push(h)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,n){const l=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof fi||m instanceof Xn||m instanceof On){for(const y of m.uniformNames)if(n[y]){const w=m.getBinding(t,n[y],y);l.push({name:y,property:h,binding:w})}}}return l}setUniforms(t,n,l,h){for(const{name:m,property:y,binding:w}of n)this.binders[y].setUniform(w,h,l.get(y),m)}updatePaintBuffers(t){this._buffers=[];for(const n in this.binders){const l=this.binders[n];if(t&&l instanceof ho){const h=t.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(l instanceof Si||l instanceof On)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(t){for(const n in this.binders){const l=this.binders[n];(l instanceof Si||l instanceof On||l instanceof ho)&&l.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const n=this.binders[t];(n instanceof Si||n instanceof On||n instanceof ho)&&n.destroy()}}}class fo{constructor(t,n,l=()=>!0){this.programConfigurations={};for(const h of t)this.programConfigurations[h.id]=new $d(h,n,l);this.needsUpload=!1,this._featureMap=new Js,this._bufferOffset=0}populatePaintArrays(t,n,l,h){for(const m in this.programConfigurations)this.programConfigurations[m].populatePaintArrays(t,n,h);n.id!==void 0&&this._featureMap.add(n.id,l,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,n,l,h){for(const m of l)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(t,this._featureMap,n,m,h)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function lp(r,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${t}-`,"").replace(/-/g,"_")]}function Fa(r,t,n){const l={color:{source:oo,composite:g},number:{source:sr,composite:oo}},h=(function(m){return{"line-pattern":{source:xt,composite:xt},"fill-pattern":{source:xt,composite:xt},"fill-extrusion-pattern":{source:xt,composite:xt},"line-dasharray":{source:zt,composite:zt}}[m]})(r);return h&&h[n]||l[t][n]}Me("ConstantBinder",fi),Me("CrossFadedConstantBinder",Xn),Me("SourceExpressionBinder",Si),Me("CrossFadedPatternBinder",Zd),Me("CrossFadedDasharrayBinder",Cc),Me("CompositeExpressionBinder",On),Me("ProgramConfiguration",$d,{omit:["_buffers"]}),Me("ProgramConfigurationSet",fo);const Ac=Math.pow(2,14)-1,Oh=-Ac-1;function po(r){const t=we/r.extent,n=r.loadGeometry();for(let l=0;l<n.length;l++){const h=n[l];for(let m=0;m<h.length;m++){const y=h[m],w=Math.round(y.x*t),C=Math.round(y.y*t);y.x=$e(w,Oh,Ac),y.y=$e(C,Oh,Ac),(w<y.x||w>y.x+1||C<y.y||C>y.y+1)&&Nn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function Br(r,t){return{type:r.type,id:r.id,properties:r.properties,geometry:t?po(r):[]}}const Nh=-32768;function Fh(r,t,n,l,h){r.emplaceBack(Nh+8*t+l,Nh+8*n+h)}class cp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=t.index,this.hasDependencies=!1,this.layoutVertexArray=new _t,this.indexArray=new ye,this.segments=new Ke,this.programConfigurations=new fo(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(t,n,l){const h=this.layers[0],m=[];let y=null,w=!1,C=h.type==="heatmap";if(h.type==="circle"){const z=h;y=z.layout.get("circle-sort-key"),w=!y.isConstant(),C=C||z.paint.get("circle-pitch-alignment")==="map"}const D=C?n.subdivisionGranularity.circle:1;for(const{feature:z,id:N,index:V,sourceLayerIndex:U}of t){const G=this.layers[0]._featureFilter.needGeometry,Y=Br(z,G);if(!this.layers[0]._featureFilter.filter(new kn(this.zoom),Y,l))continue;const tt=w?y.evaluate(Y,{},l):void 0,at={id:N,properties:z.properties,type:z.type,sourceLayerIndex:U,index:V,geometry:G?Y.geometry:po(z),patterns:{},sortKey:tt};m.push(at)}w&&m.sort(((z,N)=>z.sortKey-N.sortKey));for(const z of m){const{geometry:N,index:V,sourceLayerIndex:U}=z,G=t[V].feature;this.addFeature(z,N,V,l,D),n.featureIndex.insert(G,N,V,U,this.index)}}update(t,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,{imagePositions:l})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,tn),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,n,l,h,m=1){let y;switch(m){case 1:y=[0,7];break;case 3:y=[0,2,5,7];break;case 5:y=[0,1,3,4,6,7];break;case 7:y=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${m}; valid values are 1, 3, 5, 7.`)}const w=y.length;for(const C of n)for(const D of C){const z=D.x,N=D.y;if(z<0||z>=we||N<0||N>=we)continue;const V=this.segments.prepareSegment(w*w,this.layoutVertexArray,this.indexArray,t.sortKey),U=V.vertexLength;for(let G=0;G<w;G++)for(let Y=0;Y<w;Y++)Fh(this.layoutVertexArray,z,N,y[Y],y[G]);for(let G=0;G<w-1;G++)for(let Y=0;Y<w-1;Y++){const tt=U+G*w+Y,at=U+(G+1)*w+Y;this.indexArray.emplaceBack(tt,at+1,tt+1),this.indexArray.emplaceBack(tt,at,at+1)}V.vertexLength+=w*w,V.primitiveLength+=(w-1)*(w-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{imagePositions:{},canonical:h})}}function Hd(r,t){for(let n=0;n<r.length;n++)if(Ru(t,r[n]))return!0;for(let n=0;n<t.length;n++)if(Ru(r,t[n]))return!0;return!!hp(r,t)}function Xd(r,t,n){return!!Ru(r,t)||!!Yd(t,r,n)}function up(r,t){if(r.length===1)return Er(t,r[0]);for(let n=0;n<t.length;n++){const l=t[n];for(let h=0;h<l.length;h++)if(Ru(r,l[h]))return!0}for(let n=0;n<r.length;n++)if(Er(t,r[n]))return!0;for(let n=0;n<t.length;n++)if(hp(r,t[n]))return!0;return!1}function dy(r,t,n){if(r.length>1){if(hp(r,t))return!0;for(let l=0;l<t.length;l++)if(Yd(t[l],r,n))return!0}for(let l=0;l<r.length;l++)if(Yd(r[l],t,n))return!0;return!1}function hp(r,t){if(r.length===0||t.length===0)return!1;for(let n=0;n<r.length-1;n++){const l=r[n],h=r[n+1];for(let m=0;m<t.length-1;m++)if(bv(l,h,t[m],t[m+1]))return!0}return!1}function bv(r,t,n,l){return os(r,n,l)!==os(t,n,l)&&os(r,t,n)!==os(r,t,l)}function Yd(r,t,n){const l=n*n;if(t.length===1)return r.distSqr(t[0])<l;for(let h=1;h<t.length;h++)if(Yi(r,t[h-1],t[h])<l)return!0;return!1}function Yi(r,t,n){const l=t.distSqr(n);if(l===0)return r.distSqr(t);const h=((r.x-t.x)*(n.x-t.x)+(r.y-t.y)*(n.y-t.y))/l;return r.distSqr(h<0?t:h>1?n:n.sub(t)._mult(h)._add(t))}function Er(r,t){let n,l,h,m=!1;for(let y=0;y<r.length;y++){n=r[y];for(let w=0,C=n.length-1;w<n.length;C=w++)l=n[w],h=n[C],l.y>t.y!=h.y>t.y&&t.x<(h.x-l.x)*(t.y-l.y)/(h.y-l.y)+l.x&&(m=!m)}return m}function Ru(r,t){let n=!1;for(let l=0,h=r.length-1;l<r.length;h=l++){const m=r[l],y=r[h];m.y>t.y!=y.y>t.y&&t.x<(y.x-m.x)*(t.y-m.y)/(y.y-m.y)+m.x&&(n=!n)}return n}function fy(r,t,n){const l=n[0],h=n[2];if(r.x<l.x&&t.x<l.x||r.x>h.x&&t.x>h.x||r.y<l.y&&t.y<l.y||r.y>h.y&&t.y>h.y)return!1;const m=os(r,t,n[0]);return m!==os(r,t,n[1])||m!==os(r,t,n[2])||m!==os(r,t,n[3])}function Iu(r,t,n){const l=t.paint.get(r).value;return l.kind==="constant"?l.value:n.programConfigurations.get(t.id).getMaxValue(r)}function Wd(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function Mc(r,t,n,l,h){if(!t[0]&&!t[1])return r;const m=L.convert(t)._mult(h);n==="viewport"&&m._rotate(-l);const y=[];for(let w=0;w<r.length;w++)y.push(r[w].sub(m));return y}function py({queryGeometry:r,size:t},n){return Xd(r,n,t)}function dp({queryGeometry:r,size:t,transform:n,unwrappedTileID:l,getElevation:h},m){return Xd(r,m,t*(n.projectTileCoordinates(m.x,m.y,l,h).signedDistanceFromCamera/n.cameraToCenterDistance))}function my({queryGeometry:r,size:t,transform:n,unwrappedTileID:l,getElevation:h},m){const y=n.projectTileCoordinates(m.x,m.y,l,h).signedDistanceFromCamera,w=t*(n.cameraToCenterDistance/y);return Xd(r,Qd(m,n,l,h),w)}function wv({queryGeometry:r,size:t,transform:n,unwrappedTileID:l,getElevation:h},m){return Xd(r,Qd(m,n,l,h),t)}function Kd({queryGeometry:r,size:t,transform:n,unwrappedTileID:l,getElevation:h,pitchAlignment:m="map",pitchScale:y="map"},w){const C=m==="map"?y==="map"?py:dp:y==="map"?my:wv,D={queryGeometry:r,size:t,transform:n,unwrappedTileID:l,getElevation:h};for(const z of w)for(const N of z)if(C(D,N))return!0;return!1}function Qd(r,t,n,l){const h=t.projectTileCoordinates(r.x,r.y,n,l).point;return new L((.5*h.x+.5)*t.width,(.5*-h.y+.5)*t.height)}let Am,Mm;Me("CircleBucket",cp,{omit:["layers"]});var gy={get paint(){return Mm=Mm||new ti({"circle-radius":new Ve(ht.paint_circle["circle-radius"]),"circle-color":new Ve(ht.paint_circle["circle-color"]),"circle-blur":new Ve(ht.paint_circle["circle-blur"]),"circle-opacity":new Ve(ht.paint_circle["circle-opacity"]),"circle-translate":new Re(ht.paint_circle["circle-translate"]),"circle-translate-anchor":new Re(ht.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Re(ht.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Re(ht.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ve(ht.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ve(ht.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ve(ht.paint_circle["circle-stroke-opacity"])})},get layout(){return Am=Am||new ti({"circle-sort-key":new Ve(ht.layout_circle["circle-sort-key"])})}};class Pm extends Xi{constructor(t,n){super(t,gy,n)}createBucket(t){return new cp(t)}queryRadius(t){const n=t;return Iu("circle-radius",this,n)+Iu("circle-stroke-width",this,n)+Wd(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:l,geometry:h,transform:m,pixelsToTileUnits:y,unwrappedTileID:w,getElevation:C}){const D=Mc(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-m.bearingInRadians,y),z=this.paint.get("circle-radius").evaluate(n,l)+this.paint.get("circle-stroke-width").evaluate(n,l),N=this.paint.get("circle-pitch-scale"),V=this.paint.get("circle-pitch-alignment");let U,G;return V==="map"?(U=D,G=z*y):(U=(function(Y,tt,at,yt){return Y.map((ct=>Qd(ct,tt,at,yt)))})(D,m,w,C),G=z),Kd({queryGeometry:U,size:G,transform:m,unwrappedTileID:w,getElevation:C,pitchAlignment:V,pitchScale:N},h)}}class fp extends cp{}let pp;Me("HeatmapBucket",fp,{omit:["layers"]});var yy={get paint(){return pp=pp||new ti({"heatmap-radius":new Ve(ht.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ve(ht.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Re(ht.paint_heatmap["heatmap-intensity"]),"heatmap-color":new mr(ht.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Re(ht.paint_heatmap["heatmap-opacity"])})}};function Jd(r,{width:t,height:n},l,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==t*n*l)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${t*n*l}`)}else h=new Uint8Array(t*n*l);return r.width=t,r.height=n,r.data=h,r}function tf(r,{width:t,height:n},l){if(t===r.width&&n===r.height)return;const h=Jd({},{width:t,height:n},l);ef(r,h,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,t),height:Math.min(r.height,n)},l),r.width=t,r.height=n,r.data=h.data}function ef(r,t,n,l,h,m){if(h.width===0||h.height===0)return t;if(h.width>r.width||h.height>r.height||n.x>r.width-h.width||n.y>r.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||l.x>t.width-h.width||l.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const y=r.data,w=t.data;if(y===w)throw new Error("srcData equals dstData, so image is already copied");for(let C=0;C<h.height;C++){const D=((n.y+C)*r.width+n.x)*m,z=((l.y+C)*t.width+l.x)*m;for(let N=0;N<h.width*m;N++)w[z+N]=y[D+N]}return t}class jh{constructor(t,n){Jd(this,t,1,n)}resize(t){tf(this,t,1)}clone(){return new jh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,l,h,m){ef(t,n,l,h,m,1)}}class Vr{constructor(t,n){Jd(this,t,4,n)}resize(t){tf(this,t,4)}replace(t,n){n?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Vr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,l,h,m){ef(t,n,l,h,m,4)}setPixel(t,n,l){const h=4*(t*this.width+n);this.data[h+0]=Math.round(255*l.r/l.a),this.data[h+1]=Math.round(255*l.g/l.a),this.data[h+2]=Math.round(255*l.b/l.a),this.data[h+3]=Math.round(255*l.a)}}function Dm(r){const t={},n=r.resolution||256,l=r.clips?r.clips.length:1,h=r.image||new Vr({width:n,height:l});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const m=(y,w,C)=>{t[r.evaluationKey]=C;const D=r.expression.evaluate(t);h.setPixel(y/4/n,w/4,D)};if(r.clips)for(let y=0,w=0;y<l;++y,w+=4*n)for(let C=0,D=0;C<n;C++,D+=4){const z=C/(n-1),{start:N,end:V}=r.clips[y];m(w,D,N*(1-z)+V*z)}else for(let y=0,w=0;y<n;y++,w+=4)m(0,w,y/(n-1));return h}Me("AlphaImage",jh),Me("RGBAImage",Vr);const mo="big-fb";class Rm extends Xi{createBucket(t){return new fp(t)}constructor(t,n){super(t,yy,n),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Dm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(mo)&&this.heatmapFbos.delete(mo)}queryRadius(t){return Iu("heatmap-radius",this,t)}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:l,geometry:h,transform:m,pixelsToTileUnits:y,unwrappedTileID:w,getElevation:C}){return Kd({queryGeometry:t,size:this.paint.get("heatmap-radius").evaluate(n,l)*y,transform:m,unwrappedTileID:w,getElevation:C},h)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let _y;var vy={get paint(){return _y=_y||new ti({"hillshade-illumination-direction":new Re(ht.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Re(ht.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Re(ht.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Re(ht.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Re(ht.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Re(ht.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Re(ht.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Re(ht.paint_hillshade["hillshade-method"])})}};class Ol extends Xi{constructor(t,n){super(t,vy,n),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,n=this.paint.get("hillshade-illumination-altitude").values,l=this.paint.get("hillshade-highlight-color").values,h=this.paint.get("hillshade-shadow-color").values;const m=Math.max(t.length,n.length,l.length,h.length);t=t.concat(Array(m-t.length).fill(t.at(-1))),n=n.concat(Array(m-n.length).fill(n.at(-1))),l=l.concat(Array(m-l.length).fill(l.at(-1))),h=h.concat(Array(m-h.length).fill(h.at(-1)));const y=n.map(qi);return{directionRadians:t.map(qi),altitudeRadians:y,shadowColor:h,highlightColor:l}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let mp;var xy={get paint(){return mp=mp||new ti({"color-relief-opacity":new Re(ht["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new mr(ht["paint_color-relief"]["color-relief-color"])})}};class Bh{constructor(t,n,l,h){this.context=t,this.format=l,this.texture=t.gl.createTexture(),this.update(n,h)}update(t,n,l){const{width:h,height:m}=t,y=!(this.size&&this.size[0]===h&&this.size[1]===m||l),{context:w}=this,{gl:C}=w;if(this.useMipmap=!!(n&&n.useMipmap),C.bindTexture(C.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!n||n.premultiply!==!1)),y)this.size=[h,m],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||Us(t)?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,t):C.texImage2D(C.TEXTURE_2D,0,this.format,h,m,0,this.format,C.UNSIGNED_BYTE,t.data);else{const{x:D,y:z}=l||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||Us(t)?C.texSubImage2D(C.TEXTURE_2D,0,D,z,C.RGBA,C.UNSIGNED_BYTE,t):C.texSubImage2D(C.TEXTURE_2D,0,D,z,h,m,C.RGBA,C.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&C.generateMipmap(C.TEXTURE_2D),w.pixelStoreUnpackFlipY.setDefault(),w.pixelStoreUnpack.setDefault(),w.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(t,n,l){const{context:h}=this,{gl:m}=h;m.bindTexture(m.TEXTURE_2D,this.texture),l!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=m.LINEAR),t!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,t),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,l||t),this.filter=t),n!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,n),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class Vh{constructor(t,n,l,h=1,m=1,y=1,w=0){if(this.uid=t,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(l&&!["mapbox","terrarium","custom"].includes(l))return void Nn(`"${l}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=n.height;const C=this.dim=n.height-2;switch(this.data=new Uint32Array(n.data.buffer),l){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=m,this.blueFactor=y,this.baseShift=w;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let D=0;D<C;D++)this.data[this._idx(-1,D)]=this.data[this._idx(0,D)],this.data[this._idx(C,D)]=this.data[this._idx(C-1,D)],this.data[this._idx(D,-1)]=this.data[this._idx(D,0)],this.data[this._idx(D,C)]=this.data[this._idx(D,C-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(C,-1)]=this.data[this._idx(C-1,0)],this.data[this._idx(-1,C)]=this.data[this._idx(0,C-1)],this.data[this._idx(C,C)]=this.data[this._idx(C-1,C-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let D=0;D<C;D++)for(let z=0;z<C;z++){const N=this.get(D,z);N>this.max&&(this.max=N),N<this.min&&(this.min=N)}}get(t,n){const l=new Uint8Array(this.data.buffer),h=4*this._idx(t,n);return this.unpack(l[h],l[h+1],l[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,n){if(t<-1||t>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(t+1)}unpack(t,n,l){return t*this.redFactor+n*this.greenFactor+l*this.blueFactor-this.baseShift}pack(t){return pi(t,this.getUnpackVector())}getPixels(){return new Vr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,n,l){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let h=n*this.dim,m=n*this.dim+this.dim,y=l*this.dim,w=l*this.dim+this.dim;switch(n){case-1:h=m-1;break;case 1:m=h+1}switch(l){case-1:y=w-1;break;case 1:w=y+1}const C=-n*this.dim,D=-l*this.dim;for(let z=y;z<w;z++)for(let N=h;N<m;N++)this.data[this._idx(N,z)]=t.data[this._idx(N+C,z+D)]}}function pi(r,t){const n=t[0],l=t[1],h=t[2],m=t[3],y=Math.min(n,l,h),w=Math.round((r+m)/y);return{r:Math.floor(w*y/n)%256,g:Math.floor(w*y/l)%256,b:Math.floor(w*y/h)%256}}Me("DEMData",Vh);class Tv extends Xi{constructor(t,n){super(t,xy,n)}_createColorRamp(t){const n={elevationStops:[],colorStops:[]},l=this._transitionablePaint._values["color-relief-color"].value.expression;if(l instanceof Lo&&l._styleExpression.expression instanceof rr){this.colorRampExpression=l;const y=l._styleExpression.expression;n.elevationStops=y.labels,n.colorStops=[];for(const w of n.elevationStops)n.colorStops.push(y.evaluate({globals:{elevation:w}}))}if(n.elevationStops.length<1&&(n.elevationStops=[0],n.colorStops=[hn.transparent]),n.elevationStops.length<2&&(n.elevationStops.push(n.elevationStops[0]+1),n.colorStops.push(n.colorStops[0])),n.elevationStops.length<=t)return n;const h={elevationStops:[],colorStops:[]},m=(n.elevationStops.length-1)/(t-1);for(let y=0;y<n.elevationStops.length-.5;y+=m)h.elevationStops.push(n.elevationStops[Math.round(y)]),h.colorStops.push(n.colorStops[Math.round(y)]);return Nn(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${t}, provided: ${n.elevationStops.length}`),h}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(t,n,l){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const h=this._createColorRamp(n),m=new Vr({width:h.colorStops.length,height:1}),y=new Vr({width:h.colorStops.length,height:1});for(let w=0;w<h.elevationStops.length;w++){const C=pi(h.elevationStops[w],l);y.setPixel(0,w,new hn(C.r/255,C.g/255,C.b/255,1)),m.setPixel(0,w,h.colorStops[w])}return this.colorRampTextures={elevationTexture:new Bh(t,y,t.gl.RGBA),colorTexture:new Bh(t,m,t.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const Sv=Fn([{name:"a_pos",components:2,type:"Int16"}],4),{members:by}=Sv;function Pc(r,t,n){const l=n.patternDependencies;let h=!1;for(const m of t){const y=m.paint.get(`${r}-pattern`);y.isConstant()||(h=!0);const w=y.constantOr(null);w&&(h=!0,l[w.to]=!0,l[w.from]=!0)}return h}function $o(r,t,n,l,h){const{zoom:m}=l,y=h.patternDependencies;for(const w of t){const C=w.paint.get(`${r}-pattern`).value;if(C.kind!=="constant"){let D=C.evaluate({zoom:m-1},n,{},h.availableImages),z=C.evaluate({zoom:m},n,{},h.availableImages),N=C.evaluate({zoom:m+1},n,{},h.availableImages);D=D&&D.name?D.name:D,z=z&&z.name?z.name:z,N=N&&N.name?N.name:N,y[D]=!0,y[z]=!0,y[N]=!0,n.patterns[w.id]={min:D,mid:z,max:N}}}return n}function Im(r,t,n,l,h){let m;if(h===(function(y,w,C,D){let z=0;for(let N=w,V=C-D;N<C;N+=D)z+=(y[V]-y[N])*(y[N+1]+y[V+1]),V=N;return z})(r,t,n,l)>0)for(let y=t;y<n;y+=l)m=Nm(y/l|0,r[y],r[y+1],m);else for(let y=n-l;y>=t;y-=l)m=Nm(y/l|0,r[y],r[y+1],m);return m&&Uh(m,m.next)&&(Gh(m),m=m.next),m}function Dc(r,t){if(!r)return r;t||(t=r);let n,l=r;do if(n=!1,l.steiner||!Uh(l,l.next)&&mn(l.prev,l,l.next)!==0)l=l.next;else{if(Gh(l),l=t=l.prev,l===l.next)break;n=!0}while(n||l!==t);return t}function Nl(r,t,n,l,h,m,y){if(!r)return;!y&&m&&(function(C,D,z,N){let V=C;do V.z===0&&(V.z=yp(V.x,V.y,D,z,N)),V.prevZ=V.prev,V.nextZ=V.next,V=V.next;while(V!==C);V.prevZ.nextZ=null,V.prevZ=null,(function(U){let G,Y=1;do{let tt,at=U;U=null;let yt=null;for(G=0;at;){G++;let ct=at,dt=0;for(let Dt=0;Dt<Y&&(dt++,ct=ct.nextZ,ct);Dt++);let Pt=Y;for(;dt>0||Pt>0&&ct;)dt!==0&&(Pt===0||!ct||at.z<=ct.z)?(tt=at,at=at.nextZ,dt--):(tt=ct,ct=ct.nextZ,Pt--),yt?yt.nextZ=tt:U=tt,tt.prevZ=yt,yt=tt;at=ct}yt.nextZ=null,Y*=2}while(G>1)})(V)})(r,l,h,m);let w=r;for(;r.prev!==r.next;){const C=r.prev,D=r.next;if(m?wy(r,l,h,m):Ho(r))t.push(C.i,r.i,D.i),Gh(r),r=D.next,w=D.next;else if((r=D)===w){y?y===1?Nl(r=zm(Dc(r),t),t,n,l,h,m,2):y===2&&Ty(r,t,n,l,h,m):Nl(Dc(r),t,n,l,h,m,1);break}}}function Ho(r){const t=r.prev,n=r,l=r.next;if(mn(t,n,l)>=0)return!1;const h=t.x,m=n.x,y=l.x,w=t.y,C=n.y,D=l.y,z=Math.min(h,m,y),N=Math.min(w,C,D),V=Math.max(h,m,y),U=Math.max(w,C,D);let G=l.next;for(;G!==t;){if(G.x>=z&&G.x<=V&&G.y>=N&&G.y<=U&&zu(h,w,m,C,y,D,G.x,G.y)&&mn(G.prev,G,G.next)>=0)return!1;G=G.next}return!0}function wy(r,t,n,l){const h=r.prev,m=r,y=r.next;if(mn(h,m,y)>=0)return!1;const w=h.x,C=m.x,D=y.x,z=h.y,N=m.y,V=y.y,U=Math.min(w,C,D),G=Math.min(z,N,V),Y=Math.max(w,C,D),tt=Math.max(z,N,V),at=yp(U,G,t,n,l),yt=yp(Y,tt,t,n,l);let ct=r.prevZ,dt=r.nextZ;for(;ct&&ct.z>=at&&dt&&dt.z<=yt;){if(ct.x>=U&&ct.x<=Y&&ct.y>=G&&ct.y<=tt&&ct!==h&&ct!==y&&zu(w,z,C,N,D,V,ct.x,ct.y)&&mn(ct.prev,ct,ct.next)>=0||(ct=ct.prevZ,dt.x>=U&&dt.x<=Y&&dt.y>=G&&dt.y<=tt&&dt!==h&&dt!==y&&zu(w,z,C,N,D,V,dt.x,dt.y)&&mn(dt.prev,dt,dt.next)>=0))return!1;dt=dt.nextZ}for(;ct&&ct.z>=at;){if(ct.x>=U&&ct.x<=Y&&ct.y>=G&&ct.y<=tt&&ct!==h&&ct!==y&&zu(w,z,C,N,D,V,ct.x,ct.y)&&mn(ct.prev,ct,ct.next)>=0)return!1;ct=ct.prevZ}for(;dt&&dt.z<=yt;){if(dt.x>=U&&dt.x<=Y&&dt.y>=G&&dt.y<=tt&&dt!==h&&dt!==y&&zu(w,z,C,N,D,V,dt.x,dt.y)&&mn(dt.prev,dt,dt.next)>=0)return!1;dt=dt.nextZ}return!0}function zm(r,t){let n=r;do{const l=n.prev,h=n.next.next;!Uh(l,h)&&Om(l,n,n.next,h)&&Cr(l,h)&&Cr(h,l)&&(t.push(l.i,n.i,h.i),Gh(n),Gh(n.next),n=r=h),n=n.next}while(n!==r);return Dc(n)}function Ty(r,t,n,l,h,m){let y=r;do{let w=y.next.next;for(;w!==y.prev;){if(y.i!==w.i&&Sy(y,w)){let C=Xo(y,w);return y=Dc(y,y.next),C=Dc(C,C.next),Nl(y,t,n,l,h,m,0),void Nl(C,t,n,l,h,m,0)}w=w.next}y=y.next}while(y!==r)}function Lm(r,t){let n=r.x-t.x;return n===0&&(n=r.y-t.y,n===0)&&(n=(r.next.y-r.y)/(r.next.x-r.x)-(t.next.y-t.y)/(t.next.x-t.x)),n}function km(r,t){const n=(function(h,m){let y=m;const w=h.x,C=h.y;let D,z=-1/0;if(Uh(h,y))return y;do{if(Uh(h,y.next))return y.next;if(C<=y.y&&C>=y.next.y&&y.next.y!==y.y){const Y=y.x+(C-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(Y<=w&&Y>z&&(z=Y,D=y.x<y.next.x?y:y.next,Y===w))return D}y=y.next}while(y!==m);if(!D)return null;const N=D,V=D.x,U=D.y;let G=1/0;y=D;do{if(w>=y.x&&y.x>=V&&w!==y.x&&Wi(C<U?w:z,C,V,U,C<U?z:w,C,y.x,y.y)){const Y=Math.abs(C-y.y)/(w-y.x);Cr(y,h)&&(Y<G||Y===G&&(y.x>D.x||y.x===D.x&&gp(D,y)))&&(D=y,G=Y)}y=y.next}while(y!==N);return D})(r,t);if(!n)return t;const l=Xo(n,r);return Dc(l,l.next),Dc(n,n.next)}function gp(r,t){return mn(r.prev,r,t.prev)<0&&mn(t.next,r,r.next)<0}function yp(r,t,n,l,h){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-n)*h|0)|r<<8))|r<<4))|r<<2))|r<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-l)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Fl(r){let t=r,n=r;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==r);return n}function Wi(r,t,n,l,h,m,y,w){return(h-y)*(t-w)>=(r-y)*(m-w)&&(r-y)*(l-w)>=(n-y)*(t-w)&&(n-y)*(m-w)>=(h-y)*(l-w)}function zu(r,t,n,l,h,m,y,w){return!(r===y&&t===w)&&Wi(r,t,n,l,h,m,y,w)}function Sy(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!(function(n,l){let h=n;do{if(h.i!==n.i&&h.next.i!==n.i&&h.i!==l.i&&h.next.i!==l.i&&Om(h,h.next,n,l))return!0;h=h.next}while(h!==n);return!1})(r,t)&&(Cr(r,t)&&Cr(t,r)&&(function(n,l){let h=n,m=!1;const y=(n.x+l.x)/2,w=(n.y+l.y)/2;do h.y>w!=h.next.y>w&&h.next.y!==h.y&&y<(h.next.x-h.x)*(w-h.y)/(h.next.y-h.y)+h.x&&(m=!m),h=h.next;while(h!==n);return m})(r,t)&&(mn(r.prev,r,t.prev)||mn(r,t.prev,t))||Uh(r,t)&&mn(r.prev,r,r.next)>0&&mn(t.prev,t,t.next)>0)}function mn(r,t,n){return(t.y-r.y)*(n.x-t.x)-(t.x-r.x)*(n.y-t.y)}function Uh(r,t){return r.x===t.x&&r.y===t.y}function Om(r,t,n,l){const h=ci(mn(r,t,n)),m=ci(mn(r,t,l)),y=ci(mn(n,l,r)),w=ci(mn(n,l,t));return h!==m&&y!==w||!(h!==0||!nf(r,n,t))||!(m!==0||!nf(r,l,t))||!(y!==0||!nf(n,r,l))||!(w!==0||!nf(n,t,l))}function nf(r,t,n){return t.x<=Math.max(r.x,n.x)&&t.x>=Math.min(r.x,n.x)&&t.y<=Math.max(r.y,n.y)&&t.y>=Math.min(r.y,n.y)}function ci(r){return r>0?1:r<0?-1:0}function Cr(r,t){return mn(r.prev,r,r.next)<0?mn(r,t,r.next)>=0&&mn(r,r.prev,t)>=0:mn(r,t,r.prev)<0||mn(r,r.next,t)<0}function Xo(r,t){const n=_p(r.i,r.x,r.y),l=_p(t.i,t.x,t.y),h=r.next,m=t.prev;return r.next=t,t.prev=r,n.next=h,h.prev=n,l.next=n,n.prev=l,m.next=l,l.prev=m,l}function Nm(r,t,n,l){const h=_p(r,t,n);return l?(h.next=l.next,h.prev=l,l.next.prev=h,l.next=h):(h.prev=h,h.next=h),h}function Gh(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function _p(r,t,n){return{i:r,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class qh{constructor(t,n){if(n>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=n}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Lu{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Lu.noSubdivision=new Lu({fill:new qh(0,0),line:new qh(0,0),tile:new qh(0,0),stencil:new qh(0,0),circle:1}),Me("SubdivisionGranularityExpression",qh),Me("SubdivisionGranularitySetting",Lu);const gr=-32768,ps=32767;class Ey{constructor(t,n){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=we/t,this._canonical=n}_getKey(t,n){return(t+=32768)<<16|n+32768}_vertexToIndex(t,n){if(t<-32768||n<-32768||t>32767||n>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const l=0|Math.round(t),h=0|Math.round(n),m=this._getKey(l,h);if(this._vertexDictionary.has(m))return this._vertexDictionary.get(m);const y=this._vertexBuffer.length/2;return this._vertexDictionary.set(m,y),this._vertexBuffer.push(l,h),y}_subdivideTrianglesScanline(t){if(this._granularity<2)return(function(h,m){const y=[];for(let w=0;w<m.length;w+=3){const C=m[w],D=m[w+1],z=m[w+2],N=h[2*C],V=h[2*C+1];(h[2*D]-N)*(h[2*z+1]-V)-(h[2*D+1]-V)*(h[2*z]-N)>0?(y.push(C),y.push(z),y.push(D)):(y.push(C),y.push(D),y.push(z))}return y})(this._vertexBuffer,t);const n=[],l=t.length;for(let h=0;h<l;h+=3){const m=[t[h+0],t[h+1],t[h+2]],y=[this._vertexBuffer[2*t[h+0]+0],this._vertexBuffer[2*t[h+0]+1],this._vertexBuffer[2*t[h+1]+0],this._vertexBuffer[2*t[h+1]+1],this._vertexBuffer[2*t[h+2]+0],this._vertexBuffer[2*t[h+2]+1]];let w=1/0,C=1/0,D=-1/0,z=-1/0;for(let Y=0;Y<3;Y++){const tt=y[2*Y],at=y[2*Y+1];w=Math.min(w,tt),D=Math.max(D,tt),C=Math.min(C,at),z=Math.max(z,at)}if(w===D||C===z)continue;const N=Math.floor(w/this._granularityCellSize),V=Math.ceil(D/this._granularityCellSize),U=Math.floor(C/this._granularityCellSize),G=Math.ceil(z/this._granularityCellSize);if(N!==V||U!==G)for(let Y=U;Y<G;Y++){const tt=this._scanlineGenerateVertexRingForCellRow(Y,y,m);jl(this._vertexBuffer,tt,n)}else n.push(...m)}return n}_scanlineGenerateVertexRingForCellRow(t,n,l){const h=t*this._granularityCellSize,m=h+this._granularityCellSize,y=[];for(let w=0;w<3;w++){const C=n[2*w],D=n[2*w+1],z=n[2*(w+1)%6],N=n[(2*(w+1)+1)%6],V=n[2*(w+2)%6],U=n[(2*(w+2)+1)%6],G=z-C,Y=N-D,tt=G===0,at=Y===0,yt=(h-D)/Y,ct=(m-D)/Y,dt=Math.min(yt,ct),Pt=Math.max(yt,ct);if(!at&&(dt>=1||Pt<=0)||at&&(D<h||D>m)){N>=h&&N<=m&&y.push(l[(w+1)%3]);continue}!at&&dt>0&&y.push(this._vertexToIndex(C+G*dt,D+Y*dt));const Dt=C+G*Math.max(dt,0),Zt=C+G*Math.min(Pt,1);tt||this._generateIntraEdgeVertices(y,C,D,z,N,Dt,Zt),!at&&Pt<1&&y.push(this._vertexToIndex(C+G*Pt,D+Y*Pt)),(at||N>=h&&N<=m)&&y.push(l[(w+1)%3]),!at&&(N<=h||N>=m)&&this._generateInterEdgeVertices(y,C,D,z,N,V,U,Zt,h,m)}return y}_generateIntraEdgeVertices(t,n,l,h,m,y,w){const C=h-n,D=m-l,z=D===0,N=z?Math.min(n,h):Math.min(y,w),V=z?Math.max(n,h):Math.max(y,w),U=Math.floor(N/this._granularityCellSize)+1,G=Math.ceil(V/this._granularityCellSize)-1;if(z?n<h:y<w)for(let Y=U;Y<=G;Y++){const tt=Y*this._granularityCellSize;t.push(this._vertexToIndex(tt,l+D*(tt-n)/C))}else for(let Y=G;Y>=U;Y--){const tt=Y*this._granularityCellSize;t.push(this._vertexToIndex(tt,l+D*(tt-n)/C))}}_generateInterEdgeVertices(t,n,l,h,m,y,w,C,D,z){const N=m-l,V=y-h,U=w-m,G=(D-m)/U,Y=(z-m)/U,tt=Math.min(G,Y),at=Math.max(G,Y),yt=h+V*tt;let ct=Math.floor(Math.min(yt,C)/this._granularityCellSize)+1,dt=Math.ceil(Math.max(yt,C)/this._granularityCellSize)-1,Pt=C<yt;const Dt=U===0;if(Dt&&(w===D||w===z))return;if(Dt||tt>=1||at<=0){const ue=l-w,ie=y+(n-y)*Math.min((D-w)/ue,(z-w)/ue);ct=Math.floor(Math.min(ie,C)/this._granularityCellSize)+1,dt=Math.ceil(Math.max(ie,C)/this._granularityCellSize)-1,Pt=C<ie}const Zt=N>0?z:D;if(Pt)for(let ue=ct;ue<=dt;ue++)t.push(this._vertexToIndex(ue*this._granularityCellSize,Zt));else for(let ue=dt;ue>=ct;ue--)t.push(this._vertexToIndex(ue*this._granularityCellSize,Zt))}_generateOutline(t){const n=[];for(const l of t){const h=Rc(l,this._granularity,!0),m=this._pointArrayToIndices(h),y=[];for(let w=1;w<m.length;w++)y.push(m[w-1]),y.push(m[w]);n.push(y)}return n}_handlePoles(t){let n=!1,l=!1;this._canonical&&(this._canonical.y===0&&(n=!0),this._canonical.y===(1<<this._canonical.z)-1&&(l=!0)),(n||l)&&this._fillPoles(t,n,l)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let n=0;n<t.length;n+=2){const l=t[n+1];l===gr&&(t[n+1]=-32767),l===ps&&(t[n+1]=32766)}}_generatePoleQuad(t,n,l,h,m,y){h>m!=(y===gr)?(t.push(n),t.push(l),t.push(this._vertexToIndex(h,y)),t.push(l),t.push(this._vertexToIndex(m,y)),t.push(this._vertexToIndex(h,y))):(t.push(l),t.push(n),t.push(this._vertexToIndex(h,y)),t.push(this._vertexToIndex(m,y)),t.push(l),t.push(this._vertexToIndex(h,y)))}_fillPoles(t,n,l){const h=this._vertexBuffer,m=we,y=t.length;for(let w=2;w<y;w+=3){const C=t[w-2],D=t[w-1],z=t[w],N=h[2*C],V=h[2*C+1],U=h[2*D],G=h[2*D+1],Y=h[2*z],tt=h[2*z+1];n&&(V===0&&G===0&&this._generatePoleQuad(t,C,D,N,U,gr),G===0&&tt===0&&this._generatePoleQuad(t,D,z,U,Y,gr),tt===0&&V===0&&this._generatePoleQuad(t,z,C,Y,N,gr)),l&&(V===m&&G===m&&this._generatePoleQuad(t,C,D,N,U,ps),G===m&&tt===m&&this._generatePoleQuad(t,D,z,U,Y,ps),tt===m&&V===m&&this._generatePoleQuad(t,z,C,Y,N,ps))}}_initializeVertices(t){for(let n=0;n<t.length;n+=2)this._vertexToIndex(t[n],t[n+1])}subdividePolygonInternal(t,n){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:l,holeIndices:h}=(function(w){const C=[],D=[];for(const z of w)if(z.length!==0){z!==w[0]&&C.push(D.length/2);for(let N=0;N<z.length;N++)D.push(z[N].x),D.push(z[N].y)}return{flattened:D,holeIndices:C}})(t);let m;this._initializeVertices(l);try{const w=(function(D,z,N=2){const V=z&&z.length,U=V?z[0]*N:D.length;let G=Im(D,0,U,N,!0);const Y=[];if(!G||G.next===G.prev)return Y;let tt,at,yt;if(V&&(G=(function(ct,dt,Pt,Dt){const Zt=[];for(let ue=0,ie=dt.length;ue<ie;ue++){const de=Im(ct,dt[ue]*Dt,ue<ie-1?dt[ue+1]*Dt:ct.length,Dt,!1);de===de.next&&(de.steiner=!0),Zt.push(Fl(de))}Zt.sort(Lm);for(let ue=0;ue<Zt.length;ue++)Pt=km(Zt[ue],Pt);return Pt})(D,z,G,N)),D.length>80*N){tt=D[0],at=D[1];let ct=tt,dt=at;for(let Pt=N;Pt<U;Pt+=N){const Dt=D[Pt],Zt=D[Pt+1];Dt<tt&&(tt=Dt),Zt<at&&(at=Zt),Dt>ct&&(ct=Dt),Zt>dt&&(dt=Zt)}yt=Math.max(ct-tt,dt-at),yt=yt!==0?32767/yt:0}return Nl(G,Y,N,tt,at,yt,0),Y})(l,h),C=this._convertIndices(l,w);m=this._subdivideTrianglesScanline(C)}catch(w){console.error(w)}let y=[];return n&&(y=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(m),{verticesFlattened:this._vertexBuffer,indicesTriangles:m,indicesLineList:y}}_convertIndices(t,n){const l=[];for(let h=0;h<n.length;h++)l.push(this._vertexToIndex(t[2*n[h]],t[2*n[h]+1]));return l}_pointArrayToIndices(t){const n=[];for(let l=0;l<t.length;l++){const h=t[l];n.push(this._vertexToIndex(h.x,h.y))}return n}}function ms(r,t,n,l=!0){return new Ey(n,t).subdividePolygonInternal(r,l)}function Rc(r,t,n=!1){if(!r||r.length<1)return[];if(r.length<2)return[];const l=r[0],h=r[r.length-1],m=n&&(l.x!==h.x||l.y!==h.y);if(t<2)return m?[...r,r[0]]:[...r];const y=Math.floor(we/t),w=[];w.push(new L(r[0].x,r[0].y));const C=r.length,D=m?C:C-1;for(let z=0;z<D;z++){const N=r[z],V=z<C-1?r[z+1]:r[0],U=N.x,G=N.y,Y=V.x,tt=V.y,at=U!==Y,yt=G!==tt;if(!at&&!yt)continue;const ct=Y-U,dt=tt-G,Pt=Math.abs(ct),Dt=Math.abs(dt);let Zt=U,ue=G;for(;;){const de=ct>0?(Math.floor(Zt/y)+1)*y:(Math.ceil(Zt/y)-1)*y,Se=dt>0?(Math.floor(ue/y)+1)*y:(Math.ceil(ue/y)-1)*y,_e=Math.abs(Zt-de),ve=Math.abs(ue-Se),re=Math.abs(Zt-Y),je=Math.abs(ue-tt),Be=at?_e/Pt:Number.POSITIVE_INFINITY,qe=yt?ve/Dt:Number.POSITIVE_INFINITY;if((re<=_e||!at)&&(je<=ve||!yt))break;if(Be<qe&&at||!yt){Zt=de,ue+=dt*Be;const Ie=new L(Zt,Math.round(ue));w[w.length-1].x===Ie.x&&w[w.length-1].y===Ie.y||w.push(Ie)}else{Zt+=ct*qe,ue=Se;const Ie=new L(Math.round(Zt),ue);w[w.length-1].x===Ie.x&&w[w.length-1].y===Ie.y||w.push(Ie)}}const ie=new L(Y,tt);w[w.length-1].x===ie.x&&w[w.length-1].y===ie.y||w.push(ie)}return w}function jl(r,t,n){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let l=0,h=r[2*t[0]];for(let C=1;C<t.length;C++){const D=r[2*t[C]];D<h&&(h=D,l=C)}const m=t.length;let y=l,w=(y+1)%m;for(;;){const C=y-1>=0?y-1:m-1,D=(w+1)%m,z=r[2*t[C]],N=r[2*t[D]],V=r[2*t[y]],U=r[2*t[y]+1],G=r[2*t[w]+1];let Y=!1;if(z<N)Y=!0;else if(z>N)Y=!1;else{const tt=G-U,at=-(r[2*t[w]]-V),yt=U<G?1:-1;((z-V)*tt+(r[2*t[C]+1]-U)*at)*yt>((N-V)*tt+(r[2*t[D]+1]-U)*at)*yt&&(Y=!0)}if(Y){const tt=t[C],at=t[y],yt=t[w];tt!==at&&tt!==yt&&at!==yt&&n.push(yt,at,tt),y--,y<0&&(y=m-1)}else{const tt=t[D],at=t[y],yt=t[w];tt!==at&&tt!==yt&&at!==yt&&n.push(yt,at,tt),w++,w>=m&&(w=0)}if(C===D)break}}function Ic(r,t,n,l,h,m,y,w,C){const D=h.length/2,z=y&&w&&C;if(D<Ke.MAX_VERTEX_ARRAY_LENGTH){const N=t.prepareSegment(D,n,l),V=N.vertexLength;for(let Y=0;Y<m.length;Y+=3)l.emplaceBack(V+m[Y],V+m[Y+1],V+m[Y+2]);let U,G;N.vertexLength+=D,N.primitiveLength+=m.length/3,z&&(G=y.prepareSegment(D,n,w),U=G.vertexLength,G.vertexLength+=D);for(let Y=0;Y<h.length;Y+=2)r(h[Y],h[Y+1]);if(z)for(let Y=0;Y<C.length;Y++){const tt=C[Y];for(let at=1;at<tt.length;at+=2)w.emplaceBack(U+tt[at-1],U+tt[at]);G.primitiveLength+=tt.length/2}}else(function(N,V,U,G,Y,tt){const at=[];for(let Dt=0;Dt<G.length/2;Dt++)at.push(-1);const yt={count:0};let ct=0,dt=N.getOrCreateLatestSegment(V,U),Pt=dt.vertexLength;for(let Dt=2;Dt<Y.length;Dt+=3){const Zt=Y[Dt-2],ue=Y[Dt-1],ie=Y[Dt];let de=at[Zt]<ct,Se=at[ue]<ct,_e=at[ie]<ct;dt.vertexLength+((de?1:0)+(Se?1:0)+(_e?1:0))>Ke.MAX_VERTEX_ARRAY_LENGTH&&(dt=N.createNewSegment(V,U),ct=yt.count,de=!0,Se=!0,_e=!0,Pt=0);const ve=ea(at,G,tt,yt,Zt,de,dt),re=ea(at,G,tt,yt,ue,Se,dt),je=ea(at,G,tt,yt,ie,_e,dt);U.emplaceBack(Pt+ve-ct,Pt+re-ct,Pt+je-ct),dt.primitiveLength++}})(t,n,l,h,m,r),z&&(function(N,V,U,G,Y,tt){const at=[];for(let Dt=0;Dt<G.length/2;Dt++)at.push(-1);const yt={count:0};let ct=0,dt=N.getOrCreateLatestSegment(V,U),Pt=dt.vertexLength;for(let Dt=0;Dt<Y.length;Dt++){const Zt=Y[Dt];for(let ue=1;ue<Y[Dt].length;ue+=2){const ie=Zt[ue-1],de=Zt[ue];let Se=at[ie]<ct,_e=at[de]<ct;dt.vertexLength+((Se?1:0)+(_e?1:0))>Ke.MAX_VERTEX_ARRAY_LENGTH&&(dt=N.createNewSegment(V,U),ct=yt.count,Se=!0,_e=!0,Pt=0);const ve=ea(at,G,tt,yt,ie,Se,dt),re=ea(at,G,tt,yt,de,_e,dt);U.emplaceBack(Pt+ve-ct,Pt+re-ct),dt.primitiveLength++}}})(y,n,w,h,C,r),t.forceNewSegmentOnNextPrepare(),y?.forceNewSegmentOnNextPrepare()}function ea(r,t,n,l,h,m,y){if(m){const w=l.count;return n(t[2*h],t[2*h+1]),r[h]=l.count,l.count++,y.vertexLength++,w}return r[h]}class rf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=t.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new Tt,this.indexArray=new ye,this.indexArray2=new oe,this.programConfigurations=new fo(t.layers,t.zoom),this.segments=new Ke,this.segments2=new Ke,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(t,n,l){this.hasDependencies=Pc("fill",this.layers,n);const h=this.layers[0].layout.get("fill-sort-key"),m=!h.isConstant(),y=[];for(const{feature:w,id:C,index:D,sourceLayerIndex:z}of t){const N=this.layers[0]._featureFilter.needGeometry,V=Br(w,N);if(!this.layers[0]._featureFilter.filter(new kn(this.zoom),V,l))continue;const U=m?h.evaluate(V,{},l,n.availableImages):void 0,G={id:C,properties:w.properties,type:w.type,sourceLayerIndex:z,index:D,geometry:N?V.geometry:po(w),patterns:{},sortKey:U};y.push(G)}m&&y.sort(((w,C)=>w.sortKey-C.sortKey));for(const w of y){const{geometry:C,index:D,sourceLayerIndex:z}=w;if(this.hasDependencies){const N=$o("fill",this.layers,w,{zoom:this.zoom},n);this.patternFeatures.push(N)}else this.addFeature(w,C,D,l,{},n.subdivisionGranularity);n.featureIndex.insert(t[D].feature,C,D,z,this.index)}}update(t,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,{imagePositions:l})}addFeatures(t,n,l){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,n,l,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,by),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,n,l,h,m,y){for(const w of hc(n,500)){const C=ms(w,h,y.fill.getGranularityForZoomLevel(h.z)),D=this.layoutVertexArray;Ic(((z,N)=>{D.emplaceBack(z,N)}),this.segments,this.layoutVertexArray,this.indexArray,C.verticesFlattened,C.indicesTriangles,this.segments2,this.indexArray2,C.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{imagePositions:m,canonical:h})}}let vp,ja;Me("FillBucket",rf,{omit:["layers","patternFeatures"]});var Cy={get paint(){return ja=ja||new ti({"fill-antialias":new Re(ht.paint_fill["fill-antialias"]),"fill-opacity":new Ve(ht.paint_fill["fill-opacity"]),"fill-color":new Ve(ht.paint_fill["fill-color"]),"fill-outline-color":new Ve(ht.paint_fill["fill-outline-color"]),"fill-translate":new Re(ht.paint_fill["fill-translate"]),"fill-translate-anchor":new Re(ht.paint_fill["fill-translate-anchor"]),"fill-pattern":new Il(ht.paint_fill["fill-pattern"])})},get layout(){return vp=vp||new ti({"fill-sort-key":new Ve(ht.layout_fill["fill-sort-key"])})}};class Zh extends Xi{constructor(t,n){super(t,Cy,n)}recalculate(t,n){super.recalculate(t,n);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new rf(t)}queryRadius(){return Wd(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:n,transform:l,pixelsToTileUnits:h}){return up(Mc(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-l.bearingInRadians,h),n)}isTileClipped(){return!0}}const sf=Fn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),af=Fn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:$h}=sf;class ku{constructor(t,n,l,h,m){this.properties={},this.extent=l,this.type=0,this.id=void 0,this._pbf=t,this._geometry=-1,this._keys=h,this._values=m,t.readFields(Ay,this,n)}loadGeometry(){const t=this._pbf;t.pos=this._geometry;const n=t.readVarint()+t.pos,l=[];let h,m=1,y=0,w=0,C=0;for(;t.pos<n;){if(y<=0){const D=t.readVarint();m=7&D,y=D>>3}if(y--,m===1||m===2)w+=t.readSVarint(),C+=t.readSVarint(),m===1&&(h&&l.push(h),h=[]),h&&h.push(new L(w,C));else{if(m!==7)throw new Error(`unknown command ${m}`);h&&h.push(h[0].clone())}}return h&&l.push(h),l}bbox(){const t=this._pbf;t.pos=this._geometry;const n=t.readVarint()+t.pos;let l=1,h=0,m=0,y=0,w=1/0,C=-1/0,D=1/0,z=-1/0;for(;t.pos<n;){if(h<=0){const N=t.readVarint();l=7&N,h=N>>3}if(h--,l===1||l===2)m+=t.readSVarint(),y+=t.readSVarint(),m<w&&(w=m),m>C&&(C=m),y<D&&(D=y),y>z&&(z=y);else if(l!==7)throw new Error(`unknown command ${l}`)}return[w,D,C,z]}toGeoJSON(t,n,l){const h=this.extent*Math.pow(2,l),m=this.extent*t,y=this.extent*n,w=this.loadGeometry();function C(V){return[360*(V.x+m)/h-180,360/Math.PI*Math.atan(Math.exp((1-2*(V.y+y)/h)*Math.PI))-90]}function D(V){return V.map(C)}let z;if(this.type===1){const V=[];for(const G of w)V.push(G[0]);const U=D(V);z=V.length===1?{type:"Point",coordinates:U[0]}:{type:"MultiPoint",coordinates:U}}else if(this.type===2){const V=w.map(D);z=V.length===1?{type:"LineString",coordinates:V[0]}:{type:"MultiLineString",coordinates:V}}else{if(this.type!==3)throw new Error("unknown feature type");{const V=(function(G){const Y=G.length;if(Y<=1)return[G];const tt=[];let at,yt;for(let ct=0;ct<Y;ct++){const dt=of(G[ct]);dt!==0&&(yt===void 0&&(yt=dt<0),yt===dt<0?(at&&tt.push(at),at=[G[ct]]):at&&at.push(G[ct]))}return at&&tt.push(at),tt})(w),U=[];for(const G of V)U.push(G.map(D));z=U.length===1?{type:"Polygon",coordinates:U[0]}:{type:"MultiPolygon",coordinates:U}}}const N={type:"Feature",geometry:z,properties:this.properties};return this.id!=null&&(N.id=this.id),N}}function Ay(r,t,n){r===1?t.id=n.readVarint():r===2?(function(l,h){const m=l.readVarint()+l.pos;for(;l.pos<m;){const y=h._keys[l.readVarint()],w=h._values[l.readVarint()];h.properties[y]=w}})(n,t):r===3?t.type=n.readVarint():r===4&&(t._geometry=n.pos)}function of(r){let t=0;for(let n,l,h=0,m=r.length,y=m-1;h<m;y=h++)n=r[h],l=r[y],t+=(l.x-n.x)*(n.y+l.y);return t}ku.types=["Unknown","Point","LineString","Polygon"];class Fm{constructor(t,n){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(xp,this,n),this.length=this._features.length}feature(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const n=this._pbf.readVarint()+this._pbf.pos;return new ku(this._pbf,n,this.extent,this._keys,this._values)}}function xp(r,t,n){r===15?t.version=n.readVarint():r===1?t.name=n.readString():r===5?t.extent=n.readVarint():r===2?t._features.push(n.pos):r===3?t._keys.push(n.readString()):r===4&&t._values.push((function(l){let h=null;const m=l.readVarint()+l.pos;for(;l.pos<m;){const y=l.readVarint()>>3;h=y===1?l.readString():y===2?l.readFloat():y===3?l.readDouble():y===4?l.readVarint64():y===5?l.readVarint():y===6?l.readSVarint():y===7?l.readBoolean():null}if(h==null)throw new Error("unknown feature value");return h})(n))}class jm{constructor(t,n){this.layers=t.readFields(Ev,{},n)}}function Ev(r,t,n){if(r===3){const l=new Fm(n,n.readVarint()+n.pos);l.length&&(t[l.name]=l)}}const Bm=Math.pow(2,13);function Pn(r,t,n,l,h,m,y,w){r.emplaceBack(t,n,2*Math.floor(l*Bm)+y,h*Bm*2,m*Bm*2,Math.round(w))}class ni{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=t.index,this.hasDependencies=!1,this.layoutVertexArray=new gt,this.centroidVertexArray=new ft,this.indexArray=new ye,this.programConfigurations=new fo(t.layers,t.zoom),this.segments=new Ke,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(t,n,l){this.features=[],this.hasDependencies=Pc("fill-extrusion",this.layers,n);for(const{feature:h,id:m,index:y,sourceLayerIndex:w}of t){const C=this.layers[0]._featureFilter.needGeometry,D=Br(h,C);if(!this.layers[0]._featureFilter.filter(new kn(this.zoom),D,l))continue;const z={id:m,sourceLayerIndex:w,index:y,geometry:C?D.geometry:po(h),properties:h.properties,type:h.type,patterns:{}};this.hasDependencies?this.features.push($o("fill-extrusion",this.layers,z,{zoom:this.zoom},n)):this.addFeature(z,z.geometry,y,l,{},n.subdivisionGranularity),n.featureIndex.insert(h,z.geometry,y,w,this.index,!0)}}addFeatures(t,n,l){for(const h of this.features){const{geometry:m}=h;this.addFeature(h,m,h.index,n,l,t.subdivisionGranularity)}}update(t,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,{imagePositions:l})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,$h),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,af.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,n,l,h,m,y){for(const w of hc(n,500)){const C={x:0,y:0,sampleCount:0},D=this.layoutVertexArray.length;this.processPolygon(C,h,t,w,y);const z=this.layoutVertexArray.length-D,N=Math.floor(C.x/C.sampleCount),V=Math.floor(C.y/C.sampleCount);for(let U=0;U<z;U++)this.centroidVertexArray.emplaceBack(N,V)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{imagePositions:m,canonical:h})}processPolygon(t,n,l,h,m){if(h.length<1||Yn(h[0]))return;for(const N of h)N.length!==0&&Tn(t,N);const y={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},w=m.fill.getGranularityForZoomLevel(n.z),C=ku.types[l.type]==="Polygon";for(const N of h){if(N.length===0||Yn(N))continue;const V=Rc(N,w,C);this._generateSideFaces(V,y)}if(!C)return;const D=ms(h,n,w,!1),z=this.layoutVertexArray;Ic(((N,V)=>{Pn(z,N,V,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,D.verticesFlattened,D.indicesTriangles)}_generateSideFaces(t,n){let l=0;for(let h=1;h<t.length;h++){const m=t[h],y=t[h-1];if(An(m,y))continue;n.segment.vertexLength+4>Ke.MAX_VERTEX_ARRAY_LENGTH&&(n.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const w=m.sub(y)._perp()._unit(),C=y.dist(m);l+C>32768&&(l=0),Pn(this.layoutVertexArray,m.x,m.y,w.x,w.y,0,0,l),Pn(this.layoutVertexArray,m.x,m.y,w.x,w.y,0,1,l),l+=C,Pn(this.layoutVertexArray,y.x,y.y,w.x,w.y,0,0,l),Pn(this.layoutVertexArray,y.x,y.y,w.x,w.y,0,1,l);const D=n.segment.vertexLength;this.indexArray.emplaceBack(D,D+2,D+1),this.indexArray.emplaceBack(D+1,D+2,D+3),n.segment.vertexLength+=4,n.segment.primitiveLength+=2}}}function Tn(r,t){for(let n=0;n<t.length;n++){const l=t[n];n===t.length-1&&t[0].x===l.x&&t[0].y===l.y||(r.x+=l.x,r.y+=l.y,r.sampleCount++)}}function An(r,t){return r.x===t.x&&(r.x<0||r.x>we)||r.y===t.y&&(r.y<0||r.y>we)}function Yn(r){return r.every((t=>t.x<0))||r.every((t=>t.x>we))||r.every((t=>t.y<0))||r.every((t=>t.y>we))}let Is;Me("FillExtrusionBucket",ni,{omit:["layers","features"]});var zc={get paint(){return Is=Is||new ti({"fill-extrusion-opacity":new Re(ht["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ve(ht["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Re(ht["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Re(ht["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Il(ht["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ve(ht["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ve(ht["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Re(ht["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Hh extends Xi{constructor(t,n){super(t,zc,n)}createBucket(t){return new ni(t)}queryRadius(){return Wd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:l,geometry:h,transform:m,pixelsToTileUnits:y,pixelPosMatrix:w}){const C=Mc(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-m.bearingInRadians,y),D=this.paint.get("fill-extrusion-height").evaluate(n,l),z=this.paint.get("fill-extrusion-base").evaluate(n,l),N=(function(U,G){const Y=[];for(const tt of U){const at=[tt.x,tt.y,0,1];Ee(at,at,G),Y.push(new L(at[0]/at[3],at[1]/at[3]))}return Y})(C,w),V=(function(U,G,Y,tt){const at=[],yt=[],ct=tt[8]*G,dt=tt[9]*G,Pt=tt[10]*G,Dt=tt[11]*G,Zt=tt[8]*Y,ue=tt[9]*Y,ie=tt[10]*Y,de=tt[11]*Y;for(const Se of U){const _e=[],ve=[];for(const re of Se){const je=re.x,Be=re.y,qe=tt[0]*je+tt[4]*Be+tt[12],Ie=tt[1]*je+tt[5]*Be+tt[13],fn=tt[2]*je+tt[6]*Be+tt[14],xi=tt[3]*je+tt[7]*Be+tt[15],ar=fn+Pt,rs=xi+Dt,tl=qe+Zt,Ns=Ie+ue,Ur=fn+ie,ss=xi+de,Bi=new L((qe+ct)/rs,(Ie+dt)/rs);Bi.z=ar/rs,_e.push(Bi);const Gr=new L(tl/ss,Ns/ss);Gr.z=Ur/ss,ve.push(Gr)}at.push(_e),yt.push(ve)}return[at,yt]})(h,z,D,w);return(function(U,G,Y){let tt=1/0;up(Y,G)&&(tt=Yo(Y,G[0]));for(let at=0;at<G.length;at++){const yt=G[at],ct=U[at];for(let dt=0;dt<yt.length-1;dt++){const Pt=yt[dt],Dt=[Pt,yt[dt+1],ct[dt+1],ct[dt],Pt];Hd(Y,Dt)&&(tt=Math.min(tt,Yo(Y,Dt)))}}return tt!==1/0&&tt})(V[0],V[1],N)}}function Ou(r,t){return r.x*t.x+r.y*t.y}function Yo(r,t){if(r.length===1){let n=0;const l=t[n++];let h;for(;!h||l.equals(h);)if(h=t[n++],!h)return 1/0;for(;n<t.length;n++){const m=t[n],y=r[0],w=h.sub(l),C=m.sub(l),D=y.sub(l),z=Ou(w,w),N=Ou(w,C),V=Ou(C,C),U=Ou(D,w),G=Ou(D,C),Y=z*V-N*N,tt=(V*U-N*G)/Y,at=(z*G-N*U)/Y,yt=l.z*(1-tt-at)+h.z*tt+m.z*at;if(isFinite(yt))return yt}return 1/0}{let n=1/0;for(const l of t)n=Math.min(n,l.z);return n}}const Ni=Fn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Lc}=Ni,Nu=Fn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Vm}=Nu,na=Math.cos(Math.PI/180*37.5),Fu=Math.pow(2,14)/.5;class ju{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((n=>n.id)),this.index=t.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((n=>{this.gradients[n.id]={}})),this.layoutVertexArray=new St,this.layoutVertexArray2=new At,this.indexArray=new ye,this.programConfigurations=new fo(t.layers,t.zoom),this.segments=new Ke,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((n=>n.isStateDependent())).map((n=>n.id))}populate(t,n,l){this.hasDependencies=Pc("line",this.layers,n)||this.hasLineDasharray(this.layers);const h=this.layers[0].layout.get("line-sort-key"),m=!h.isConstant(),y=[];for(const{feature:w,id:C,index:D,sourceLayerIndex:z}of t){const N=this.layers[0]._featureFilter.needGeometry,V=Br(w,N);if(!this.layers[0]._featureFilter.filter(new kn(this.zoom),V,l))continue;const U=m?h.evaluate(V,{},l):void 0,G={id:C,properties:w.properties,type:w.type,sourceLayerIndex:z,index:D,geometry:N?V.geometry:po(w),patterns:{},dashes:{},sortKey:U};y.push(G)}m&&y.sort(((w,C)=>w.sortKey-C.sortKey));for(const w of y){const{geometry:C,index:D,sourceLayerIndex:z}=w;this.hasDependencies?(Pc("line",this.layers,n)?$o("line",this.layers,w,{zoom:this.zoom},n):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,w,this.zoom,n),this.patternFeatures.push(w)):this.addFeature(w,C,D,l,{},{},n.subdivisionGranularity),n.featureIndex.insert(t[D].feature,C,D,z,this.index)}}update(t,n,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,{imagePositions:l,dashPositions:h})}addFeatures(t,n,l,h){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,n,l,h,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Vm)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Lc),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,n,l,h,m,y,w){const C=this.layers[0].layout,D=C.get("line-join").evaluate(t,{}),z=C.get("line-cap"),N=C.get("line-miter-limit"),V=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const U of n)this.addLine(U,t,D,z,N,V,h,w);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{imagePositions:m,dashPositions:y,canonical:h})}addLine(t,n,l,h,m,y,w,C){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=Rc(t,w?C.line.getGranularityForZoomLevel(w.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ct=0;ct<t.length-1;ct++)this.totalDistance+=t[ct].dist(t[ct+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const D=ku.types[n.type]==="Polygon";let z=t.length;for(;z>=2&&t[z-1].equals(t[z-2]);)z--;let N=0;for(;N<z-1&&t[N].equals(t[N+1]);)N++;if(z<(D?3:2))return;l==="bevel"&&(m=1.05);const V=this.overscaling<=16?122880/(512*this.overscaling):0,U=this.segments.prepareSegment(10*z,this.layoutVertexArray,this.indexArray);let G,Y,tt,at,yt;this.e1=this.e2=-1,D&&(G=t[z-2],yt=t[N].sub(G)._unit()._perp());for(let ct=N;ct<z;ct++){if(tt=ct===z-1?D?t[N+1]:void 0:t[ct+1],tt&&t[ct].equals(tt))continue;yt&&(at=yt),G&&(Y=G),G=t[ct],yt=tt?tt.sub(G)._unit()._perp():at,at=at||yt;let dt=at.add(yt);dt.x===0&&dt.y===0||dt._unit();const Pt=at.x*yt.x+at.y*yt.y,Dt=dt.x*yt.x+dt.y*yt.y,Zt=Dt!==0?1/Dt:1/0,ue=2*Math.sqrt(2-2*Dt),ie=Dt<na&&Y&&tt,de=at.x*yt.y-at.y*yt.x>0;if(ie&&ct>N){const ve=G.dist(Y);if(ve>2*V){const re=G.sub(G.sub(Y)._mult(V/ve)._round());this.updateDistance(Y,re),this.addCurrentVertex(re,at,0,0,U),Y=re}}const Se=Y&&tt;let _e=Se?l:D?"butt":h;if(Se&&_e==="round"&&(Zt<y?_e="miter":Zt<=2&&(_e="fakeround")),_e==="miter"&&Zt>m&&(_e="bevel"),_e==="bevel"&&(Zt>2&&(_e="flipbevel"),Zt<m&&(_e="miter")),Y&&this.updateDistance(Y,G),_e==="miter")dt._mult(Zt),this.addCurrentVertex(G,dt,0,0,U);else if(_e==="flipbevel"){if(Zt>100)dt=yt.mult(-1);else{const ve=Zt*at.add(yt).mag()/at.sub(yt).mag();dt._perp()._mult(ve*(de?-1:1))}this.addCurrentVertex(G,dt,0,0,U),this.addCurrentVertex(G,dt.mult(-1),0,0,U)}else if(_e==="bevel"||_e==="fakeround"){const ve=-Math.sqrt(Zt*Zt-1),re=de?ve:0,je=de?0:ve;if(Y&&this.addCurrentVertex(G,at,re,je,U),_e==="fakeround"){const Be=Math.round(180*ue/Math.PI/20);for(let qe=1;qe<Be;qe++){let Ie=qe/Be;if(Ie!==.5){const xi=Ie-.5;Ie+=Ie*xi*(Ie-1)*((1.0904+Pt*(Pt*(3.55645-1.43519*Pt)-3.2452))*xi*xi+(.848013+Pt*(.215638*Pt-1.06021)))}const fn=yt.sub(at)._mult(Ie)._add(at)._unit()._mult(de?-1:1);this.addHalfVertex(G,fn.x,fn.y,!1,de,0,U)}}tt&&this.addCurrentVertex(G,yt,-re,-je,U)}else if(_e==="butt")this.addCurrentVertex(G,dt,0,0,U);else if(_e==="square"){const ve=Y?1:-1;this.addCurrentVertex(G,dt,ve,ve,U)}else _e==="round"&&(Y&&(this.addCurrentVertex(G,at,0,0,U),this.addCurrentVertex(G,at,1,1,U,!0)),tt&&(this.addCurrentVertex(G,yt,-1,-1,U,!0),this.addCurrentVertex(G,yt,0,0,U)));if(ie&&ct<z-1){const ve=G.dist(tt);if(ve>2*V){const re=G.add(tt.sub(G)._mult(V/ve)._round());this.updateDistance(G,re),this.addCurrentVertex(re,yt,0,0,U),G=re}}}}addCurrentVertex(t,n,l,h,m,y=!1){const w=n.y*h-n.x,C=-n.y-n.x*h;this.addHalfVertex(t,n.x+n.y*l,n.y-n.x*l,y,!1,l,m),this.addHalfVertex(t,w,C,y,!0,-h,m),this.distance>Fu/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,n,l,h,m,y))}addHalfVertex({x:t,y:n},l,h,m,y,w,C){const D=.5*(this.lineClips?this.scaledDistance*(Fu-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(m?1:0),(n<<1)+(y?1:0),Math.round(63*l)+128,Math.round(63*h)+128,1+(w===0?0:w<0?-1:1)|(63&D)<<2,D>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const z=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,z,this.e2),C.primitiveLength++),y?this.e2=z:this.e1=z}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,n){this.distance+=t.dist(n),this.updateScaledDistance()}hasLineDasharray(t){for(const n of t){const l=n.paint.get("line-dasharray");if(l&&!l.isConstant())return!0}return!1}addLineDashDependencies(t,n,l,h){for(const m of t){const y=m.paint.get("line-dasharray");if(!y||y.value.kind==="constant")continue;const w=m.layout.get("line-cap")==="round",C={dasharray:y.value.evaluate({zoom:l-1},n,{}),round:w},D={dasharray:y.value.evaluate({zoom:l},n,{}),round:w},z={dasharray:y.value.evaluate({zoom:l+1},n,{}),round:w},N=`${C.dasharray.join(",")},${C.round}`,V=`${D.dasharray.join(",")},${D.round}`,U=`${z.dasharray.join(",")},${z.round}`;h.dashDependencies[N]=C,h.dashDependencies[V]=D,h.dashDependencies[U]=z,n.dashes[m.id]={min:N,mid:V,max:U}}}}let gs,bp;Me("LineBucket",ju,{omit:["layers","patternFeatures"]});var lf={get paint(){return bp=bp||new ti({"line-opacity":new Ve(ht.paint_line["line-opacity"]),"line-color":new Ve(ht.paint_line["line-color"]),"line-translate":new Re(ht.paint_line["line-translate"]),"line-translate-anchor":new Re(ht.paint_line["line-translate-anchor"]),"line-width":new Ve(ht.paint_line["line-width"]),"line-gap-width":new Ve(ht.paint_line["line-gap-width"]),"line-offset":new Ve(ht.paint_line["line-offset"]),"line-blur":new Ve(ht.paint_line["line-blur"]),"line-dasharray":new Il(ht.paint_line["line-dasharray"]),"line-pattern":new Il(ht.paint_line["line-pattern"]),"line-gradient":new mr(ht.paint_line["line-gradient"])})},get layout(){return gs=gs||new ti({"line-cap":new Re(ht.layout_line["line-cap"]),"line-join":new Ve(ht.layout_line["line-join"]),"line-miter-limit":new Re(ht.layout_line["line-miter-limit"]),"line-round-limit":new Re(ht.layout_line["line-round-limit"]),"line-sort-key":new Ve(ht.layout_line["line-sort-key"])})}};class My extends Ve{possiblyEvaluate(t,n){return n=new kn(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),super.possiblyEvaluate(t,n)}evaluate(t,n,l,h){return n=yn({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(t,n,l,h)}}let Bu;class wp extends Xi{constructor(t,n){super(t,lf,n),this.gradientVersion=0,Bu||(Bu=new My(lf.paint.properties["line-width"].specification),Bu.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const n=this.gradientExpression();this.stepInterpolant=!!(function(l){return l._styleExpression!==void 0})(n)&&n._styleExpression.expression instanceof Mo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,n){super.recalculate(t,n),this.paint._values["line-floorwidth"]=Bu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new ju(t)}queryRadius(t){const n=t,l=Bl(Iu("line-width",this,n),Iu("line-gap-width",this,n)),h=Iu("line-offset",this,n);return l/2+Math.abs(h)+Wd(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:l,geometry:h,transform:m,pixelsToTileUnits:y}){const w=Mc(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-m.bearingInRadians,y),C=y/2*Bl(this.paint.get("line-width").evaluate(n,l),this.paint.get("line-gap-width").evaluate(n,l)),D=this.paint.get("line-offset").evaluate(n,l);return D&&(h=(function(z,N){const V=[];for(let U=0;U<z.length;U++){const G=z[U],Y=[];for(let tt=0;tt<G.length;tt++){const at=G[tt-1],yt=G[tt],ct=G[tt+1],dt=tt===0?new L(0,0):yt.sub(at)._unit()._perp(),Pt=tt===G.length-1?new L(0,0):ct.sub(yt)._unit()._perp(),Dt=dt._add(Pt)._unit(),Zt=Dt.x*Pt.x+Dt.y*Pt.y;Zt!==0&&Dt._mult(1/Zt),Y.push(Dt._mult(N)._add(yt))}V.push(Y)}return V})(h,D*y)),(function(z,N,V){for(let U=0;U<N.length;U++){const G=N[U];if(z.length>=3){for(let Y=0;Y<G.length;Y++)if(Ru(z,G[Y]))return!0}if(dy(z,G,V))return!0}return!1})(w,h,C)}isTileClipped(){return!0}}function Bl(r,t){return t>0?t+2*r:r}const yr=Fn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),kc=Fn([{name:"a_projected_pos",components:3,type:"Float32"}],4);Fn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Xh=Fn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Fn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Wo=Fn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Um=Fn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Gm(r,t,n){return r.sections.forEach((l=>{l.text=(function(h,m,y){const w=m.layout.get("text-transform").evaluate(y,{});return w==="uppercase"?h=h.toLocaleUpperCase():w==="lowercase"&&(h=h.toLocaleLowerCase()),La.applyArabicShaping&&(h=La.applyArabicShaping(h)),h})(l.text,t,n)})),r}Fn([{name:"triangle",components:3,type:"Uint16"}]),Fn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Fn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Fn([{type:"Float32",name:"offsetX"}]),Fn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Fn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var Ki=24;const Vl={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},qm={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},ia={40:!0};function Zm(r,t,n,l,h,m){if("fontStack"in t){const y=n[t.fontStack],w=y&&y[r];return w?w.metrics.advance*t.scale+h:0}{const y=l[t.imageName];return y?y.displaySize[0]*t.scale*Ki/m+h:0}}function ys(r,t,n,l){const h=Math.pow(r-t,2);return l?r<t?h/2:2*h:h+Math.abs(n)*n}function Py(r,t,n){let l=0;return r===10&&(l-=1e4),n&&(l+=150),r!==40&&r!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function $m(r,t,n,l,h,m){let y=null,w=ys(t,n,h,m);for(const C of l){const D=ys(t-C.x,n,h,m)+C.badness;D<=w&&(y=C,w=D)}return{index:r,x:t,priorBreak:y,badness:w}}function Dy(r){return r?Dy(r.priorBreak).concat(r.index):[]}class ra{constructor(t="",n=[],l=[]){this.text=t,this.sections=n,this.sectionIndex=l,this.imageSectionID=null}static fromFeature(t,n){const l=new ra;for(let h=0;h<t.sections.length;h++){const m=t.sections[h];m.image?l.addImageSection(m):l.addTextSection(m,n)}return l}length(){return[...this.text].length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}verticalizePunctuation(){this.text=(function(t){let n="",l={premature:!0,value:void 0};const h=t[Symbol.iterator]();let m=h.next();const y=t[Symbol.iterator]();y.next();let w=y.next();for(;!m.done;)n+=!w.done&&wc(w.value.codePointAt(0))&&!Vl[w.value]||!l.premature&&wc(l.value.codePointAt(0))&&!Vl[l.value]||!Vl[m.value]?m.value:Vl[m.value],l={value:m.value,premature:!1},m=h.next(),w=y.next();return n})(this.text)}hasZeroWidthSpaces(){return this.text.includes("")}trim(){const t=this.text.match(/^\s*/),n=t?t[0].length:0,l=this.text.match(/\S\s*$/),h=l?l[0].length-1:0;this.text=this.text.substring(n,this.text.length-h),this.sectionIndex=this.sectionIndex.slice(n,this.sectionIndex.length-h)}substring(t,n){const l=[...this.text].slice(t,n).join(""),h=this.sectionIndex.slice(t,n);return new ra(l,this.sections,h)}toCodeUnitIndex(t){return[...this.text].slice(0,t).join("").length}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((t,n)=>Math.max(t,this.sections[n].scale)),0)}getMaxImageSize(t){let n=0,l=0;for(let h=0;h<this.length();h++){const m=this.getSection(h);if("imageName"in m){const y=t[m.imageName];if(!y)continue;const w=y.displaySize;n=Math.max(n,w[0]),l=Math.max(l,w[1])}}return{maxImageWidth:n,maxImageHeight:l}}addTextSection(t,n){this.text+=t.text,this.sections.push({scale:t.scale||1,verticalAlign:t.verticalAlign||"bottom",fontStack:t.fontStack||n});const l=this.sections.length-1;this.sectionIndex.push(...[...t.text].map((()=>l)))}addImageSection(t){const n=t.image?t.image.name:"";if(n.length===0)return void Nn("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push({scale:1,verticalAlign:t.verticalAlign||"bottom",imageName:n}),this.sectionIndex.push(this.sections.length-1)):Nn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}determineLineBreaks(t,n,l,h,m){const y=[],w=this.determineAverageLineWidth(t,n,l,h,m),C=this.hasZeroWidthSpaces();let D=0,z=0;const N=this.text[Symbol.iterator]();let V=N.next();const U=this.text[Symbol.iterator]();U.next();let G=U.next();const Y=this.text[Symbol.iterator]();Y.next(),Y.next();let tt=Y.next();for(;!V.done;){const at=this.getSection(z),yt=V.value.codePointAt(0);if(Gd(yt)||(D+=Zm(yt,at,l,h,t,m)),!G.done){const ct=Ml(yt),dt=G.value.codePointAt(0);(qm[yt]||ct||"imageName"in at||!tt.done&&ia[dt])&&y.push($m(z+1,D,w,y,Py(yt,dt,ct&&C),!1))}z++,V=N.next(),G=U.next(),tt=Y.next()}return Dy($m(this.length(),D,w,y,0,!0))}determineAverageLineWidth(t,n,l,h,m){let y=0,w=0;for(const C of this.text){const D=this.getSection(w);y+=Zm(C.codePointAt(0),D,l,h,t,m),w++}return y/Math.max(1,Math.ceil(y/n))}}const Yh=4294967296,Tp=1/Yh,Vu=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class Sp{constructor(t=new Uint8Array(16)){this.buf=ArrayBuffer.isView(t)?t:new Uint8Array(t),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(t,n,l=this.length){for(;this.pos<l;){const h=this.readVarint(),m=h>>3,y=this.pos;this.type=7&h,t(m,n,this),this.pos===y&&this.skip(h)}return n}readMessage(t,n){return this.readFields(t,n,this.readVarint()+this.pos)}readFixed32(){const t=this.dataView.getUint32(this.pos,!0);return this.pos+=4,t}readSFixed32(){const t=this.dataView.getInt32(this.pos,!0);return this.pos+=4,t}readFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Yh;return this.pos+=8,t}readSFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Yh;return this.pos+=8,t}readFloat(){const t=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,t}readDouble(){const t=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,t}readVarint(t){const n=this.buf;let l,h;return h=n[this.pos++],l=127&h,h<128?l:(h=n[this.pos++],l|=(127&h)<<7,h<128?l:(h=n[this.pos++],l|=(127&h)<<14,h<128?l:(h=n[this.pos++],l|=(127&h)<<21,h<128?l:(h=n[this.pos],l|=(15&h)<<28,(function(m,y,w){const C=w.buf;let D,z;if(z=C[w.pos++],D=(112&z)>>4,z<128||(z=C[w.pos++],D|=(127&z)<<3,z<128)||(z=C[w.pos++],D|=(127&z)<<10,z<128)||(z=C[w.pos++],D|=(127&z)<<17,z<128)||(z=C[w.pos++],D|=(127&z)<<24,z<128)||(z=C[w.pos++],D|=(1&z)<<31,z<128))return Uu(m,D,y);throw new Error("Expected varint not more than 10 bytes")})(l,t,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const t=this.readVarint();return t%2==1?(t+1)/-2:t/2}readBoolean(){return!!this.readVarint()}readString(){const t=this.readVarint()+this.pos,n=this.pos;return this.pos=t,t-n>=12&&Vu?Vu.decode(this.buf.subarray(n,t)):(function(l,h,m){let y="",w=h;for(;w<m;){const C=l[w];let D,z,N,V=null,U=C>239?4:C>223?3:C>191?2:1;if(w+U>m)break;U===1?C<128&&(V=C):U===2?(D=l[w+1],(192&D)==128&&(V=(31&C)<<6|63&D,V<=127&&(V=null))):U===3?(D=l[w+1],z=l[w+2],(192&D)==128&&(192&z)==128&&(V=(15&C)<<12|(63&D)<<6|63&z,(V<=2047||V>=55296&&V<=57343)&&(V=null))):U===4&&(D=l[w+1],z=l[w+2],N=l[w+3],(192&D)==128&&(192&z)==128&&(192&N)==128&&(V=(15&C)<<18|(63&D)<<12|(63&z)<<6|63&N,(V<=65535||V>=1114112)&&(V=null))),V===null?(V=65533,U=1):V>65535&&(V-=65536,y+=String.fromCharCode(V>>>10&1023|55296),V=56320|1023&V),y+=String.fromCharCode(V),w+=U}return y})(this.buf,n,t)}readBytes(){const t=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,t);return this.pos=t,n}readPackedVarint(t=[],n){const l=this.readPackedEnd();for(;this.pos<l;)t.push(this.readVarint(n));return t}readPackedSVarint(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readSVarint());return t}readPackedBoolean(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readBoolean());return t}readPackedFloat(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readFloat());return t}readPackedDouble(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readDouble());return t}readPackedFixed32(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readFixed32());return t}readPackedSFixed32(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readSFixed32());return t}readPackedFixed64(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readFixed64());return t}readPackedSFixed64(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readSFixed64());return t}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(t){const n=7&t;if(n===0)for(;this.buf[this.pos++]>127;);else if(n===2)this.pos=this.readVarint()+this.pos;else if(n===5)this.pos+=4;else{if(n!==1)throw new Error(`Unimplemented type: ${n}`);this.pos+=8}}writeTag(t,n){this.writeVarint(t<<3|n)}realloc(t){let n=this.length||16;for(;n<this.pos+t;)n*=2;if(n!==this.length){const l=new Uint8Array(n);l.set(this.buf),this.buf=l,this.dataView=new DataView(l.buffer),this.length=n}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeSFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*Tp),!0),this.pos+=8}writeSFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*Tp),!0),this.pos+=8}writeVarint(t){(t=+t||0)>268435455||t<0?(function(n,l){let h,m;if(n>=0?(h=n%4294967296|0,m=n/4294967296|0):(h=~(-n%4294967296),m=~(-n/4294967296),4294967295^h?h=h+1|0:(h=0,m=m+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),(function(y,w,C){C.buf[C.pos++]=127&y|128,y>>>=7,C.buf[C.pos++]=127&y|128,y>>>=7,C.buf[C.pos++]=127&y|128,y>>>=7,C.buf[C.pos++]=127&y|128,C.buf[C.pos]=127&(y>>>=7)})(h,0,l),(function(y,w){const C=(7&y)<<4;w.buf[w.pos++]|=C|((y>>>=3)?128:0),y&&(w.buf[w.pos++]=127&y|((y>>>=7)?128:0),y&&(w.buf[w.pos++]=127&y|((y>>>=7)?128:0),y&&(w.buf[w.pos++]=127&y|((y>>>=7)?128:0),y&&(w.buf[w.pos++]=127&y|((y>>>=7)?128:0),y&&(w.buf[w.pos++]=127&y)))))})(m,l)})(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))}writeSVarint(t){this.writeVarint(t<0?2*-t-1:2*t)}writeBoolean(t){this.writeVarint(+t)}writeString(t){t=String(t),this.realloc(4*t.length),this.pos++;const n=this.pos;this.pos=(function(h,m,y){for(let w,C,D=0;D<m.length;D++){if(w=m.charCodeAt(D),w>55295&&w<57344){if(!C){w>56319||D+1===m.length?(h[y++]=239,h[y++]=191,h[y++]=189):C=w;continue}if(w<56320){h[y++]=239,h[y++]=191,h[y++]=189,C=w;continue}w=C-55296<<10|w-56320|65536,C=null}else C&&(h[y++]=239,h[y++]=191,h[y++]=189,C=null);w<128?h[y++]=w:(w<2048?h[y++]=w>>6|192:(w<65536?h[y++]=w>>12|224:(h[y++]=w>>18|240,h[y++]=w>>12&63|128),h[y++]=w>>6&63|128),h[y++]=63&w|128)}return y})(this.buf,t,this.pos);const l=this.pos-n;l>=128&&Hm(n,l,this),this.pos=n-1,this.writeVarint(l),this.pos+=l}writeFloat(t){this.realloc(4),this.dataView.setFloat32(this.pos,t,!0),this.pos+=4}writeDouble(t){this.realloc(8),this.dataView.setFloat64(this.pos,t,!0),this.pos+=8}writeBytes(t){const n=t.length;this.writeVarint(n),this.realloc(n);for(let l=0;l<n;l++)this.buf[this.pos++]=t[l]}writeRawMessage(t,n){this.pos++;const l=this.pos;t(n,this);const h=this.pos-l;h>=128&&Hm(l,h,this),this.pos=l-1,this.writeVarint(h),this.pos+=h}writeMessage(t,n,l){this.writeTag(t,2),this.writeRawMessage(n,l)}writePackedVarint(t,n){n.length&&this.writeMessage(t,Ry,n)}writePackedSVarint(t,n){n.length&&this.writeMessage(t,Ep,n)}writePackedBoolean(t,n){n.length&&this.writeMessage(t,Av,n)}writePackedFloat(t,n){n.length&&this.writeMessage(t,Xm,n)}writePackedDouble(t,n){n.length&&this.writeMessage(t,Cv,n)}writePackedFixed32(t,n){n.length&&this.writeMessage(t,Mv,n)}writePackedSFixed32(t,n){n.length&&this.writeMessage(t,Iy,n)}writePackedFixed64(t,n){n.length&&this.writeMessage(t,zy,n)}writePackedSFixed64(t,n){n.length&&this.writeMessage(t,Wh,n)}writeBytesField(t,n){this.writeTag(t,2),this.writeBytes(n)}writeFixed32Field(t,n){this.writeTag(t,5),this.writeFixed32(n)}writeSFixed32Field(t,n){this.writeTag(t,5),this.writeSFixed32(n)}writeFixed64Field(t,n){this.writeTag(t,1),this.writeFixed64(n)}writeSFixed64Field(t,n){this.writeTag(t,1),this.writeSFixed64(n)}writeVarintField(t,n){this.writeTag(t,0),this.writeVarint(n)}writeSVarintField(t,n){this.writeTag(t,0),this.writeSVarint(n)}writeStringField(t,n){this.writeTag(t,2),this.writeString(n)}writeFloatField(t,n){this.writeTag(t,5),this.writeFloat(n)}writeDoubleField(t,n){this.writeTag(t,1),this.writeDouble(n)}writeBooleanField(t,n){this.writeVarintField(t,+n)}}function Uu(r,t,n){return n?4294967296*t+(r>>>0):4294967296*(t>>>0)+(r>>>0)}function Hm(r,t,n){const l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));n.realloc(l);for(let h=n.pos-1;h>=r;h--)n.buf[h+l]=n.buf[h]}function Ry(r,t){for(let n=0;n<r.length;n++)t.writeVarint(r[n])}function Ep(r,t){for(let n=0;n<r.length;n++)t.writeSVarint(r[n])}function Xm(r,t){for(let n=0;n<r.length;n++)t.writeFloat(r[n])}function Cv(r,t){for(let n=0;n<r.length;n++)t.writeDouble(r[n])}function Av(r,t){for(let n=0;n<r.length;n++)t.writeBoolean(r[n])}function Mv(r,t){for(let n=0;n<r.length;n++)t.writeFixed32(r[n])}function Iy(r,t){for(let n=0;n<r.length;n++)t.writeSFixed32(r[n])}function zy(r,t){for(let n=0;n<r.length;n++)t.writeFixed64(r[n])}function Wh(r,t){for(let n=0;n<r.length;n++)t.writeSFixed64(r[n])}function Cp(r,t,n){r===1&&n.readMessage(Ly,t)}function Ly(r,t,n){if(r===3){const{id:l,bitmap:h,width:m,height:y,left:w,top:C,advance:D}=n.readMessage(ky,{});t.push({id:l,bitmap:new jh({width:m+6,height:y+6},h),metrics:{width:m,height:y,left:w,top:C,advance:D}})}}function ky(r,t,n){r===1?t.id=n.readVarint():r===2?t.bitmap=n.readBytes():r===3?t.width=n.readVarint():r===4?t.height=n.readVarint():r===5?t.left=n.readSVarint():r===6?t.top=n.readSVarint():r===7&&(t.advance=n.readVarint())}function Ym(r){let t=0,n=0;for(const y of r)t+=y.w*y.h,n=Math.max(n,y.w);r.sort(((y,w)=>w.h-y.h));const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),n),h:1/0}];let h=0,m=0;for(const y of r)for(let w=l.length-1;w>=0;w--){const C=l[w];if(!(y.w>C.w||y.h>C.h)){if(y.x=C.x,y.y=C.y,m=Math.max(m,y.y+y.h),h=Math.max(h,y.x+y.w),y.w===C.w&&y.h===C.h){const D=l.pop();D&&w<l.length&&(l[w]=D)}else y.h===C.h?(C.x+=y.w,C.w-=y.w):y.w===C.w?(C.y+=y.h,C.h-=y.h):(l.push({x:C.x+y.w,y:C.y,w:C.w-y.w,h:y.h}),C.y+=y.h,C.h-=y.h);break}}return{w:h,h:m,fill:t/(h*m)||0}}class Ap{constructor(t,{pixelRatio:n,version:l,stretchX:h,stretchY:m,content:y,textFitWidth:w,textFitHeight:C}){this.paddedRect=t,this.pixelRatio=n,this.stretchX=h,this.stretchY=m,this.content=y,this.version=l,this.textFitWidth=w,this.textFitHeight=C}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Wm{constructor(t,n){const l={},h={};this.haveRenderCallbacks=[];const m=[];this.addImages(t,l,m),this.addImages(n,h,m);const{w:y,h:w}=Ym(m),C=new Vr({width:y||1,height:w||1});for(const D in t){const z=t[D],N=l[D].paddedRect;Vr.copy(z.data,C,{x:0,y:0},{x:N.x+1,y:N.y+1},z.data)}for(const D in n){const z=n[D],N=h[D].paddedRect,V=N.x+1,U=N.y+1,G=z.data.width,Y=z.data.height;Vr.copy(z.data,C,{x:0,y:0},{x:V,y:U},z.data),Vr.copy(z.data,C,{x:0,y:Y-1},{x:V,y:U-1},{width:G,height:1}),Vr.copy(z.data,C,{x:0,y:0},{x:V,y:U+Y},{width:G,height:1}),Vr.copy(z.data,C,{x:G-1,y:0},{x:V-1,y:U},{width:1,height:Y}),Vr.copy(z.data,C,{x:0,y:0},{x:V+G,y:U},{width:1,height:Y})}this.image=C,this.iconPositions=l,this.patternPositions=h}addImages(t,n,l){for(const h in t){const m=t[h],y={x:0,y:0,w:m.data.width+2,h:m.data.height+2};l.push(y),n[h]=new Ap(y,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(t,n){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in t.updatedImages)this.patchUpdatedImage(this.iconPositions[l],t.getImage(l),n),this.patchUpdatedImage(this.patternPositions[l],t.getImage(l),n)}patchUpdatedImage(t,n,l){if(!t||!n||t.version===n.version)return;t.version=n.version;const[h,m]=t.tl;l.update(n.data,void 0,{x:h,y:m})}}var Ul;function Gu(r,t,n,l,h,m,y,w,C,D,z,N,V,U,G){const Y=ra.fromFeature(r,h);let tt;N===T.ay.vertical&&Y.verticalizePunctuation();let at=Y.determineLineBreaks(D,m,t,l,U);const{processBidirectionalText:yt,processStyledBidirectionalText:ct}=La;if(yt&&Y.sections.length===1){tt=[],at=at.map((Zt=>Y.toCodeUnitIndex(Zt)));const Dt=yt(Y.toString(),at);for(const Zt of Dt){const ue=[...Zt].map((()=>0));tt.push(new ra(Zt,Y.sections,ue))}}else if(ct){tt=[],at=at.map((ie=>Y.toCodeUnitIndex(ie)));let Dt=0;const Zt=[];for(const ie of Y.text)Zt.push(...Array(ie.length).fill(Y.sectionIndex[Dt])),Dt++;const ue=ct(Y.text,Zt,at);for(const ie of ue){const de=[];let Se="";for(const _e of ie[0])de.push(ie[1][Se.length]),Se+=_e;tt.push(new ra(ie[0],Y.sections,de))}}else tt=(function(Dt,Zt){const ue=[];let ie=0;for(const de of Zt)ue.push(Dt.substring(ie,de)),ie=de;return ie<Dt.length()&&ue.push(Dt.substring(ie,Dt.length())),ue})(Y,at);const dt=[],Pt={positionedLines:dt,text:Y.toString(),top:z[1],bottom:z[1],left:z[0],right:z[0],writingMode:N,iconsInText:!1,verticalizable:!1};return(function(Dt,Zt,ue,ie,de,Se,_e,ve,re,je,Be,qe){let Ie=0,fn=0,xi=0,ar=0;const rs=ve==="right"?1:ve==="left"?0:.5,tl=Ki/qe;let Ns=0;for(const Bi of de){Bi.trim();const Gr=Bi.getMaxScale(),vs={positionedGlyphs:[],lineOffset:0};Dt.positionedLines[Ns]=vs;const xs=vs.positionedGlyphs;let oa=0;if(!Bi.length()){fn+=Se,++Ns;continue}const as=Oy(ie,Bi,tl);let la=0;for(const Pr of Bi.text){const Ei=Bi.getSection(la),or=Pr.codePointAt(0),zi=Km(re,Be,or),Dr={glyph:or,imageName:null,x:Ie,y:fn+-17,vertical:zi,scale:1,fontStack:"",sectionIndex:Bi.getSectionIndex(la),metrics:null,rect:null};let eh;if("fontStack"in Ei){if(eh=Pv(Ei,or,zi,as,Zt,ue),!eh)continue;Dr.fontStack=Ei.fontStack}else{if(Dt.iconsInText=!0,Ei.scale*=tl,eh=Ny(Ei,zi,Gr,as,ie),!eh)continue;oa=Math.max(oa,eh.imageOffset),Dr.imageName=Ei.imageName}const{rect:Hl,metrics:Rg,baselineOffset:cd}=eh;Dr.y+=cd,Dr.scale=Ei.scale,Dr.metrics=Rg,Dr.rect=Hl,xs.push(Dr),zi?(Dt.verticalizable=!0,Ie+=("imageName"in Ei?Rg.advance:Ki)*Ei.scale+je):Ie+=Rg.advance*Ei.scale+je,la++}xs.length!==0&&(xi=Math.max(Ie-je,xi),Dv(xs,0,xs.length-1,rs)),Ie=0,vs.lineOffset=Math.max(oa,(Gr-1)*Ki);const el=Se*Gr+oa;fn+=el,ar=Math.max(el,ar),++Ns}const{horizontalAlign:Ur,verticalAlign:ss}=Mp(_e);(function(Bi,Gr,vs,xs,oa,as,la,el,Pr){const Ei=(Gr-vs)*oa;let or=0;or=as!==la?-el*xs- -17:-xs*Pr*la+.5*la;for(const zi of Bi)for(const Dr of zi.positionedGlyphs)Dr.x+=Ei,Dr.y+=or})(Dt.positionedLines,rs,Ur,ss,xi,ar,Se,fn,de.length),Dt.top+=-ss*fn,Dt.bottom=Dt.top+fn,Dt.left+=-Ur*xi,Dt.right=Dt.left+xi})(Pt,t,n,l,tt,y,w,C,N,D,V,G),!(function(Dt){for(const Zt of Dt)if(Zt.positionedGlyphs.length!==0)return!1;return!0})(dt)&&Pt}function Mp(r){let t=.5,n=.5;switch(r){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:t,verticalAlign:n}}function Oy(r,t,n){const l=t.getMaxScale()*Ki,{maxImageWidth:h,maxImageHeight:m}=t.getMaxImageSize(r),y=Math.max(l,m*n);return{verticalLineContentWidth:Math.max(l,h*n),horizontalLineContentHeight:y}}function Wn(r){switch(r){case"top":return 0;case"center":return .5;default:return 1}}function Km(r,t,n){return!(r===T.ay.horizontal||!t&&!Ms(n)||t&&(Gd(n)||(l=n,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(l)))));var l}function Pv(r,t,n,l,h,m){const y=m[r.fontStack],w=(function(D,z,N,V){if(D&&D.rect)return D;const U=z[N.fontStack],G=U&&U[V];return G?{rect:null,metrics:G.metrics}:null})(y&&y[t],h,r,t);if(w===null)return null;let C;if(n)C=l.verticalLineContentWidth-r.scale*Ki;else{const D=Wn(r.verticalAlign);C=(l.horizontalLineContentHeight-r.scale*Ki)*D}return{rect:w.rect,metrics:w.metrics,baselineOffset:C}}function Ny(r,t,n,l,h){const m=h[r.imageName];if(!m)return null;const y=m.paddedRect,w=m.displaySize,C={width:w[0],height:w[1],left:1,top:-3,advance:t?w[1]:w[0]};let D;if(t)D=l.verticalLineContentWidth-w[1]*r.scale;else{const z=Wn(r.verticalAlign);D=(l.horizontalLineContentHeight-w[1]*r.scale)*z}return{rect:y,metrics:C,baselineOffset:D,imageOffset:(t?w[0]:w[1])*r.scale-Ki*n}}function Dv(r,t,n,l){if(l===0)return;const h=r[n],m=(r[n].x+h.metrics.advance*h.scale)*l;for(let y=t;y<=n;y++)r[y].x-=m}function Rv(r,t,n){const{horizontalAlign:l,verticalAlign:h}=Mp(n),m=t[0]-r.displaySize[0]*l,y=t[1]-r.displaySize[1]*h;return{image:r,top:y,bottom:y+r.displaySize[1],left:m,right:m+r.displaySize[0]}}function Fy(r){var t,n;let l=r.left,h=r.top,m=r.right-l,y=r.bottom-h;const w=(t=r.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",C=(n=r.image.textFitHeight)!==null&&n!==void 0?n:"stretchOrShrink",D=(r.image.content[2]-r.image.content[0])/(r.image.content[3]-r.image.content[1]);if(C==="proportional"){if(w==="stretchOnly"&&m/y<D||w==="proportional"){const z=Math.ceil(y*D);l*=z/m,m=z}}else if(w==="proportional"&&C==="stretchOnly"&&D!==0&&m/y>D){const z=Math.ceil(m/D);h*=z/y,y=z}return{x1:l,y1:h,x2:l+m,y2:h+y}}function cf(r,t,n,l,h,m){const y=r.image;let w;if(y.content){const tt=y.content,at=y.pixelRatio||1;w=[tt[0]/at,tt[1]/at,y.displaySize[0]-tt[2]/at,y.displaySize[1]-tt[3]/at]}const C=t.left*m,D=t.right*m;let z,N,V,U;n==="width"||n==="both"?(U=h[0]+C-l[3],N=h[0]+D+l[1]):(U=h[0]+(C+D-y.displaySize[0])/2,N=U+y.displaySize[0]);const G=t.top*m,Y=t.bottom*m;return n==="height"||n==="both"?(z=h[1]+G-l[0],V=h[1]+Y+l[2]):(z=h[1]+(G+Y-y.displaySize[1])/2,V=z+y.displaySize[1]),{image:y,top:z,right:N,bottom:V,left:U,collisionPadding:w}}Me("ImagePosition",Ap),Me("ImageAtlas",Wm),T.ay=void 0,(Ul=T.ay||(T.ay={}))[Ul.none=0]="none",Ul[Ul.horizontal=1]="horizontal",Ul[Ul.vertical=2]="vertical",Ul[Ul.horizontalOnly=3]="horizontalOnly";const zs=128,Ko=32640;function uf(r,t){const{expression:n}=t;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new kn(r+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:h}=n;let m=0;for(;m<l.length&&l[m]<=r;)m++;m=Math.max(0,m-1);let y=m;for(;y<l.length&&l[y]<r+1;)y++;y=Math.min(l.length-1,y);const w=l[m],C=l[y];return n.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:C,interpolationType:h}:{kind:"camera",minZoom:w,maxZoom:C,minSize:n.evaluate(new kn(w)),maxSize:n.evaluate(new kn(C)),interpolationType:h}}}function hf(r,t,n){let l="never";const h=r.get(t);return h?l=h:r.get(n)&&(l="always"),l}const Oc=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function sa(r,t,n,l,h,m,y,w,C,D,z,N,V){const U=w?Math.min(Ko,Math.round(w[0])):0,G=w?Math.min(Ko,Math.round(w[1])):0;r.emplaceBack(t,n,Math.round(32*l),Math.round(32*h),m,y,(U<<1)+(C?1:0),G,16*D,16*z,256*N,256*V)}function qu(r,t,n){r.emplaceBack(t.x,t.y,n),r.emplaceBack(t.x,t.y,n),r.emplaceBack(t.x,t.y,n),r.emplaceBack(t.x,t.y,n)}function Iv(r){for(const t of r.sections)if(so(t.text))return!0;return!1}class Pp{constructor(t){this.layoutVertexArray=new $t,this.indexArray=new ye,this.programConfigurations=t,this.segments=new Ke,this.dynamicLayoutVertexArray=new Vt,this.opacityVertexArray=new Ut,this.hasVisibleVertices=!1,this.placedSymbolArray=new R}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,n,l,h){this.isEmpty()||(l&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,yr.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,kc.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Oc,!0),this.opacityVertexBuffer.itemSize=1),(l||h)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Me("SymbolBuffers",Pp);class Dp{constructor(t,n,l){this.layoutVertexArray=new t,this.layoutAttributes=n,this.indexArray=new l,this.segments=new Ke,this.collisionVertexArray=new ge}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Xh.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Me("CollisionBuffers",Dp);class Zu{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((y=>y.id)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=uf(this.zoom,n["text-size"]),this.iconSizeData=uf(this.zoom,n["icon-size"]);const l=this.layers[0].layout,h=l.get("symbol-sort-key"),m=l.get("symbol-z-order");this.canOverlap=hf(l,"text-overlap","text-allow-overlap")!=="never"||hf(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map((y=>T.ay[y]))),this.stateDependentLayerIds=this.layers.filter((y=>y.isStateDependent())).map((y=>y.id)),this.sourceID=t.sourceID}createArrays(){this.text=new Pp(new fo(this.layers,this.zoom,(t=>/^text/.test(t)))),this.icon=new Pp(new fo(this.layers,this.zoom,(t=>/^icon/.test(t)))),this.glyphOffsetArray=new $,this.lineVertexArray=new q,this.symbolInstances=new j,this.textAnchorOffsets=new nt}calculateGlyphDependencies(t,n,l,h,m){for(const y of t)if(n[y.codePointAt(0)]=!0,(l||h)&&m){const w=Vl[y];w&&(n[w.codePointAt(0)]=!0)}}populate(t,n,l){const h=this.layers[0],m=h.layout,y=m.get("text-font"),w=m.get("text-field"),C=m.get("icon-image"),D=(w.value.kind!=="constant"||w.value.value instanceof bi&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),z=C.value.kind!=="constant"||!!C.value.value||Object.keys(C.parameters).length>0,N=m.get("symbol-sort-key");if(this.features=[],!D&&!z)return;const V=n.iconDependencies,U=n.glyphDependencies,G=n.availableImages,Y=new kn(this.zoom);for(const{feature:tt,id:at,index:yt,sourceLayerIndex:ct}of t){const dt=h._featureFilter.needGeometry,Pt=Br(tt,dt);if(!h._featureFilter.filter(Y,Pt,l))continue;let Dt,Zt;if(dt||(Pt.geometry=po(tt)),D){const ie=h.getValueAndResolveTokens("text-field",Pt,l,G),de=bi.factory(ie),Se=this.hasRTLText=this.hasRTLText||Iv(de);(!Se||La.getRTLTextPluginStatus()==="unavailable"||Se&&La.isParsed())&&(Dt=Gm(de,h,Pt))}if(z){const ie=h.getValueAndResolveTokens("icon-image",Pt,l,G);Zt=ie instanceof wi?ie:wi.fromString(ie)}if(!Dt&&!Zt)continue;const ue=this.sortFeaturesByKey?N.evaluate(Pt,{},l):void 0;if(this.features.push({id:at,text:Dt,icon:Zt,index:yt,sourceLayerIndex:ct,geometry:Pt.geometry,properties:tt.properties,type:ku.types[tt.type],sortKey:ue}),Zt&&(V[Zt.name]=!0),Dt){const ie=y.evaluate(Pt,{},l).join(","),de=m.get("text-rotation-alignment")!=="viewport"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(T.ay.vertical)>=0;for(const Se of Dt.sections)if(Se.image)V[Se.image.name]=!0;else{const _e=xc(Dt.toString()),ve=Se.fontStack||ie,re=U[ve]=U[ve]||{};this.calculateGlyphDependencies(Se.text,re,de,this.allowVerticalPlacement,_e)}}}m.get("symbol-placement")==="line"&&(this.features=(function(tt){const at={},yt={},ct=[];let dt=0;function Pt(ie){ct.push(tt[ie]),dt++}function Dt(ie,de,Se){const _e=yt[ie];return delete yt[ie],yt[de]=_e,ct[_e].geometry[0].pop(),ct[_e].geometry[0]=ct[_e].geometry[0].concat(Se[0]),_e}function Zt(ie,de,Se){const _e=at[de];return delete at[de],at[ie]=_e,ct[_e].geometry[0].shift(),ct[_e].geometry[0]=Se[0].concat(ct[_e].geometry[0]),_e}function ue(ie,de,Se){const _e=Se?de[0][de[0].length-1]:de[0][0];return`${ie}:${_e.x}:${_e.y}`}for(let ie=0;ie<tt.length;ie++){const de=tt[ie],Se=de.geometry,_e=de.text?de.text.toString():null;if(!_e){Pt(ie);continue}const ve=ue(_e,Se),re=ue(_e,Se,!0);if(ve in yt&&re in at&&yt[ve]!==at[re]){const je=Zt(ve,re,Se),Be=Dt(ve,re,ct[je].geometry);delete at[ve],delete yt[re],yt[ue(_e,ct[Be].geometry,!0)]=Be,ct[je].geometry=null}else ve in yt?Dt(ve,re,Se):re in at?Zt(ve,re,Se):(Pt(ie),at[ve]=dt-1,yt[re]=dt-1)}return ct.filter((ie=>ie.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((tt,at)=>tt.sortKey-at.sortKey))}update(t,n,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,n,this.layers,{imagePositions:l}),this.icon.programConfigurations.updatePaintArrays(t,n,this.layers,{imagePositions:l}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,n){const l=this.lineVertexArray.length;if(t.segment!==void 0){let h=t.dist(n[t.segment+1]),m=t.dist(n[t.segment]);const y={};for(let w=t.segment+1;w<n.length;w++)y[w]={x:n[w].x,y:n[w].y,tileUnitDistanceFromAnchor:h},w<n.length-1&&(h+=n[w+1].dist(n[w]));for(let w=t.segment||0;w>=0;w--)y[w]={x:n[w].x,y:n[w].y,tileUnitDistanceFromAnchor:m},w>0&&(m+=n[w-1].dist(n[w]));for(let w=0;w<n.length;w++){const C=y[w];this.lineVertexArray.emplaceBack(C.x,C.y,C.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(t,n,l,h,m,y,w,C,D,z,N,V){const U=t.indexArray,G=t.layoutVertexArray,Y=t.segments.prepareSegment(4*n.length,G,U,this.canOverlap?y.sortKey:void 0),tt=this.glyphOffsetArray.length,at=Y.vertexLength,yt=this.allowVerticalPlacement&&w===T.ay.vertical?Math.PI/2:0,ct=y.text&&y.text.sections;for(let dt=0;dt<n.length;dt++){const{tl:Pt,tr:Dt,bl:Zt,br:ue,tex:ie,pixelOffsetTL:de,pixelOffsetBR:Se,minFontScaleX:_e,minFontScaleY:ve,glyphOffset:re,isSDF:je,sectionIndex:Be}=n[dt],qe=Y.vertexLength,Ie=re[1];sa(G,C.x,C.y,Pt.x,Ie+Pt.y,ie.x,ie.y,l,je,de.x,de.y,_e,ve),sa(G,C.x,C.y,Dt.x,Ie+Dt.y,ie.x+ie.w,ie.y,l,je,Se.x,de.y,_e,ve),sa(G,C.x,C.y,Zt.x,Ie+Zt.y,ie.x,ie.y+ie.h,l,je,de.x,Se.y,_e,ve),sa(G,C.x,C.y,ue.x,Ie+ue.y,ie.x+ie.w,ie.y+ie.h,l,je,Se.x,Se.y,_e,ve),qu(t.dynamicLayoutVertexArray,C,yt),U.emplaceBack(qe,qe+2,qe+1),U.emplaceBack(qe+1,qe+2,qe+3),Y.vertexLength+=4,Y.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(re[0]),dt!==n.length-1&&Be===n[dt+1].sectionIndex||t.programConfigurations.populatePaintArrays(G.length,y,y.index,{imagePositions:{},canonical:V,formattedSection:ct&&ct[Be]})}t.placedSymbolArray.emplaceBack(C.x,C.y,tt,this.glyphOffsetArray.length-tt,at,D,z,C.segment,l?l[0]:0,l?l[1]:0,h[0],h[1],w,0,!1,0,N)}_addCollisionDebugVertex(t,n,l,h,m,y){return n.emplaceBack(0,0),t.emplaceBack(l.x,l.y,h,m,Math.round(y.x),Math.round(y.y))}addCollisionDebugVertices(t,n,l,h,m,y,w){const C=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),D=C.vertexLength,z=m.layoutVertexArray,N=m.collisionVertexArray,V=w.anchorX,U=w.anchorY;this._addCollisionDebugVertex(z,N,y,V,U,new L(t,n)),this._addCollisionDebugVertex(z,N,y,V,U,new L(l,n)),this._addCollisionDebugVertex(z,N,y,V,U,new L(l,h)),this._addCollisionDebugVertex(z,N,y,V,U,new L(t,h)),C.vertexLength+=4;const G=m.indexArray;G.emplaceBack(D,D+1),G.emplaceBack(D+1,D+2),G.emplaceBack(D+2,D+3),G.emplaceBack(D+3,D),C.primitiveLength+=4}addDebugCollisionBoxes(t,n,l,h){for(let m=t;m<n;m++){const y=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(y.x1,y.y1,y.x2,y.y2,h?this.textCollisionBox:this.iconCollisionBox,y.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Dp(qt,Wo.members,oe),this.iconCollisionBox=new Dp(qt,Wo.members,oe);for(let t=0;t<this.symbolInstances.length;t++){const n=this.symbolInstances.get(t);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}}_deserializeCollisionBoxesForSymbol(t,n,l,h,m,y,w,C,D){const z={};for(let N=n;N<l;N++){const V=t.get(N);z.textBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},z.textFeatureIndex=V.featureIndex;break}for(let N=h;N<m;N++){const V=t.get(N);z.verticalTextBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},z.verticalTextFeatureIndex=V.featureIndex;break}for(let N=y;N<w;N++){const V=t.get(N);z.iconBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},z.iconFeatureIndex=V.featureIndex;break}for(let N=C;N<D;N++){const V=t.get(N);z.verticalIconBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,anchorPointX:V.anchorPointX,anchorPointY:V.anchorPointY},z.verticalIconFeatureIndex=V.featureIndex;break}return z}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const l=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,n){const l=t.placedSymbolArray.get(n),h=l.vertexStartIndex+4*l.numGlyphs;for(let m=l.vertexStartIndex;m<h;m+=4)t.indexArray.emplaceBack(m,m+2,m+1),t.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(t),l=Math.cos(t),h=[],m=[],y=[];for(let w=0;w<this.symbolInstances.length;++w){y.push(w);const C=this.symbolInstances.get(w);h.push(0|Math.round(n*C.anchorX+l*C.anchorY)),m.push(C.featureIndex)}return y.sort(((w,C)=>h[w]-h[C]||m[C]-m[w])),y}addToSortKeyRanges(t,n){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===n?l.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const l=this.symbolInstances.get(n);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach(((h,m,y)=>{h>=0&&y.indexOf(h)===m&&this.addIndicesForPlacedSymbol(this.text,h)})),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Qm,jy;Me("SymbolBucket",Zu,{omit:["layers","collisionBoxArray","features","compareText"]}),Zu.MAX_GLYPHS=65535,Zu.addDynamicAttributes=qu;var df={get paint(){return jy=jy||new ti({"icon-opacity":new Ve(ht.paint_symbol["icon-opacity"]),"icon-color":new Ve(ht.paint_symbol["icon-color"]),"icon-halo-color":new Ve(ht.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ve(ht.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ve(ht.paint_symbol["icon-halo-blur"]),"icon-translate":new Re(ht.paint_symbol["icon-translate"]),"icon-translate-anchor":new Re(ht.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ve(ht.paint_symbol["text-opacity"]),"text-color":new Ve(ht.paint_symbol["text-color"],{runtimeType:wr,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new Ve(ht.paint_symbol["text-halo-color"]),"text-halo-width":new Ve(ht.paint_symbol["text-halo-width"]),"text-halo-blur":new Ve(ht.paint_symbol["text-halo-blur"]),"text-translate":new Re(ht.paint_symbol["text-translate"]),"text-translate-anchor":new Re(ht.paint_symbol["text-translate-anchor"])})},get layout(){return Qm=Qm||new ti({"symbol-placement":new Re(ht.layout_symbol["symbol-placement"]),"symbol-spacing":new Re(ht.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Re(ht.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ve(ht.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Re(ht.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Re(ht.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Re(ht.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Re(ht.layout_symbol["icon-ignore-placement"]),"icon-optional":new Re(ht.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Re(ht.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ve(ht.layout_symbol["icon-size"]),"icon-text-fit":new Re(ht.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Re(ht.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ve(ht.layout_symbol["icon-image"]),"icon-rotate":new Ve(ht.layout_symbol["icon-rotate"]),"icon-padding":new Ve(ht.layout_symbol["icon-padding"]),"icon-keep-upright":new Re(ht.layout_symbol["icon-keep-upright"]),"icon-offset":new Ve(ht.layout_symbol["icon-offset"]),"icon-anchor":new Ve(ht.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Re(ht.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Re(ht.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Re(ht.layout_symbol["text-rotation-alignment"]),"text-field":new Ve(ht.layout_symbol["text-field"]),"text-font":new Ve(ht.layout_symbol["text-font"]),"text-size":new Ve(ht.layout_symbol["text-size"]),"text-max-width":new Ve(ht.layout_symbol["text-max-width"]),"text-line-height":new Re(ht.layout_symbol["text-line-height"]),"text-letter-spacing":new Ve(ht.layout_symbol["text-letter-spacing"]),"text-justify":new Ve(ht.layout_symbol["text-justify"]),"text-radial-offset":new Ve(ht.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Re(ht.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Ve(ht.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Ve(ht.layout_symbol["text-anchor"]),"text-max-angle":new Re(ht.layout_symbol["text-max-angle"]),"text-writing-mode":new Re(ht.layout_symbol["text-writing-mode"]),"text-rotate":new Ve(ht.layout_symbol["text-rotate"]),"text-padding":new Re(ht.layout_symbol["text-padding"]),"text-keep-upright":new Re(ht.layout_symbol["text-keep-upright"]),"text-transform":new Ve(ht.layout_symbol["text-transform"]),"text-offset":new Ve(ht.layout_symbol["text-offset"]),"text-allow-overlap":new Re(ht.layout_symbol["text-allow-overlap"]),"text-overlap":new Re(ht.layout_symbol["text-overlap"]),"text-ignore-placement":new Re(ht.layout_symbol["text-ignore-placement"]),"text-optional":new Re(ht.layout_symbol["text-optional"])})}};class Jm{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Cn,this.defaultValue=t}evaluate(t){if(t.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(t.formattedSection))return n.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Me("FormatSectionOverride",Jm,{omit:["defaultValue"]});class ff extends Xi{constructor(t,n){super(t,df,n)}recalculate(t,n){if(super.recalculate(t,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const h=[];for(const m of l)h.indexOf(m)<0&&h.push(m);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,n,l,h){const m=this.layout.get(t).evaluate(n,{},l,h),y=this._unevaluatedLayout._values[t];return y.isDataDriven()||vu(y.value)||!m?m:(function(w,C){return C.replace(/{([^{}]+)}/g,((D,z)=>w&&z in w?String(w[z]):""))})(n.properties,m)}createBucket(t){return new Zu(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of df.paint.overridableProperties){if(!ff.hasPaintOverride(this.layout,t))continue;const n=this.paint.get(t),l=new Jm(n),h=new mc(l,n.property.specification);let m=null;m=n.value.kind==="constant"||n.value.kind==="source"?new Lo("source",h):new Nr("composite",h,n.value.zoomStops),this.paint._values[t]=new Ds(n.property,m,n.parameters)}}_handleOverridablePaintPropertyUpdate(t,n,l){return!(!this.layout||n.isDataDriven()||l.isDataDriven())&&ff.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,n){const l=t.get("text-field"),h=df.paint.properties[n];let m=!1;const y=w=>{for(const C of w)if(h.overrides&&h.overrides.hasOverride(C))return void(m=!0)};if(l.value.kind==="constant"&&l.value.value instanceof bi)y(l.value.value.sections);else if(l.value.kind==="source"||l.value.kind==="composite"){const w=D=>{m||(D instanceof Ha&&$n(D.value)===Eo?y(D.value.sections):D instanceof fl?y(D.sections):D.eachChild(w))},C=l.value;C._styleExpression&&w(C._styleExpression.expression)}return m}}let By;var tg={get paint(){return By=By||new ti({"background-color":new Re(ht.paint_background["background-color"]),"background-pattern":new zh(ht.paint_background["background-pattern"]),"background-opacity":new Re(ht.paint_background["background-opacity"])})}};class eg extends Xi{constructor(t,n){super(t,tg,n)}}class zv extends Xi{constructor(t,n){super(t,{},n),this.onAdd=l=>{this.implementation.onAdd&&this.implementation.onAdd(l,l.painter.context.gl)},this.onRemove=l=>{this.implementation.onRemove&&this.implementation.onRemove(l,l.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Lv{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const pf={once:!0},ng=63710088e-1;class Gl{constructor(t,n){if(isNaN(t)||isNaN(n))throw new Error(`Invalid LngLat object: (${t}, ${n})`);if(this.lng=+t,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Gl(Le(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const n=Math.PI/180,l=this.lat*n,h=t.lat*n,m=Math.sin(l)*Math.sin(h)+Math.cos(l)*Math.cos(h)*Math.cos((t.lng-this.lng)*n);return ng*Math.acos(Math.min(m,1))}static convert(t){if(t instanceof Gl)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Gl(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Gl(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const xn=2*Math.PI*ng;function Rp(r){return xn*Math.cos(r*Math.PI/180)}function mf(r){return(180+r)/360}function Ip(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function ig(r,t){return r/Rp(t)}function zp(r){return 360*r-180}function Nc(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function gf(r,t){return r*Rp(Nc(t))}class yf{constructor(t,n,l=0){this.x=+t,this.y=+n,this.z=+l}static fromLngLat(t,n=0){const l=Gl.convert(t);return new yf(mf(l.lng),Ip(l.lat),ig(n,l.lat))}toLngLat(){return new Gl(zp(this.x),Nc(this.y))}toAltitude(){return gf(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/xn*(t=Nc(this.y),1/Math.cos(t*Math.PI/180));var t}}function rg(r,t,n){var l=2*Math.PI*6378137/256/Math.pow(2,n);return[r*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}class sg{constructor(t,n,l){if(!(function(h,m,y){return!(h<0||h>25||y<0||y>=Math.pow(2,h)||m<0||m>=Math.pow(2,h))})(t,n,l))throw new Error(`x=${n}, y=${l}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=n,this.y=l,this.key=$u(0,t,t,n,l)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,n,l){const h=(y=this.y,w=this.z,C=rg(256*(m=this.x),256*(y=Math.pow(2,w)-y-1),w),D=rg(256*(m+1),256*(y+1),w),C[0]+","+C[1]+","+D[0]+","+D[1]);var m,y,w,C,D;const z=(function(N,V,U){let G,Y="";for(let tt=N;tt>0;tt--)G=1<<tt-1,Y+=(V&G?1:0)+(U&G?2:0);return Y})(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,n>1?"@2x":"").replace(/{quadkey}/g,z).replace(/{bbox-epsg-3857}/g,h)}isChildOf(t){const n=this.z-t.z;return n>0&&t.x===this.x>>n&&t.y===this.y>>n}getTilePoint(t){const n=Math.pow(2,this.z);return new L((t.x*n-this.x)*we,(t.y*n-this.y)*we)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Vy{constructor(t,n){this.wrap=t,this.canonical=n,this.key=$u(t,n.z,n.z,n.x,n.y)}}class Ls{constructor(t,n,l,h,m){if(this.terrainRttPosMatrix32f=null,t<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${l}`);this.overscaledZ=t,this.wrap=n,this.canonical=new sg(l,+h,+m),this.key=$u(n,t,l,h,m)}clone(){return new Ls(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-t;return t>this.canonical.z?new Ls(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ls(t,this.wrap,t,this.canonical.x>>n,this.canonical.y>>n)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(t,n){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-t;return t>this.canonical.z?$u(this.wrap*+n,t,this.canonical.z,this.canonical.x,this.canonical.y):$u(this.wrap*+n,t,t,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(t){if(t.wrap!==this.wrap||this.overscaledZ-t.overscaledZ<=0)return!1;if(t.overscaledZ===0)return this.overscaledZ>0;const n=this.canonical.z-t.canonical.z;return!(n<0)&&t.canonical.x===this.canonical.x>>n&&t.canonical.y===this.canonical.y>>n}children(t){if(this.overscaledZ>=t)return[new Ls(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,l=2*this.canonical.x,h=2*this.canonical.y;return[new Ls(n,this.wrap,n,l,h),new Ls(n,this.wrap,n,l+1,h),new Ls(n,this.wrap,n,l,h+1),new Ls(n,this.wrap,n,l+1,h+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Ls(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Ls(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Vy(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new yf(t.x-this.wrap,t.y))}}function $u(r,t,n,l,h){(r*=2)<0&&(r=-1*r-1);const m=1<<n;return(m*m*r+m*h+l).toString(36)+n.toString(36)+t.toString(36)}function jn(r,t){return t?r.properties[t]:r.id}function ag(r,t){const n={id:r.id};if(t.removeAllProperties&&(delete r.removeProperties,delete r.addOrUpdateProperties,delete t.removeProperties),t.removeProperties)for(const l of t.removeProperties){const h=r.addOrUpdateProperties.findIndex((m=>m.key===l));h>-1&&r.addOrUpdateProperties.splice(h,1)}return(r.removeAllProperties||t.removeAllProperties)&&(n.removeAllProperties=!0),(r.removeProperties||t.removeProperties)&&(n.removeProperties=[...r.removeProperties||[],...t.removeProperties||[]]),(r.addOrUpdateProperties||t.addOrUpdateProperties)&&(n.addOrUpdateProperties=[...r.addOrUpdateProperties||[],...t.addOrUpdateProperties||[]]),(r.newGeometry||t.newGeometry)&&(n.newGeometry=t.newGeometry||r.newGeometry),n}function Ar(r){var t,n;if(!r)return{};const l={};return l.removeAll=r.removeAll,l.remove=new Set(r.remove||[]),l.add=new Map((t=r.add)===null||t===void 0?void 0:t.map((h=>[h.id,h]))),l.update=new Map((n=r.update)===null||n===void 0?void 0:n.map((h=>[h.id,h]))),l}Me("CanonicalTileID",sg),Me("OverscaledTileID",Ls,{omit:["terrainRttPosMatrix32f"]});class Uy{constructor(t){this._stringToNumber={},this._numberToString=[];for(let n=0;n<t.length;n++){const l=t[n];this._stringToNumber[l]=n,this._numberToString[n]=l}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class og{constructor(t,n,l,h,m){this.type="Feature",this._vectorTileFeature=t,t._z=n,t._x=l,t._y=h,this.properties=t.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(t[n]=this[n]);return t}}class Kh{_name;dataBuffer;nullabilityBuffer;_size;constructor(t,n,l){this._name=t,this.dataBuffer=n,typeof l=="number"?this._size=l:(this.nullabilityBuffer=l,this._size=l.size())}getValue(t){return this.nullabilityBuffer&&!this.nullabilityBuffer.get(t)?null:this.getValueFromBuffer(t)}has(t){return this.nullabilityBuffer&&this.nullabilityBuffer.get(t)||!this.nullabilityBuffer}get name(){return this._name}get size(){return this._size}}class Qh extends Kh{}class _f extends Qh{getValueFromBuffer(t){return this.dataBuffer[t]}}class Jh extends Qh{getValueFromBuffer(t){return this.dataBuffer[t]}}class lg extends Kh{delta;constructor(t,n,l,h){super(t,n,h),this.delta=l}}class Lp extends lg{constructor(t,n,l,h){super(t,Int32Array.of(n),l,h)}getValueFromBuffer(t){return this.dataBuffer[0]+t*this.delta}}class vf extends Kh{constructor(t,n,l){super(t,Int32Array.of(n),l)}getValueFromBuffer(t){return this.dataBuffer[0]}}class cg{_name;_geometryVector;_idVector;_propertyVectors;_extent;propertyVectorsMap;constructor(t,n,l,h,m=4096){this._name=t,this._geometryVector=n,this._idVector=l,this._propertyVectors=h,this._extent=m}get name(){return this._name}get idVector(){return this._idVector}get geometryVector(){return this._geometryVector}get propertyVectors(){return this._propertyVectors}getPropertyVector(t){return this.propertyVectorsMap||(this.propertyVectorsMap=new Map(this._propertyVectors.map((n=>[n.name,n])))),this.propertyVectorsMap.get(t)}*[Symbol.iterator](){const t=this.geometryVector[Symbol.iterator]();let n=0;for(;n<this.numFeatures;){let l;this.idVector&&(l=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(n)):this.idVector.getValue(n));const h=t?.next().value,m={};for(const y of this.propertyVectors){if(!y)continue;const w=y.name,C=y.getValue(n);C!==null&&(m[w]=C)}n++,yield{id:l,geometry:h,properties:m}}}get numFeatures(){return this.geometryVector.numGeometries}get extent(){return this._extent}getFeatures(){const t=[],n=this.geometryVector.getGeometries();for(let l=0;l<this.numFeatures;l++){let h;this.idVector&&(h=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(l)):this.idVector.getValue(l));const m={coordinates:n[l],type:this.geometryVector.geometryType(l)},y={};for(const w of this.propertyVectors){if(!w)continue;const C=w.name,D=w.getValue(l);D!==null&&(y[C]=D)}t.push({id:h,geometry:m,properties:y})}return t}containsMaxSaveIntegerValues(t){return t instanceof _f||t instanceof vf&&t instanceof Lp||t instanceof Jh}}class kv{value;constructor(t){this.value=t}get(){return this.value}set(t){this.value=t}increment(){return this.value++}add(t){this.value+=t}}var _r,dn,Qo,go,Hu,Qi,Ji,tr,kp,aa;(function(r){r.PRESENT="PRESENT",r.DATA="DATA",r.OFFSET="OFFSET",r.LENGTH="LENGTH"})(_r||(_r={}));class ug{_dictionaryType;_offsetType;_lengthType;constructor(t,n,l){this._dictionaryType=t,this._offsetType=n,this._lengthType=l}get dictionaryType(){return this._dictionaryType}get offsetType(){return this._offsetType}get lengthType(){return this._lengthType}}function Fi(r,t,n){const l=new Int32Array(n);let h=0,m=t.get();for(let y=0;y<l.length;y++){let w=r[m++],C=127&w;w<128||(w=r[m++],C|=(127&w)<<7,w<128||(w=r[m++],C|=(127&w)<<14,w<128||(w=r[m++],C|=(127&w)<<21,w<128||(w=r[m++],C|=(15&w)<<28)))),l[h++]=C}return t.set(m),l}function td(r,t,n){const l=new BigInt64Array(n);for(let h=0;h<l.length;h++)l[h]=qy(r,t);return l}function hg(r,t){let n,l;return l=r[t.get()],t.increment(),n=127&l,l<128?n:(l=r[t.get()],t.increment(),n|=(127&l)<<7,l<128?n:(l=r[t.get()],t.increment(),n|=(127&l)<<14,l<128?n:(l=r[t.get()],t.increment(),n|=(127&l)<<21,l<128?n:(l=r[t.get()],n|=(15&l)<<28,(function(h,m,y){let w,C;if(C=m[y.get()],y.increment(),w=(112&C)>>4,C<128||(C=m[y.get()],y.increment(),w|=(127&C)<<3,C<128)||(C=m[y.get()],y.increment(),w|=(127&C)<<10,C<128)||(C=m[y.get()],y.increment(),w|=(127&C)<<17,C<128)||(C=m[y.get()],y.increment(),w|=(127&C)<<24,C<128)||(C=m[y.get()],y.increment(),w|=(1&C)<<31,C<128))return 4294967296*w+(h>>>0);throw new Error("Expected varint not more than 10 bytes")})(n,r,t)))))}function Gy(r,t,n,l){throw new Error("FastPFor is not implemented yet.")}function Mr(r){return r>>>1^-(1&r)}function Fc(r){return r>>1n^-(1n&r)}function qy(r,t){let n=0n,l=0,h=t.get();for(;h<r.length;){const m=r[h++];if(n|=BigInt(127&m)<<BigInt(l),!(128&m))break;if(l+=7,l>=64)throw new Error("Varint too long")}return t.set(h),n}function dg(r,t,n){const l=new Int32Array(n);let h=0;for(let m=0;m<t;m++){const y=r[m];l.fill(r[m+t],h,h+y),h+=y}return l}function fg(r,t,n){const l=new BigInt64Array(n);let h=0;for(let m=0;m<t;m++){const y=Number(r[m]);l.fill(r[m+t],h,h+y),h+=y}return l}function ed(r,t,n){const l=new Float64Array(n);let h=0;for(let m=0;m<t;m++){const y=r[m];l.fill(r[m+t],h,h+y),h+=y}return l}function ks(r){const t=r.length/4*4;let n=1;if(t>=4)for(let l=r[0];n<t-4;n+=4)l=r[n]+=l,l=r[n+1]+=l,l=r[n+2]+=l,l=r[n+3]+=l;for(;n!=r.length;)r[n]+=r[n-1],++n}function pg(r){r[0]=r[0]>>>1^-(1&r[0]),r[1]=r[1]>>>1^-(1&r[1]);const t=r.length/4*4;let n=2;if(t>=4)for(;n<t-4;n+=4){const l=r[n],h=r[n+1],m=r[n+2],y=r[n+3];r[n]=(l>>>1^-(1&l))+r[n-2],r[n+1]=(h>>>1^-(1&h))+r[n-1],r[n+2]=(m>>>1^-(1&m))+r[n],r[n+3]=(y>>>1^-(1&y))+r[n+1]}for(;n!=r.length;n+=2)r[n]=(r[n]>>>1^-(1&r[n]))+r[n-2],r[n+1]=(r[n+1]>>>1^-(1&r[n+1]))+r[n-1]}function yo(r,t,n){return Math.min(n,Math.max(t,r))}(function(r){r.NONE="NONE",r.DELTA="DELTA",r.COMPONENTWISE_DELTA="COMPONENTWISE_DELTA",r.RLE="RLE",r.MORTON="MORTON",r.PDE="PDE"})(dn||(dn={})),(function(r){r.NONE="NONE",r.FAST_PFOR="FAST_PFOR",r.VARINT="VARINT",r.ALP="ALP"})(Qo||(Qo={})),(function(r){r.NONE="NONE",r.SINGLE="SINGLE",r.SHARED="SHARED",r.VERTEX="VERTEX",r.MORTON="MORTON",r.FSST="FSST"})(go||(go={})),(function(r){r.VERTEX="VERTEX",r.INDEX="INDEX",r.STRING="STRING",r.KEY="KEY"})(Hu||(Hu={})),(function(r){r.VAR_BINARY="VAR_BINARY",r.GEOMETRIES="GEOMETRIES",r.PARTS="PARTS",r.RINGS="RINGS",r.TRIANGLES="TRIANGLES",r.SYMBOL="SYMBOL",r.DICTIONARY="DICTIONARY"})(Qi||(Qi={}));class _s{_physicalStreamType;_logicalStreamType;_logicalLevelTechnique1;_logicalLevelTechnique2;_physicalLevelTechnique;_numValues;_byteLength;constructor(t,n,l,h,m,y,w){this._physicalStreamType=t,this._logicalStreamType=n,this._logicalLevelTechnique1=l,this._logicalLevelTechnique2=h,this._physicalLevelTechnique=m,this._numValues=y,this._byteLength=w}static decode(t,n){const l=t[n.get()],h=Object.values(_r)[l>>4];let m=null;switch(h){case _r.DATA:m=new ug(Object.values(go)[15&l]);break;case _r.OFFSET:m=new ug(null,Object.values(Hu)[15&l]);break;case _r.LENGTH:m=new ug(null,null,Object.values(Qi)[15&l])}n.increment();const y=t[n.get()],w=Object.values(dn)[y>>5],C=Object.values(dn)[y>>2&7],D=Object.values(Qo)[3&y];n.increment();const z=Fi(t,n,2);return new _s(h,m,w,C,D,z[0],z[1])}get physicalStreamType(){return this._physicalStreamType}get logicalStreamType(){return this._logicalStreamType}get logicalLevelTechnique1(){return this._logicalLevelTechnique1}get logicalLevelTechnique2(){return this._logicalLevelTechnique2}get physicalLevelTechnique(){return this._physicalLevelTechnique}get numValues(){return this._numValues}get byteLength(){return this._byteLength}getDecompressedCount(){return this._numValues}}class Op extends _s{num_bits;coordinate_shift;constructor(t,n,l,h,m,y,w,C,D){super(t,n,l,h,m,y,w),this.num_bits=C,this.coordinate_shift=D}static decode(t,n){const l=_s.decode(t,n),h=Fi(t,n,2);return new Op(l.physicalStreamType,l.logicalStreamType,l.logicalLevelTechnique1,l.logicalLevelTechnique2,l.physicalLevelTechnique,l.numValues,l.byteLength,h[0],h[1])}static decodePartial(t,n,l){const h=Fi(n,l,2);return new Op(t.physicalStreamType,t.logicalStreamType,t.logicalLevelTechnique1,t.logicalLevelTechnique2,t.physicalLevelTechnique,t.numValues,t.byteLength,h[0],h[1])}numBits(){return this.num_bits}coordinateShift(){return this.coordinate_shift}}class xf extends _s{_runs;_numRleValues;constructor(t,n,l,h,m,y,w,C,D){super(t,n,l,h,m,y,w),this._runs=C,this._numRleValues=D}static decode(t,n){const l=_s.decode(t,n),h=Fi(t,n,2);return new xf(l.physicalStreamType,l.logicalStreamType,l.logicalLevelTechnique1,l.logicalLevelTechnique2,l.physicalLevelTechnique,l.numValues,l.byteLength,h[0],h[1])}static decodePartial(t,n,l){const h=Fi(n,l,2);return new xf(t.physicalStreamType,t.logicalStreamType,t.logicalLevelTechnique1,t.logicalLevelTechnique2,t.physicalLevelTechnique,t.numValues,t.byteLength,h[0],h[1])}get runs(){return this._runs}get numRleValues(){return this._numRleValues}getDecompressedCount(){return this._numRleValues}}class ji{static decode(t,n){const l=_s.decode(t,n);return l.logicalLevelTechnique1===dn.MORTON?Op.decodePartial(l,t,n):dn.RLE!==l.logicalLevelTechnique1&&dn.RLE!==l.logicalLevelTechnique2||Qo.NONE===l.physicalLevelTechnique?l:xf.decodePartial(l,t,n)}}(function(r){r[r.FLAT=0]="FLAT",r[r.CONST=1]="CONST",r[r.SEQUENCE=2]="SEQUENCE",r[r.DICTIONARY=3]="DICTIONARY",r[r.FSST_DICTIONARY=4]="FSST_DICTIONARY"})(Ji||(Ji={}));class Ba{values;_size;constructor(t,n){this.values=t,this._size=n}get(t){const n=Math.floor(t/8);return(this.values[n]>>t%8&1)==1}set(t,n){const l=Math.floor(t/8);this.values[l]=this.values[l]|(n?1:0)<<t%8}getInt(t){const n=Math.floor(t/8);return this.values[n]>>t%8&1}size(){return this._size}getBuffer(){return this.values}}class nn{constructor(){}static decodeIntStream(t,n,l,h,m){const y=nn.decodePhysicalLevelTechnique(t,n,l);return this.decodeIntBuffer(y,l,h,m)}static decodeLengthStreamToOffsetBuffer(t,n,l){const h=nn.decodePhysicalLevelTechnique(t,n,l);return this.decodeLengthToOffsetBuffer(h,l)}static decodePhysicalLevelTechnique(t,n,l){const h=l.physicalLevelTechnique;if(h===Qo.FAST_PFOR)return Gy();if(h===Qo.VARINT)return Fi(t,n,l.numValues);if(h===Qo.NONE){const m=n.get();n.add(l.byteLength);const y=t.subarray(m,n.get());return new Int32Array(y)}throw new Error("Specified physicalLevelTechnique is not supported (yet).")}static decodeConstIntStream(t,n,l,h){const m=nn.decodePhysicalLevelTechnique(t,n,l);if(m.length===1){const y=m[0];return h?Mr(y):y}return h?(function(y){return Mr(y[1])})(m):(function(y){return y[1]})(m)}static decodeSequenceIntStream(t,n,l){return(function(h){if(h.length==2){const m=Mr(h[1]);return[m,m]}return[Mr(h[2]),Mr(h[3])]})(nn.decodePhysicalLevelTechnique(t,n,l))}static decodeSequenceLongStream(t,n,l){return(function(h){if(h.length==2){const m=Fc(h[1]);return[m,m]}return[Fc(h[2]),Fc(h[3])]})(td(t,n,l.numValues))}static decodeLongStream(t,n,l,h){const m=td(t,n,l.numValues);return this.decodeLongBuffer(m,l,h)}static decodeLongFloat64Stream(t,n,l,h){const m=(function(y,w,C){const D=new Float64Array(w);for(let z=0;z<w;z++)D[z]=hg(y,C);return D})(t,l.numValues,n);return this.decodeFloat64Buffer(m,l,h)}static decodeConstLongStream(t,n,l,h){const m=td(t,n,l.numValues);if(m.length===1){const y=m[0];return h?Fc(y):y}return h?(function(y){return Fc(y[1])})(m):(function(y){return y[1]})(m)}static decodeIntBuffer(t,n,l,h){switch(n.logicalLevelTechnique1){case dn.DELTA:return n.logicalLevelTechnique2===dn.RLE?(function(m,y,w){const C=new Int32Array(w);let D=0,z=0;for(let N=0;N<y;N++){const V=m[N],U=Mr(m[N+y]);for(let G=0;G<V;G++)z+=U,C[D++]=z}return C})(t,n.runs,n.numRleValues):((function(m){m[0]=m[0]>>>1^-(1&m[0]);const y=m.length/4*4;let w=1;if(y>=4)for(;w<y-4;w+=4){const C=m[w],D=m[w+1],z=m[w+2],N=m[w+3];m[w]=(C>>>1^-(1&C))+m[w-1],m[w+1]=(D>>>1^-(1&D))+m[w],m[w+2]=(z>>>1^-(1&z))+m[w+1],m[w+3]=(N>>>1^-(1&N))+m[w+2]}for(;w!=m.length;++w)m[w]=(m[w]>>>1^-(1&m[w]))+m[w-1]})(t),t);case dn.RLE:return(function(m,y,w){return w?(function(C,D,z){const N=new Int32Array(z);let V=0;for(let U=0;U<D;U++){const G=C[U];let Y=C[U+D];Y=Y>>>1^-(1&Y),N.fill(Y,V,V+G),V+=G}return N})(m,y.runs,y.numRleValues):dg(m,y.runs,y.numRleValues)})(t,n,l);case dn.MORTON:return ks(t),t;case dn.COMPONENTWISE_DELTA:return h?((function(m,y,w,C){let D=m[0]>>>1^-(1&m[0]),z=m[1]>>>1^-(1&m[1]);m[0]=yo(Math.round(D*y),w,C),m[1]=yo(Math.round(z*y),w,C);const N=m.length/16;let V=2;if(N>=4)for(;V<N-4;V+=4){const U=m[V],G=m[V+1],Y=(U>>>1^-(1&U))+D,tt=(G>>>1^-(1&G))+z;m[V]=yo(Math.round(Y*y),w,C),m[V+1]=yo(Math.round(tt*y),w,C);const at=m[V+2],yt=m[V+3];D=(at>>>1^-(1&at))+Y,z=(yt>>>1^-(1&yt))+tt,m[V+2]=yo(Math.round(D*y),w,C),m[V+3]=yo(Math.round(z*y),w,C)}for(;V!=m.length;V+=2)D+=m[V]>>>1^-(1&m[V]),z+=m[V+1]>>>1^-(1&m[V+1]),m[V]=yo(Math.round(D*y),w,C),m[V+1]=yo(Math.round(z*y),w,C)})(t,h.scale,h.min,h.max),t):(pg(t),t);case dn.NONE:return l&&(function(m){for(let y=0;y<m.length;y++){const w=m[y];m[y]=w>>>1^-(1&w)}})(t),t;default:throw new Error(`The specified Logical level technique is not supported: ${n.logicalLevelTechnique1}`)}}static decodeLongBuffer(t,n,l){switch(n.logicalLevelTechnique1){case dn.DELTA:return n.logicalLevelTechnique2===dn.RLE?(function(h,m,y){const w=new BigInt64Array(y);let C=0,D=0n;for(let z=0;z<m;z++){const N=Number(h[z]),V=Fc(h[z+m]);for(let U=0;U<N;U++)D+=V,w[C++]=D}return w})(t,n.runs,n.numRleValues):((function(h){h[0]=h[0]>>1n^-(1n&h[0]);const m=h.length/4*4;let y=1;if(m>=4)for(;y<m-4;y+=4){const w=h[y],C=h[y+1],D=h[y+2],z=h[y+3];h[y]=(w>>1n^-(1n&w))+h[y-1],h[y+1]=(C>>1n^-(1n&C))+h[y],h[y+2]=(D>>1n^-(1n&D))+h[y+1],h[y+3]=(z>>1n^-(1n&z))+h[y+2]}for(;y!=h.length;++y)h[y]=(h[y]>>1n^-(1n&h[y]))+h[y-1]})(t),t);case dn.RLE:return(function(h,m,y){return y?(function(w,C,D){const z=new BigInt64Array(D);let N=0;for(let V=0;V<C;V++){const U=Number(w[V]);let G=w[V+C];G=G>>1n^-(1n&G),z.fill(G,N,N+U),N+=U}return z})(h,m.runs,m.numRleValues):fg(h,m.runs,m.numRleValues)})(t,n,l);case dn.NONE:return l&&(function(h){for(let m=0;m<h.length;m++){const y=h[m];h[m]=y>>1n^-(1n&y)}})(t),t;default:throw new Error(`The specified Logical level technique is not supported: ${n.logicalLevelTechnique1}`)}}static decodeFloat64Buffer(t,n,l){switch(n.logicalLevelTechnique1){case dn.DELTA:return n.logicalLevelTechnique2===dn.RLE&&(t=ed(t,n.runs,n.numRleValues)),(function(h){h[0]=h[0]%2==1?(h[0]+1)/-2:h[0]/2;const m=h.length/4*4;let y=1;if(m>=4)for(;y<m-4;y+=4){const w=h[y],C=h[y+1],D=h[y+2],z=h[y+3];h[y]=(w%2==1?(w+1)/-2:w/2)+h[y-1],h[y+1]=(C%2==1?(C+1)/-2:C/2)+h[y],h[y+2]=(D%2==1?(D+1)/-2:D/2)+h[y+1],h[y+3]=(z%2==1?(z+1)/-2:z/2)+h[y+2]}for(;y!=h.length;++y)h[y]=(h[y]%2==1?(h[y]+1)/-2:h[y]/2)+h[y-1]})(t),t;case dn.RLE:return(function(h,m,y){return y?(function(w,C,D){const z=new Float64Array(D);let N=0;for(let V=0;V<C;V++){const U=w[V];let G=w[V+C];G=G%2==1?(G+1)/-2:G/2,z.fill(G,N,N+U),N+=U}return z})(h,m.runs,m.numRleValues):ed(h,m.runs,m.numRleValues)})(t,n,l);case dn.NONE:return l&&(function(h){for(let m=0;m<h.length;m++){const y=h[m];h[m]=y%2==1?(y+1)/-2:y/2}})(t),t;default:throw new Error(`The specified Logical level technique is not supported: ${n.logicalLevelTechnique1}`)}}static decodeLengthToOffsetBuffer(t,n){if(n.logicalLevelTechnique1===dn.DELTA&&n.logicalLevelTechnique2===dn.NONE)return(function(l){const h=new Int32Array(l.length+1);h[0]=0,h[1]=Mr(l[0]);let m=h[1],y=2;for(;y!=h.length;++y){const w=l[y-1];m+=w>>>1^-(1&w),h[y]=h[y-1]+m}return h})(t);if(n.logicalLevelTechnique1===dn.RLE&&n.logicalLevelTechnique2===dn.NONE)return(function(l,h,m){const y=new Int32Array(m+1);y[0]=0;let w=1,C=y[0];for(let D=0;D<h;D++){const z=l[D],N=l[D+h];for(let V=w;V<w+z;V++)y[V]=N+C,C=y[V];w+=z}return y})(t,n.runs,n.numRleValues);if(n.logicalLevelTechnique1===dn.NONE&&n.logicalLevelTechnique2===dn.NONE){(function(h){let m=0;for(let y=0;y<h.length;y++)h[y]+=m,m=h[y]})(t);const l=new Int32Array(n.numValues+1);return l[0]=0,l.set(t,1),l}if(n.logicalLevelTechnique1===dn.DELTA&&n.logicalLevelTechnique2===dn.RLE){const l=(function(h,m,y){const w=new Int32Array(y+1);w[0]=0;let C=1,D=w[0];for(let z=0;z<m;z++){const N=h[z];let V=h[z+m];V=V>>>1^-(1&V);for(let U=C;U<C+N;U++)w[U]=V+D,D=w[U];C+=N}return w})(t,n.runs,n.numRleValues);return ks(l),l}throw new Error("Only delta encoding is supported for transforming length to offset streams yet.")}static decodeNullableIntStream(t,n,l,h,m){const y=l.physicalLevelTechnique===Qo.FAST_PFOR?Gy():Fi(t,n,l.numValues);return this.decodeNullableIntBuffer(y,l,h,m)}static decodeNullableLongStream(t,n,l,h,m){const y=td(t,n,l.numValues);return this.decodeNullableLongBuffer(y,l,h,m)}static decodeNullableIntBuffer(t,n,l,h){switch(n.logicalLevelTechnique1){case dn.DELTA:return n.logicalLevelTechnique2===dn.RLE&&(t=dg(t,n.runs,n.numRleValues)),(function(m,y){const w=new Int32Array(m.size());let C=0;m.get(0)?(w[0]=m.get(0)?y[0]>>>1^-(1&y[0]):0,C=1):w[0]=0;let D=1;for(;D!=w.length;++D)w[D]=m.get(D)?w[D-1]+(y[C]>>>1^-(1&y[C++])):w[D-1];return w})(h,t);case dn.RLE:return(function(m,y,w,C){const D=y;return w?(function(z,N,V){const U=new Int32Array(z.size());let G=0;for(let Y=0;Y<V;Y++){const tt=N[Y];let at=N[Y+V];at=at>>>1^-(1&at);for(let yt=G;yt<G+tt;yt++)z.get(yt)?U[yt]=at:(U[yt]=0,G++);G+=tt}return U})(C,m,D.runs):(function(z,N,V){const U=new Int32Array(z.size());let G=0;for(let Y=0;Y<V;Y++){const tt=N[Y],at=N[Y+V];for(let yt=G;yt<G+tt;yt++)z.get(yt)?U[yt]=at:(U[yt]=0,G++);G+=tt}return U})(C,m,D.runs)})(t,n,l,h);case dn.MORTON:return ks(t),t;case dn.COMPONENTWISE_DELTA:return pg(t),t;case dn.NONE:return t=l?(function(m,y){const w=new Int32Array(m.size());let C=0,D=0;for(;D!=w.length;++D)if(m.get(D)){const z=y[C++];w[D]=z>>>1^-(1&z)}else w[D]=0;return w})(h,t):(function(m,y){const w=new Int32Array(m.size());let C=0,D=0;for(;D!=w.length;++D)w[D]=m.get(D)?y[C++]:0;return w})(h,t),t;default:throw new Error("The specified Logical level technique is not supported")}}static decodeNullableLongBuffer(t,n,l,h){switch(n.logicalLevelTechnique1){case dn.DELTA:return n.logicalLevelTechnique2===dn.RLE&&(t=fg(t,n.runs,n.numRleValues)),(function(m,y){const w=new BigInt64Array(m.size());let C=0;m.get(0)?(w[0]=m.get(0)?y[0]>>1n^-(1n&y[0]):0n,C=1):w[0]=0n;let D=1;for(;D!=w.length;++D)w[D]=m.get(D)?w[D-1]+(y[C]>>1n^-(1n&y[C++])):w[D-1];return w})(h,t);case dn.RLE:return(function(m,y,w,C){const D=y;return w?(function(z,N,V){const U=new BigInt64Array(z.size());let G=0;for(let Y=0;Y<V;Y++){const tt=Number(N[Y]);let at=N[Y+V];at=at>>1n^-(1n&at);for(let yt=G;yt<G+tt;yt++)z.get(yt)?U[yt]=at:(U[yt]=0n,G++);G+=tt}return U})(C,m,D.runs):(function(z,N,V){const U=new BigInt64Array(z.size());let G=0;for(let Y=0;Y<V;Y++){const tt=Number(N[Y]),at=N[Y+V];for(let yt=G;yt<G+tt;yt++)z.get(yt)?U[yt]=at:(U[yt]=0n,G++);G+=tt}return U})(C,m,D.runs)})(t,n,l,h);case dn.NONE:return t=l?(function(m,y){const w=new BigInt64Array(m.size());let C=0,D=0;for(;D!=w.length;++D)if(m.get(D)){const z=y[C++];w[D]=z>>1n^-(1n&z)}else w[D]=0n;return w})(h,t):(function(m,y){const w=new BigInt64Array(m.size());let C=0,D=0;for(;D!=w.length;++D)w[D]=m.get(D)?y[C++]:0n;return w})(h,t),t;default:throw new Error("The specified Logical level technique is not supported")}}static getVectorType(t,n,l,h){const m=t.logicalLevelTechnique1;if(m===dn.RLE)return t.runs===1?Ji.CONST:Ji.FLAT;const y=n instanceof Ba?n.size():n;if(m===dn.DELTA&&t.logicalLevelTechnique2===dn.RLE){const w=t.runs,C=2;if(t.numRleValues!==y)return Ji.FLAT;if(w===1)return Ji.SEQUENCE;if(w===2){const D=h.get();let z;if(t.physicalLevelTechnique===Qo.VARINT)z=Fi(l,h,4);else{const N=h.get();z=new Int32Array(l.buffer,l.byteOffset+N,4)}if(h.set(D),z[2]===C&&z[3]===C)return Ji.SEQUENCE}}return t.numValues===1?Ji.CONST:Ji.FLAT}}class Zy extends Qh{getValueFromBuffer(t){return this.dataBuffer[t]}}class $y extends lg{constructor(t,n,l,h){super(t,BigInt64Array.of(n),l,h)}getValueFromBuffer(t){return this.dataBuffer[0]+BigInt(t)*this.delta}}class nd{_geometryOffsets;_partOffsets;_ringOffsets;constructor(t,n,l){this._geometryOffsets=t,this._partOffsets=n,this._ringOffsets=l}get geometryOffsets(){return this._geometryOffsets}get partOffsets(){return this._partOffsets}get ringOffsets(){return this._ringOffsets}}class Ov{tileExtent;_numBits;_coordinateShift;minBound;maxBound;constructor(t,n){this._coordinateShift=t<0?Math.abs(t):0,this.tileExtent=n+this._coordinateShift,this._numBits=Math.ceil(Math.log2(this.tileExtent)),this.minBound=t,this.maxBound=n}validateCoordinates(t){if(t.x<this.minBound||t.y<this.minBound||t.x>this.maxBound||t.y>this.maxBound)throw new Error("The specified tile buffer size is currently not supported.")}numBits(){return this._numBits}coordinateShift(){return this._coordinateShift}}class id extends Ov{encode(t){this.validateCoordinates(t);const n=t.x+this._coordinateShift,l=t.y+this._coordinateShift;let h=0;for(let m=0;m<this._numBits;m++)h|=(n&1<<m)<<m|(l&1<<m)<<m+1;return h}decode(t){return{x:this.decodeMorton(t)-this._coordinateShift,y:this.decodeMorton(t>>1)-this._coordinateShift}}decodeMorton(t){let n=0;for(let l=0;l<this._numBits;l++)n|=(t&1<<2*l)>>l;return n}static decode(t,n,l){return{x:id.decodeMorton(t,n)-l,y:id.decodeMorton(t>>1,n)-l}}static decodeMorton(t,n){let l=0;for(let h=0;h<n;h++)l|=(t&1<<2*h)>>h;return l}}(function(r){r[r.POINT=0]="POINT",r[r.LINESTRING=1]="LINESTRING",r[r.POLYGON=2]="POLYGON",r[r.MULTIPOINT=3]="MULTIPOINT",r[r.MULTILINESTRING=4]="MULTILINESTRING",r[r.MULTIPOLYGON=5]="MULTIPOLYGON"})(tr||(tr={})),(function(r){r[r.POINT=0]="POINT",r[r.LINESTRING=1]="LINESTRING",r[r.POLYGON=2]="POLYGON"})(kp||(kp={})),(function(r){r[r.MORTON=0]="MORTON",r[r.VEC_2=1]="VEC_2",r[r.VEC_3=2]="VEC_3"})(aa||(aa={}));class Nv{createPoint(t){return[[t]]}createMultiPoint(t){return t.map((n=>[n]))}createLineString(t){return[t]}createMultiLineString(t){return t}createPolygon(t,n){return[t,...n]}createMultiPolygon(t){return t.flat()}}function mg(r){const t=new Array(r.numGeometries);let n=1,l=1,h=1,m=0;const y=new Nv;let w=0,C=0;const D=r.mortonSettings,z=r.topologyVector,N=z.geometryOffsets,V=z.partOffsets,U=z.ringOffsets,G=r.vertexOffsets,Y=r.containsPolygonGeometry(),tt=r.vertexBuffer;for(let at=0;at<r.numGeometries;at++){const yt=r.geometryType(at);if(yt===tr.POINT){if(G&&G.length!==0)if(r.vertexBufferType===aa.VEC_2){const ct=2*G[C++],dt=new L(tt[ct],tt[ct+1]);t[m++]=y.createPoint(dt)}else{const ct=G[C++],dt=id.decode(tt[ct],D.numBits,D.coordinateShift),Pt=new L(dt.x,dt.y);t[m++]=y.createPoint(Pt)}else{const ct=new L(tt[w++],tt[w++]);t[m++]=y.createPoint(ct)}N&&h++,V&&n++,U&&l++}else if(yt===tr.MULTIPOINT){const ct=N[h]-N[h-1];h++;const dt=new Array(ct);if(G&&G.length!==0){for(let Pt=0;Pt<ct;Pt++){const Dt=2*G[C++];dt[Pt]=new L(tt[Dt],tt[Dt+1])}t[m++]=y.createMultiPoint(dt)}else{for(let Pt=0;Pt<ct;Pt++){const Dt=tt[w++],Zt=tt[w++];dt[Pt]=new L(Dt,Zt)}t[m++]=y.createMultiPoint(dt)}}else if(yt===tr.LINESTRING){let ct,dt=0;Y?(dt=U[l]-U[l-1],l++):dt=V[n]-V[n-1],n++,G&&G.length!==0?(ct=r.vertexBufferType===aa.VEC_2?Bc(tt,G,C,dt,!1):Xu(tt,G,C,dt,!1,D),C+=dt):(ct=gg(tt,w,dt,!1),w+=2*dt),t[m++]=y.createLineString(ct),N&&h++}else if(yt===tr.POLYGON){const ct=V[n]-V[n-1];n++;const dt=new Array(ct-1);let Pt=U[l]-U[l-1];if(l++,G&&G.length!==0){const Dt=r.vertexBufferType===aa.VEC_2?jc(tt,G,C,Pt):bf(tt,G,C,Pt,0,D);C+=Pt;for(let Zt=0;Zt<dt.length;Zt++)Pt=U[l]-U[l-1],l++,dt[Zt]=r.vertexBufferType===aa.VEC_2?jc(tt,G,C,Pt):bf(tt,G,C,Pt,0,D),C+=Pt;t[m++]=y.createPolygon(Dt,dt)}else{const Dt=ql(tt,w,Pt);w+=2*Pt;for(let Zt=0;Zt<dt.length;Zt++)Pt=U[l]-U[l-1],l++,dt[Zt]=ql(tt,w,Pt),w+=2*Pt;t[m++]=y.createPolygon(Dt,dt)}N&&h++}else if(yt===tr.MULTILINESTRING){const ct=N[h]-N[h-1];h++;const dt=new Array(ct);if(G&&G.length!==0){for(let Pt=0;Pt<ct;Pt++){let Dt=0;Y?(Dt=U[l]-U[l-1],l++):Dt=V[n]-V[n-1],n++;const Zt=r.vertexBufferType===aa.VEC_2?Bc(tt,G,C,Dt,!1):Xu(tt,G,C,Dt,!1,D);dt[Pt]=Zt,C+=Dt}t[m++]=y.createMultiLineString(dt)}else{for(let Pt=0;Pt<ct;Pt++){let Dt=0;Y?(Dt=U[l]-U[l-1],l++):Dt=V[n]-V[n-1],n++,dt[Pt]=gg(tt,w,Dt,!1),w+=2*Dt}t[m++]=y.createMultiLineString(dt)}}else{if(yt!==tr.MULTIPOLYGON)throw new Error("The specified geometry type is currently not supported.");{const ct=N[h]-N[h-1];h++;const dt=new Array(ct);let Pt=0;if(G&&G.length!==0){for(let Dt=0;Dt<ct;Dt++){const Zt=V[n]-V[n-1];n++;const ue=new Array(Zt-1);Pt=U[l]-U[l-1],l++;const ie=r.vertexBufferType===aa.VEC_2?jc(tt,G,C,Pt):bf(tt,G,C,Pt,0,D);C+=Pt;for(let de=0;de<ue.length;de++)Pt=U[l]-U[l-1],l++,ue[de]=r.vertexBufferType===aa.VEC_2?jc(tt,G,C,Pt):bf(tt,G,C,Pt,0,D),C+=Pt;dt[Dt]=y.createPolygon(ie,ue)}t[m++]=y.createMultiPolygon(dt)}else{for(let Dt=0;Dt<ct;Dt++){const Zt=V[n]-V[n-1];n++;const ue=new Array(Zt-1);Pt=U[l]-U[l-1],l++;const ie=ql(tt,w,Pt);w+=2*Pt;for(let de=0;de<ue.length;de++){const Se=U[l]-U[l-1];l++,ue[de]=ql(tt,w,Se),w+=2*Se}dt[Dt]=y.createPolygon(ie,ue)}t[m++]=y.createMultiPolygon(dt)}}}}return t}function ql(r,t,n){return gg(r,t,n,!0)}function jc(r,t,n,l){return Bc(r,t,n,l,!0)}function bf(r,t,n,l,h,m){return Xu(r,t,n,l,!0,m)}function gg(r,t,n,l){const h=new Array(l?n+1:n);for(let m=0;m<2*n;m+=2)h[m/2]=new L(r[t+m],r[t+m+1]);return l&&(h[h.length-1]=h[0]),h}function Bc(r,t,n,l,h){const m=new Array(h?l+1:l);for(let y=0;y<2*l;y+=2){const w=2*t[n+y/2];m[y/2]=new L(r[w],r[w+1])}return h&&(m[m.length-1]=m[0]),m}function Xu(r,t,n,l,h,m){const y=new Array(h?l+1:l);for(let w=0;w<l;w++){const C=id.decode(r[t[n+w]],m.numBits,m.coordinateShift);y[w]=new L(C.x,C.y)}return h&&(y[y.length-1]=y[0]),y}class yg{_vertexBufferType;_topologyVector;_vertexOffsets;_vertexBuffer;_mortonSettings;constructor(t,n,l,h,m){this._vertexBufferType=t,this._topologyVector=n,this._vertexOffsets=l,this._vertexBuffer=h,this._mortonSettings=m}get vertexBufferType(){return this._vertexBufferType}get topologyVector(){return this._topologyVector}get vertexOffsets(){return this._vertexOffsets}get vertexBuffer(){return this._vertexBuffer}*[Symbol.iterator](){const t=mg(this);let n=0;for(;n<this.numGeometries;)yield{coordinates:t[n],type:this.geometryType(n)},n++}getSimpleEncodedVertex(t){const n=this.vertexOffsets?2*this.vertexOffsets[t]:2*t;return[this.vertexBuffer[n],this.vertexBuffer[n+1]]}getVertex(t){if(this.vertexOffsets&&this.mortonSettings){const l=id.decode(this.vertexBuffer[this.vertexOffsets[t]],this.mortonSettings.numBits,this.mortonSettings.coordinateShift);return[l.x,l.y]}const n=this.vertexOffsets?2*this.vertexOffsets[t]:2*t;return[this.vertexBuffer[n],this.vertexBuffer[n+1]]}getGeometries(){return mg(this)}get mortonSettings(){return this._mortonSettings}}class Vc extends yg{_numGeometries;_geometryType;constructor(t,n,l,h,m,y,w){super(l,h,m,y,w),this._numGeometries=t,this._geometryType=n}static createMortonEncoded(t,n,l,h,m,y){return new Vc(t,n,aa.MORTON,l,h,m,y)}static create(t,n,l,h,m){return new Vc(t,n,aa.VEC_2,l,h,m)}geometryType(t){return this._geometryType}get numGeometries(){return this._numGeometries}containsPolygonGeometry(){return this._geometryType===tr.POLYGON||this._geometryType===tr.MULTIPOLYGON}containsSingleGeometryType(){return!0}}class Yu extends yg{_geometryTypes;constructor(t,n,l,h,m,y){super(t,l,h,m,y),this._geometryTypes=n}static createMortonEncoded(t,n,l,h,m){return new Yu(aa.MORTON,t,n,l,h,m)}static create(t,n,l,h){return new Yu(aa.VEC_2,t,n,l,h)}geometryType(t){return this._geometryTypes[t]}get numGeometries(){return this._geometryTypes.length}containsPolygonGeometry(){for(let t=0;t<this.numGeometries;t++)if(this.geometryType(t)===tr.POLYGON||this.geometryType(t)===tr.MULTIPOLYGON)return!0;return!1}containsSingleGeometryType(){return!1}}class Np{_triangleOffsets;_indexBuffer;_vertexBuffer;_topologyVector;constructor(t,n,l,h){this._triangleOffsets=t,this._indexBuffer=n,this._vertexBuffer=l,this._topologyVector=h}get triangleOffsets(){return this._triangleOffsets}get indexBuffer(){return this._indexBuffer}get vertexBuffer(){return this._vertexBuffer}get topologyVector(){return this._topologyVector}getGeometries(){if(!this._topologyVector)throw new Error("Cannot convert GpuVector to coordinates without topology information");const t=new Array(this.numGeometries),n=this._topologyVector,l=n.partOffsets,h=n.ringOffsets,m=n.geometryOffsets;let y=0,w=1,C=1,D=1;for(let z=0;z<this.numGeometries;z++)switch(this.geometryType(z)){case tr.POLYGON:{const N=l[w]-l[w-1];w++;const V=[];for(let U=0;U<N;U++){const G=h[C]-h[C-1];C++;const Y=[];for(let tt=0;tt<G;tt++){const at=this._vertexBuffer[y++],yt=this._vertexBuffer[y++];Y.push(new L(at,yt))}Y.length>0&&Y.push(Y[0]),V.push(Y)}t[z]=V,m&&D++}break;case tr.MULTIPOLYGON:{const N=m[D]-m[D-1];D++;const V=[];for(let U=0;U<N;U++){const G=l[w]-l[w-1];w++;for(let Y=0;Y<G;Y++){const tt=h[C]-h[C-1];C++;const at=[];for(let yt=0;yt<tt;yt++){const ct=this._vertexBuffer[y++],dt=this._vertexBuffer[y++];at.push(new L(ct,dt))}at.length>0&&at.push(at[0]),V.push(at)}}t[z]=V}}return t}[Symbol.iterator](){return null}}class Wu extends Np{_numGeometries;_geometryType;constructor(t,n,l,h,m,y){super(l,h,m,y),this._numGeometries=t,this._geometryType=n}static create(t,n,l,h,m,y){return new Wu(t,n,l,h,m,y)}geometryType(t){return this._geometryType}get numGeometries(){return this._numGeometries}containsSingleGeometryType(){return!0}}class wf extends Np{_geometryTypes;constructor(t,n,l,h,m){super(n,l,h,m),this._geometryTypes=t}static create(t,n,l,h,m){return new wf(t,n,l,h,m)}geometryType(t){return this._geometryTypes[t]}get numGeometries(){return this._geometryTypes.length}containsSingleGeometryType(){return!1}}function Hy(r,t,n,l,h){const m=ji.decode(r,n);let y=null,w=null,C=null,D=null,z=null,N=null,V=null,U=null;if(nn.getVectorType(m,l,r,n)===Ji.CONST){const Y=nn.decodeConstIntStream(r,n,m,!1);for(let tt=0;tt<t-1;tt++){const at=ji.decode(r,n);switch(at.physicalStreamType){case _r.LENGTH:switch(at.logicalStreamType.lengthType){case Qi.GEOMETRIES:y=nn.decodeLengthStreamToOffsetBuffer(r,n,at);break;case Qi.PARTS:w=nn.decodeLengthStreamToOffsetBuffer(r,n,at);break;case Qi.RINGS:C=nn.decodeLengthStreamToOffsetBuffer(r,n,at);break;case Qi.TRIANGLES:V=nn.decodeLengthStreamToOffsetBuffer(r,n,at)}break;case _r.OFFSET:switch(at.logicalStreamType.offsetType){case Hu.VERTEX:D=nn.decodeIntStream(r,n,at,!1);break;case Hu.INDEX:U=nn.decodeIntStream(r,n,at,!1)}break;case _r.DATA:if(go.VERTEX===at.logicalStreamType.dictionaryType)z=nn.decodeIntStream(r,n,at,!0,h);else{const yt=at;N={numBits:yt.numBits(),coordinateShift:yt.coordinateShift()},z=nn.decodeIntStream(r,n,at,!1,h)}}}if(U!==null){if(y!=null||w!=null){const tt=new nd(y,w,C);return Wu.create(l,Y,V,U,z,tt)}return Wu.create(l,Y,V,U,z)}return N===null?Vc.create(l,Y,new nd(y,w,C),D,z):Vc.createMortonEncoded(l,Y,new nd(y,w,C),D,z,N)}const G=nn.decodeIntStream(r,n,m,!1);for(let Y=0;Y<t-1;Y++){const tt=ji.decode(r,n);switch(tt.physicalStreamType){case _r.LENGTH:switch(tt.logicalStreamType.lengthType){case Qi.GEOMETRIES:y=nn.decodeIntStream(r,n,tt,!1);break;case Qi.PARTS:w=nn.decodeIntStream(r,n,tt,!1);break;case Qi.RINGS:C=nn.decodeIntStream(r,n,tt,!1);break;case Qi.TRIANGLES:V=nn.decodeLengthStreamToOffsetBuffer(r,n,tt)}break;case _r.OFFSET:switch(tt.logicalStreamType.offsetType){case Hu.VERTEX:D=nn.decodeIntStream(r,n,tt,!1);break;case Hu.INDEX:U=nn.decodeIntStream(r,n,tt,!1)}break;case _r.DATA:if(go.VERTEX===tt.logicalStreamType.dictionaryType)z=nn.decodeIntStream(r,n,tt,!0,h);else{const at=tt;N={numBits:at.numBits(),coordinateShift:at.coordinateShift()},z=nn.decodeIntStream(r,n,tt,!1,h)}}}return U!==null&&w===null?wf.create(G,V,U,z):(y!==null?(y=_g(G,y,2),w!==null&&C!==null?(w=vg(G,y,w,!1),C=(function(Y,tt,at,yt){const ct=new Int32Array(at[at.length-1]+1);let dt=0;ct[0]=dt;let Pt=1,Dt=1,Zt=0;for(let ue=0;ue<Y.length;ue++){const ie=Y[ue],de=tt[ue+1]-tt[ue];if(ie!==0&&ie!==3)for(let Se=0;Se<de;Se++){const _e=at[Pt]-at[Pt-1];Pt++;for(let ve=0;ve<_e;ve++)dt=ct[Dt++]=dt+yt[Zt++]}else for(let Se=0;Se<de;Se++)ct[Dt++]=++dt,Pt++}return ct})(G,y,w,C)):w!==null&&(w=(function(Y,tt,at){const yt=new Int32Array(tt[tt.length-1]+1);let ct=0;yt[0]=ct;let dt=1,Pt=0;for(let Dt=0;Dt<Y.length;Dt++){const Zt=Y[Dt],ue=tt[Dt+1]-tt[Dt];if(Zt===4||Zt===1)for(let ie=0;ie<ue;ie++)ct=yt[dt++]=ct+at[Pt++];else for(let ie=0;ie<ue;ie++)yt[dt++]=++ct}return yt})(G,y,w))):w!==null&&C!==null?(w=_g(G,w,1),C=vg(G,w,C,!0)):w!==null&&(w=_g(G,w,0)),U!==null?wf.create(G,V,U,z,new nd(y,w,C)):N===null?Yu.create(G,new nd(y,w,C),D,z):Yu.createMortonEncoded(G,new nd(y,w,C),D,z,N))}function _g(r,t,n){const l=new Int32Array(r.length+1);let h=0;l[0]=h;let m=0;for(let y=0;y<r.length;y++)h=l[y+1]=h+(r[y]>n?t[m++]:1);return l}function vg(r,t,n,l){const h=new Int32Array(t[t.length-1]+1);let m=0;h[0]=m;let y=1,w=0;for(let C=0;C<r.length;C++){const D=r[C],z=t[C+1]-t[C];if(D===5||D===2||l&&(D===4||D===1))for(let N=0;N<z;N++)m=h[y++]=m+n[w++];else for(let N=0;N<z;N++)h[y++]=++m}return h}class Fv extends Kh{dataVector;constructor(t,n,l){super(t,n.getBuffer(),l),this.dataVector=n}getValueFromBuffer(t){return this.dataVector.get(t)}}class xg extends Qh{getValueFromBuffer(t){return this.dataBuffer[t]}}class Xy extends Kh{constructor(t,n,l){super(t,BigInt64Array.of(n),l)}getValueFromBuffer(t){return this.dataBuffer[0]}}function Fp(r,t,n){for(let l=0;l<r;l++){const h=ji.decode(t,n);n.add(h.byteLength)}}function Uc(r,t,n){return Tf(r,Math.ceil(t/8),n)}function Tf(r,t,n){const l=new Uint8Array(t);let h=0;for(;h<t;){const m=r[n.increment()];if(m<=127){const y=m+3,w=r[n.increment()],C=h+y;l.fill(w,h,C),h=C}else{const y=256-m;for(let w=0;w<y;w++)l[h++]=r[n.increment()]}}return l}const jv=new TextDecoder;function Ku(r,t,n){return n-t>=12?jv.decode(r.subarray(t,n)):(function(l,h,m){let y="",w=h;for(;w<m;){const C=l[w];let D,z,N,V=null,U=C>239?4:C>223?3:C>191?2:1;if(w+U>m)break;U===1?C<128&&(V=C):U===2?(D=l[w+1],(192&D)==128&&(V=(31&C)<<6|63&D,V<=127&&(V=null))):U===3?(D=l[w+1],z=l[w+2],(192&D)==128&&(192&z)==128&&(V=(15&C)<<12|(63&D)<<6|63&z,(V<=2047||V>=55296&&V<=57343)&&(V=null))):U===4&&(D=l[w+1],z=l[w+2],N=l[w+3],(192&D)==128&&(192&z)==128&&(192&N)==128&&(V=(15&C)<<18|(63&D)<<12|(63&z)<<6|63&N,(V<=65535||V>=1114112)&&(V=null))),V===null?(V=65533,U=1):V>65535&&(V-=65536,y+=String.fromCharCode(V>>>10&1023|55296),V=56320|1023&V),y+=String.fromCharCode(V),w+=U}return y})(r,t,n)}class bg extends Kh{offsetBuffer;constructor(t,n,l,h){super(t,l,h),this.offsetBuffer=n}}class wg extends bg{textEncoder;constructor(t,n,l,h){super(t,n,l,h??n.length-1),this.textEncoder=new TextEncoder}getValueFromBuffer(t){return Ku(this.dataBuffer,this.offsetBuffer[t],this.offsetBuffer[t+1])}}class Qu extends bg{indexBuffer;textEncoder;constructor(t,n,l,h,m){super(t,l,h,m??n.length),this.indexBuffer=n,this.indexBuffer=n,this.textEncoder=new TextEncoder}getValueFromBuffer(t){const n=this.indexBuffer[t];return Ku(this.dataBuffer,this.offsetBuffer[n],this.offsetBuffer[n+1])}}class Tg extends bg{indexBuffer;symbolOffsetBuffer;symbolTableBuffer;textEncoder;symbolLengthBuffer;lengthBuffer;decodedDictionary;constructor(t,n,l,h,m,y,w){super(t,l,h,w),this.indexBuffer=n,this.symbolOffsetBuffer=m,this.symbolTableBuffer=y,this.textEncoder=new TextEncoder}getValueFromBuffer(t){this.decodedDictionary==null&&(this.symbolLengthBuffer==null&&(this.symbolLengthBuffer=this.offsetToLengthBuffer(this.symbolOffsetBuffer),this.lengthBuffer=this.offsetToLengthBuffer(this.offsetBuffer)),this.decodedDictionary=(function(l,h,m){const y=[],w=new Array(h.length).fill(0);for(let C=1;C<h.length;C++)w[C]=w[C-1]+h[C-1];for(let C=0;C<m.length;C++)if(m[C]===255)y.push(m[++C]);else{const D=h[m[C]],z=w[m[C]];for(let N=0;N<D;N++)y.push(l[z+N])}return new Uint8Array(y)})(this.symbolTableBuffer,this.symbolLengthBuffer,this.dataBuffer));const n=this.indexBuffer[t];return Ku(this.decodedDictionary,this.offsetBuffer[n],this.offsetBuffer[n+1])}offsetToLengthBuffer(t){const n=new Uint32Array(t.length-1);let l=t[0];for(let h=1;h<t.length;h++){const m=t[h];n[h-1]=m-l,l=m}return n}}class rd{static ROOT_COLUMN_NAME="default";static NESTED_COLUMN_SEPARATOR=":";constructor(){}static decode(t,n,l,h,m){let y=null,w=null,C=null,D=null,z=null,N=null,V=null,U=null;for(let G=0;G<h;G++){const Y=ji.decode(n,l);if(Y.byteLength!==0)switch(Y.physicalStreamType){case _r.PRESENT:{const tt=Uc(n,Y.numValues,l);N=new Ba(tt,Y.numValues);break}case _r.OFFSET:w=m!=null||N!=null?nn.decodeNullableIntStream(n,l,Y,!1,m??N):nn.decodeIntStream(n,l,Y,!1);break;case _r.LENGTH:{const tt=nn.decodeLengthStreamToOffsetBuffer(n,l,Y);Qi.DICTIONARY===Y.logicalStreamType.lengthType?y=tt:Qi.SYMBOL===Y.logicalStreamType.lengthType?D=tt:V=tt;break}case _r.DATA:{const tt=n.subarray(l.get(),l.get()+Y.byteLength);l.add(Y.byteLength);const at=Y.logicalStreamType.dictionaryType;go.FSST===at?z=tt:go.SINGLE===at||go.SHARED===at?C=tt:go.NONE===at&&(U=tt);break}}}return this.decodeFsstDictionaryVector(t,z,w,y,C,D,m??N)??this.decodeDictionaryVector(t,C,w,y,m??N)??this.decodePlainStringVector(t,V,U,w,m??N)}static decodeFsstDictionaryVector(t,n,l,h,m,y,w){return n?new Tg(t,l,h,m,y,n,w):null}static decodeDictionaryVector(t,n,l,h,m){return n?m?new Qu(t,l,h,n,m):new Qu(t,l,h,n):null}static decodePlainStringVector(t,n,l,h,m){if(!n||!l)return null;if(h)return m?new Qu(t,h,n,l,m):new Qu(t,h,n,l);if(m&&m.size()!==n.length-1){const y=new Int32Array(m.size());let w=0;for(let C=0;C<m.size();C++)y[C]=m.get(C)?w++:0;return new Qu(t,y,n,l,m)}return m?new wg(t,n,l,m):new wg(t,n,l)}static decodeSharedDictionary(t,n,l,h,m){let y=null,w=null,C=null,D=null,z=!1;for(;!z;){const G=ji.decode(t,n);switch(G.physicalStreamType){case _r.LENGTH:Qi.DICTIONARY===G.logicalStreamType.lengthType?y=nn.decodeLengthStreamToOffsetBuffer(t,n,G):C=nn.decodeLengthStreamToOffsetBuffer(t,n,G);break;case _r.DATA:go.SINGLE===G.logicalStreamType.dictionaryType||go.SHARED===G.logicalStreamType.dictionaryType?(w=t.subarray(n.get(),n.get()+G.byteLength),z=!0):D=t.subarray(n.get(),n.get()+G.byteLength),n.add(G.byteLength)}}const N=l.complexType.children,V=[];let U=0;for(const G of N){const Y=Fi(t,n,1)[0];if(Y==0)continue;const tt=`${l.name}${G.name===rd.ROOT_COLUMN_NAME?"":rd.NESTED_COLUMN_SEPARATOR+G.name}`;if(m&&!m.has(tt)){Fp(Y,t,n);continue}if(Y!==2||G.type!=="scalarField"||G.scalarField.physicalType!==9)throw new Error("Currently only optional string fields are implemented for a struct.");const at=ji.decode(t,n),yt=Uc(t,at.numValues,n),ct=ji.decode(t,n),dt=(ct instanceof xf?ct.numRleValues:ct.numValues)!==h?nn.decodeNullableIntStream(t,n,ct,!1,new Ba(yt,at.numValues)):nn.decodeIntStream(t,n,ct,!1);V[U++]=D?new Tg(tt,dt,y,w,C,D,new Ba(yt,at.numValues)):new Qu(tt,dt,y,w,new Ba(yt,at.numValues))}return V}}function Sg(r,t,n,l,h,m){return n.type==="scalarType"?(function(y,w,C,D,z,N){let V=null,U=0;if(y===0)return null;if(N.nullable){const Y=ji.decode(w,C);U=Y.numValues;const tt=C.get(),at=Uc(w,U,C);C.set(tt+Y.byteLength),V=new Ba(at,Y.numValues)}const G=V??D;switch(z.physicalType){case 4:case 3:return(function(Y,tt,at,yt,ct){const dt=ji.decode(Y,tt),Pt=nn.getVectorType(dt,ct,Y,tt),Dt=yt.physicalType===3;if(Pt===Ji.FLAT){const Zt=sd(ct)?nn.decodeNullableIntStream(Y,tt,dt,Dt,ct):nn.decodeIntStream(Y,tt,dt,Dt);return new _f(at.name,Zt,ct)}if(Pt===Ji.SEQUENCE){const Zt=nn.decodeSequenceIntStream(Y,tt,dt);return new Lp(at.name,Zt[0],Zt[1],dt.numRleValues)}{const Zt=nn.decodeConstIntStream(Y,tt,dt,Dt);return new vf(at.name,Zt,ct)}})(w,C,N,z,G);case 9:return rd.decode(N.name,w,C,N.nullable?y-1:y,V);case 0:return(function(Y,tt,at,yt,ct){const dt=ji.decode(Y,tt),Pt=dt.numValues,Dt=tt.get(),Zt=sd(ct)?(function(ie,de,Se,_e){const ve=Tf(ie,Math.ceil(de/8),Se),re=new Ba(ve,de),je=_e.size(),Be=new Ba(new Uint8Array(je),je);let qe=0;for(let Ie=0;Ie<_e.size();Ie++){const fn=!!_e.get(Ie)&&re.get(qe++);Be.set(Ie,fn)}return Be.getBuffer()})(Y,Pt,tt,ct):Uc(Y,Pt,tt);tt.set(Dt+dt.byteLength);const ue=new Ba(Zt,Pt);return new Fv(at.name,ue,ct)})(w,C,N,0,G);case 6:case 5:return(function(Y,tt,at,yt,ct){const dt=ji.decode(Y,tt),Pt=nn.getVectorType(dt,yt,Y,tt),Dt=ct.physicalType===5;if(Pt===Ji.FLAT){const Zt=sd(yt)?nn.decodeNullableLongStream(Y,tt,dt,Dt,yt):nn.decodeLongStream(Y,tt,dt,Dt);return new Zy(at.name,Zt,yt)}if(Pt===Ji.SEQUENCE){const Zt=nn.decodeSequenceLongStream(Y,tt,dt);return new $y(at.name,Zt[0],Zt[1],dt.numRleValues)}{const Zt=nn.decodeConstLongStream(Y,tt,dt,Dt);return new Xy(at.name,Zt,yt)}})(w,C,N,G,z);case 7:return(function(Y,tt,at,yt){const ct=ji.decode(Y,tt),dt=sd(yt)?(function(Pt,Dt,Zt,ue){const ie=Dt.get(),de=ie+ue*Float32Array.BYTES_PER_ELEMENT,Se=new Uint8Array(Pt.subarray(ie,de)).buffer,_e=new Float32Array(Se);Dt.set(de);const ve=Zt.size(),re=new Float32Array(ve);let je=0;for(let Be=0;Be<ve;Be++)re[Be]=Zt.get(Be)?_e[je++]:0;return re})(Y,tt,yt,ct.numValues):(function(Pt,Dt,Zt){const ue=Dt.get(),ie=ue+Zt*Float32Array.BYTES_PER_ELEMENT,de=new Uint8Array(Pt.subarray(ue,ie)).buffer,Se=new Float32Array(de);return Dt.set(ie),Se})(Y,tt,ct.numValues);return new xg(at.name,dt,yt)})(w,C,N,G);case 8:return(function(Y,tt,at,yt){const ct=ji.decode(Y,tt),dt=sd(yt)?(function(Pt,Dt,Zt,ue){const ie=Dt.get(),de=ie+ue*Float64Array.BYTES_PER_ELEMENT,Se=new Uint8Array(Pt.subarray(ie,de)).buffer,_e=new Float64Array(Se);Dt.set(de);const ve=Zt.size(),re=new Float64Array(ve);let je=0;for(let Be=0;Be<ve;Be++)re[Be]=Zt.get(Be)?_e[je++]:0;return re})(Y,tt,yt,ct.numValues):(function(Pt,Dt,Zt){const ue=Dt.get(),ie=ue+Zt*Float64Array.BYTES_PER_ELEMENT,de=new Uint8Array(Pt.subarray(ue,ie)).buffer,Se=new Float64Array(de);return Dt.set(ie),Se})(Y,tt,ct.numValues);return new Jh(at.name,dt,yt)})(w,C,N,G);default:throw new Error(`The specified data type for the field is currently not supported: ${z}`)}})(l,r,t,h,n.scalarType,n):l!=1?null:rd.decodeSharedDictionary(r,t,n,h,m)}function sd(r){return r instanceof Ba}class Sf{static decodeColumnType(t){switch(t){case 0:case 1:case 2:case 3:{const n={};n.nullable=!!(1&t),n.columnScope=0;const l={};return l.physicalType=t>1?6:4,l.type="physicalType",n.scalarType=l,n.type="scalarType",n}case 4:{const n={nullable:!1,columnScope:0},l={type:"physicalType",physicalType:0};return n.type="complexType",n.complexType=l,n}case 30:{const n={nullable:!1,columnScope:0},l={type:"physicalType",physicalType:1};return n.type="complexType",n.complexType=l,n}default:return this.mapScalarType(t)}}static columnTypeHasName(t){return t>=10}static columnTypeHasChildren(t){return t===30}static hasStreamCount(t){if(t.name==="id")return!1;if(t.type==="scalarType"){const n=t.scalarType;if(n.type==="physicalType")switch(n.physicalType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:default:return!1;case 9:return!0}else if(n.type==="logicalType")return!1}else if(t.type==="complexType"){const n=t.complexType;if(n.type==="physicalType")switch(n.physicalType){case 0:case 1:return!0;default:return!1}}return console.warn("Unexpected column type in hasStreamCount",t),!1}static mapScalarType(t){let n=null;switch(t){case 10:case 11:n=0;break;case 12:case 13:n=1;break;case 14:case 15:n=2;break;case 16:case 17:n=3;break;case 18:case 19:n=4;break;case 20:case 21:n=5;break;case 22:case 23:n=6;break;case 24:case 25:n=7;break;case 26:case 27:n=8;break;case 28:case 29:n=9;break;default:return null}const l={};l.nullable=!!(1&t),l.columnScope=0;const h={type:"physicalType"};return h.physicalType=n,l.type="scalarType",l.scalarType=h,l}}const jp=new TextDecoder;function Yy(r,t){const n=Fi(r,t,1)[0];if(n===0)return"";const l=t.get(),h=r.subarray(l,l+n);return t.add(n),jp.decode(h)}function Wy(r,t){const n=Fi(r,t,1)[0]>>>0,l=!!(4&n),h=!!(2&n),m=Fi(r,t,1)[0]>>>0,y={};if(1&n&&(y.nullable=!0),h){const w={};if(l?(w.type="logicalType",w.logicalType=m):(w.type="physicalType",w.physicalType=m),8&n){const C=Fi(r,t,1)[0]>>>0;w.children=new Array(C);for(let D=0;D<C;D++)w.children[D]=Wy(r,t)}y.type="complexField",y.complexField=w}else{const w={};l?(w.type="logicalType",w.logicalType=m):(w.type="physicalType",w.physicalType=m),y.type="scalarField",y.scalarField=w}return y}function Eg(r,t){const n=Fi(r,t,1)[0]>>>0,l=Sf.decodeColumnType(n);if(!l)throw new Error(`Unsupported column type code: ${n}`);if(Sf.columnTypeHasName(n)?l.name=Yy(r,t):n>=0&&n<=3?l.name="id":n===4&&(l.name="geometry"),Sf.columnTypeHasChildren(n)){const h=Fi(r,t,1)[0]>>>0,m=l.complexType;m.children=new Array(h);for(let y=0;y<h;y++)m.children[y]=Wy(r,t)}return l}function Cg(r,t){const n={featureTables:[]},l={};l.name=Yy(r,t);const h=Fi(r,t,1)[0]>>>0,m=Fi(r,t,1)[0]>>>0;l.columns=new Array(m);for(let y=0;y<m;y++)l.columns[y]=Eg(r,t);return n.featureTables.push(l),[n,h]}function Bp(r,t,n,l,h,m,y=!1){const w=t.scalarType.physicalType,C=nn.getVectorType(h,m,r,n);if(w===4)switch(C){case Ji.FLAT:{const D=nn.decodeIntStream(r,n,h,!1);return new _f(l,D,m)}case Ji.SEQUENCE:{const D=nn.decodeSequenceIntStream(r,n,h);return new Lp(l,D[0],D[1],h.numRleValues)}case Ji.CONST:{const D=nn.decodeConstIntStream(r,n,h,!1);return new vf(l,D,m)}}else switch(C){case Ji.FLAT:{if(y){const z=nn.decodeLongFloat64Stream(r,n,h,!1);return new Jh(l,z,m)}const D=nn.decodeLongStream(r,n,h,!1);return new Zy(l,D,m)}case Ji.SEQUENCE:{const D=nn.decodeSequenceLongStream(r,n,h);return new $y(l,D[0],D[1],h.numRleValues)}case Ji.CONST:{const D=nn.decodeConstLongStream(r,n,h,!1);return new Xy(l,D,m)}}throw new Error("Vector type not supported for id column.")}class Ag{constructor(t,n){var l;switch(this._featureData=t,this.properties=this._featureData.properties||{},(l=this._featureData.geometry)===null||l===void 0?void 0:l.type){case tr.POINT:case tr.MULTIPOINT:this.type=1;break;case tr.LINESTRING:case tr.MULTILINESTRING:this.type=2;break;case tr.POLYGON:case tr.MULTIPOLYGON:this.type=3;break;default:this.type=0}this.extent=n,this.id=Number(this._featureData.id)}projectPoint(t,n,l,h){return[360*(t.x+n)/h-180,360/Math.PI*Math.atan(Math.exp((1-2*(t.y+l)/h)*Math.PI))-90]}projectLine(t,n,l,h){return t.map((m=>this.projectPoint(m,n,l,h)))}toGeoJSON(t,n,l){const h=this.extent*Math.pow(2,l),m=this.extent*t,y=this.extent*n,w=this.loadGeometry();let C;switch(this.type){case 1:{const z=[];for(const V of w)z.push(V[0]);const N=this.projectLine(z,m,y,h);C=z.length===1?{type:"Point",coordinates:N[0]}:{type:"MultiPoint",coordinates:N};break}case 2:{const z=w.map((N=>this.projectLine(N,m,y,h)));C=z.length===1?{type:"LineString",coordinates:z[0]}:{type:"MultiLineString",coordinates:z};break}case 3:{const z=hc(w),N=[];for(const V of z)N.push(V.map((U=>this.projectLine(U,m,y,h))));C=N.length===1?{type:"Polygon",coordinates:N[0]}:{type:"MultiPolygon",coordinates:N};break}default:throw new Error(`unknown feature type: ${this.type}`)}const D={type:"Feature",geometry:C,properties:this.properties};return this.id!=null&&(D.id=this.id),D}loadGeometry(){const t=[];for(const n of this._featureData.geometry.coordinates){const l=[];for(const h of n)l.push(new L(h.x,h.y));t.push(l)}return t}bbox(){return[0,0,0,0]}}class Ky{constructor(t){this.features=[],this.featureTable=t,this.name=t.name,this.extent=t.extent,this.version=2,this.features=t.getFeatures(),this.length=this.features.length}feature(t){return new Ag(this.features[t],this.extent)}}class Vp{constructor(t){this.layers={};const n=(function(l,h,m=!0){const y=new kv(0),w=[];for(;y.get()<l.length;){const C=Fi(l,y,1)[0]>>>0,D=y.get()+C;if(D>l.length)throw new Error(`Block overruns tile: ${D} > ${l.length}`);if(Fi(l,y,1)[0]>>>0!=1){y.set(D);continue}const z=Cg(l,y),N=z[1],V=z[0].featureTables[0];let U=null,G=null;const Y=[];let tt=0;for(const yt of V.columns){const ct=yt.name;if(ct==="id"){let dt=null;if(yt.nullable){const Dt=ji.decode(l,y),Zt=y.get(),ue=Uc(l,Dt.numValues,y);y.set(Zt+Dt.byteLength),dt=new Ba(ue,Dt.numValues)}const Pt=ji.decode(l,y);tt=Pt.getDecompressedCount(),U=Bp(l,yt,y,ct,Pt,dt??tt,m)}else if(ct==="geometry"){const dt=Fi(l,y,1)[0];if(tt===0){const Pt=y.get();tt=ji.decode(l,y).getDecompressedCount(),y.set(Pt)}G=Hy(l,dt,y,tt,h)}else{const dt=Sf.hasStreamCount(yt)?Fi(l,y,1)[0]:1;if(dt===0&&yt.type==="scalarType")continue;const Pt=Sg(l,y,yt,dt,tt,void 0);Pt&&(Array.isArray(Pt)?Y.push(...Pt):Y.push(Pt))}}const at=new cg(V.name,G,U,Y,N);w.push(at),y.set(D)}return w})(new Uint8Array(t));this.layers=n.reduce(((l,h)=>Object.assign(Object.assign({},l),{[h.name]:new Ky(h)})),{})}}class Os{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(t){return this.minX=Math.min(this.minX,t.x),this.minY=Math.min(this.minY,t.y),this.maxX=Math.max(this.maxX,t.x),this.maxY=Math.max(this.maxY,t.y),this}expandBy(t){return this.minX-=t,this.minY-=t,this.maxX+=t,this.maxY+=t,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(t){return this.expandBy(-t)}map(t){const n=new Os;return n.extend(t(new L(this.minX,this.minY))),n.extend(t(new L(this.maxX,this.minY))),n.extend(t(new L(this.minX,this.maxY))),n.extend(t(new L(this.maxX,this.maxY))),n}static fromPoints(t){const n=new Os;for(const l of t)n.extend(l);return n}contains(t){return t.x>=this.minX&&t.x<=this.maxX&&t.y>=this.minY&&t.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(t){return!this.empty()&&!t.empty()&&t.minX>=this.minX&&t.maxX<=this.maxX&&t.minY>=this.minY&&t.maxY<=this.maxY}intersects(t){return!this.empty()&&!t.empty()&&t.minX<=this.maxX&&t.maxX>=this.minX&&t.minY<=this.maxY&&t.maxY>=this.minY}}const Jo="_geojsonTileLayer";class Zl{constructor(t,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Al(we,16,0),this.grid3D=new Al(we,16,0),this.featureIndexArray=new ut,this.promoteId=n}insert(t,n,l,h,m,y){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,h,m);const C=y?this.grid3D:this.grid;for(let D=0;D<n.length;D++){const z=n[D],N=[1/0,1/0,-1/0,-1/0];for(let V=0;V<z.length;V++){const U=z[V];N[0]=Math.min(N[0],U.x),N[1]=Math.min(N[1],U.y),N[2]=Math.max(N[2],U.x),N[3]=Math.max(N[3],U.y)}N[0]<we&&N[1]<we&&N[2]>=0&&N[3]>=0&&C.insert(w,N[0],N[1],N[2],N[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=this.encoding!=="mlt"?new jm(new Sp(this.rawTileData)).layers:new Vp(this.rawTileData).layers,this.sourceLayerCoder=new Uy(this.vtLayers?Object.keys(this.vtLayers).sort():[Jo])),this.vtLayers}query(t,n,l,h){this.loadVTLayers();const m=t.params,y=we/t.tileSize/t.scale,w=ts(m.filter,m.globalState),C=t.queryGeometry,D=t.queryPadding*y,z=Os.fromPoints(C),N=this.grid.query(z.minX-D,z.minY-D,z.maxX+D,z.maxY+D),V=Os.fromPoints(t.cameraQueryGeometry).expandBy(D),U=this.grid3D.query(V.minX,V.minY,V.maxX,V.maxY,((tt,at,yt,ct)=>(function(dt,Pt,Dt,Zt,ue){for(const de of dt)if(Pt<=de.x&&Dt<=de.y&&Zt>=de.x&&ue>=de.y)return!0;const ie=[new L(Pt,Dt),new L(Pt,ue),new L(Zt,ue),new L(Zt,Dt)];if(dt.length>2){for(const de of ie)if(Ru(dt,de))return!0}for(let de=0;de<dt.length-1;de++)if(fy(dt[de],dt[de+1],ie))return!0;return!1})(t.cameraQueryGeometry,tt-D,at-D,yt+D,ct+D)));for(const tt of U)N.push(tt);N.sort(Ef);const G={};let Y;for(let tt=0;tt<N.length;tt++){const at=N[tt];if(at===Y)continue;Y=at;const yt=this.featureIndexArray.get(at);let ct=null;this.loadMatchingFeature(G,yt.bucketIndex,yt.sourceLayerIndex,yt.featureIndex,w,m.layers,m.availableImages,n,l,h,((dt,Pt,Dt)=>(ct||(ct=po(dt)),Pt.queryIntersectsFeature({queryGeometry:C,feature:dt,featureState:Dt,geometry:ct,zoom:this.z,transform:t.transform,pixelsToTileUnits:y,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation}))))}return G}loadMatchingFeature(t,n,l,h,m,y,w,C,D,z,N){const V=this.bucketLayerIDs[n];if(y&&!V.some((tt=>y.has(tt))))return;const U=this.sourceLayerCoder.decode(l),G=this.vtLayers[U].feature(h);if(m.needGeometry){const tt=Br(G,!0);if(!m.filter(new kn(this.tileID.overscaledZ),tt,this.tileID.canonical))return}else if(!m.filter(new kn(this.tileID.overscaledZ),G))return;const Y=this.getId(G,U);for(let tt=0;tt<V.length;tt++){const at=V[tt];if(y&&!y.has(at))continue;const yt=C[at];if(!yt)continue;let ct={};Y&&z&&(ct=z.getState(yt.sourceLayer||Jo,Y));const dt=yn({},D[at]);dt.paint=ad(dt.paint,yt.paint,G,ct,w),dt.layout=ad(dt.layout,yt.layout,G,ct,w);const Pt=!N||N(G,yt,ct);if(!Pt)continue;const Dt=new og(G,this.z,this.x,this.y,Y);Dt.layer=dt;let Zt=t[at];Zt===void 0&&(Zt=t[at]=[]),Zt.push({featureIndex:h,feature:Dt,intersectionZ:Pt})}}lookupSymbolFeatures(t,n,l,h,m,y,w,C){const D={};this.loadVTLayers();const z=ts(m.filterSpec,m.globalState);for(const N of t)this.loadMatchingFeature(D,l,h,N,z,y,w,C,n);return D}hasLayer(t){for(const n of this.bucketLayerIDs)for(const l of n)if(t===l)return!0;return!1}getId(t,n){var l;let h=t.id;return this.promoteId&&(h=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof h=="boolean"&&(h=Number(h)),h===void 0&&(!((l=t.properties)===null||l===void 0)&&l.cluster)&&this.promoteId&&(h=Number(t.properties.cluster_id))),h}}function ad(r,t,n,l,h){return Gi(r,((m,y)=>{const w=t instanceof Rs?t.get(y):null;return w&&w.evaluate?w.evaluate(n,l,h):w}))}function Ef(r,t){return t-r}function $l(r,t,n,l,h){const m=[];for(let y=0;y<r.length;y++){const w=r[y];let C;for(let D=0;D<w.length-1;D++){let z=w[D],N=w[D+1];z.x<t&&N.x<t||(z.x<t?z=new L(t,z.y+(t-z.x)/(N.x-z.x)*(N.y-z.y))._round():N.x<t&&(N=new L(t,z.y+(t-z.x)/(N.x-z.x)*(N.y-z.y))._round()),z.y<n&&N.y<n||(z.y<n?z=new L(z.x+(n-z.y)/(N.y-z.y)*(N.x-z.x),n)._round():N.y<n&&(N=new L(z.x+(n-z.y)/(N.y-z.y)*(N.x-z.x),n)._round()),z.x>=l&&N.x>=l||(z.x>=l?z=new L(l,z.y+(l-z.x)/(N.x-z.x)*(N.y-z.y))._round():N.x>=l&&(N=new L(l,z.y+(l-z.x)/(N.x-z.x)*(N.y-z.y))._round()),z.y>=h&&N.y>=h||(z.y>=h?z=new L(z.x+(h-z.y)/(N.y-z.y)*(N.x-z.x),h)._round():N.y>=h&&(N=new L(z.x+(h-z.y)/(N.y-z.y)*(N.x-z.x),h)._round()),C&&z.equals(C[C.length-1])||(C=[z],m.push(C)),C.push(N)))))}}return m}function Qy(r,t,n,l,h){switch(t){case 1:return(function(m,y,w,C){const D=[];for(const z of m)for(const N of z){const V=C===0?N.x:N.y;V>=y&&V<=w&&D.push([N])}return D})(r,n,l,h);case 2:return od(r,n,l,h,!1);case 3:return od(r,n,l,h,!0)}return[]}function Jy(r,t,n,l,h){const m=l===0?Bv:t_;let y=[];const w=[];for(let z=0;z<r.length-1;z++){const N=r[z],V=r[z+1],U=l===0?N.x:N.y,G=l===0?V.x:V.y;let Y=!1;U<t?G>t&&y.push(m(N,V,t)):U>n?G<n&&y.push(m(N,V,n)):y.push(N),G<t&&U>=t&&(y.push(m(N,V,t)),Y=!0),G>n&&U<=n&&(y.push(m(N,V,n)),Y=!0),!h&&Y&&(w.push(y),y=[])}const C=r.length-1,D=l===0?r[C].x:r[C].y;return D>=t&&D<=n&&y.push(r[C]),h&&y.length>0&&!y[0].equals(y[y.length-1])&&y.push(new L(y[0].x,y[0].y)),y.length>0&&w.push(y),w}function od(r,t,n,l,h){const m=[];for(const y of r){const w=Jy(y,t,n,l,h);w.length>0&&m.push(...w)}return m}function Bv(r,t,n){return new L(n,r.y+(n-r.x)/(t.x-r.x)*(t.y-r.y))}function t_(r,t,n){return new L(r.x+(n-r.y)/(t.y-r.y)*(t.x-r.x),n)}Me("FeatureIndex",Zl,{omit:["rawTileData","sourceLayerCoder"]});class _o extends L{constructor(t,n,l,h){super(t,n),this.angle=l,h!==void 0&&(this.segment=h)}clone(){return new _o(this.x,this.y,this.angle,this.segment)}}function Mg(r,t,n,l,h){if(t.segment===void 0||n===0)return!0;let m=t,y=t.segment+1,w=0;for(;w>-n/2;){if(y--,y<0)return!1;w-=r[y].dist(m),m=r[y]}w+=r[y].dist(r[y+1]),y++;const C=[];let D=0;for(;w<n/2;){const z=r[y],N=r[y+1];if(!N)return!1;let V=r[y-1].angleTo(z)-z.angleTo(N);for(V=Math.abs((V+3*Math.PI)%(2*Math.PI)-Math.PI),C.push({distance:w,angleDelta:V}),D+=V;w-C[0].distance>l;)D-=C.shift().angleDelta;if(D>h)return!1;y++,w+=z.dist(N)}return!0}function e_(r){let t=0;for(let n=0;n<r.length-1;n++)t+=r[n].dist(r[n+1]);return t}function Cf(r,t,n){return r?.6*t*n:0}function Af(r,t){return Math.max(r?r.right-r.left:0,t?t.right-t.left:0)}function n_(r,t,n,l,h,m){const y=Cf(n,h,m),w=Af(n,l)*m;let C=0;const D=e_(r)/2;for(let z=0;z<r.length-1;z++){const N=r[z],V=r[z+1],U=N.dist(V);if(C+U>D){const G=(D-C)/U,Y=$s.number(N.x,V.x,G),tt=$s.number(N.y,V.y,G),at=new _o(Y,tt,V.angleTo(N),z);return at._round(),!y||Mg(r,at,w,y,t)?at:void 0}C+=U}}function ld(r,t,n,l,h,m,y,w,C){const D=Cf(l,m,y),z=Af(l,h),N=z*y,V=r[0].x===0||r[0].x===C||r[0].y===0||r[0].y===C;return t-N<t/4&&(t=N+t/4),Pg(r,V?t/2*w%t:(z/2+2*m)*y*w%t,t,D,n,N,V,!1,C)}function Pg(r,t,n,l,h,m,y,w,C){const D=m/2,z=e_(r);let N=0,V=t-n,U=[];for(let G=0;G<r.length-1;G++){const Y=r[G],tt=r[G+1],at=Y.dist(tt),yt=tt.angleTo(Y);for(;V+n<N+at;){V+=n;const ct=(V-N)/at,dt=$s.number(Y.x,tt.x,ct),Pt=$s.number(Y.y,tt.y,ct);if(dt>=0&&dt<C&&Pt>=0&&Pt<C&&V-D>=0&&V+D<=z){const Dt=new _o(dt,Pt,yt,G);Dt._round(),l&&!Mg(r,Dt,m,l,h)||U.push(Dt)}}N+=at}return w||U.length||y||(U=Pg(r,N/2,n,l,h,m,y,!0,C)),U}function Up(r,t,n,l){const h=[],m=r.image,y=m.pixelRatio,w=m.paddedRect.w-2,C=m.paddedRect.h-2;let D={x1:r.left,y1:r.top,x2:r.right,y2:r.bottom};const z=m.stretchX||[[0,w]],N=m.stretchY||[[0,C]],V=(re,je)=>re+je[1]-je[0],U=z.reduce(V,0),G=N.reduce(V,0),Y=w-U,tt=C-G;let at=0,yt=U,ct=0,dt=G,Pt=0,Dt=Y,Zt=0,ue=tt;if(m.content&&l){const re=m.content,je=re[2]-re[0],Be=re[3]-re[1];(m.textFitWidth||m.textFitHeight)&&(D=Fy(r)),at=Ju(z,0,re[0]),ct=Ju(N,0,re[1]),yt=Ju(z,re[0],re[2]),dt=Ju(N,re[1],re[3]),Pt=re[0]-at,Zt=re[1]-ct,Dt=je-yt,ue=Be-dt}const ie=D.x1,de=D.y1,Se=D.x2-ie,_e=D.y2-de,ve=(re,je,Be,qe)=>{const Ie=Gp(re.stretch-at,yt,Se,ie),fn=th(re.fixed-Pt,Dt,re.stretch,U),xi=Gp(je.stretch-ct,dt,_e,de),ar=th(je.fixed-Zt,ue,je.stretch,G),rs=Gp(Be.stretch-at,yt,Se,ie),tl=th(Be.fixed-Pt,Dt,Be.stretch,U),Ns=Gp(qe.stretch-ct,dt,_e,de),Ur=th(qe.fixed-Zt,ue,qe.stretch,G),ss=new L(Ie,xi),Bi=new L(rs,xi),Gr=new L(rs,Ns),vs=new L(Ie,Ns),xs=new L(fn/y,ar/y),oa=new L(tl/y,Ur/y),as=t*Math.PI/180;if(as){const Pr=Math.sin(as),Ei=Math.cos(as),or=[Ei,-Pr,Pr,Ei];ss._matMult(or),Bi._matMult(or),vs._matMult(or),Gr._matMult(or)}const la=re.stretch+re.fixed,el=je.stretch+je.fixed;return{tl:ss,tr:Bi,bl:vs,br:Gr,tex:{x:m.paddedRect.x+1+la,y:m.paddedRect.y+1+el,w:Be.stretch+Be.fixed-la,h:qe.stretch+qe.fixed-el},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:xs,pixelOffsetBR:oa,minFontScaleX:Dt/y/Se,minFontScaleY:ue/y/_e,isSDF:n}};if(l&&(m.stretchX||m.stretchY)){const re=Dg(z,Y,U),je=Dg(N,tt,G);for(let Be=0;Be<re.length-1;Be++){const qe=re[Be],Ie=re[Be+1];for(let fn=0;fn<je.length-1;fn++)h.push(ve(qe,je[fn],Ie,je[fn+1]))}}else h.push(ve({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:C+1}));return h}function Ju(r,t,n){let l=0;for(const h of r)l+=Math.max(t,Math.min(n,h[1]))-Math.max(t,Math.min(n,h[0]));return l}function Dg(r,t,n){const l=[{fixed:-1,stretch:0}];for(const[h,m]of r){const y=l[l.length-1];l.push({fixed:h-y.stretch,stretch:y.stretch}),l.push({fixed:h-y.stretch,stretch:y.stretch+(m-h)})}return l.push({fixed:t+1,stretch:n}),l}function Gp(r,t,n,l){return r/t*n+l}function th(r,t,n,l){return r-t*n/l}Me("Anchor",_o);class i{constructor(t,n,l,h,m,y,w,C,D,z){var N;if(this.boxStartIndex=t.length,D){let V=y.top,U=y.bottom;const G=y.collisionPadding;G&&(V-=G[1],U+=G[3]);let Y=U-V;Y>0&&(Y=Math.max(10,Y),this.circleDiameter=Y)}else{const V=!((N=y.image)===null||N===void 0)&&N.content&&(y.image.textFitWidth||y.image.textFitHeight)?Fy(y):{x1:y.left,y1:y.top,x2:y.right,y2:y.bottom};V.y1=V.y1*w-C[0],V.y2=V.y2*w+C[2],V.x1=V.x1*w-C[3],V.x2=V.x2*w+C[1];const U=y.collisionPadding;if(U&&(V.x1-=U[0]*w,V.y1-=U[1]*w,V.x2+=U[2]*w,V.y2+=U[3]*w),z){const G=new L(V.x1,V.y1),Y=new L(V.x2,V.y1),tt=new L(V.x1,V.y2),at=new L(V.x2,V.y2),yt=z*Math.PI/180;G._rotate(yt),Y._rotate(yt),tt._rotate(yt),at._rotate(yt),V.x1=Math.min(G.x,Y.x,tt.x,at.x),V.x2=Math.max(G.x,Y.x,tt.x,at.x),V.y1=Math.min(G.y,Y.y,tt.y,at.y),V.y2=Math.max(G.y,Y.y,tt.y,at.y)}t.emplaceBack(n.x,n.y,V.x1,V.y1,V.x2,V.y2,l,h,m)}this.boxEndIndex=t.length}}class o{constructor(t=[],n=(l,h)=>l<h?-1:l>h?1:0){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:l}=this,h=n[t];for(;t>0;){const m=t-1>>1,y=n[m];if(l(h,y)>=0)break;n[t]=y,t=m}n[t]=h}_down(t){const{data:n,compare:l}=this,h=this.length>>1,m=n[t];for(;t<h;){let y=1+(t<<1);const w=y+1;if(w<this.length&&l(n[w],n[y])<0&&(y=w),l(n[y],m)>=0)break;n[t]=n[y],t=y}n[t]=m}}function f(r,t=1,n=!1){const l=Os.fromPoints(r[0]),h=Math.min(l.width(),l.height());let m=h/2;const y=new o([],b),{minX:w,minY:C,maxX:D,maxY:z}=l;if(h===0)return new L(w,C);for(let U=w;U<D;U+=h)for(let G=C;G<z;G+=h)y.push(new M(U+m,G+m,m,r));let N=(function(U){let G=0,Y=0,tt=0;const at=U[0];for(let yt=0,ct=at.length,dt=ct-1;yt<ct;dt=yt++){const Pt=at[yt],Dt=at[dt],Zt=Pt.x*Dt.y-Dt.x*Pt.y;Y+=(Pt.x+Dt.x)*Zt,tt+=(Pt.y+Dt.y)*Zt,G+=3*Zt}return new M(Y/G,tt/G,0,U)})(r),V=y.length;for(;y.length;){const U=y.pop();(U.d>N.d||!N.d)&&(N=U,n&&console.log("found best %d after %d probes",Math.round(1e4*U.d)/1e4,V)),U.max-N.d<=t||(m=U.h/2,y.push(new M(U.p.x-m,U.p.y-m,m,r)),y.push(new M(U.p.x+m,U.p.y-m,m,r)),y.push(new M(U.p.x-m,U.p.y+m,m,r)),y.push(new M(U.p.x+m,U.p.y+m,m,r)),V+=4)}return n&&(console.log(`num probes: ${V}`),console.log(`best distance: ${N.d}`)),N.p}function b(r,t){return t.max-r.max}function M(r,t,n,l){this.p=new L(r,t),this.h=n,this.d=(function(h,m){let y=!1,w=1/0;for(let C=0;C<m.length;C++){const D=m[C];for(let z=0,N=D.length,V=N-1;z<N;V=z++){const U=D[z],G=D[V];U.y>h.y!=G.y>h.y&&h.x<(G.x-U.x)*(h.y-U.y)/(G.y-U.y)+U.x&&(y=!y),w=Math.min(w,Yi(h,U,G))}}return(y?1:-1)*Math.sqrt(w)})(this.p,l),this.max=this.d+this.h*Math.SQRT2}var I;T.aO=void 0,(I=T.aO||(T.aO={}))[I.center=1]="center",I[I.left=2]="left",I[I.right=3]="right",I[I.top=4]="top",I[I.bottom=5]="bottom",I[I["top-left"]=6]="top-left",I[I["top-right"]=7]="top-right",I[I["bottom-left"]=8]="bottom-left",I[I["bottom-right"]=9]="bottom-right";const X=Number.POSITIVE_INFINITY;function ot(r,t){return t[1]!==X?(function(n,l,h){let m=0,y=0;switch(l=Math.abs(l),h=Math.abs(h),n){case"top-right":case"top-left":case"top":y=h-7;break;case"bottom-right":case"bottom-left":case"bottom":y=7-h}switch(n){case"top-right":case"bottom-right":case"right":m=-l;break;case"top-left":case"bottom-left":case"left":m=l}return[m,y]})(r,t[0],t[1]):(function(n,l){let h=0,m=0;l<0&&(l=0);const y=l/Math.SQRT2;switch(n){case"top-right":case"top-left":m=y-7;break;case"bottom-right":case"bottom-left":m=7-y;break;case"bottom":m=7-l;break;case"top":m=l-7}switch(n){case"top-right":case"bottom-right":h=-y;break;case"top-left":case"bottom-left":h=y;break;case"left":h=l;break;case"right":h=-l}return[h,m]})(r,t[0])}function Mt(r,t,n){var l;const h=r.layout,m=(l=h.get("text-variable-anchor-offset"))===null||l===void 0?void 0:l.evaluate(t,{},n);if(m){const w=m.values,C=[];for(let D=0;D<w.length;D+=2){const z=C[D]=w[D],N=w[D+1].map((V=>V*Ki));z.startsWith("top")?N[1]-=7:z.startsWith("bottom")&&(N[1]+=7),C[D+1]=N}return new Zi(C)}const y=h.get("text-variable-anchor");if(y){let w;w=r._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(t,{},n)*Ki,X]:h.get("text-offset").evaluate(t,{},n).map((D=>D*Ki));const C=[];for(const D of y)C.push(D,ot(D,w));return new Zi(C)}return null}function Yt(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function le(r,t,n,l,h,m,y,w,C,D,z,N){let V=m.textMaxSize.evaluate(t,{});V===void 0&&(V=y);const U=r.layers[0].layout,G=U.get("icon-offset").evaluate(t,{},z),Y=Jt(n.horizontal),tt=y/24,at=r.tilePixelRatio*tt,yt=r.tilePixelRatio*V/24,ct=r.tilePixelRatio*w,dt=r.tilePixelRatio*U.get("symbol-spacing"),Pt=U.get("text-padding")*r.tilePixelRatio,Dt=(function(Be,qe,Ie,fn=1){const xi=Be.get("icon-padding").evaluate(qe,{},Ie),ar=xi&&xi.values;return[ar[0]*fn,ar[1]*fn,ar[2]*fn,ar[3]*fn]})(U,t,z,r.tilePixelRatio),Zt=U.get("text-max-angle")/180*Math.PI,ue=U.get("text-rotation-alignment")!=="viewport"&&U.get("symbol-placement")!=="point",ie=U.get("icon-rotation-alignment")==="map"&&U.get("symbol-placement")!=="point",de=U.get("symbol-placement"),Se=dt/2,_e=U.get("icon-text-fit");let ve;l&&_e!=="none"&&(r.allowVerticalPlacement&&n.vertical&&(ve=cf(l,n.vertical,_e,U.get("icon-text-fit-padding"),G,tt)),Y&&(l=cf(l,Y,_e,U.get("icon-text-fit-padding"),G,tt)));const re=z?N.line.getGranularityForZoomLevel(z.z):1,je=(Be,qe)=>{qe.x<0||qe.x>=we||qe.y<0||qe.y>=we||(function(Ie,fn,xi,ar,rs,tl,Ns,Ur,ss,Bi,Gr,vs,xs,oa,as,la,el,Pr,Ei,or,zi,Dr,eh,Hl,Rg){const cd=Ie.addToLineVertexArray(fn,xi);let Mf,qp,Zp,$p,Ib=0,zb=0,Lb=0,kb=0,Vv=-1,Uv=-1;const nh={};let Ob=ka("");if(Ie.allowVerticalPlacement&&ar.vertical){const bs=Ur.layout.get("text-rotate").evaluate(zi,{},Hl)+90;Zp=new i(ss,fn,Bi,Gr,vs,ar.vertical,xs,oa,as,bs),Ns&&($p=new i(ss,fn,Bi,Gr,vs,Ns,el,Pr,as,bs))}if(rs){const bs=Ur.layout.get("icon-rotate").evaluate(zi,{}),vo=Ur.layout.get("icon-text-fit")!=="none",Pf=Up(rs,bs,eh,vo),Yl=Ns?Up(Ns,bs,eh,vo):void 0;qp=new i(ss,fn,Bi,Gr,vs,rs,el,Pr,!1,bs),Ib=4*Pf.length;const Df=Ie.iconSizeData;let qc=null;Df.kind==="source"?(qc=[zs*Ur.layout.get("icon-size").evaluate(zi,{})],qc[0]>Ko&&Nn(`${Ie.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Df.kind==="composite"&&(qc=[zs*Dr.compositeIconSizes[0].evaluate(zi,{},Hl),zs*Dr.compositeIconSizes[1].evaluate(zi,{},Hl)],(qc[0]>Ko||qc[1]>Ko)&&Nn(`${Ie.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Ie.addSymbols(Ie.icon,Pf,qc,or,Ei,zi,T.ay.none,fn,cd.lineStartIndex,cd.lineLength,-1,Hl),Vv=Ie.icon.placedSymbolArray.length-1,Yl&&(zb=4*Yl.length,Ie.addSymbols(Ie.icon,Yl,qc,or,Ei,zi,T.ay.vertical,fn,cd.lineStartIndex,cd.lineLength,-1,Hl),Uv=Ie.icon.placedSymbolArray.length-1)}const Nb=Object.keys(ar.horizontal);for(const bs of Nb){const vo=ar.horizontal[bs];if(!Mf){Ob=ka(vo.text);const Yl=Ur.layout.get("text-rotate").evaluate(zi,{},Hl);Mf=new i(ss,fn,Bi,Gr,vs,vo,xs,oa,as,Yl)}const Pf=vo.positionedLines.length===1;if(Lb+=fe(Ie,fn,vo,tl,Ur,as,zi,la,cd,ar.vertical?T.ay.horizontal:T.ay.horizontalOnly,Pf?Nb:[bs],nh,Vv,Dr,Hl),Pf)break}ar.vertical&&(kb+=fe(Ie,fn,ar.vertical,tl,Ur,as,zi,la,cd,T.ay.vertical,["vertical"],nh,Uv,Dr,Hl));const XC=Mf?Mf.boxStartIndex:Ie.collisionBoxArray.length,YC=Mf?Mf.boxEndIndex:Ie.collisionBoxArray.length,WC=Zp?Zp.boxStartIndex:Ie.collisionBoxArray.length,KC=Zp?Zp.boxEndIndex:Ie.collisionBoxArray.length,QC=qp?qp.boxStartIndex:Ie.collisionBoxArray.length,JC=qp?qp.boxEndIndex:Ie.collisionBoxArray.length,tA=$p?$p.boxStartIndex:Ie.collisionBoxArray.length,eA=$p?$p.boxEndIndex:Ie.collisionBoxArray.length;let Xl=-1;const i_=(bs,vo)=>bs&&bs.circleDiameter?Math.max(bs.circleDiameter,vo):vo;Xl=i_(Mf,Xl),Xl=i_(Zp,Xl),Xl=i_(qp,Xl),Xl=i_($p,Xl);const Fb=Xl>-1?1:0;Fb&&(Xl*=Rg/Ki),Ie.glyphOffsetArray.length>=Zu.MAX_GLYPHS&&Nn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),zi.sortKey!==void 0&&Ie.addToSortKeyRanges(Ie.symbolInstances.length,zi.sortKey);const nA=Mt(Ur,zi,Hl),[iA,rA]=(function(bs,vo){const Pf=bs.length,Yl=vo?.values;if(Yl?.length>0)for(let Df=0;Df<Yl.length;Df+=2){const qc=Yl[Df+1];bs.emplaceBack(T.aO[Yl[Df]],qc[0],qc[1])}return[Pf,bs.length]})(Ie.textAnchorOffsets,nA);Ie.symbolInstances.emplaceBack(fn.x,fn.y,nh.right>=0?nh.right:-1,nh.center>=0?nh.center:-1,nh.left>=0?nh.left:-1,nh.vertical||-1,Vv,Uv,Ob,XC,YC,WC,KC,QC,JC,tA,eA,Bi,Lb,kb,Ib,zb,Fb,0,xs,Xl,iA,rA)})(r,qe,Be,n,l,h,ve,r.layers[0],r.collisionBoxArray,t.index,t.sourceLayerIndex,r.index,at,[Pt,Pt,Pt,Pt],ue,C,ct,Dt,ie,G,t,m,D,z,y)};if(de==="line")for(const Be of $l(t.geometry,0,0,we,we)){const qe=Rc(Be,re),Ie=ld(qe,dt,Zt,n.vertical||Y,l,24,yt,r.overscaling,we);for(const fn of Ie)Y&&ne(r,Y.text,Se,fn)||je(qe,fn)}else if(de==="line-center"){for(const Be of t.geometry)if(Be.length>1){const qe=Rc(Be,re),Ie=n_(qe,Zt,n.vertical||Y,l,24,yt);Ie&&je(qe,Ie)}}else if(t.type==="Polygon")for(const Be of hc(t.geometry,0)){const qe=f(Be,16);je(Rc(Be[0],re,!0),new _o(qe.x,qe.y,0))}else if(t.type==="LineString")for(const Be of t.geometry){const qe=Rc(Be,re);je(qe,new _o(qe[0].x,qe[0].y,0))}else if(t.type==="Point")for(const Be of t.geometry)for(const qe of Be)je([qe],new _o(qe.x,qe.y,0))}function fe(r,t,n,l,h,m,y,w,C,D,z,N,V,U,G){const Y=(function(yt,ct,dt,Pt,Dt,Zt,ue,ie){const de=Pt.layout.get("text-rotate").evaluate(Zt,{})*Math.PI/180,Se=[];for(const _e of ct.positionedLines)for(const ve of _e.positionedGlyphs){if(!ve.rect)continue;const re=ve.rect||{};let je=4,Be=!0,qe=1,Ie=0;const fn=(Dt||ie)&&ve.vertical,xi=ve.metrics.advance*ve.scale/2;if(ie&&ct.verticalizable&&(Ie=_e.lineOffset/2-(ve.imageName?-(Ki-ve.metrics.width*ve.scale)/2:(ve.scale-1)*Ki)),ve.imageName){const Pr=ue[ve.imageName];Be=Pr.sdf,qe=Pr.pixelRatio,je=1/qe}const ar=Dt?[ve.x+xi,ve.y]:[0,0];let rs=Dt?[0,0]:[ve.x+xi+dt[0],ve.y+dt[1]-Ie],tl=[0,0];fn&&(tl=rs,rs=[0,0]);const Ns=ve.metrics.isDoubleResolution?2:1,Ur=(ve.metrics.left-je)*ve.scale-xi+rs[0],ss=(-ve.metrics.top-je)*ve.scale+rs[1],Bi=Ur+re.w/Ns*ve.scale/qe,Gr=ss+re.h/Ns*ve.scale/qe,vs=new L(Ur,ss),xs=new L(Bi,ss),oa=new L(Ur,Gr),as=new L(Bi,Gr);if(fn){const Pr=new L(-xi,xi- -17),Ei=-Math.PI/2,or=12-xi,zi=new L(22-or,-(ve.imageName?or:0)),Dr=new L(...tl);vs._rotateAround(Ei,Pr)._add(zi)._add(Dr),xs._rotateAround(Ei,Pr)._add(zi)._add(Dr),oa._rotateAround(Ei,Pr)._add(zi)._add(Dr),as._rotateAround(Ei,Pr)._add(zi)._add(Dr)}if(de){const Pr=Math.sin(de),Ei=Math.cos(de),or=[Ei,-Pr,Pr,Ei];vs._matMult(or),xs._matMult(or),oa._matMult(or),as._matMult(or)}const la=new L(0,0),el=new L(0,0);Se.push({tl:vs,tr:xs,bl:oa,br:as,tex:re,writingMode:ct.writingMode,glyphOffset:ar,sectionIndex:ve.sectionIndex,isSDF:Be,pixelOffsetTL:la,pixelOffsetBR:el,minFontScaleX:0,minFontScaleY:0})}return Se})(0,n,w,h,m,y,l,r.allowVerticalPlacement),tt=r.textSizeData;let at=null;tt.kind==="source"?(at=[zs*h.layout.get("text-size").evaluate(y,{})],at[0]>Ko&&Nn(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):tt.kind==="composite"&&(at=[zs*U.compositeTextSizes[0].evaluate(y,{},G),zs*U.compositeTextSizes[1].evaluate(y,{},G)],(at[0]>Ko||at[1]>Ko)&&Nn(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),r.addSymbols(r.text,Y,at,w,m,y,D,t,C.lineStartIndex,C.lineLength,V,G);for(const yt of z)N[yt]=r.text.placedSymbolArray.length-1;return 4*Y.length}function Jt(r){for(const t in r)return r[t];return null}function ne(r,t,n,l){const h=r.compareText;if(t in h){const m=h[t];for(let y=m.length-1;y>=0;y--)if(l.dist(m[y])<n)return!0}else h[t]=[];return h[t].push(l),!1}const ke=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Je{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,l]=new Uint8Array(t,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=l>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const m=ke[15&l];if(!m)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(t,2,1),[w]=new Uint32Array(t,4,1);return new Je(w,y,m,t)}constructor(t,n=64,l=Float64Array,h){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=l,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const m=ke.indexOf(this.ArrayType),y=2*t*this.ArrayType.BYTES_PER_ELEMENT,w=t*this.IndexArrayType.BYTES_PER_ELEMENT,C=(8-w%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${l}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+w+C,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+y+w+C),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+w+C,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t)}add(t,n){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=t,this.coords[this._pos++]=n,l}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Kn(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,n,l,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:y,nodeSize:w}=this,C=[0,m.length-1,0],D=[];for(;C.length;){const z=C.pop()||0,N=C.pop()||0,V=C.pop()||0;if(N-V<=w){for(let tt=V;tt<=N;tt++){const at=y[2*tt],yt=y[2*tt+1];at>=t&&at<=l&&yt>=n&&yt<=h&&D.push(m[tt])}continue}const U=V+N>>1,G=y[2*U],Y=y[2*U+1];G>=t&&G<=l&&Y>=n&&Y<=h&&D.push(m[U]),(z===0?t<=G:n<=Y)&&(C.push(V),C.push(U-1),C.push(1-z)),(z===0?l>=G:h>=Y)&&(C.push(U+1),C.push(N),C.push(1-z))}return D}within(t,n,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:m,nodeSize:y}=this,w=[0,h.length-1,0],C=[],D=l*l;for(;w.length;){const z=w.pop()||0,N=w.pop()||0,V=w.pop()||0;if(N-V<=y){for(let tt=V;tt<=N;tt++)he(m[2*tt],m[2*tt+1],t,n)<=D&&C.push(h[tt]);continue}const U=V+N>>1,G=m[2*U],Y=m[2*U+1];he(G,Y,t,n)<=D&&C.push(h[U]),(z===0?t-l<=G:n-l<=Y)&&(w.push(V),w.push(U-1),w.push(1-z)),(z===0?t+l>=G:n+l>=Y)&&(w.push(U+1),w.push(N),w.push(1-z))}return C}}function Kn(r,t,n,l,h,m){if(h-l<=n)return;const y=l+h>>1;Bt(r,t,y,l,h,m),Kn(r,t,n,l,y-1,1-m),Kn(r,t,n,y+1,h,1-m)}function Bt(r,t,n,l,h,m){for(;h>l;){if(h-l>600){const D=h-l+1,z=n-l+1,N=Math.log(D),V=.5*Math.exp(2*N/3),U=.5*Math.sqrt(N*V*(D-V)/D)*(z-D/2<0?-1:1);Bt(r,t,n,Math.max(l,Math.floor(n-z*V/D+U)),Math.min(h,Math.floor(n+(D-z)*V/D+U)),m)}const y=t[2*n+m];let w=l,C=h;for(kt(r,t,l,n),t[2*h+m]>y&&kt(r,t,l,h);w<C;){for(kt(r,t,w,C),w++,C--;t[2*w+m]<y;)w++;for(;t[2*C+m]>y;)C--}t[2*l+m]===y?kt(r,t,l,C):(C++,kt(r,t,C,h)),C<=n&&(l=C+1),n<=C&&(h=C-1)}}function kt(r,t,n,l){Ht(r,n,l),Ht(t,2*n,2*l),Ht(t,2*n+1,2*l+1)}function Ht(r,t,n){const l=r[t];r[t]=r[n],r[n]=l}function he(r,t,n,l){const h=r-n,m=t-l;return h*h+m*m}var Xe;T.cG=void 0,(Xe=T.cG||(T.cG={})).create="create",Xe.load="load",Xe.fullLoad="fullLoad";let Dn=null,Fe=[];const un=1e3/60,bn="loadTime",Ln="fullLoadTime",Gc={mark(r){performance.mark(r)},frame(r){const t=r;Dn!=null&&Fe.push(t-Dn),Dn=t},clearMetrics(){Dn=null,Fe=[],performance.clearMeasures(bn),performance.clearMeasures(Ln);for(const r in T.cG)performance.clearMarks(T.cG[r])},getPerformanceMetrics(){performance.measure(bn,T.cG.create,T.cG.load),performance.measure(Ln,T.cG.create,T.cG.fullLoad);const r=performance.getEntriesByName(bn)[0].duration,t=performance.getEntriesByName(Ln)[0].duration,n=Fe.length,l=1/(Fe.reduce(((m,y)=>m+y),0)/n/1e3),h=Fe.filter((m=>m>un)).reduce(((m,y)=>m+(y-un)/un),0);return{loadTime:r,fullLoadTime:t,fps:l,percentDroppedFrames:h/(n+h)*100,totalFrames:n}}};T.$=mt,T.A=bt,T.B=Ia,T.C=As,T.D=Re,T.E=Ft,T.F=function([r,t,n]){return t+=90,t*=Math.PI/180,n*=Math.PI/180,{x:r*Math.cos(t)*Math.sin(n),y:r*Math.sin(t)*Math.sin(n),z:r*Math.cos(n)}},T.G=$s,T.H=kn,T.I=Ap,T.J=sp,T.K=function(r){if(ui==null){const t=r.navigator?r.navigator.userAgent:null;ui=!!r.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return ui},T.L=class{constructor(r,t){this.target=r,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Lv((()=>this.process())),this.subscription=So(this.target,"message",(n=>this.receive(n)),!1),this.globalScope=Ts(self)?r:window}registerMessageHandler(r,t){this.messageHandlers[r]=t}unregisterMessageHandler(r){delete this.messageHandlers[r]}sendAsync(r,t){return new Promise(((n,l)=>{const h=Math.round(1e18*Math.random()).toString(36).substring(0,10),m=t?So(t.signal,"abort",(()=>{m?.unsubscribe(),delete this.resolveRejects[h];const C={id:h,type:"<cancel>",origin:location.origin,targetMapId:r.targetMapId,sourceMapId:this.mapId};this.target.postMessage(C)}),pf):null;this.resolveRejects[h]={resolve:C=>{m?.unsubscribe(),n(C)},reject:C=>{m?.unsubscribe(),l(C)}};const y=[],w=Object.assign(Object.assign({},r),{id:h,sourceMapId:this.mapId,origin:location.origin,data:jo(r.data,y)});this.target.postMessage(w,{transfer:y})}))}receive(r){const t=r.data,n=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[n];const l=this.abortControllers[n];return delete this.abortControllers[n],void(l&&l.abort())}if(Ts(self)||t.mustQueue)return this.tasks[n]=t,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,t)}}process(){if(this.taskQueue.length===0)return;const r=this.taskQueue.shift(),t=this.tasks[r];delete this.tasks[r],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(r,t)}processTask(r,t){return u(this,void 0,void 0,(function*(){if(t.type==="<response>"){const h=this.resolveRejects[r];return delete this.resolveRejects[r],h?void(t.error?h.reject(za(t.error)):h.resolve(za(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(r,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const n=za(t.data),l=new AbortController;this.abortControllers[r]=l;try{const h=yield this.messageHandlers[t.type](t.sourceMapId,n,l);this.completeTask(r,null,h)}catch(h){this.completeTask(r,h)}}))}completeTask(r,t,n){const l=[];delete this.abortControllers[r];const h={id:r,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?jo(t):null,data:jo(n,l)};this.target.postMessage(h,{transfer:l})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},T.M=ol,T.N=function(){var r=new bt(16);return bt!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},T.O=function(r,t,n){var l,h,m,y,w,C,D,z,N,V,U,G,Y=n[0],tt=n[1],at=n[2];return t===r?(r[12]=t[0]*Y+t[4]*tt+t[8]*at+t[12],r[13]=t[1]*Y+t[5]*tt+t[9]*at+t[13],r[14]=t[2]*Y+t[6]*tt+t[10]*at+t[14],r[15]=t[3]*Y+t[7]*tt+t[11]*at+t[15]):(h=t[1],m=t[2],y=t[3],w=t[4],C=t[5],D=t[6],z=t[7],N=t[8],V=t[9],U=t[10],G=t[11],r[0]=l=t[0],r[1]=h,r[2]=m,r[3]=y,r[4]=w,r[5]=C,r[6]=D,r[7]=z,r[8]=N,r[9]=V,r[10]=U,r[11]=G,r[12]=l*Y+w*tt+N*at+t[12],r[13]=h*Y+C*tt+V*at+t[13],r[14]=m*Y+D*tt+U*at+t[14],r[15]=y*Y+z*tt+G*at+t[15]),r},T.P=L,T.Q=function(r,t,n){var l=n[0],h=n[1],m=n[2];return r[0]=t[0]*l,r[1]=t[1]*l,r[2]=t[2]*l,r[3]=t[3]*l,r[4]=t[4]*h,r[5]=t[5]*h,r[6]=t[6]*h,r[7]=t[7]*h,r[8]=t[8]*m,r[9]=t[9]*m,r[10]=t[10]*m,r[11]=t[11]*m,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},T.R=Vr,T.S=function(r,t,n){var l=t[0],h=t[1],m=t[2],y=t[3],w=t[4],C=t[5],D=t[6],z=t[7],N=t[8],V=t[9],U=t[10],G=t[11],Y=t[12],tt=t[13],at=t[14],yt=t[15],ct=n[0],dt=n[1],Pt=n[2],Dt=n[3];return r[0]=ct*l+dt*w+Pt*N+Dt*Y,r[1]=ct*h+dt*C+Pt*V+Dt*tt,r[2]=ct*m+dt*D+Pt*U+Dt*at,r[3]=ct*y+dt*z+Pt*G+Dt*yt,r[4]=(ct=n[4])*l+(dt=n[5])*w+(Pt=n[6])*N+(Dt=n[7])*Y,r[5]=ct*h+dt*C+Pt*V+Dt*tt,r[6]=ct*m+dt*D+Pt*U+Dt*at,r[7]=ct*y+dt*z+Pt*G+Dt*yt,r[8]=(ct=n[8])*l+(dt=n[9])*w+(Pt=n[10])*N+(Dt=n[11])*Y,r[9]=ct*h+dt*C+Pt*V+Dt*tt,r[10]=ct*m+dt*D+Pt*U+Dt*at,r[11]=ct*y+dt*z+Pt*G+Dt*yt,r[12]=(ct=n[12])*l+(dt=n[13])*w+(Pt=n[14])*N+(Dt=n[15])*Y,r[13]=ct*h+dt*C+Pt*V+Dt*tt,r[14]=ct*m+dt*D+Pt*U+Dt*at,r[15]=ct*y+dt*z+Pt*G+Dt*yt,r},T.T=Bh,T.U=function(r,t){const n={};for(let l=0;l<t.length;l++){const h=t[l];h in r&&(n[h]=r[h])}return n},T.V=Gl,T.W=Le,T.X=Ip,T.Y=mf,T.Z=J,T._=u,T.a=Ga,T.a$=xe,T.a0=To,T.a1=Ls,T.a2=zp,T.a3=Nc,T.a4=we,T.a5=function(r,t,n){if(!r)return t||{};if(!t)return r||{};const l=Ar(r),h=Ar(t);(function(y,w){w.removeAll&&(y.add.clear(),y.update.clear(),y.remove.clear(),w.remove.clear());for(const C of w.remove)y.add.delete(C),y.update.delete(C);for(const[C,D]of w.update){const z=y.update.get(C);z&&(w.update.set(C,ag(z,D)),y.update.delete(C))}})(l,h);const m={};if((l.removeAll||h.removeAll)&&(m.removeAll=!0),m.remove=new Set([...l.remove,...h.remove]),m.add=new Map([...l.add,...h.add]),m.update=new Map([...l.update,...h.update]),m.remove.size&&m.add.size)for(const y of m.add.keys())m.remove.delete(y);return(function(y){const w={};return y.removeAll&&(w.removeAll=y.removeAll),y.remove&&(w.remove=Array.from(y.remove)),y.add&&(w.add=Array.from(y.add.values())),y.update&&(w.update=Array.from(y.update.values())),w})(m)},T.a6=function(r,t){if(r==null)return!0;if(r.type==="Feature")return jn(r,t)!=null;if(r.type==="FeatureCollection"){const n=new Set;for(const l of r.features){const h=jn(l,t);if(h==null||n.has(h))return!1;n.add(h)}return!0}return!1},T.a7=function(r,t){const n=new Map;if(r!=null)if(r.type==="Feature")n.set(jn(r,t),r);else for(const l of r.features)n.set(jn(l,t),l);return n},T.a8=function(r,t,n){var l,h;if(t.removeAll)r.clear();else if(t.remove)for(const m of t.remove)r.delete(m);if(t.add)for(const m of t.add){const y=jn(m,n);y!=null&&r.set(y,m)}if(t.update)for(const m of t.update){let y=r.get(m.id);if(!y)continue;const w=!!m.newGeometry,C=m.removeAllProperties||((l=m.removeProperties)===null||l===void 0?void 0:l.length)>0||((h=m.addOrUpdateProperties)===null||h===void 0?void 0:h.length)>0;if((w||C)&&(y=Object.assign({},y),r.set(m.id,y),w&&(y.geometry=m.newGeometry),C)){if(y.properties=m.removeAllProperties?{}:Object.assign({},y.properties||{}),m.removeProperties)for(const D of m.removeProperties)delete y.properties[D];if(m.addOrUpdateProperties)for(const{key:D,value:z}of m.addOrUpdateProperties)y.properties[D]=z}}},T.a9=Jo,T.aA=function(r,t){var n=t[0],l=t[1],h=t[2],m=t[3],y=t[4],w=t[5],C=t[6],D=t[7],z=t[8],N=t[9],V=t[10],U=t[11],G=t[12],Y=t[13],tt=t[14],at=t[15],yt=n*w-l*y,ct=n*C-h*y,dt=n*D-m*y,Pt=l*C-h*w,Dt=l*D-m*w,Zt=h*D-m*C,ue=z*Y-N*G,ie=z*tt-V*G,de=z*at-U*G,Se=N*tt-V*Y,_e=N*at-U*Y,ve=V*at-U*tt,re=yt*ve-ct*_e+dt*Se+Pt*de-Dt*ie+Zt*ue;return re?(r[0]=(w*ve-C*_e+D*Se)*(re=1/re),r[1]=(h*_e-l*ve-m*Se)*re,r[2]=(Y*Zt-tt*Dt+at*Pt)*re,r[3]=(V*Dt-N*Zt-U*Pt)*re,r[4]=(C*de-y*ve-D*ie)*re,r[5]=(n*ve-h*de+m*ie)*re,r[6]=(tt*dt-G*Zt-at*ct)*re,r[7]=(z*Zt-V*dt+U*ct)*re,r[8]=(y*_e-w*de+D*ue)*re,r[9]=(l*de-n*_e-m*ue)*re,r[10]=(G*Dt-Y*dt+at*yt)*re,r[11]=(N*dt-z*Dt-U*yt)*re,r[12]=(w*ie-y*Se-C*ue)*re,r[13]=(n*Se-l*ie+h*ue)*re,r[14]=(Y*ct-G*Pt-tt*yt)*re,r[15]=(z*Pt-N*ct+V*yt)*re,r):null},T.aB=Qt,T.aC=function(r){var t=r[0],n=r[1];return Math.sqrt(t*t+n*n)},T.aD=function(r){return r[0]=0,r[1]=0,r},T.aE=function(r,t,n){return r[0]=t[0]*n,r[1]=t[1]*n,r},T.aF=qu,T.aG=Ee,T.aH=function(r,t,n,l){const h=t.y-r.y,m=t.x-r.x,y=l.y-n.y,w=l.x-n.x,C=y*m-w*h;if(C===0)return null;const D=(w*(r.y-n.y)-y*(r.x-n.x))/C;return new L(r.x+D*m,r.y+D*h)},T.aI=$l,T.aJ=Hd,T.aK=function(r){let t=1/0,n=1/0,l=-1/0,h=-1/0;for(const m of r)t=Math.min(t,m.x),n=Math.min(n,m.y),l=Math.max(l,m.x),h=Math.max(h,m.y);return[t,n,l,h]},T.aL=Ki,T.aM=He,T.aN=function(r,t,n,l,h=!1){if(!n[0]&&!n[1])return[0,0];const m=h?l==="map"?-r.bearingInRadians:0:l==="viewport"?r.bearingInRadians:0;if(m){const y=Math.sin(m),w=Math.cos(m);n=[n[0]*w-n[1]*y,n[0]*y+n[1]*w]}return[h?n[0]:He(t,n[0],r.zoom),h?n[1]:He(t,n[1],r.zoom)]},T.aP=hf,T.aQ=Yt,T.aR=Mp,T.aS=Je,T.aT=Fn,T.aU=Lu,T.aV=ft,T.aW=Ke,T.aX=ye,T.aY=Hr,T.aZ=gf,T.a_=Ae,T.aa=yf,T.ab=Os,T.ac=25,T.ad=sg,T.ae=r=>{const t=window.document.createElement("video");return t.muted=!0,new Promise((n=>{t.onloadstart=()=>{n(t)};for(const l of r){const h=window.document.createElement("source");K(l)||(t.crossOrigin="Anonymous"),h.src=l,t.appendChild(h)}}))},T.af=pe,T.ag=function(){return Mn++},T.ah=E,T.ai=Zu,T.aj=ts,T.ak=Br,T.al=og,T.am=function(r){const t={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((n,l,h,m)=>{const y=h||m;return t[l]=!y||y.toLowerCase(),""})),t["max-age"]){const n=parseInt(t["max-age"],10);isNaN(n)?delete t["max-age"]:t["max-age"]=n}return t},T.an=$e,T.ao=85.051129,T.ap=qi,T.aq=function(r){return Math.pow(2,r)},T.ar=Ot,T.as=ig,T.at=function(r){return Math.log(r)/Math.LN2},T.au=function(r){var t=r[0],n=r[1];return t*t+n*n},T.av=class{constructor(r,t){this.max=r,this.onRemove=t,this.reset()}reset(){for(const r in this.data)for(const t of this.data[r])t.timeout&&clearTimeout(t.timeout),this.onRemove(t.value);return this.data={},this.order=[],this}add(r,t,n){const l=r.wrapped().key;this.data[l]===void 0&&(this.data[l]=[]);const h={value:t,timeout:void 0};if(n!==void 0&&(h.timeout=setTimeout((()=>{this.remove(r,h)}),n)),this.data[l].push(h),this.order.push(l),this.order.length>this.max){const m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const t=this.data[r].shift();return t.timeout&&clearTimeout(t.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),t.value}getByKey(r){const t=this.data[r];return t?t[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,t){if(!this.has(r))return this;const n=r.wrapped().key,l=t===void 0?0:this.data[n].indexOf(t),h=this.data[n][l];return this.data[n].splice(l,1),h.timeout&&clearTimeout(h.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(h.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}filter(r){const t=[];for(const n in this.data)for(const l of this.data[n])r(l.value)||t.push(l);for(const n of t)this.remove(n.value.tileID,n)}},T.aw=function(r){if(!r.length)return new Set;const t=Math.max(...r.map((C=>C.canonical.z)));let n=1/0,l=-1/0,h=1/0,m=-1/0;const y=[];for(const C of r){const{x:D,y:z,z:N}=C.canonical,V=Math.pow(2,t-N),U=D*V,G=z*V;y.push({id:C,x:U,y:G}),U<n&&(n=U),U>l&&(l=U),G<h&&(h=G),G>m&&(m=G)}const w=new Set;for(const C of y)C.x!==n&&C.x!==l&&C.y!==h&&C.y!==m||w.add(C.id);return w},T.ax=function(r,t){let n=0,l=0;if(r.kind==="constant")l=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:h,minZoom:m,maxZoom:y}=r,w=h?$e(rr.interpolationFactor(h,t,m,y),0,1):0;r.kind==="camera"?l=$s.number(r.minSize,r.maxSize,w):n=w}return{uSizeT:n,uSize:l}},T.az=function(r,{uSize:t,uSizeT:n},{lowerSize:l,upperSize:h}){return r.kind==="source"?l/zs:r.kind==="composite"?$s.number(l/zs,h/zs,n):t},T.b=Us,T.b$=class extends fs{constructor(r,t){super(r,t),this.current=Ll}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let t=1;t<16;t++)if(r[t]!==this.current[t]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},T.b0=function(r){var t=new bt(3);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t},T.b1=function(r,t,n){return r[0]=t[0]-n[0],r[1]=t[1]-n[1],r[2]=t[2]-n[2],r},T.b2=function(r,t){var n=t[0],l=t[1],h=t[2],m=n*n+l*l+h*h;return m>0&&(m=1/Math.sqrt(m)),r[0]=t[0]*m,r[1]=t[1]*m,r[2]=t[2]*m,r},T.b3=ae,T.b4=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]},T.b5=function(r,t,n){return r[0]=t[0]*n[0],r[1]=t[1]*n[1],r[2]=t[2]*n[2],r[3]=t[3]*n[3],r},T.b6=Nt,T.b7=function(r,t,n){const l=t[0]*n[0]+t[1]*n[1]+t[2]*n[2];return l===0?null:(-(r[0]*n[0]+r[1]*n[1]+r[2]*n[2])-n[3])/l},T.b8=We,T.b9=function(r,t,n){return r[0]=t[0]*n,r[1]=t[1]*n,r[2]=t[2]*n,r[3]=t[3]*n,r},T.bA=jt,T.bB=function(r,t,n){var l=n[0],h=n[1],m=n[2],y=n[3],w=t[0],C=t[1],D=t[2],z=h*D-m*C,N=m*w-l*D,V=l*C-h*w;return r[0]=w+y*(z+=z)+h*(V+=V)-m*(N+=N),r[1]=C+y*N+m*z-l*V,r[2]=D+y*V+l*N-h*z,r},T.bC=function(r,t,n){const l=(h=[r[0],r[1],r[2],t[0],t[1],t[2],n[0],n[1],n[2]])[0]*((z=h[8])*(y=h[4])-(w=h[5])*(D=h[7]))+h[1]*(-z*(m=h[3])+w*(C=h[6]))+h[2]*(D*m-y*C);var h,m,y,w,C,D,z;if(l===0)return null;const N=ae([],[t[0],t[1],t[2]],[n[0],n[1],n[2]]),V=ae([],[n[0],n[1],n[2]],[r[0],r[1],r[2]]),U=ae([],[r[0],r[1],r[2]],[t[0],t[1],t[2]]),G=Ae([],N,-r[3]);return xe(G,G,Ae([],V,-t[3])),xe(G,G,Ae([],U,-n[3])),Ae(G,G,1/l),G},T.bD=ng,T.bE=function(){return new Float64Array(4)},T.bF=function(r,t,n,l){var h=[],m=[];return h[0]=t[0]-n[0],h[1]=t[1]-n[1],h[2]=t[2]-n[2],m[0]=h[0]*Math.cos(l)-h[1]*Math.sin(l),m[1]=h[0]*Math.sin(l)+h[1]*Math.cos(l),m[2]=h[2],r[0]=m[0]+n[0],r[1]=m[1]+n[1],r[2]=m[2]+n[2],r},T.bG=function(r,t,n,l){var h=[],m=[];return h[0]=t[0]-n[0],h[1]=t[1]-n[1],h[2]=t[2]-n[2],m[0]=h[0],m[1]=h[1]*Math.cos(l)-h[2]*Math.sin(l),m[2]=h[1]*Math.sin(l)+h[2]*Math.cos(l),r[0]=m[0]+n[0],r[1]=m[1]+n[1],r[2]=m[2]+n[2],r},T.bH=function(r,t,n,l){var h=[],m=[];return h[0]=t[0]-n[0],h[1]=t[1]-n[1],h[2]=t[2]-n[2],m[0]=h[2]*Math.sin(l)+h[0]*Math.cos(l),m[1]=h[1],m[2]=h[2]*Math.cos(l)-h[0]*Math.sin(l),r[0]=m[0]+n[0],r[1]=m[1]+n[1],r[2]=m[2]+n[2],r},T.bI=function(r,t,n){var l=Math.sin(n),h=Math.cos(n),m=t[0],y=t[1],w=t[2],C=t[3],D=t[8],z=t[9],N=t[10],V=t[11];return t!==r&&(r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=m*h-D*l,r[1]=y*h-z*l,r[2]=w*h-N*l,r[3]=C*h-V*l,r[8]=m*l+D*h,r[9]=y*l+z*h,r[10]=w*l+N*h,r[11]=C*l+V*h,r},T.bJ=function(r,t){const n=Rt(r,360),l=Rt(t,360),h=l-n,m=l>n?h-360:h+360;return Math.abs(h)<Math.abs(m)?h:m},T.bK=function(r){return r[0]=0,r[1]=0,r[2]=0,r},T.bL=function(r,t,n,l){const h=Math.sqrt(r*r+t*t),m=Math.sqrt(n*n+l*l);r/=h,t/=h,n/=m,l/=m;const y=Math.acos(r*n+t*l);return-t*n+r*l>0?y:-y},T.bM=function(r,t){const n=Rt(r,2*Math.PI),l=Rt(t,2*Math.PI);return Math.min(Math.abs(n-l),Math.abs(n-l+2*Math.PI),Math.abs(n-l-2*Math.PI))},T.bN=function(){const r={},t=ht.$version;for(const n in ht.$root){const l=ht.$root[n];if(l.required){let h=null;h=n==="version"?t:l.type==="array"?[]:{},h!=null&&(r[n]=h)}}return r},T.bO=ri,T.bP=Dh,T.bQ=function r(t,n){if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(let l=0;l<t.length;l++)if(!r(t[l],n[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&n!==null){if(typeof n!="object"||Object.keys(t).length!==Object.keys(n).length)return!1;for(const l in t)if(!r(t[l],n[l]))return!1;return!0}return t===n},T.bR=function(r){r=r.slice();const t=Object.create(null);for(let n=0;n<r.length;n++)t[r[n].id]=r[n];for(let n=0;n<r.length;n++)"ref"in r[n]&&(r[n]=Xt(r[n],t[r[n].ref]));return r},T.bS=function(r,t){if(r.type==="custom")return new zv(r,t);switch(r.type){case"background":return new eg(r,t);case"circle":return new Pm(r,t);case"color-relief":return new Tv(r,t);case"fill":return new Zh(r,t);case"fill-extrusion":return new Hh(r,t);case"heatmap":return new Rm(r,t);case"hillshade":return new Ol(r,t);case"line":return new wp(r,t);case"raster":return new Vo(r,t);case"symbol":return new ff(r,t)}},T.bT=r=>r.type==="raster",T.bU=Ci,T.bV=function(r,t){if(!r)return[{command:"setStyle",args:[t]}];let n=[];try{if(!Wt(r.version,t.version))return[{command:"setStyle",args:[t]}];Wt(r.center,t.center)||n.push({command:"setCenter",args:[t.center]}),Wt(r.state,t.state)||n.push({command:"setGlobalState",args:[t.state]}),Wt(r.centerAltitude,t.centerAltitude)||n.push({command:"setCenterAltitude",args:[t.centerAltitude]}),Wt(r.zoom,t.zoom)||n.push({command:"setZoom",args:[t.zoom]}),Wt(r.bearing,t.bearing)||n.push({command:"setBearing",args:[t.bearing]}),Wt(r.pitch,t.pitch)||n.push({command:"setPitch",args:[t.pitch]}),Wt(r.roll,t.roll)||n.push({command:"setRoll",args:[t.roll]}),Wt(r.sprite,t.sprite)||n.push({command:"setSprite",args:[t.sprite]}),Wt(r.glyphs,t.glyphs)||n.push({command:"setGlyphs",args:[t.glyphs]}),Wt(r.transition,t.transition)||n.push({command:"setTransition",args:[t.transition]}),Wt(r.light,t.light)||n.push({command:"setLight",args:[t.light]}),Wt(r.terrain,t.terrain)||n.push({command:"setTerrain",args:[t.terrain]}),Wt(r.sky,t.sky)||n.push({command:"setSky",args:[t.sky]}),Wt(r.projection,t.projection)||n.push({command:"setProjection",args:[t.projection]});const l={},h=[];(function(y,w,C,D){let z;for(z in w=w||{},y=y||{})Object.prototype.hasOwnProperty.call(y,z)&&(Object.prototype.hasOwnProperty.call(w,z)||Oe(z,C,D));for(z in w)Object.prototype.hasOwnProperty.call(w,z)&&(Object.prototype.hasOwnProperty.call(y,z)?Wt(y[z],w[z])||(y[z].type==="geojson"&&w[z].type==="geojson"&&mi(y,w,z)?te(C,{command:"setGeoJSONSourceData",args:[z,w[z].data]}):Qe(z,w,C,D)):Pe(z,w,C))})(r.sources,t.sources,h,l);const m=[];r.layers&&r.layers.forEach((y=>{"source"in y&&l[y.source]?n.push({command:"removeLayer",args:[y.id]}):m.push(y)})),n=n.concat(h),(function(y,w,C){w=w||[];const D=(y=y||[]).map(En),z=w.map(En),N=y.reduce(Un,{}),V=w.reduce(Un,{}),U=D.slice(),G=Object.create(null);let Y,tt,at,yt,ct;for(let dt=0,Pt=0;dt<D.length;dt++)Y=D[dt],Object.prototype.hasOwnProperty.call(V,Y)?Pt++:(te(C,{command:"removeLayer",args:[Y]}),U.splice(U.indexOf(Y,Pt),1));for(let dt=0,Pt=0;dt<z.length;dt++)Y=z[z.length-1-dt],U[U.length-1-dt]!==Y&&(Object.prototype.hasOwnProperty.call(N,Y)?(te(C,{command:"removeLayer",args:[Y]}),U.splice(U.lastIndexOf(Y,U.length-Pt),1)):Pt++,yt=U[U.length-dt],te(C,{command:"addLayer",args:[V[Y],yt]}),U.splice(U.length-dt,0,Y),G[Y]=!0);for(let dt=0;dt<z.length;dt++)if(Y=z[dt],tt=N[Y],at=V[Y],!G[Y]&&!Wt(tt,at))if(Wt(tt.source,at.source)&&Wt(tt["source-layer"],at["source-layer"])&&Wt(tt.type,at.type)){for(ct in ln(tt.layout,at.layout,C,Y,null,"setLayoutProperty"),ln(tt.paint,at.paint,C,Y,null,"setPaintProperty"),Wt(tt.filter,at.filter)||te(C,{command:"setFilter",args:[Y,at.filter]}),Wt(tt.minzoom,at.minzoom)&&Wt(tt.maxzoom,at.maxzoom)||te(C,{command:"setLayerZoomRange",args:[Y,at.minzoom,at.maxzoom]}),tt)Object.prototype.hasOwnProperty.call(tt,ct)&&ct!=="layout"&&ct!=="paint"&&ct!=="filter"&&ct!=="metadata"&&ct!=="minzoom"&&ct!=="maxzoom"&&(ct.indexOf("paint.")===0?ln(tt[ct],at[ct],C,Y,ct.slice(6),"setPaintProperty"):Wt(tt[ct],at[ct])||te(C,{command:"setLayerProperty",args:[Y,ct,at[ct]]}));for(ct in at)Object.prototype.hasOwnProperty.call(at,ct)&&!Object.prototype.hasOwnProperty.call(tt,ct)&&ct!=="layout"&&ct!=="paint"&&ct!=="filter"&&ct!=="metadata"&&ct!=="minzoom"&&ct!=="maxzoom"&&(ct.indexOf("paint.")===0?ln(tt[ct],at[ct],C,Y,ct.slice(6),"setPaintProperty"):Wt(tt[ct],at[ct])||te(C,{command:"setLayerProperty",args:[Y,ct,at[ct]]}))}else te(C,{command:"removeLayer",args:[Y]}),yt=U[U.lastIndexOf(Y)+1],te(C,{command:"addLayer",args:[at,yt]})})(m,t.layers,n)}catch(l){console.warn("Unable to compute style diff:",l),n=[{command:"setStyle",args:[t]}]}return n},T.bW=function(r){const t=[],n=r.id;return n===void 0&&t.push({message:`layers.${n}: missing required property "id"`}),r.render===void 0&&t.push({message:`layers.${n}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&t.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),t},T.bX=Gi,T.bY=br,T.bZ=class extends fs{constructor(r,t){super(r,t),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},T.b_=Na,T.ba=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]},T.bb=Vy,T.bc=$u,T.bd=function(r,t,n,l,h){var m=1/Math.tan(t/2);if(r[0]=m/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=m,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,h!=null&&h!==1/0){var y=1/(l-h);r[10]=(h+l)*y,r[14]=2*h*l*y}else r[10]=-1,r[14]=-2*l;return r},T.be=function(r){var t=new bt(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},T.bf=function(r,t,n){var l=Math.sin(n),h=Math.cos(n),m=t[0],y=t[1],w=t[2],C=t[3],D=t[4],z=t[5],N=t[6],V=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=m*h+D*l,r[1]=y*h+z*l,r[2]=w*h+N*l,r[3]=C*h+V*l,r[4]=D*h-m*l,r[5]=z*h-y*l,r[6]=N*h-w*l,r[7]=V*h-C*l,r},T.bg=function(r,t,n){var l=Math.sin(n),h=Math.cos(n),m=t[4],y=t[5],w=t[6],C=t[7],D=t[8],z=t[9],N=t[10],V=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=m*h+D*l,r[5]=y*h+z*l,r[6]=w*h+N*l,r[7]=C*h+V*l,r[8]=D*h-m*l,r[9]=z*h-y*l,r[10]=N*h-w*l,r[11]=V*h-C*l,r},T.bh=function(){const r=new Float32Array(16);return Ot(r),r},T.bi=function(){const r=new Float64Array(16);return Ot(r),r},T.bj=function(){return new Float64Array(16)},T.bk=function(r,t,n){const l=new Float64Array(4);return jt(l,r,t-90,n),l},T.bl=function(r,t,n,l){var h,m,y,w,C,D=t[0],z=t[1],N=t[2],V=t[3],U=n[0],G=n[1],Y=n[2],tt=n[3];return(m=D*U+z*G+N*Y+V*tt)<0&&(m=-m,U=-U,G=-G,Y=-Y,tt=-tt),1-m>Et?(h=Math.acos(m),y=Math.sin(h),w=Math.sin((1-l)*h)/y,C=Math.sin(l*h)/y):(w=1-l,C=l),r[0]=w*D+C*U,r[1]=w*z+C*G,r[2]=w*N+C*Y,r[3]=w*V+C*tt,r},T.bm=function(r){const t=new Float64Array(9);var n,l,h,m,y,w,C,D,z,N,V,U,G,Y,tt,at,yt,ct;N=(h=(l=r)[0])*(C=h+h),V=(m=l[1])*C,G=(y=l[2])*C,Y=y*(D=m+m),at=(w=l[3])*C,yt=w*D,ct=w*(z=y+y),(n=t)[0]=1-(U=m*D)-(tt=y*z),n[3]=V-ct,n[6]=G+yt,n[1]=V+ct,n[4]=1-N-tt,n[7]=Y-at,n[2]=G-yt,n[5]=Y+at,n[8]=1-N-U;const dt=Hr(-Math.asin($e(t[2],-1,1)));let Pt,Dt;return Math.hypot(t[5],t[8])<.001?(Pt=0,Dt=-Hr(Math.atan2(t[3],t[4]))):(Pt=Hr(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),Dt=Hr(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:Pt,pitch:dt+90,bearing:Dt}},T.bn=function(r,t){return r.roll==t.roll&&r.pitch==t.pitch&&r.bearing==t.bearing},T.bo=hn,T.bp=ta,T.bq=gr,T.br=ps,T.bs=qh,T.bt=se,T.bu=be,T.bv=ir,T.bw=function(r,t,n,l,h){return se(l,h,$e((r-t)/(n-t),0,1))},T.bx=Rt,T.by=function(){return new Float64Array(3)},T.bz=function(r,t,n,l){return r[0]=t[0]+n[0]*l,r[1]=t[1]+n[1]*l,r[2]=t[2]+n[2]*l,r},T.c=rc,T.c$=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},T.c0=is,T.c1=class extends fs{constructor(r,t){super(r,t),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},T.c2=class extends fs{constructor(r,t){super(r,t),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},T.c3=Lt,T.c4=function(r,t){var n=Math.sin(t),l=Math.cos(t);return r[0]=l,r[1]=n,r[2]=0,r[3]=-n,r[4]=l,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},T.c5=function(r,t,n){var l=t[0],h=t[1],m=t[2];return r[0]=l*n[0]+h*n[3]+m*n[6],r[1]=l*n[1]+h*n[4]+m*n[7],r[2]=l*n[2]+h*n[5]+m*n[8],r},T.c6=function(r,t,n,l,h,m,y){var w=1/(t-n),C=1/(l-h),D=1/(m-y);return r[0]=-2*w,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*C,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*D,r[11]=0,r[12]=(t+n)*w,r[13]=(h+l)*C,r[14]=(y+m)*D,r[15]=1,r},T.c7=class extends fs{constructor(r,t){super(r,t),this.current=new Array}set(r){if(r!=this.current){this.current=r;const t=new Float32Array(4*r.length);for(let n=0;n<r.length;n++)t[4*n]=r[n].r,t[4*n+1]=r[n].g,t[4*n+2]=r[n].b,t[4*n+3]=r[n].a;this.gl.uniform4fv(this.location,t)}}},T.c8=class extends fs{constructor(r,t){super(r,t),this.current=new Array}set(r){if(r!=this.current){this.current=r;const t=new Float32Array(r);this.gl.uniform1fv(this.location,t)}}},T.c9=class extends Pu{},T.cA=function(r){return nc[r]||ic[r]},T.cB=function(r,t,n){var l=t[0],h=t[1];return r[0]=n[0]*l+n[4]*h+n[12],r[1]=n[1]*l+n[5]*h+n[13],r},T.cC=function(r,t){const{x:n,y:l}=yf.fromLngLat(t);return!(r<0||r>25||l<0||l>=1||n<0||n>=1)},T.cD=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},T.cE=class extends hi{},T.cF=Gc,T.cH=function(r){return r.message===pa},T.cI=Ir,T.cJ=function(r,t){Ga.REGISTERED_PROTOCOLS[r]=t},T.cK=function(r){delete Ga.REGISTERED_PROTOCOLS[r]},T.cL=function(r,t){const n={};for(let h=0;h<r.length;h++){const m=t&&t[r[h].id]||vn(r[h]);t&&(t[r[h].id]=m);let y=n[m];y||(y=n[m]=[]),y.push(r[h])}const l=[];for(const h in n)l.push(n[h]);return l},T.cM=Me,T.cN=Uy,T.cO=Zl,T.cP=Wm,T.cQ=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=we/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const t=r.bucket.layers[0],n=t.layout,l=t._unevaluatedLayout._values,h={layoutIconSize:l["icon-size"].possiblyEvaluate(new kn(r.bucket.zoom+1),r.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new kn(r.bucket.zoom+1),r.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new kn(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:D,maxZoom:z}=r.bucket.textSizeData;h.compositeTextSizes=[l["text-size"].possiblyEvaluate(new kn(D),r.canonical),l["text-size"].possiblyEvaluate(new kn(z),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:D,maxZoom:z}=r.bucket.iconSizeData;h.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new kn(D),r.canonical),l["icon-size"].possiblyEvaluate(new kn(z),r.canonical)]}const m=n.get("text-line-height")*Ki,y=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",w=n.get("text-keep-upright"),C=n.get("text-size");for(const D of r.bucket.features){const z=n.get("text-font").evaluate(D,{},r.canonical).join(","),N=C.evaluate(D,{},r.canonical),V=h.layoutTextSize.evaluate(D,{},r.canonical),U=h.layoutIconSize.evaluate(D,{},r.canonical),G={horizontal:{},vertical:void 0},Y=D.text;let tt,at=[0,0];if(Y){const dt=Y.toString(),Pt=n.get("text-letter-spacing").evaluate(D,{},r.canonical)*Ki,Dt=io(dt)?Pt:0,Zt=n.get("text-anchor").evaluate(D,{},r.canonical),ue=Mt(t,D,r.canonical);if(!ue){const _e=n.get("text-radial-offset").evaluate(D,{},r.canonical);at=_e?ot(Zt,[_e*Ki,X]):n.get("text-offset").evaluate(D,{},r.canonical).map((ve=>ve*Ki))}let ie=y?"center":n.get("text-justify").evaluate(D,{},r.canonical);const de=n.get("symbol-placement")==="point"?n.get("text-max-width").evaluate(D,{},r.canonical)*Ki:1/0,Se=()=>{r.bucket.allowVerticalPlacement&&xc(dt)&&(G.vertical=Gu(Y,r.glyphMap,r.glyphPositions,r.imagePositions,z,de,m,Zt,"left",Dt,at,T.ay.vertical,!0,V,N))};if(!y&&ue){const _e=new Set;if(ie==="auto")for(let re=0;re<ue.values.length;re+=2)_e.add(Yt(ue.values[re]));else _e.add(ie);let ve=!1;for(const re of _e)if(!G.horizontal[re])if(ve)G.horizontal[re]=G.horizontal[0];else{const je=Gu(Y,r.glyphMap,r.glyphPositions,r.imagePositions,z,de,m,"center",re,Dt,at,T.ay.horizontal,!1,V,N);je&&(G.horizontal[re]=je,ve=je.positionedLines.length===1)}Se()}else{ie==="auto"&&(ie=Yt(Zt));const _e=Gu(Y,r.glyphMap,r.glyphPositions,r.imagePositions,z,de,m,Zt,ie,Dt,at,T.ay.horizontal,!1,V,N);_e&&(G.horizontal[ie]=_e),Se(),xc(dt)&&y&&w&&(G.vertical=Gu(Y,r.glyphMap,r.glyphPositions,r.imagePositions,z,de,m,Zt,ie,Dt,at,T.ay.vertical,!1,V,N))}}let yt=!1;if(D.icon&&D.icon.name){const dt=r.imageMap[D.icon.name];dt&&(tt=Rv(r.imagePositions[D.icon.name],n.get("icon-offset").evaluate(D,{},r.canonical),n.get("icon-anchor").evaluate(D,{},r.canonical)),yt=!!dt.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=yt:r.bucket.sdfIcons!==yt&&Nn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(dt.pixelRatio!==r.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const ct=Jt(G.horizontal)||G.vertical;r.bucket.iconsInText=!!ct&&ct.iconsInText,(ct||tt)&&le(r.bucket,D,G,tt,r.imageMap,h,V,U,at,yt,r.canonical,r.subdivisionGranularity)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},T.cR=rf,T.cS=ni,T.cT=ju,T.cU=Fm,T.cV=Sp,T.cW=ku,T.cX=function(r,t,n,l,h,m){let y=Qy(r,t,n,h,0);return y=Qy(y,t,l,m,1),y},T.cY=class{constructor(r){this.maxEntries=r,this.map=new Map}get(r){const t=this.map.get(r);return t!==void 0&&(this.map.delete(r),this.map.set(r,t)),t}set(r,t){if(this.map.has(r))this.map.delete(r);else if(this.map.size>=this.maxEntries){const n=this.map.keys().next().value;this.map.delete(n)}this.map.set(r,t)}clear(){this.map.clear()}},T.cZ=jm,T.c_=Vp,T.ca=Um,T.cb=class extends Sc{},T.cc=mo,T.cd=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},T.ce=Dm,T.cf=function(r,t,n){var l=t[0],h=t[1],m=t[2],y=n[3]*l+n[7]*h+n[11]*m+n[15];return r[0]=(n[0]*l+n[4]*h+n[8]*m+n[12])/(y=y||1),r[1]=(n[1]*l+n[5]*h+n[9]*m+n[13])/y,r[2]=(n[2]*l+n[6]*h+n[10]*m+n[14])/y,r},T.cg=class extends Tc{},T.ch=class extends d{},T.ci=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]&&r[9]===t[9]&&r[10]===t[10]&&r[11]===t[11]&&r[12]===t[12]&&r[13]===t[13]&&r[14]===t[14]&&r[15]===t[15]},T.cj=function(r,t){var n=r[0],l=r[1],h=r[2],m=r[3],y=r[4],w=r[5],C=r[6],D=r[7],z=r[8],N=r[9],V=r[10],U=r[11],G=r[12],Y=r[13],tt=r[14],at=r[15],yt=t[0],ct=t[1],dt=t[2],Pt=t[3],Dt=t[4],Zt=t[5],ue=t[6],ie=t[7],de=t[8],Se=t[9],_e=t[10],ve=t[11],re=t[12],je=t[13],Be=t[14],qe=t[15];return Math.abs(n-yt)<=Et*Math.max(1,Math.abs(n),Math.abs(yt))&&Math.abs(l-ct)<=Et*Math.max(1,Math.abs(l),Math.abs(ct))&&Math.abs(h-dt)<=Et*Math.max(1,Math.abs(h),Math.abs(dt))&&Math.abs(m-Pt)<=Et*Math.max(1,Math.abs(m),Math.abs(Pt))&&Math.abs(y-Dt)<=Et*Math.max(1,Math.abs(y),Math.abs(Dt))&&Math.abs(w-Zt)<=Et*Math.max(1,Math.abs(w),Math.abs(Zt))&&Math.abs(C-ue)<=Et*Math.max(1,Math.abs(C),Math.abs(ue))&&Math.abs(D-ie)<=Et*Math.max(1,Math.abs(D),Math.abs(ie))&&Math.abs(z-de)<=Et*Math.max(1,Math.abs(z),Math.abs(de))&&Math.abs(N-Se)<=Et*Math.max(1,Math.abs(N),Math.abs(Se))&&Math.abs(V-_e)<=Et*Math.max(1,Math.abs(V),Math.abs(_e))&&Math.abs(U-ve)<=Et*Math.max(1,Math.abs(U),Math.abs(ve))&&Math.abs(G-re)<=Et*Math.max(1,Math.abs(G),Math.abs(re))&&Math.abs(Y-je)<=Et*Math.max(1,Math.abs(Y),Math.abs(je))&&Math.abs(tt-Be)<=Et*Math.max(1,Math.abs(tt),Math.abs(Be))&&Math.abs(at-qe)<=Et*Math.max(1,Math.abs(at),Math.abs(qe))},T.ck=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},T.cl=r=>r.type==="symbol",T.cm=r=>r.type==="circle",T.cn=r=>r.type==="heatmap",T.co=r=>r.type==="line",T.cp=r=>r.type==="fill",T.cq=r=>r.type==="fill-extrusion",T.cr=r=>r.type==="hillshade",T.cs=r=>r.type==="color-relief",T.ct=r=>r.type==="background",T.cu=r=>r.type==="custom",T.cv=Te,T.cw=function(r,t,n){const l=Gt(t.x-n.x,t.y-n.y),h=Gt(r.x-n.x,r.y-n.y);var m,y;return Hr(Math.atan2(l[0]*h[1]-l[1]*h[0],(m=l)[0]*(y=h)[0]+m[1]*y[1]))},T.cx=Ze,T.cy=function(r,t){return ic[t]&&(r instanceof MouseEvent||r instanceof WheelEvent)},T.cz=function(r,t){return nc[t]&&"touches"in r},T.d=K,T.d0=function(r,t,n,l,h){return u(this,void 0,void 0,(function*(){if(mt())try{return yield To(r,t,n,l,h)}catch{}return(function(m,y,w,C,D){const z=m.width,N=m.height;da&&fa||(da=new OffscreenCanvas(z,N),fa=da.getContext("2d",{willReadFrequently:!0})),da.width=z,da.height=N,fa.drawImage(m,0,0,z,N);const V=fa.getImageData(y,w,C,D);return fa.clearRect(0,0,z,N),V.data})(r,t,n,l,h)}))},T.d1=Vh,T.d2=k,T.d3=gc,T.d4=La,T.e=yn,T.f=r=>u(void 0,void 0,void 0,(function*(){if(r.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(r)],{type:"image/png"});try{return createImageBitmap(t)}catch(n){throw new Error(`Could not load image because of ${n.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),T.g=sc,T.h=r=>new Promise(((t,n)=>{const l=new Image;l.onload=()=>{t(l),URL.revokeObjectURL(l.src),l.onload=null,window.requestAnimationFrame((()=>{l.src=Ss}))},l.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(r)],{type:"image/png"});l.src=r.byteLength?URL.createObjectURL(h):Ss})),T.i=Ts,T.j=(r,t)=>Ct(yn(r,{type:"json"}),t),T.k=wt,T.l=vt,T.m=Ct,T.n=(r,t)=>Ct(yn(r,{type:"arrayBuffer"}),t),T.o=function(r){return new Sp(r).readFields(Cp,[])},T.p=Ym,T.q=function(r){return/[\u02EA\u02EB\u1100-\u11FF\u2E80-\u2FDF\u3000-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(r))},T.r=jh,T.s=So,T.t=ti,T.u=ht,T.v=Ra,T.w=Nn,T.x=Ih,T.y=Cm,T.z=Ps})),S("worker",["./shared"],(function(T){class u{constructor(K,et){this.keyCache={},K&&this.replace(K,et)}replace(K,et){this._layerConfigs={},this._layers={},this.update(K,[],et)}update(K,et,st){for(const wt of K){this._layerConfigs[wt.id]=wt;const Ft=this._layers[wt.id]=T.bS(wt,st);Ft._featureFilter=T.aj(Ft.filter,st),this.keyCache[wt.id]&&delete this.keyCache[wt.id]}for(const wt of et)delete this.keyCache[wt],delete this._layerConfigs[wt],delete this._layers[wt];this.familiesBySource={};const vt=T.cL(Object.values(this._layerConfigs),this.keyCache);for(const wt of vt){const Ft=wt.map((Pe=>this._layers[Pe.id])),ht=Ft[0];if(ht.visibility==="none")continue;const It=ht.source||"";let Xt=this.familiesBySource[It];Xt||(Xt=this.familiesBySource[It]={});const Wt=ht.sourceLayer||T.a9;let te=Xt[Wt];te||(te=Xt[Wt]=[]),te.push(Ft)}}}class L{constructor(K){const et={},st=[];for(const ht in K){const It=K[ht],Xt=et[ht]={};for(const Wt in It){const te=It[+Wt];if(!te||te.bitmap.width===0||te.bitmap.height===0)continue;const Pe={x:0,y:0,w:te.bitmap.width+2,h:te.bitmap.height+2};st.push(Pe),Xt[Wt]={rect:Pe,metrics:te.metrics}}}const{w:vt,h:wt}=T.p(st),Ft=new T.r({width:vt||1,height:wt||1});for(const ht in K){const It=K[ht];for(const Xt in It){const Wt=It[+Xt];if(!Wt||Wt.bitmap.width===0||Wt.bitmap.height===0)continue;const te=et[ht][Xt].rect;T.r.copy(Wt.bitmap,Ft,{x:0,y:0},{x:te.x+1,y:te.y+1},Wt.bitmap)}}this.image=Ft,this.positions=et}}T.cM("GlyphAtlas",L);class k{constructor(K){this.tileID=new T.a1(K.tileID.overscaledZ,K.tileID.wrap,K.tileID.canonical.z,K.tileID.canonical.x,K.tileID.canonical.y),this.uid=K.uid,this.zoom=K.zoom,this.pixelRatio=K.pixelRatio,this.tileSize=K.tileSize,this.source=K.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=K.showCollisionBoxes,this.collectResourceTiming=!!K.collectResourceTiming,this.returnDependencies=!!K.returnDependencies,this.promoteId=K.promoteId,this.inFlightDependencies=[]}parse(K,et,st,vt,wt){return T._(this,void 0,void 0,(function*(){this.status="parsing",this.data=K,this.collisionBoxArray=new T.ah;const Ft=new T.cN(Object.keys(K.layers).sort()),ht=new T.cO(this.tileID,this.promoteId);ht.bucketLayerIDs=[];const It={},Xt={featureIndex:ht,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:st,subdivisionGranularity:wt},Wt=et.familiesBySource[this.source];for(const Ce in Wt){const Ne=K.layers[Ce];if(!Ne)continue;Ne.version===1&&T.w(`Vector tile source "${this.source}" layer "${Ce}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const wr=Ft.encode(Ce),ll=[];for(let nr=0;nr<Ne.length;nr++){const Ye=Ne.feature(nr),ls=ht.getId(Ye,Ce);ll.push({feature:Ye,id:ls,index:nr,sourceLayerIndex:wr})}for(const nr of Wt[Ce]){const Ye=nr[0];Ye.source!==this.source&&T.w(`layer.source = ${Ye.source} does not equal this.source = ${this.source}`),Ye.isHidden(this.zoom,!0)||(B(nr,this.zoom,st),(It[Ye.id]=Ye.createBucket({index:ht.bucketLayerIDs.length,layers:nr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:wr,sourceID:this.source})).populate(ll,Xt,this.tileID.canonical),ht.bucketLayerIDs.push(nr.map((ls=>ls.id))))}}const te=T.bX(Xt.glyphDependencies,(Ce=>Object.keys(Ce).map(Number)));this.inFlightDependencies.forEach((Ce=>Ce?.abort())),this.inFlightDependencies=[];let Pe=Promise.resolve({});if(Object.keys(te).length){const Ce=new AbortController;this.inFlightDependencies.push(Ce),Pe=vt.sendAsync({type:"GG",data:{stacks:te,source:this.source,tileID:this.tileID,type:"glyphs"}},Ce)}const Oe=Object.keys(Xt.iconDependencies);let Qe=Promise.resolve({});if(Oe.length){const Ce=new AbortController;this.inFlightDependencies.push(Ce),Qe=vt.sendAsync({type:"GI",data:{icons:Oe,source:this.source,tileID:this.tileID,type:"icons"}},Ce)}const mi=Object.keys(Xt.patternDependencies);let ln=Promise.resolve({});if(mi.length){const Ce=new AbortController;this.inFlightDependencies.push(Ce),ln=vt.sendAsync({type:"GI",data:{icons:mi,source:this.source,tileID:this.tileID,type:"patterns"}},Ce)}const En=Xt.dashDependencies;let Un=Promise.resolve({});if(Object.keys(En).length){const Ce=new AbortController;this.inFlightDependencies.push(Ce),Un=vt.sendAsync({type:"GDA",data:{dashes:En}},Ce)}const[pe,Gn,qn,Ai]=yield Promise.all([Pe,Qe,ln,Un]),Cn=new L(pe),ce=new T.cP(Gn,qn);for(const Ce in It){const Ne=It[Ce];Ne instanceof T.ai?(B(Ne.layers,this.zoom,st),T.cQ({bucket:Ne,glyphMap:pe,glyphPositions:Cn.positions,imageMap:Gn,imagePositions:ce.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Xt.subdivisionGranularity})):Ne.hasDependencies&&(Ne instanceof T.cR||Ne instanceof T.cS||Ne instanceof T.cT)&&(B(Ne.layers,this.zoom,st),Ne.addFeatures(Xt,this.tileID.canonical,ce.patternPositions,Ai))}return this.status="done",{buckets:Object.values(It).filter((Ce=>!Ce.isEmpty())),featureIndex:ht,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Cn.image,imageAtlas:ce,dashPositions:Ai,glyphMap:this.returnDependencies?pe:null,iconMap:this.returnDependencies?Gn:null,glyphPositions:this.returnDependencies?Cn.positions:null}}))}}function B(Ct,K,et){const st=new T.H(K);for(const vt of Ct)vt.recalculate(st,et)}class H extends T.cW{constructor(K,et){super(new T.cV,0,et,[],[]),this.feature=K,this.type=K.type,this.properties=K.tags?K.tags:{},"id"in K&&(typeof K.id=="string"?this.id=parseInt(K.id,10):typeof K.id!="number"||isNaN(K.id)||(this.id=K.id))}loadGeometry(){const K=[],et=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const st of et){const vt=[];for(const wt of st)vt.push(new T.P(wt[0],wt[1]));K.push(vt)}return K}}class W extends T.cU{constructor(K,et){super(new T.cV),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=et?et.version:1,this.extent=et?et.extent:4096,this.length=K.length,this.features=K}feature(K){return new H(this.features[K],this.extent)}}function it(Ct,K){K.writeVarintField(15,Ct.version||1),K.writeStringField(1,Ct.name||""),K.writeVarintField(5,Ct.extent||4096);const et={keys:[],values:[],keycache:{},valuecache:{}};for(let wt=0;wt<Ct.length;wt++)et.feature=Ct.feature(wt),K.writeMessage(2,pt,et);const st=et.keys;for(const wt of st)K.writeStringField(3,wt);const vt=et.values;for(const wt of vt)K.writeMessage(4,bt,wt)}function pt(Ct,K){if(!Ct.feature)return;const et=Ct.feature;et.id!==void 0&&K.writeVarintField(1,et.id),K.writeMessage(2,rt,Ct),K.writeVarintField(3,et.type),K.writeMessage(4,Et,et)}function rt(Ct,K){for(const et in Ct.feature?.properties){let st=Ct.feature.properties[et],vt=Ct.keycache[et];if(st===null)continue;vt===void 0&&(Ct.keys.push(et),vt=Ct.keys.length-1,Ct.keycache[et]=vt),K.writeVarint(vt),typeof st!="string"&&typeof st!="boolean"&&typeof st!="number"&&(st=JSON.stringify(st));const wt=typeof st+":"+st;let Ft=Ct.valuecache[wt];Ft===void 0&&(Ct.values.push(st),Ft=Ct.values.length-1,Ct.valuecache[wt]=Ft),K.writeVarint(Ft)}}function J(Ct,K){return(K<<3)+(7&Ct)}function mt(Ct){return Ct<<1^Ct>>31}function Et(Ct,K){const et=Ct.loadGeometry(),st=Ct.type;let vt=0,wt=0;for(const Ft of et){let ht=1;st===1&&(ht=Ft.length),K.writeVarint(J(1,ht));const It=st===3?Ft.length-1:Ft.length;for(let Xt=0;Xt<It;Xt++){Xt===1&&st!==1&&K.writeVarint(J(2,It-1));const Wt=Ft[Xt].x-vt,te=Ft[Xt].y-wt;K.writeVarint(mt(Wt)),K.writeVarint(mt(te)),vt+=Wt,wt+=te}Ct.type===3&&K.writeVarint(J(7,1))}}function bt(Ct,K){const et=typeof Ct;et==="string"?K.writeStringField(1,Ct):et==="boolean"?K.writeBooleanField(7,Ct):et==="number"&&(Ct%1!=0?K.writeDoubleField(3,Ct):Ct<0?K.writeSVarintField(6,Ct):K.writeVarintField(5,Ct))}class Lt extends T.cW{constructor(K,et,st,vt,wt){super(new T.cV,0,wt,[],[]),this.type=K,this.properties=st||{},this.extent=wt,this.pointsArray=et,this.id=vt}loadGeometry(){return this.pointsArray.map((K=>K.map((et=>new T.P(et.x,et.y)))))}}class Ot extends T.cU{constructor(K,et,st){super(new T.cV),this.version=2,this._myFeatures=K,this.name=et,this.length=K.length,this.extent=st}feature(K){return this._myFeatures[K]}}class ee{constructor(){this.layers={}}addLayer(K){this.layers[K.name]=K}}function Nt(Ct){let K=(function(et){const st=new T.cV;return(function(vt,wt){for(const Ft in vt.layers)wt.writeMessage(3,it,vt.layers[Ft])})(et,st),st.finish()})(Ct);return K.byteOffset===0&&K.byteLength===K.buffer.byteLength||(K=new Uint8Array(K)),{vectorTile:Ct,rawData:K.buffer}}function Kt(Ct,K,et){const{extent:st}=Ct,vt=Math.pow(2,et.z-K.z),wt=(et.x-K.x*vt)*st,Ft=(et.y-K.y*vt)*st,ht=[];for(let It=0;It<Ct.length;It++){const Xt=Ct.feature(It);let Wt=Xt.loadGeometry();for(const Pe of Wt)for(const Oe of Pe)Oe.x=Oe.x*vt-wt,Oe.y=Oe.y*vt-Ft;const te=128;Wt=T.cX(Wt,Xt.type,-te,-te,st+te,st+te),Wt.length!==0&&ht.push(new Lt(Xt.type,Wt,Xt.properties,Xt.id,st))}return new Ot(ht,Ct.name,st)}class xe{constructor(K,et,st){this.actor=K,this.layerIndex=et,this.availableImages=st,this.fetching={},this.loading={},this.loaded={},this.overzoomedTileResultCache=new T.cY(1e3)}loadVectorTile(K,et){return T._(this,void 0,void 0,(function*(){const st=yield T.n(K.request,et);try{return{vectorTile:K.encoding!=="mlt"?new T.cZ(new T.cV(st.data)):new T.c_(st.data),rawData:st.data,cacheControl:st.cacheControl,expires:st.expires}}catch(vt){const wt=new Uint8Array(st.data);let Ft=`Unable to parse the tile at ${K.request.url}, `;throw Ft+=wt[0]===31&&wt[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${vt.message}`,new Error(Ft)}}))}loadTile(K){return T._(this,void 0,void 0,(function*(){const{uid:et,overzoomParameters:st}=K;st&&(K.request=st.overzoomRequest);const vt=!!(K&&K.request&&K.request.collectResourceTiming)&&new T.c$(K.request),wt=new k(K);this.loading[et]=wt;const Ft=new AbortController;wt.abort=Ft;try{const ht=yield this.loadVectorTile(K,Ft);if(delete this.loading[et],!ht)return null;if(st){const Pe=this._getOverzoomTile(K,ht.vectorTile);ht.rawData=Pe.rawData,ht.vectorTile=Pe.vectorTile}const It=ht.rawData,Xt={};ht.expires&&(Xt.expires=ht.expires),ht.cacheControl&&(Xt.cacheControl=ht.cacheControl);const Wt={};if(vt){const Pe=vt.finish();Pe&&(Wt.resourceTiming=JSON.parse(JSON.stringify(Pe)))}wt.vectorTile=ht.vectorTile;const te=wt.parse(ht.vectorTile,this.layerIndex,this.availableImages,this.actor,K.subdivisionGranularity);this.loaded[et]=wt,this.fetching[et]={rawTileData:It,cacheControl:Xt,resourceTiming:Wt};try{const Pe=yield te;return T.e({rawTileData:It.slice(0),encoding:K.encoding},Pe,Xt,Wt)}finally{delete this.fetching[et]}}catch(ht){throw delete this.loading[et],wt.status="done",this.loaded[et]=wt,ht}}))}_getOverzoomTile(K,et){const{tileID:st,source:vt,overzoomParameters:wt}=K,{maxZoomTileID:Ft}=wt,ht=`${Ft.key}_${st.key}`,It=this.overzoomedTileResultCache.get(ht);if(It)return It;const Xt=new ee,Wt=this.layerIndex.familiesBySource[vt];for(const Pe in Wt){const Oe=et.layers[Pe];if(!Oe)continue;const Qe=Kt(Oe,Ft,st.canonical);Qe.length>0&&Xt.addLayer(Qe)}const te=Nt(Xt);return this.overzoomedTileResultCache.set(ht,te),te}reloadTile(K){return T._(this,void 0,void 0,(function*(){const et=K.uid;if(!this.loaded||!this.loaded[et])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const st=this.loaded[et];if(st.showCollisionBoxes=K.showCollisionBoxes,st.status==="parsing"){const vt=yield st.parse(st.vectorTile,this.layerIndex,this.availableImages,this.actor,K.subdivisionGranularity);let wt;if(this.fetching[et]){const{rawTileData:Ft,cacheControl:ht,resourceTiming:It}=this.fetching[et];delete this.fetching[et],wt=T.e({rawTileData:Ft.slice(0),encoding:K.encoding},vt,ht,It)}else wt=vt;return wt}if(st.status==="done"&&st.vectorTile)return st.parse(st.vectorTile,this.layerIndex,this.availableImages,this.actor,K.subdivisionGranularity)}))}abortTile(K){return T._(this,void 0,void 0,(function*(){const et=this.loading,st=K.uid;et&&et[st]&&et[st].abort&&(et[st].abort.abort(),delete et[st])}))}removeTile(K){return T._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[K.uid]&&delete this.loaded[K.uid]}))}}class Ae{constructor(){this.loaded={}}loadTile(K){return T._(this,void 0,void 0,(function*(){const{uid:et,encoding:st,rawImageData:vt,redFactor:wt,greenFactor:Ft,blueFactor:ht,baseShift:It}=K,Xt=vt.width+2,Wt=vt.height+2,te=T.b(vt)?new T.R({width:Xt,height:Wt},yield T.d0(vt,-1,-1,Xt,Wt)):vt,Pe=new T.d1(et,te,st,wt,Ft,ht,It);return this.loaded=this.loaded||{},this.loaded[et]=Pe,Pe}))}removeTile(K){const et=this.loaded,st=K.uid;et&&et[st]&&delete et[st]}}var ae,ze,We=(function(){if(ze)return ae;function Ct(et,st){if(et.length!==0){K(et[0],st);for(var vt=1;vt<et.length;vt++)K(et[vt],!st)}}function K(et,st){for(var vt=0,wt=0,Ft=0,ht=et.length,It=ht-1;Ft<ht;It=Ft++){var Xt=(et[Ft][0]-et[It][0])*(et[It][1]+et[Ft][1]),Wt=vt+Xt;wt+=Math.abs(vt)>=Math.abs(Xt)?vt-Wt+Xt:Xt-Wt+vt,vt=Wt}vt+wt>=0!=!!st&&et.reverse()}return ze=1,ae=function et(st,vt){var wt,Ft=st&&st.type;if(Ft==="FeatureCollection")for(wt=0;wt<st.features.length;wt++)et(st.features[wt],vt);else if(Ft==="GeometryCollection")for(wt=0;wt<st.geometries.length;wt++)et(st.geometries[wt],vt);else if(Ft==="Feature")et(st.geometry,vt);else if(Ft==="Polygon")Ct(st.coordinates,vt);else if(Ft==="MultiPolygon")for(wt=0;wt<st.coordinates.length;wt++)Ct(st.coordinates[wt],vt);return st}})(),Ee=T.d2(We);const me={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ct=>Ct},jt=Math.fround||(Qt=new Float32Array(1),Ct=>(Qt[0]=+Ct,Qt[0]));var Qt;class Gt{constructor(K){this.options=Object.assign(Object.create(me),K),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(K){const{log:et,minZoom:st,maxZoom:vt}=this.options;et&&console.time("total time");const wt=`prepare ${K.length} points`;et&&console.time(wt),this.points=K;const Ft=[];for(let It=0;It<K.length;It++){const Xt=K[It];if(!Xt.geometry)continue;const[Wt,te]=Xt.geometry.coordinates,Pe=jt(Rt(Wt)),Oe=jt(se(te));Ft.push(Pe,Oe,1/0,It,-1,1),this.options.reduce&&Ft.push(0)}let ht=this.trees[vt+1]=this._createTree(Ft);et&&console.timeEnd(wt);for(let It=vt;It>=st;It--){const Xt=+Date.now();ht=this.trees[It]=this._createTree(this._cluster(ht,It)),et&&console.log("z%d: %d clusters in %dms",It,ht.numItems,+Date.now()-Xt)}return et&&console.timeEnd("total time"),this}getClusters(K,et){let st=((K[0]+180)%360+360)%360-180;const vt=Math.max(-90,Math.min(90,K[1]));let wt=K[2]===180?180:((K[2]+180)%360+360)%360-180;const Ft=Math.max(-90,Math.min(90,K[3]));if(K[2]-K[0]>=360)st=-180,wt=180;else if(st>wt){const te=this.getClusters([st,vt,180,Ft],et),Pe=this.getClusters([-180,vt,wt,Ft],et);return te.concat(Pe)}const ht=this.trees[this._limitZoom(et)],It=ht.range(Rt(st),se(Ft),Rt(wt),se(vt)),Xt=ht.data,Wt=[];for(const te of It){const Pe=this.stride*te;Wt.push(Xt[Pe+5]>1?we(Xt,Pe,this.clusterProps):this.points[Xt[Pe+3]])}return Wt}getChildren(K){const et=this._getOriginId(K),st=this._getOriginZoom(K),vt="No cluster with the specified id.",wt=this.trees[st];if(!wt)throw new Error(vt);const Ft=wt.data;if(et*this.stride>=Ft.length)throw new Error(vt);const ht=this.options.radius/(this.options.extent*Math.pow(2,st-1)),It=wt.within(Ft[et*this.stride],Ft[et*this.stride+1],ht),Xt=[];for(const Wt of It){const te=Wt*this.stride;Ft[te+4]===K&&Xt.push(Ft[te+5]>1?we(Ft,te,this.clusterProps):this.points[Ft[te+3]])}if(Xt.length===0)throw new Error(vt);return Xt}getLeaves(K,et,st){const vt=[];return this._appendLeaves(vt,K,et=et||10,st=st||0,0),vt}getTile(K,et,st){const vt=this.trees[this._limitZoom(K)],wt=Math.pow(2,K),{extent:Ft,radius:ht}=this.options,It=ht/Ft,Xt=(st-It)/wt,Wt=(st+1+It)/wt,te={features:[]};return this._addTileFeatures(vt.range((et-It)/wt,Xt,(et+1+It)/wt,Wt),vt.data,et,st,wt,te),et===0&&this._addTileFeatures(vt.range(1-It/wt,Xt,1,Wt),vt.data,wt,st,wt,te),et===wt-1&&this._addTileFeatures(vt.range(0,Xt,It/wt,Wt),vt.data,-1,st,wt,te),te.features.length?te:null}getClusterExpansionZoom(K){let et=this._getOriginZoom(K)-1;for(;et<=this.options.maxZoom;){const st=this.getChildren(K);if(et++,st.length!==1)break;K=st[0].properties.cluster_id}return et}_appendLeaves(K,et,st,vt,wt){const Ft=this.getChildren(et);for(const ht of Ft){const It=ht.properties;if(It&&It.cluster?wt+It.point_count<=vt?wt+=It.point_count:wt=this._appendLeaves(K,It.cluster_id,st,vt,wt):wt<vt?wt++:K.push(ht),K.length===st)break}return wt}_createTree(K){const et=new T.aS(K.length/this.stride|0,this.options.nodeSize,Float32Array);for(let st=0;st<K.length;st+=this.stride)et.add(K[st],K[st+1]);return et.finish(),et.data=K,et}_addTileFeatures(K,et,st,vt,wt,Ft){for(const ht of K){const It=ht*this.stride,Xt=et[It+5]>1;let Wt,te,Pe;if(Xt)Wt=He(et,It,this.clusterProps),te=et[It],Pe=et[It+1];else{const mi=this.points[et[It+3]];Wt=mi.properties;const[ln,En]=mi.geometry.coordinates;te=Rt(ln),Pe=se(En)}const Oe={type:1,geometry:[[Math.round(this.options.extent*(te*wt-st)),Math.round(this.options.extent*(Pe*wt-vt))]],tags:Wt};let Qe;Qe=Xt||this.options.generateId?et[It+3]:this.points[et[It+3]].id,Qe!==void 0&&(Oe.id=Qe),Ft.features.push(Oe)}}_limitZoom(K){return Math.max(this.options.minZoom,Math.min(Math.floor(+K),this.options.maxZoom+1))}_cluster(K,et){const{radius:st,extent:vt,reduce:wt,minPoints:Ft}=this.options,ht=st/(vt*Math.pow(2,et)),It=K.data,Xt=[],Wt=this.stride;for(let te=0;te<It.length;te+=Wt){if(It[te+2]<=et)continue;It[te+2]=et;const Pe=It[te],Oe=It[te+1],Qe=K.within(It[te],It[te+1],ht),mi=It[te+5];let ln=mi;for(const En of Qe){const Un=En*Wt;It[Un+2]>et&&(ln+=It[Un+5])}if(ln>mi&&ln>=Ft){let En,Un=Pe*mi,pe=Oe*mi,Gn=-1;const qn=(te/Wt<<5)+(et+1)+this.points.length;for(const Ai of Qe){const Cn=Ai*Wt;if(It[Cn+2]<=et)continue;It[Cn+2]=et;const ce=It[Cn+5];Un+=It[Cn]*ce,pe+=It[Cn+1]*ce,It[Cn+4]=qn,wt&&(En||(En=this._map(It,te,!0),Gn=this.clusterProps.length,this.clusterProps.push(En)),wt(En,this._map(It,Cn)))}It[te+4]=qn,Xt.push(Un/ln,pe/ln,1/0,qn,-1,ln),wt&&Xt.push(Gn)}else{for(let En=0;En<Wt;En++)Xt.push(It[te+En]);if(ln>1)for(const En of Qe){const Un=En*Wt;if(!(It[Un+2]<=et)){It[Un+2]=et;for(let pe=0;pe<Wt;pe++)Xt.push(It[Un+pe])}}}}return Xt}_getOriginId(K){return K-this.points.length>>5}_getOriginZoom(K){return(K-this.points.length)%32}_map(K,et,st){if(K[et+5]>1){const Ft=this.clusterProps[K[et+6]];return st?Object.assign({},Ft):Ft}const vt=this.points[K[et+3]].properties,wt=this.options.map(vt);return st&&wt===vt?Object.assign({},wt):wt}}function we(Ct,K,et){return{type:"Feature",id:Ct[K+3],properties:He(Ct,K,et),geometry:{type:"Point",coordinates:[(st=Ct[K],360*(st-.5)),be(Ct[K+1])]}};var st}function He(Ct,K,et){const st=Ct[K+5],vt=st>=1e4?`${Math.round(st/1e3)}k`:st>=1e3?Math.round(st/100)/10+"k":st,wt=Ct[K+6],Ft=wt===-1?{}:Object.assign({},et[wt]);return Object.assign(Ft,{cluster:!0,cluster_id:Ct[K+3],point_count:st,point_count_abbreviated:vt})}function Rt(Ct){return Ct/360+.5}function se(Ct){const K=Math.sin(Ct*Math.PI/180),et=.5-.25*Math.log((1+K)/(1-K))/Math.PI;return et<0?0:et>1?1:et}function be(Ct){const K=(180-360*Ct)*Math.PI/180;return 360*Math.atan(Math.exp(K))/Math.PI-90}function Te(Ct,K,et,st){let vt=st;const wt=K+(et-K>>1);let Ft,ht=et-K;const It=Ct[K],Xt=Ct[K+1],Wt=Ct[et],te=Ct[et+1];for(let Pe=K+3;Pe<et;Pe+=3){const Oe=Ze(Ct[Pe],Ct[Pe+1],It,Xt,Wt,te);if(Oe>vt)Ft=Pe,vt=Oe;else if(Oe===vt){const Qe=Math.abs(Pe-wt);Qe<ht&&(Ft=Pe,ht=Qe)}}vt>st&&(Ft-K>3&&Te(Ct,K,Ft,st),Ct[Ft+2]=vt,et-Ft>3&&Te(Ct,Ft,et,st))}function Ze(Ct,K,et,st,vt,wt){let Ft=vt-et,ht=wt-st;if(Ft!==0||ht!==0){const It=((Ct-et)*Ft+(K-st)*ht)/(Ft*Ft+ht*ht);It>1?(et=vt,st=wt):It>0&&(et+=Ft*It,st+=ht*It)}return Ft=Ct-et,ht=K-st,Ft*Ft+ht*ht}function $e(Ct,K,et,st){const vt={id:Ct??null,type:K,geometry:et,tags:st,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(K==="Point"||K==="MultiPoint"||K==="LineString")Le(vt,et);else if(K==="Polygon")Le(vt,et[0]);else if(K==="MultiLineString")for(const wt of et)Le(vt,wt);else if(K==="MultiPolygon")for(const wt of et)Le(vt,wt[0]);return vt}function Le(Ct,K){for(let et=0;et<K.length;et+=3)Ct.minX=Math.min(Ct.minX,K[et]),Ct.minY=Math.min(Ct.minY,K[et+1]),Ct.maxX=Math.max(Ct.maxX,K[et]),Ct.maxY=Math.max(Ct.maxY,K[et+1])}function yn(Ct,K,et,st){if(!K.geometry)return;const vt=K.geometry.coordinates;if(vt&&vt.length===0)return;const wt=K.geometry.type,Ft=Math.pow(et.tolerance/((1<<et.maxZoom)*et.extent),2);let ht=[],It=K.id;if(et.promoteId?It=K.properties[et.promoteId]:et.generateId&&(It=st||0),wt==="Point")Mn(vt,ht);else if(wt==="MultiPoint")for(const Xt of vt)Mn(Xt,ht);else if(wt==="LineString")Gi(vt,ht,Ft,!1);else if(wt==="MultiLineString"){if(et.lineMetrics){for(const Xt of vt)ht=[],Gi(Xt,ht,Ft,!1),Ct.push($e(It,"LineString",ht,K.properties));return}br(vt,ht,Ft,!1)}else if(wt==="Polygon")br(vt,ht,Ft,!0);else{if(wt!=="MultiPolygon"){if(wt==="GeometryCollection"){for(const Xt of K.geometry.geometries)yn(Ct,{id:It,geometry:Xt,properties:K.properties},et,st);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Xt of vt){const Wt=[];br(Xt,Wt,Ft,!0),ht.push(Wt)}}Ct.push($e(It,wt,ht,K.properties))}function Mn(Ct,K){K.push(Ci(Ct[0]),Vs(Ct[1]),0)}function Gi(Ct,K,et,st){let vt,wt,Ft=0;for(let It=0;It<Ct.length;It++){const Xt=Ci(Ct[It][0]),Wt=Vs(Ct[It][1]);K.push(Xt,Wt,0),It>0&&(Ft+=st?(vt*Wt-Xt*wt)/2:Math.sqrt(Math.pow(Xt-vt,2)+Math.pow(Wt-wt,2))),vt=Xt,wt=Wt}const ht=K.length-3;K[2]=1,Te(K,0,ht,et),K[ht+2]=1,K.size=Math.abs(Ft),K.start=0,K.end=K.size}function br(Ct,K,et,st){for(let vt=0;vt<Ct.length;vt++){const wt=[];Gi(Ct[vt],wt,et,st),K.push(wt)}}function Ci(Ct){return Ct/360+.5}function Vs(Ct){const K=Math.sin(Ct*Math.PI/180),et=.5-.25*Math.log((1+K)/(1-K))/Math.PI;return et<0?0:et>1?1:et}function Nn(Ct,K,et,st,vt,wt,Ft,ht){if(st/=K,wt>=(et/=K)&&Ft<st)return Ct;if(Ft<et||wt>=st)return null;const It=[];for(const Xt of Ct){const Wt=Xt.geometry;let te=Xt.type;const Pe=vt===0?Xt.minX:Xt.minY,Oe=vt===0?Xt.maxX:Xt.maxY;if(Pe>=et&&Oe<st){It.push(Xt);continue}if(Oe<et||Pe>=st)continue;let Qe=[];if(te==="Point"||te==="MultiPoint")os(Wt,Qe,et,st,vt);else if(te==="LineString")Ts(Wt,Qe,et,st,vt,!1,ht.lineMetrics);else if(te==="MultiLineString")Us(Wt,Qe,et,st,vt,!1);else if(te==="Polygon")Us(Wt,Qe,et,st,vt,!0);else if(te==="MultiPolygon")for(const mi of Wt){const ln=[];Us(mi,ln,et,st,vt,!0),ln.length&&Qe.push(ln)}if(Qe.length){if(ht.lineMetrics&&te==="LineString"){for(const mi of Qe)It.push($e(Xt.id,te,mi,Xt.tags));continue}te!=="LineString"&&te!=="MultiLineString"||(Qe.length===1?(te="LineString",Qe=Qe[0]):te="MultiLineString"),te!=="Point"&&te!=="MultiPoint"||(te=Qe.length===3?"Point":"MultiPoint"),It.push($e(Xt.id,te,Qe,Xt.tags))}}return It.length?It:null}function os(Ct,K,et,st,vt){for(let wt=0;wt<Ct.length;wt+=3){const Ft=Ct[wt+vt];Ft>=et&&Ft<=st&&Ss(K,Ct[wt],Ct[wt+1],Ct[wt+2])}}function Ts(Ct,K,et,st,vt,wt,Ft){let ht=ui(Ct);const It=vt===0?To:da;let Xt,Wt,te=Ct.start;for(let ln=0;ln<Ct.length-3;ln+=3){const En=Ct[ln],Un=Ct[ln+1],pe=Ct[ln+2],Gn=Ct[ln+3],qn=Ct[ln+4],Ai=vt===0?En:Un,Cn=vt===0?Gn:qn;let ce=!1;Ft&&(Xt=Math.sqrt(Math.pow(En-Gn,2)+Math.pow(Un-qn,2))),Ai<et?Cn>et&&(Wt=It(ht,En,Un,Gn,qn,et),Ft&&(ht.start=te+Xt*Wt)):Ai>st?Cn<st&&(Wt=It(ht,En,Un,Gn,qn,st),Ft&&(ht.start=te+Xt*Wt)):Ss(ht,En,Un,pe),Cn<et&&Ai>=et&&(Wt=It(ht,En,Un,Gn,qn,et),ce=!0),Cn>st&&Ai<=st&&(Wt=It(ht,En,Un,Gn,qn,st),ce=!0),!wt&&ce&&(Ft&&(ht.end=te+Xt*Wt),K.push(ht),ht=ui(Ct)),Ft&&(te+=Xt)}let Pe=Ct.length-3;const Oe=Ct[Pe],Qe=Ct[Pe+1],mi=vt===0?Oe:Qe;mi>=et&&mi<=st&&Ss(ht,Oe,Qe,Ct[Pe+2]),Pe=ht.length-3,wt&&Pe>=3&&(ht[Pe]!==ht[0]||ht[Pe+1]!==ht[1])&&Ss(ht,ht[0],ht[1],ht[2]),ht.length&&K.push(ht)}function ui(Ct){const K=[];return K.size=Ct.size,K.start=Ct.start,K.end=Ct.end,K}function Us(Ct,K,et,st,vt,wt){for(const Ft of Ct)Ts(Ft,K,et,st,vt,wt,!1)}function Ss(Ct,K,et,st){Ct.push(K,et,st)}function To(Ct,K,et,st,vt,wt){const Ft=(wt-K)/(st-K);return Ss(Ct,wt,et+(vt-et)*Ft,1),Ft}function da(Ct,K,et,st,vt,wt){const Ft=(wt-et)/(vt-et);return Ss(Ct,K+(st-K)*Ft,wt,1),Ft}function fa(Ct,K){const et=[];for(let st=0;st<Ct.length;st++){const vt=Ct[st],wt=vt.type;let Ft;if(wt==="Point"||wt==="MultiPoint"||wt==="LineString")Ft=So(vt.geometry,K);else if(wt==="MultiLineString"||wt==="Polygon"){Ft=[];for(const ht of vt.geometry)Ft.push(So(ht,K))}else if(wt==="MultiPolygon"){Ft=[];for(const ht of vt.geometry){const It=[];for(const Xt of ht)It.push(So(Xt,K));Ft.push(It)}}et.push($e(vt.id,wt,Ft,vt.tags))}return et}function So(Ct,K){const et=[];et.size=Ct.size,Ct.start!==void 0&&(et.start=Ct.start,et.end=Ct.end);for(let st=0;st<Ct.length;st+=3)et.push(Ct[st]+K,Ct[st+1],Ct[st+2]);return et}function qi(Ct,K){if(Ct.transformed)return Ct;const et=1<<Ct.z,st=Ct.x,vt=Ct.y;for(const wt of Ct.features){const Ft=wt.geometry,ht=wt.type;if(wt.geometry=[],ht===1)for(let It=0;It<Ft.length;It+=2)wt.geometry.push(Hr(Ft[It],Ft[It+1],K,et,st,vt));else for(let It=0;It<Ft.length;It++){const Xt=[];for(let Wt=0;Wt<Ft[It].length;Wt+=2)Xt.push(Hr(Ft[It][Wt],Ft[It][Wt+1],K,et,st,vt));wt.geometry.push(Xt)}}return Ct.transformed=!0,Ct}function Hr(Ct,K,et,st,vt,wt){return[Math.round(et*(Ct*st-vt)),Math.round(et*(K*st-wt))]}function nc(Ct,K,et,st,vt){const wt=K===vt.maxZoom?0:vt.tolerance/((1<<K)*vt.extent),Ft={features:[],numPoints:0,numSimplified:0,numFeatures:Ct.length,source:null,x:et,y:st,z:K,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ht of Ct)ic(Ft,ht,wt,vt);return Ft}function ic(Ct,K,et,st){const vt=K.geometry,wt=K.type,Ft=[];if(Ct.minX=Math.min(Ct.minX,K.minX),Ct.minY=Math.min(Ct.minY,K.minY),Ct.maxX=Math.max(Ct.maxX,K.maxX),Ct.maxY=Math.max(Ct.maxY,K.maxY),wt==="Point"||wt==="MultiPoint")for(let ht=0;ht<vt.length;ht+=3)Ft.push(vt[ht],vt[ht+1]),Ct.numPoints++,Ct.numSimplified++;else if(wt==="LineString")pa(Ft,vt,Ct,et,!1,!1);else if(wt==="MultiLineString"||wt==="Polygon")for(let ht=0;ht<vt.length;ht++)pa(Ft,vt[ht],Ct,et,wt==="Polygon",ht===0);else if(wt==="MultiPolygon")for(let ht=0;ht<vt.length;ht++){const It=vt[ht];for(let Xt=0;Xt<It.length;Xt++)pa(Ft,It[Xt],Ct,et,!0,Xt===0)}if(Ft.length){let ht=K.tags||null;if(wt==="LineString"&&st.lineMetrics){ht={};for(const Xt in K.tags)ht[Xt]=K.tags[Xt];ht.mapbox_clip_start=vt.start/vt.size,ht.mapbox_clip_end=vt.end/vt.size}const It={geometry:Ft,type:wt==="Polygon"||wt==="MultiPolygon"?3:wt==="LineString"||wt==="MultiLineString"?2:1,tags:ht};K.id!==null&&(It.id=K.id),Ct.features.push(It)}}function pa(Ct,K,et,st,vt,wt){const Ft=st*st;if(st>0&&K.size<(vt?Ft:st))return void(et.numPoints+=K.length/3);const ht=[];for(let It=0;It<K.length;It+=3)(st===0||K[It+2]>Ft)&&(et.numSimplified++,ht.push(K[It],K[It+1])),et.numPoints++;vt&&(function(It,Xt){let Wt=0;for(let te=0,Pe=It.length,Oe=Pe-2;te<Pe;Oe=te,te+=2)Wt+=(It[te]-It[Oe])*(It[te+1]+It[Oe+1]);if(Wt>0===Xt)for(let te=0,Pe=It.length;te<Pe/2;te+=2){const Oe=It[te],Qe=It[te+1];It[te]=It[Pe-2-te],It[te+1]=It[Pe-1-te],It[Pe-2-te]=Oe,It[Pe-1-te]=Qe}})(ht,wt),Ct.push(ht)}const rc={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ga{constructor(K,et){const st=(et=this.options=(function(wt,Ft){for(const ht in Ft)wt[ht]=Ft[ht];return wt})(Object.create(rc),et)).debug;if(st&&console.time("preprocess data"),et.maxZoom<0||et.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(et.promoteId&&et.generateId)throw new Error("promoteId and generateId cannot be used together.");let vt=(function(wt,Ft){const ht=[];if(wt.type==="FeatureCollection")for(let It=0;It<wt.features.length;It++)yn(ht,wt.features[It],Ft,It);else yn(ht,wt.type==="Feature"?wt:{geometry:wt},Ft);return ht})(K,et);this.tiles={},this.tileCoords=[],st&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",et.indexMaxZoom,et.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),vt=(function(wt,Ft){const ht=Ft.buffer/Ft.extent;let It=wt;const Xt=Nn(wt,1,-1-ht,ht,0,-1,2,Ft),Wt=Nn(wt,1,1-ht,2+ht,0,-1,2,Ft);return(Xt||Wt)&&(It=Nn(wt,1,-ht,1+ht,0,-1,2,Ft)||[],Xt&&(It=fa(Xt,1).concat(It)),Wt&&(It=It.concat(fa(Wt,-1)))),It})(vt,et),vt.length&&this.splitTile(vt,0,0,0),st&&(vt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(K,et,st,vt,wt,Ft,ht){const It=[K,et,st,vt],Xt=this.options,Wt=Xt.debug;for(;It.length;){vt=It.pop(),st=It.pop(),et=It.pop(),K=It.pop();const te=1<<et,Pe=sc(et,st,vt);let Oe=this.tiles[Pe];if(!Oe&&(Wt>1&&console.time("creation"),Oe=this.tiles[Pe]=nc(K,et,st,vt,Xt),this.tileCoords.push({z:et,x:st,y:vt}),Wt)){Wt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",et,st,vt,Oe.numFeatures,Oe.numPoints,Oe.numSimplified),console.timeEnd("creation"));const ce=`z${et}`;this.stats[ce]=(this.stats[ce]||0)+1,this.total++}if(Oe.source=K,wt==null){if(et===Xt.indexMaxZoom||Oe.numPoints<=Xt.indexMaxPoints)continue}else{if(et===Xt.maxZoom||et===wt)continue;if(wt!=null){const ce=wt-et;if(st!==Ft>>ce||vt!==ht>>ce)continue}}if(Oe.source=null,K.length===0)continue;Wt>1&&console.time("clipping");const Qe=.5*Xt.buffer/Xt.extent,mi=.5-Qe,ln=.5+Qe,En=1+Qe;let Un=null,pe=null,Gn=null,qn=null,Ai=Nn(K,te,st-Qe,st+ln,0,Oe.minX,Oe.maxX,Xt),Cn=Nn(K,te,st+mi,st+En,0,Oe.minX,Oe.maxX,Xt);K=null,Ai&&(Un=Nn(Ai,te,vt-Qe,vt+ln,1,Oe.minY,Oe.maxY,Xt),pe=Nn(Ai,te,vt+mi,vt+En,1,Oe.minY,Oe.maxY,Xt),Ai=null),Cn&&(Gn=Nn(Cn,te,vt-Qe,vt+ln,1,Oe.minY,Oe.maxY,Xt),qn=Nn(Cn,te,vt+mi,vt+En,1,Oe.minY,Oe.maxY,Xt),Cn=null),Wt>1&&console.timeEnd("clipping"),It.push(Un||[],et+1,2*st,2*vt),It.push(pe||[],et+1,2*st,2*vt+1),It.push(Gn||[],et+1,2*st+1,2*vt),It.push(qn||[],et+1,2*st+1,2*vt+1)}}getTile(K,et,st){K=+K,et=+et,st=+st;const vt=this.options,{extent:wt,debug:Ft}=vt;if(K<0||K>24)return null;const ht=1<<K,It=sc(K,et=et+ht&ht-1,st);if(this.tiles[It])return qi(this.tiles[It],wt);Ft>1&&console.log("drilling down to z%d-%d-%d",K,et,st);let Xt,Wt=K,te=et,Pe=st;for(;!Xt&&Wt>0;)Wt--,te>>=1,Pe>>=1,Xt=this.tiles[sc(Wt,te,Pe)];return Xt&&Xt.source?(Ft>1&&(console.log("found parent tile z%d-%d-%d",Wt,te,Pe),console.time("drilling down")),this.splitTile(Xt.source,Wt,te,Pe,K,et,st),Ft>1&&console.timeEnd("drilling down"),this.tiles[It]?qi(this.tiles[It],wt):null):null}}function sc(Ct,K,et){return 32*((1<<Ct)*et+K)+Ct}class ol extends xe{constructor(K,et,st,vt=Ir){super(K,et,st),this._dataUpdateable=new Map,this._createGeoJSONIndex=vt}loadVectorTile(K,et){return T._(this,void 0,void 0,(function*(){const st=K.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const vt=this._geoJSONIndex.getTile(st.z,st.x,st.y);return vt?Nt(new W(vt.features,{version:2,extent:T.a4})):null}))}loadData(K){return T._(this,void 0,void 0,(function*(){var et;(et=this._pendingRequest)===null||et===void 0||et.abort();const st=this._startPerformance(K);this._pendingRequest=new AbortController;try{(!this._pendingData||K.request||K.data||K.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(K,this._pendingRequest));const vt=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(vt,K),this.loaded={};const wt=K.dataDiff&&T.a6(vt)?{applyDiff:!0}:{data:vt};return this._finishPerformance(st,K,wt),wt}catch(vt){if(delete this._pendingRequest,T.cH(vt))return{abandoned:!0};throw vt}}))}_startPerformance(K){var et;if(!((et=K?.request)===null||et===void 0)&&et.collectResourceTiming)return new T.c$(K.request)}_finishPerformance(K,et,st){if(!K)return;const vt=K.finish();vt&&(st.resourceTiming={},st.resourceTiming[et.source]=JSON.parse(JSON.stringify(vt)))}getData(){return T._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(K){const et=this.loaded;return et&&et[K.uid]?super.reloadTile(K):this.loadTile(K)}loadAndProcessGeoJSON(K,et){return T._(this,void 0,void 0,(function*(){let st;if(K.request?st=yield this.loadGeoJSONFromUrl(K.request,K.promoteId,et):K.data?st=this._loadGeoJSONFromObject(K.data,K.promoteId):K.dataDiff&&(st=this._loadGeoJSONFromDiff(K.dataDiff,K.promoteId,K.source)),delete this._pendingRequest,typeof st!="object")throw new Error(`Input data given to '${K.source}' is not a valid GeoJSON object.`);return Ee(st,!0),K.filter&&(st=this._filterGeoJSON(st,K.filter)),st}))}loadGeoJSONFromUrl(K,et,st){return T._(this,void 0,void 0,(function*(){const vt=yield T.j(K,st);return this._dataUpdateable=T.a6(vt.data,et)?T.a7(vt.data,et):void 0,vt.data}))}_loadGeoJSONFromObject(K,et){return this._dataUpdateable=T.a6(K,et)?T.a7(K,et):void 0,K}_loadGeoJSONFromDiff(K,et,st){if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${st}`);T.a8(this._dataUpdateable,K,et);const vt=Array.from(this._dataUpdateable.values());return this._toFeatureCollection(vt)}_filterGeoJSON(K,et){const st=T.d3(et,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(st.result==="error")throw new Error(st.value.map((wt=>`${wt.key}: ${wt.message}`)).join(", "));const vt=K.features.filter((wt=>st.value.evaluate({zoom:0},wt)));return this._toFeatureCollection(vt)}_toFeatureCollection(K){return{type:"FeatureCollection",features:K}}removeSource(K){return T._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(K){return this._geoJSONIndex.getClusterExpansionZoom(K.clusterId)}getClusterChildren(K){return this._geoJSONIndex.getChildren(K.clusterId)}getClusterLeaves(K){return this._geoJSONIndex.getLeaves(K.clusterId,K.limit,K.offset)}}function Ir(Ct,K){return K.cluster?new Gt((function({superclusterOptions:et,clusterProperties:st}){if(!st||!et)return et;const vt={},wt={},Ft={accumulated:null,zoom:0},ht={properties:null},It=Object.keys(st);for(const Xt of It){const[Wt,te]=st[Xt],Pe=T.d3(te),Oe=T.d3(typeof Wt=="string"?[Wt,["accumulated"],["get",Xt]]:Wt);vt[Xt]=Pe.value,wt[Xt]=Oe.value}return et.map=Xt=>{ht.properties=Xt;const Wt={};for(const te of It)Wt[te]=vt[te].evaluate(Ft,ht);return Wt},et.reduce=(Xt,Wt)=>{ht.properties=Wt;for(const te of It)Ft.accumulated=Xt[te],Xt[te]=wt[te].evaluate(Ft,ht)},et})(K)).load(Ct.features):(function(et,st){return new Ga(et,st)})(Ct,K.geojsonVtOptions)}class ri{constructor(K){this.self=K,this.actor=new T.L(K),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(et,st)=>{if(this.externalWorkerSourceTypes[et])throw new Error(`Worker source with name "${et}" already registered.`);this.externalWorkerSourceTypes[et]=st},this.self.addProtocol=T.cJ,this.self.removeProtocol=T.cK,this.self.registerRTLTextPlugin=et=>{T.d4.setMethods(et)},this.actor.registerMessageHandler("LDT",((et,st)=>this._getDEMWorkerSource(et,st.source).loadTile(st))),this.actor.registerMessageHandler("RDT",((et,st)=>T._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(et,st.source).removeTile(st)})))),this.actor.registerMessageHandler("GCEZ",((et,st)=>T._(this,void 0,void 0,(function*(){return this._getWorkerSource(et,st.type,st.source).getClusterExpansionZoom(st)})))),this.actor.registerMessageHandler("GCC",((et,st)=>T._(this,void 0,void 0,(function*(){return this._getWorkerSource(et,st.type,st.source).getClusterChildren(st)})))),this.actor.registerMessageHandler("GCL",((et,st)=>T._(this,void 0,void 0,(function*(){return this._getWorkerSource(et,st.type,st.source).getClusterLeaves(st)})))),this.actor.registerMessageHandler("LD",((et,st)=>this._getWorkerSource(et,st.type,st.source).loadData(st))),this.actor.registerMessageHandler("GD",((et,st)=>this._getWorkerSource(et,st.type,st.source).getData())),this.actor.registerMessageHandler("LT",((et,st)=>this._getWorkerSource(et,st.type,st.source).loadTile(st))),this.actor.registerMessageHandler("RT",((et,st)=>this._getWorkerSource(et,st.type,st.source).reloadTile(st))),this.actor.registerMessageHandler("AT",((et,st)=>this._getWorkerSource(et,st.type,st.source).abortTile(st))),this.actor.registerMessageHandler("RMT",((et,st)=>this._getWorkerSource(et,st.type,st.source).removeTile(st))),this.actor.registerMessageHandler("RS",((et,st)=>T._(this,void 0,void 0,(function*(){if(!this.workerSources[et]||!this.workerSources[et][st.type]||!this.workerSources[et][st.type][st.source])return;const vt=this.workerSources[et][st.type][st.source];delete this.workerSources[et][st.type][st.source],vt.removeSource!==void 0&&vt.removeSource(st)})))),this.actor.registerMessageHandler("RM",(et=>T._(this,void 0,void 0,(function*(){delete this.layerIndexes[et],delete this.availableImages[et],delete this.workerSources[et],delete this.demWorkerSources[et],this.globalStates.delete(et)})))),this.actor.registerMessageHandler("SR",((et,st)=>T._(this,void 0,void 0,(function*(){this.referrer=st})))),this.actor.registerMessageHandler("SRPS",((et,st)=>this._syncRTLPluginState(et,st))),this.actor.registerMessageHandler("IS",((et,st)=>T._(this,void 0,void 0,(function*(){this.self.importScripts(st)})))),this.actor.registerMessageHandler("SI",((et,st)=>this._setImages(et,st))),this.actor.registerMessageHandler("UL",((et,st)=>T._(this,void 0,void 0,(function*(){this._getLayerIndex(et).update(st.layers,st.removedIds,this._getGlobalState(et))})))),this.actor.registerMessageHandler("UGS",((et,st)=>T._(this,void 0,void 0,(function*(){const vt=this._getGlobalState(et);for(const wt in st)vt[wt]=st[wt]})))),this.actor.registerMessageHandler("SL",((et,st)=>T._(this,void 0,void 0,(function*(){this._getLayerIndex(et).replace(st,this._getGlobalState(et))}))))}_getGlobalState(K){let et=this.globalStates.get(K);return et||(et={},this.globalStates.set(K,et)),et}_setImages(K,et){return T._(this,void 0,void 0,(function*(){this.availableImages[K]=et;for(const st in this.workerSources[K]){const vt=this.workerSources[K][st];for(const wt in vt)vt[wt].availableImages=et}}))}_syncRTLPluginState(K,et){return T._(this,void 0,void 0,(function*(){return yield T.d4.syncState(et,this.self.importScripts)}))}_getAvailableImages(K){let et=this.availableImages[K];return et||(et=[]),et}_getLayerIndex(K){let et=this.layerIndexes[K];return et||(et=this.layerIndexes[K]=new u),et}_getWorkerSource(K,et,st){if(this.workerSources[K]||(this.workerSources[K]={}),this.workerSources[K][et]||(this.workerSources[K][et]={}),!this.workerSources[K][et][st]){const vt={sendAsync:(wt,Ft)=>(wt.targetMapId=K,this.actor.sendAsync(wt,Ft))};switch(et){case"vector":this.workerSources[K][et][st]=new xe(vt,this._getLayerIndex(K),this._getAvailableImages(K));break;case"geojson":this.workerSources[K][et][st]=new ol(vt,this._getLayerIndex(K),this._getAvailableImages(K));break;default:this.workerSources[K][et][st]=new this.externalWorkerSourceTypes[et](vt,this._getLayerIndex(K),this._getAvailableImages(K))}}return this.workerSources[K][et][st]}_getDEMWorkerSource(K,et){return this.demWorkerSources[K]||(this.demWorkerSources[K]={}),this.demWorkerSources[K][et]||(this.demWorkerSources[K][et]=new Ae),this.demWorkerSources[K][et]}}return T.i(self)&&(self.worker=new ri(self)),ri})),S("index",["exports","./shared"],(function(T,u){var L="5.13.0";function k(){var v=new u.A(4);return u.A!=Float32Array&&(v[1]=0,v[2]=0),v[0]=1,v[3]=1,v}let B,H,W;const it={frame(v,e,a){const d=requestAnimationFrame((x=>{g(),e(x)})),{unsubscribe:g}=u.s(v.signal,"abort",(()=>{g(),cancelAnimationFrame(d),a(u.c())}),!1)},frameAsync(v){return new Promise(((e,a)=>{this.frame(v,e,a)}))},getImageData(v,e=0){return this.getImageCanvasContext(v).getImageData(-e,-e,v.width+2*e,v.height+2*e)},getImageCanvasContext(v){const e=window.document.createElement("canvas"),a=e.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return e.width=v.width,e.height=v.height,a.drawImage(v,0,0,v.width,v.height),a},resolveURL:v=>(B||(B=document.createElement("a")),B.href=v,B.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return W!==void 0?W:!!matchMedia&&(H==null&&(H=matchMedia("(prefers-reduced-motion: reduce)")),H.matches)},set prefersReducedMotion(v){W=v}},pt=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(v){this._frozenAt=v}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function rt(){return pt.getCurrentTime()}class J{static testProp(e){if(!J.docStyle)return e[0];for(let a=0;a<e.length;a++)if(e[a]in J.docStyle)return e[a];return e[0]}static create(e,a,d){const g=window.document.createElement(e);return a!==void 0&&(g.className=a),d&&d.appendChild(g),g}static createNS(e,a){return window.document.createElementNS(e,a)}static disableDrag(){J.docStyle&&J.selectProp&&(J.userSelect=J.docStyle[J.selectProp],J.docStyle[J.selectProp]="none")}static enableDrag(){J.docStyle&&J.selectProp&&(J.docStyle[J.selectProp]=J.userSelect)}static setTransform(e,a){e.style[J.transformProp]=a}static addEventListener(e,a,d,g={}){e.addEventListener(a,d,"passive"in g?g:g.capture)}static removeEventListener(e,a,d,g={}){e.removeEventListener(a,d,"passive"in g?g:g.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",J.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",J.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",J.suppressClickInternal,!0)}),0)}static getScale(e){const a=e.getBoundingClientRect();return{x:a.width/e.offsetWidth||1,y:a.height/e.offsetHeight||1,boundingClientRect:a}}static getPoint(e,a,d){const g=a.boundingClientRect;return new u.P((d.clientX-g.left)/a.x-e.clientLeft,(d.clientY-g.top)/a.y-e.clientTop)}static mousePos(e,a){const d=J.getScale(e);return J.getPoint(e,d,a)}static touchPos(e,a){const d=[],g=J.getScale(e);for(let x=0;x<a.length;x++)d.push(J.getPoint(e,g,a[x]));return d}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const a=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),d=a.querySelectorAll("script");for(const g of d)g.remove();return J.clean(a),a.innerHTML}static isPossiblyDangerous(e,a){const d=a.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!d.includes("javascript:")&&!d.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const a=e.children;for(const d of a)J.removeAttributes(d),J.clean(d)}static removeAttributes(e){for(const{name:a,value:d}of e.attributes)J.isPossiblyDangerous(a,d)&&e.removeAttribute(a)}}J.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,J.selectProp=J.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),J.transformProp=J.testProp(["transform","WebkitTransform"]);const mt={supported:!1,testSupport:function(v){!Lt&&bt&&(Ot?ee(v):Et=v)}};let Et,bt,Lt=!1,Ot=!1;function ee(v){const e=v.createTexture();v.bindTexture(v.TEXTURE_2D,e);try{if(v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,bt),v.isContextLost())return;mt.supported=!0}catch{}v.deleteTexture(e),Lt=!0}var Nt;typeof document<"u"&&(bt=document.createElement("img"),bt.onload=()=>{Et&&ee(Et),Et=null,Ot=!0},bt.onerror=()=>{Lt=!0,Et=null},bt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(v){let e,a,d,g;v.resetRequestQueue=()=>{e=[],a=0,d=0,g={}},v.addThrottleControl=R=>{const O=d++;return g[O]=R,O},v.removeThrottleControl=R=>{delete g[R],E()},v.getImage=(R,O,j=!0)=>new Promise((($,q)=>{mt.supported&&(R.headers||(R.headers={}),R.headers.accept="image/webp,*/*"),u.e(R,{type:"image"}),e.push({abortController:O,requestParameters:R,supportImageRefresh:j,state:"queued",onError:Q=>{q(Q)},onSuccess:Q=>{$(Q)}}),E()}));const x=R=>u._(this,void 0,void 0,(function*(){R.state="running";const{requestParameters:O,supportImageRefresh:j,onError:$,onSuccess:q,abortController:Q}=R,nt=j===!1&&!u.i(self)&&!u.g(O.url)&&(!O.headers||Object.keys(O.headers).reduce(((ft,_t)=>ft&&_t==="accept"),!0));a++;const lt=nt?P(O,Q):u.m(O,Q);try{const ft=yield lt;delete R.abortController,R.state="completed",ft.data instanceof HTMLImageElement||u.b(ft.data)?q(ft):ft.data&&q({data:yield(ut=ft.data,typeof createImageBitmap=="function"?u.f(ut):u.h(ut)),cacheControl:ft.cacheControl,expires:ft.expires})}catch(ft){delete R.abortController,$(ft)}finally{a--,E()}var ut})),E=()=>{const R=(()=>{for(const O of Object.keys(g))if(g[O]())return!0;return!1})()?u.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:u.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let O=a;O<R&&e.length>0;O++){const j=e.shift();j.abortController.signal.aborted?O--:x(j)}},P=(R,O)=>new Promise(((j,$)=>{const q=new Image,Q=R.url,nt=R.credentials;nt&&nt==="include"?q.crossOrigin="use-credentials":(nt&&nt==="same-origin"||!u.d(Q))&&(q.crossOrigin="anonymous"),O.signal.addEventListener("abort",(()=>{q.src="",$(u.c())})),q.fetchPriority="high",q.onload=()=>{q.onerror=q.onload=null,j({data:q})},q.onerror=()=>{q.onerror=q.onload=null,O.signal.aborted||$(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},q.src=Q}))})(Nt||(Nt={})),Nt.resetRequestQueue();class Kt{constructor(e){this._transformRequestFn=e??null}transformRequest(e,a){return this._transformRequestFn&&this._transformRequestFn(e,a)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function xe(v){const e=[];if(typeof v=="string")e.push({id:"default",url:v});else if(v&&v.length>0){const a=[];for(const{id:d,url:g}of v){const x=`${d}${g}`;a.indexOf(x)===-1&&(a.push(x),e.push({id:d,url:g}))}}return e}function Ae(v,e,a){try{const d=new URL(v);return d.pathname+=`${e}${a}`,d.toString()}catch{throw new Error(`Invalid sprite URL "${v}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function ae(v){const{userImage:e}=v;return!!(e&&e.render&&e.render())&&(v.data.replace(new Uint8Array(e.data.buffer)),!0)}class ze extends u.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.R({width:1,height:1}),this.dirty=!0}destroy(){this.atlasTexture&&(this.atlasTexture.destroy(),this.atlasTexture=null);for(const e of Object.keys(this.images))this.removeImage(e);this.patterns={},this.atlasImage=new u.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:a,promiseResolve:d}of this.requestors)d(this._getImagesForIds(a));this.requestors=[]}}getImage(e){const a=this.images[e];if(a&&!a.data&&a.spriteData){const d=a.spriteData;a.data=new u.R({width:d.width,height:d.height},d.context.getImageData(d.x,d.y,d.width,d.height).data),a.spriteData=null}return a}addImage(e,a){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,a)&&(this.images[e]=a)}_validate(e,a){let d=!0;const g=a.data||a.spriteData;return this._validateStretch(a.stretchX,g&&g.width)||(this.fire(new u.k(new Error(`Image "${e}" has invalid "stretchX" value`))),d=!1),this._validateStretch(a.stretchY,g&&g.height)||(this.fire(new u.k(new Error(`Image "${e}" has invalid "stretchY" value`))),d=!1),this._validateContent(a.content,a)||(this.fire(new u.k(new Error(`Image "${e}" has invalid "content" value`))),d=!1),d}_validateStretch(e,a){if(!e)return!0;let d=0;for(const g of e){if(g[0]<d||g[1]<g[0]||a<g[1])return!1;d=g[1]}return!0}_validateContent(e,a){if(!e)return!0;if(e.length!==4)return!1;const d=a.spriteData,g=d&&d.width||a.data.width,x=d&&d.height||a.data.height;return!(e[0]<0||g<e[0]||e[1]<0||x<e[1]||e[2]<0||g<e[2]||e[3]<0||x<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,a,d=!0){const g=this.getImage(e);if(d&&(g.data.width!==a.data.width||g.data.height!==a.data.height))throw new Error(`size mismatch between old image (${g.data.width}x${g.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=g.version+1,this.images[e]=a,this.updatedImages[e]=!0}removeImage(e){const a=this.images[e];delete this.images[e],delete this.patterns[e],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise(((a,d)=>{let g=!0;if(!this.isLoaded())for(const x of e)this.images[x]||(g=!1);this.isLoaded()||g?a(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:a})}))}_getImagesForIds(e){const a={};for(const d of e){let g=this.getImage(d);g||(this.fire(new u.l("styleimagemissing",{id:d})),g=this.getImage(d)),g?a[d]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,stretchX:g.stretchX,stretchY:g.stretchY,content:g.content,textFitWidth:g.textFitWidth,textFitHeight:g.textFitHeight,hasRenderCallback:!!(g.userImage&&g.userImage.render)}:u.w(`Image "${d}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:e,height:a}=this.atlasImage;return{width:e,height:a}}getPattern(e){const a=this.patterns[e],d=this.getImage(e);if(!d)return null;if(a&&a.position.version===d.version)return a.position;if(a)a.position.version=d.version;else{const g={w:d.data.width+2,h:d.data.height+2,x:0,y:0},x=new u.I(g,d);this.patterns[e]={bin:g,position:x}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const a=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new u.T(e,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const x in this.patterns)e.push(this.patterns[x].bin);const{w:a,h:d}=u.p(e),g=this.atlasImage;g.resize({width:a||1,height:d||1});for(const x in this.patterns){const{bin:E}=this.patterns[x],P=E.x+1,R=E.y+1,O=this.getImage(x).data,j=O.width,$=O.height;u.R.copy(O,g,{x:0,y:0},{x:P,y:R},{width:j,height:$}),u.R.copy(O,g,{x:0,y:$-1},{x:P,y:R-1},{width:j,height:1}),u.R.copy(O,g,{x:0,y:0},{x:P,y:R+$},{width:j,height:1}),u.R.copy(O,g,{x:j-1,y:0},{x:P-1,y:R},{width:1,height:$}),u.R.copy(O,g,{x:0,y:0},{x:P+j,y:R},{width:1,height:$})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const a of e){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const d=this.getImage(a);d||u.w(`Image with ID: "${a}" was not found`),ae(d)&&this.updateImage(a,d)}}cloneImages(){const e={};for(const a in this.images){const d=this.images[a];e[a]=Object.assign(Object.assign({},d),{data:d.data?d.data.clone():null})}return e}}const We=1e20;function Ee(v,e,a,d,g,x,E,P,R){for(let O=e;O<e+d;O++)me(v,a*x+O,x,g,E,P,R);for(let O=a;O<a+g;O++)me(v,O*x+e,1,d,E,P,R)}function me(v,e,a,d,g,x,E){x[0]=0,E[0]=-We,E[1]=We,g[0]=v[e];for(let P=1,R=0,O=0;P<d;P++){g[P]=v[e+P*a];const j=P*P;do{const $=x[R];O=(g[P]-g[$]+j-$*$)/(P-$)/2}while(O<=E[R]&&--R>-1);R++,x[R]=P,E[R]=O,E[R+1]=We}for(let P=0,R=0;P<d;P++){for(;E[R+1]<P;)R++;const O=x[R],j=P-O;v[e+P*a]=g[O]+j*j}}const jt=u.v.layout_symbol["text-font"].default.join(",");class Qt{constructor(e,a,d){this.requestManager=e,this.localIdeographFontFamily=a,this.entries={},this.lang=d}setURL(e){this.url=e}getGlyphs(e){return u._(this,void 0,void 0,(function*(){const a=[];for(const x in e)for(const E of e[x])a.push(this._getAndCacheGlyphsPromise(x,E));const d=yield Promise.all(a),g={};for(const{stack:x,id:E,glyph:P}of d)g[x]||(g[x]={}),g[x][E]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics};return g}))}_getAndCacheGlyphsPromise(e,a){return u._(this,void 0,void 0,(function*(){let d=this.entries[e];d||(d=this.entries[e]={glyphs:{},requests:{},ranges:{}});let g=d.glyphs[a];return g!==void 0?{stack:e,id:a,glyph:g}:!this.url||this._charUsesLocalIdeographFontFamily(a)?(g=d.glyphs[a]=this._drawGlyph(d,e,a),{stack:e,id:a,glyph:g}):yield this._downloadAndCacheRangePromise(e,a)}))}_downloadAndCacheRangePromise(e,a){return u._(this,void 0,void 0,(function*(){const d=this.entries[e],g=Math.floor(a/256);if(d.ranges[g])return{stack:e,id:a,glyph:null};if(!d.requests[g]){const x=Qt.loadGlyphRange(e,g,this.url,this.requestManager);d.requests[g]=x}try{const x=yield d.requests[g];for(const E in x)d.glyphs[+E]=x[+E];return d.ranges[g]=!0,{stack:e,id:a,glyph:x[a]||null}}catch(x){const E=d.glyphs[a]=this._drawGlyph(d,e,a);return this._warnOnMissingGlyphRange(E,g,a,x),{stack:e,id:a,glyph:E}}}))}_warnOnMissingGlyphRange(e,a,d,g){const x=256*a,E=x+255,P=d.toString(16).padStart(4,"0").toUpperCase();u.w(`Unable to load glyph range ${a}, ${x}-${E}. Rendering codepoint U+${P} locally instead. ${g}`)}_charUsesLocalIdeographFontFamily(e){return!!this.localIdeographFontFamily&&u.q(e)}_drawGlyph(e,a,d){const g=a===jt&&this.localIdeographFontFamily!==""&&this._charUsesLocalIdeographFontFamily(d),x=g?"ideographTinySDF":"tinySDF";e[x]||(e[x]=this._createTinySDF(g?this.localIdeographFontFamily:a));const E=e[x].draw(String.fromCodePoint(d));return{id:d,bitmap:new u.r({width:E.width||60,height:E.height||60},E.data),metrics:{width:E.glyphWidth/2||24,height:E.glyphHeight/2||24,left:E.glyphLeft/2+.5||0,top:E.glyphTop/2-27.5||-8,advance:E.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(e){const a=e?e.split(","):[];a.push("sans-serif");const d=a.map((g=>/[-\w]+/.test(g)?g:`'${CSS.escape(g)}'`)).join(",");return new Qt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:d,fontWeight:this._fontWeight(a[0]),fontStyle:this._fontStyle(a[0]),lang:this.lang})}_fontStyle(e){return/italic/i.test(e)?"italic":/oblique/i.test(e)?"oblique":"normal"}_fontWeight(e){const a={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let d;for(const[g,x]of Object.entries(a))new RegExp(`\\b${g}\\b`,"i").test(e)&&(d=`${x}`);return d}destroy(){for(const e in this.entries){const a=this.entries[e];a.tinySDF&&(a.tinySDF=null),a.ideographTinySDF&&(a.ideographTinySDF=null),a.glyphs={},a.requests={},a.ranges={}}this.entries={}}}Qt.loadGlyphRange=function(v,e,a,d){return u._(this,void 0,void 0,(function*(){const g=256*e,x=g+255,E=d.transformRequest(a.replace("{fontstack}",v).replace("{range}",`${g}-${x}`),"Glyphs"),P=yield u.n(E,new AbortController);if(!P||!P.data)throw new Error(`Could not load glyph range. range: ${e}, ${g}-${x}`);const R={};for(const O of u.o(P.data))R[O.id]=O;return R}))},Qt.TinySDF=class{constructor({fontSize:v=24,buffer:e=3,radius:a=8,cutoff:d=.25,fontFamily:g="sans-serif",fontWeight:x="normal",fontStyle:E="normal",lang:P=null}={}){this.buffer=e,this.cutoff=d,this.radius=a,this.lang=P;const R=this.size=v+4*e,O=this._createCanvas(R),j=this.ctx=O.getContext("2d",{willReadFrequently:!0});j.font=`${E} ${x} ${v}px ${g}`,j.textBaseline="alphabetic",j.textAlign="left",j.fillStyle="black",this.gridOuter=new Float64Array(R*R),this.gridInner=new Float64Array(R*R),this.f=new Float64Array(R),this.z=new Float64Array(R+1),this.v=new Uint16Array(R)}_createCanvas(v){const e=document.createElement("canvas");return e.width=e.height=v,e}draw(v){const{width:e,actualBoundingBoxAscent:a,actualBoundingBoxDescent:d,actualBoundingBoxLeft:g,actualBoundingBoxRight:x}=this.ctx.measureText(v),E=Math.ceil(a),P=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-g))),R=Math.min(this.size-this.buffer,E+Math.ceil(d)),O=P+2*this.buffer,j=R+2*this.buffer,$=Math.max(O*j,0),q=new Uint8ClampedArray($),Q={data:q,width:O,height:j,glyphWidth:P,glyphHeight:R,glyphTop:E,glyphLeft:0,glyphAdvance:e};if(P===0||R===0)return Q;const{ctx:nt,buffer:lt,gridInner:ut,gridOuter:ft}=this;this.lang&&(nt.lang=this.lang),nt.clearRect(lt,lt,P,R),nt.fillText(v,lt,lt+E);const _t=nt.getImageData(lt,lt,P,R);ft.fill(We,0,$),ut.fill(0,0,$);for(let Tt=0;Tt<R;Tt++)for(let gt=0;gt<P;gt++){const St=_t.data[4*(Tt*P+gt)+3]/255;if(St===0)continue;const At=(Tt+lt)*O+gt+lt;if(St===1)ft[At]=0,ut[At]=We;else{const xt=.5-St;ft[At]=xt>0?xt*xt:0,ut[At]=xt<0?xt*xt:0}}Ee(ft,0,0,O,j,O,this.f,this.v,this.z),Ee(ut,lt,lt,P,R,O,this.f,this.v,this.z);for(let Tt=0;Tt<$;Tt++){const gt=Math.sqrt(ft[Tt])-Math.sqrt(ut[Tt]);q[Tt]=Math.round(255-255*(gt/this.radius+this.cutoff))}return Q}};class Gt{constructor(){this.specification=u.u.light.position}possiblyEvaluate(e,a){return u.F(e.expression.evaluate(a))}interpolate(e,a,d){return{x:u.G.number(e.x,a.x,d),y:u.G.number(e.y,a.y,d),z:u.G.number(e.z,a.z,d)}}}let we;class He extends u.E{constructor(e){super(),we=we||new u.t({anchor:new u.D(u.u.light.anchor),position:new Gt,color:new u.D(u.u.light.color),intensity:new u.D(u.u.light.intensity)}),this._transitionable=new u.x(we,void 0),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,a={}){if(!this._validate(u.y,e,a))for(const d in e){const g=e[d];d.endsWith(u.z)?this._transitionable.setTransition(d.slice(0,-u.z.length),g):this._transitionable.setValue(d,g)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,a,d){return(!d||d.validate!==!1)&&u.B(this,e.call(u.C,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:u.u}))}}const Rt=new u.t({"sky-color":new u.D(u.u.sky["sky-color"]),"horizon-color":new u.D(u.u.sky["horizon-color"]),"fog-color":new u.D(u.u.sky["fog-color"]),"fog-ground-blend":new u.D(u.u.sky["fog-ground-blend"]),"horizon-fog-blend":new u.D(u.u.sky["horizon-fog-blend"]),"sky-horizon-blend":new u.D(u.u.sky["sky-horizon-blend"]),"atmosphere-blend":new u.D(u.u.sky["atmosphere-blend"])});class se extends u.E{constructor(e){super(),this._transitionable=new u.x(Rt,void 0),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new u.H(0))}setSky(e,a={}){if(!this._validate(u.J,e,a)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const d in e){const g=e[d];d.endsWith(u.z)?this._transitionable.setTransition(d.slice(0,-u.z.length),g):this._transitionable.setValue(d,g)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,a,d={}){return d?.validate!==!1&&u.B(this,e.call(u.C,u.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:u.u})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class be{constructor(e,a){this.width=e,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,a){const d=e.join(",")+String(a);return this.dashEntry[d]||(this.dashEntry[d]=this.addDash(e,a)),this.dashEntry[d]}getDashRanges(e,a,d){const g=[];let x=e.length%2==1?-e[e.length-1]*d:0,E=e[0]*d,P=!0;g.push({left:x,right:E,isDash:P,zeroLength:e[0]===0});let R=e[0];for(let O=1;O<e.length;O++){P=!P;const j=e[O];x=R*d,R+=j,E=R*d,g.push({left:x,right:E,isDash:P,zeroLength:j===0})}return g}addRoundDash(e,a,d){const g=a/2;for(let x=-d;x<=d;x++){const E=this.width*(this.nextRow+d+x);let P=0,R=e[P];for(let O=0;O<this.width;O++){O/R.right>1&&(R=e[++P]);const j=Math.abs(O-R.left),$=Math.abs(O-R.right),q=Math.min(j,$);let Q;const nt=x/d*(g+1);if(R.isDash){const lt=g-Math.abs(nt);Q=Math.sqrt(q*q+lt*lt)}else Q=g-Math.sqrt(q*q+nt*nt);this.data[E+O]=Math.max(0,Math.min(255,Q+128))}}}addRegularDash(e){for(let P=e.length-1;P>=0;--P){const R=e[P],O=e[P+1];R.zeroLength?e.splice(P,1):O&&O.isDash===R.isDash&&(O.left=R.left,e.splice(P,1))}const a=e[0],d=e[e.length-1];a.isDash===d.isDash&&(a.left=d.left-this.width,d.right=a.right+this.width);const g=this.width*this.nextRow;let x=0,E=e[x];for(let P=0;P<this.width;P++){P/E.right>1&&(E=e[++x]);const R=Math.abs(P-E.left),O=Math.abs(P-E.right),j=Math.min(R,O);this.data[g+P]=Math.max(0,Math.min(255,(E.isDash?j:-j)+128))}}addDash(e,a){const d=a?7:0,g=2*d+1;if(this.nextRow+g>this.height)return u.w("LineAtlas out of space"),null;let x=0;for(let P=0;P<e.length;P++)x+=e[P];if(x!==0){const P=this.width/x,R=this.getDashRanges(e,this.width,P);a?this.addRoundDash(R,P,d):this.addRegularDash(R)}const E={y:this.nextRow+d,height:2*d,width:x};return this.nextRow+=g,this.dirty=!0,E}bind(e){const a=e.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const Te="maplibre_preloaded_worker_pool";class Ze{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Ze.workerCount;)this.workers.push(new Worker(u.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach((a=>{a.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Te]}numActive(){return Object.keys(this.active).length}}const $e=Math.floor(it.hardwareConcurrency/2);let Le,yn;function Mn(){return Le||(Le=new Ze),Le}Ze.workerCount=u.K(globalThis)?Math.max(Math.min($e,3),1):1;class Gi{constructor(e,a){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=a;const d=this.workerPool.acquire(a);for(let g=0;g<d.length;g++){const x=new u.L(d[g],a);x.name=`Worker ${g}`,this.actors.push(x)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,a){const d=[];for(const g of this.actors)d.push(g.sendAsync({type:e,data:a}));return Promise.all(d)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach((a=>{a.remove()})),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,a){for(const d of this.actors)d.registerMessageHandler(e,a)}unregisterMessageHandler(e){for(const a of this.actors)a.unregisterMessageHandler(e)}}function br(){return yn||(yn=new Gi(Mn(),u.M),yn.registerMessageHandler("GR",((v,e,a)=>u.m(e,a)))),yn}function Ci(v,e){const a=u.N();return u.O(a,a,[1,1,0]),u.Q(a,a,[.5*v.width,.5*v.height,1]),v.calculatePosMatrix?u.S(a,a,v.calculatePosMatrix(e.toUnwrapped())):a}function Vs(v,e,a,d,g,x,E){var P;const R=(function(q,Q,nt){if(q)for(const lt of q){const ut=Q[lt];if(ut&&ut.source===nt&&ut.type==="fill-extrusion")return!0}else for(const lt in Q){const ut=Q[lt];if(ut.source===nt&&ut.type==="fill-extrusion")return!0}return!1})((P=g?.layers)!==null&&P!==void 0?P:null,e,v.id),O=x.maxPitchScaleFactor(),j=v.tilesIn(d,O,R);j.sort(Nn);const $=[];for(const q of j)$.push({wrappedTileID:q.tileID.wrapped().key,queryResults:q.tile.queryRenderedFeatures(e,a,v.getState(),q.queryGeometry,q.cameraQueryGeometry,q.scale,g,x,O,Ci(x,q.tileID),E?(Q,nt)=>E(q.tileID,Q,nt):void 0)});return(function(q,Q){for(const nt in q)for(const lt of q[nt])os(lt,Q);return q})((function(q){const Q={},nt={};for(const lt of q){const ut=lt.queryResults,ft=lt.wrappedTileID,_t=nt[ft]=nt[ft]||{};for(const Tt in ut){const gt=ut[Tt],St=_t[Tt]=_t[Tt]||{},At=Q[Tt]=Q[Tt]||[];for(const xt of gt)St[xt.featureIndex]||(St[xt.featureIndex]=!0,At.push(xt))}}return Q})($),v)}function Nn(v,e){const a=v.tileID,d=e.tileID;return a.overscaledZ-d.overscaledZ||a.canonical.y-d.canonical.y||a.wrap-d.wrap||a.canonical.x-d.canonical.x}function os(v,e){const a=v.feature,d=e.getFeatureState(a.layer["source-layer"],a.id);a.source=a.layer.source,a.layer["source-layer"]&&(a.sourceLayer=a.layer["source-layer"]),a.state=d}function Ts(v,e,a){return u._(this,void 0,void 0,(function*(){let d=v;if(v.url?d=(yield u.j(e.transformRequest(v.url,"Source"),a)).data:yield it.frameAsync(a),!d)return null;const g=u.U(u.e(d,v),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in d&&d.vector_layers&&(g.vectorLayerIds=d.vector_layers.map((x=>x.id))),g}))}class ui{constructor(e,a){e&&(a?this.setSouthWest(e).setNorthEast(a):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof u.V?new u.V(e.lng,e.lat):u.V.convert(e),this}setSouthWest(e){return this._sw=e instanceof u.V?new u.V(e.lng,e.lat):u.V.convert(e),this}extend(e){const a=this._sw,d=this._ne;let g,x;if(e instanceof u.V)g=e,x=e;else{if(!(e instanceof ui))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(ui.convert(e)):this.extend(u.V.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(u.V.convert(e)):this;if(g=e._sw,x=e._ne,!g||!x)return this}return a||d?(a.lng=Math.min(g.lng,a.lng),a.lat=Math.min(g.lat,a.lat),d.lng=Math.max(x.lng,d.lng),d.lat=Math.max(x.lat,d.lat)):(this._sw=new u.V(g.lng,g.lat),this._ne=new u.V(x.lng,x.lat)),this}getCenter(){return new u.V((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new u.V(this.getWest(),this.getNorth())}getSouthEast(){return new u.V(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:a,lat:d}=u.V.convert(e);let g=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&g}intersects(e){if((e=ui.convert(e)).getNorth()<this.getSouth()||e.getSouth()>this.getNorth())return!1;const a=u.W(this.getWest(),-180,180),d=u.W(this.getEast(),-180,180),g=u.W(e.getWest(),-180,180),x=u.W(e.getEast(),-180,180),E=a>d,P=g>x;return!(!E||!P)||(E?x>=a||g<=d:P?d>=g||a<=x:!(g>d||x<a))}static convert(e){return e instanceof ui?e:e&&new ui(e)}static fromLngLat(e,a=0){const d=360*a/40075017,g=d/Math.cos(Math.PI/180*e.lat);return new ui(new u.V(e.lng-g,e.lat-d),new u.V(e.lng+g,e.lat+d))}adjustAntiMeridian(){const e=new u.V(this._sw.lng,this._sw.lat),a=new u.V(this._ne.lng,this._ne.lat);return new ui(e,e.lng>a.lng?new u.V(a.lng+360,a.lat):a)}}class Us{constructor(e,a,d){this.bounds=ui.convert(this.validateBounds(e)),this.minzoom=a||0,this.maxzoom=d||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const a=Math.pow(2,e.z),d=Math.floor(u.Y(this.bounds.getWest())*a),g=Math.floor(u.X(this.bounds.getNorth())*a),x=Math.ceil(u.Y(this.bounds.getEast())*a),E=Math.ceil(u.X(this.bounds.getSouth())*a);return e.x>=d&&e.x<x&&e.y>=g&&e.y<E}}class Ss extends u.E{constructor(e,a,d,g){if(super(),this.id=e,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.e(this,u.U(a,["url","scheme","tileSize","promoteId","encoding"])),this._options=u.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(g)}load(){return u._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new u.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield Ts(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),e&&(u.e(this,e),e.bounds&&(this.tileBounds=new Us(e.bounds,this.minzoom,this.maxzoom)),this.fire(new u.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this._loaded=!0,this.fire(new u.k(e))}}))}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return u.e({},this._options)}loadTile(e){return u._(this,void 0,void 0,(function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d={request:this.map._requestManager.transformRequest(a,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,encoding:this.encoding,overzoomParameters:this._getOverzoomParameters(e)};d.request.collectResourceTiming=this._collectResourceTiming;let g="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise(((x,E)=>{e.reloadPromise={resolve:x,reject:E}}))}else e.actor=this.dispatcher.getActor(),g="LT";e.abortController=new AbortController;try{const x=yield e.actor.sendAsync({type:g,data:d},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,x)}catch(x){if(delete e.abortController,e.aborted)return;if(x&&x.status!==404)throw x;this._afterTileLoadWorkerResponse(e,null)}}))}_getOverzoomParameters(e){if(e.tileID.canonical.z<=this.maxzoom||this.map._zoomLevelsToOverscale===void 0)return;const a=e.tileID.scaledTo(this.maxzoom).canonical,d=a.url(this.tiles,this.map.getPixelRatio(),this.scheme);return{maxZoomTileID:a,overzoomRequest:this.map._requestManager.transformRequest(d,"Tile")}}_afterTileLoadWorkerResponse(e,a){if(a&&a.resourceTiming&&(e.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&e.setExpiryData(a),e.loadVectorData(a,this.map.painter),e.reloadPromise){const d=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(d.resolve).catch(d.reject)}}abortTile(e){return u._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}unloadTile(e){return u._(this,void 0,void 0,(function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class To extends u.E{constructor(e,a,d,g){super(),this.id=e,this.dispatcher=d,this.setEventedParent(g),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.e({type:"raster"},a),u.e(this,u.U(a,["url","scheme","tileSize"]))}load(){return u._(this,arguments,void 0,(function*(e=!1){this._loaded=!1,this.fire(new u.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const a=yield Ts(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,a&&(u.e(this,a),a.bounds&&(this.tileBounds=new Us(a.bounds,this.minzoom,this.maxzoom)),this.fire(new u.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(a){this._tileJSONRequest=null,this._loaded=!0,this.fire(new u.k(a))}}))}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}serialize(){return u.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return u._(this,void 0,void 0,(function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const d=yield Nt.getImage(this.map._requestManager.transformRequest(a,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(d&&d.data){this.map._refreshExpiredTiles&&(d.cacheControl||d.expires)&&e.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const g=this.map.painter.context,x=g.gl,E=d.data;e.texture=this.map.painter.getTileTexture(E.width),e.texture?e.texture.update(E,{useMipmap:!0}):(e.texture=new u.T(g,E,x.RGBA,{useMipmap:!0}),e.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(d){if(delete e.abortController,e.aborted)e.state="unloaded";else if(d)throw e.state="errored",d}}))}abortTile(e){return u._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)}))}unloadTile(e){return u._(this,void 0,void 0,(function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)}))}hasTransition(){return!1}}class da extends To{constructor(e,a,d,g){super(e,a,d,g),this.type="raster-dem",this.maxzoom=22,this._options=u.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(e){return u._(this,void 0,void 0,(function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d=this.map._requestManager.transformRequest(a,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const g=yield Nt.getImage(d,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(g&&g.data){const x=g.data;this.map._refreshExpiredTiles&&(g.cacheControl||g.expires)&&e.setExpiryData({cacheControl:g.cacheControl,expires:g.expires});const E=u.b(x)&&u.Z()?x:yield this.readImageNow(x),P={type:this.type,uid:e.uid,source:this.id,rawImageData:E,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const R=yield e.actor.sendAsync({type:"LDT",data:P});e.dem=R,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(g){if(delete e.abortController,e.aborted)e.state="unloaded";else if(g)throw e.state="errored",g}}))}readImageNow(e){return u._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&u.$()){const a=e.width+2,d=e.height+2;try{return new u.R({width:a,height:d},yield u.a0(e,-1,-1,a,d))}catch{}}return it.getImageData(e,1)}))}_getNeighboringTiles(e){const a=e.canonical,d=Math.pow(2,a.z),g=(a.x-1+d)%d,x=a.x===0?e.wrap-1:e.wrap,E=(a.x+1+d)%d,P=a.x+1===d?e.wrap+1:e.wrap,R={};return R[new u.a1(e.overscaledZ,x,a.z,g,a.y).key]={backfilled:!1},R[new u.a1(e.overscaledZ,P,a.z,E,a.y).key]={backfilled:!1},a.y>0&&(R[new u.a1(e.overscaledZ,x,a.z,g,a.y-1).key]={backfilled:!1},R[new u.a1(e.overscaledZ,e.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},R[new u.a1(e.overscaledZ,P,a.z,E,a.y-1).key]={backfilled:!1}),a.y+1<d&&(R[new u.a1(e.overscaledZ,x,a.z,g,a.y+1).key]={backfilled:!1},R[new u.a1(e.overscaledZ,e.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},R[new u.a1(e.overscaledZ,P,a.z,E,a.y+1).key]={backfilled:!1}),R}unloadTile(e){return u._(this,void 0,void 0,(function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))}))}}function fa(v){return v.type==="GeometryCollection"?v.geometries.map((e=>e.coordinates)).flat(1/0):v.coordinates.flat(1/0)}function So(v){const e=new ui;let a;switch(v.type){case"FeatureCollection":a=v.features.map((d=>fa(d.geometry))).flat(1/0);break;case"Feature":a=fa(v.geometry);break;default:a=fa(v)}if(a.length==0)return e;for(let d=0;d<a.length-1;d+=2)e.extend([a[d],a[d+1]]);return e}class qi extends u.E{constructor(e,a,d,g){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:a.data},this.actor=d.getActor(),this.setEventedParent(g),this._data=typeof a.data=="string"?{url:a.data}:{geojson:a.data},this._options=u.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId,a.clusterMaxZoom!==void 0&&this.maxzoom<=a.clusterMaxZoom&&u.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${a.clusterMaxZoom}".`),this.workerOptions=u.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(a.buffer!==void 0?a.buffer:128),tolerance:this._pixelsToTileUnits(a.tolerance!==void 0?a.tolerance:.375),extent:u.a4,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(a.clusterMaxZoom),minPoints:Math.max(2,a.clusterMinPoints||2),extent:u.a4,radius:this._pixelsToTileUnits(a.clusterRadius||50),log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(e){return e*(u.a4/this.tileSize)}_getClusterMaxZoom(e){const a=e?Math.round(e):this.maxzoom-1;return Number.isInteger(e)||e===void 0||u.w(`Integer expected for option 'clusterMaxZoom': provided value "${e}" rounded to "${a}"`),a}load(){return u._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(e){this.map=e,this.load()}setData(e,a){this._data=typeof e=="string"?{url:e}:{geojson:e},this._pendingWorkerUpdate={data:e};const d=this._updateWorkerData();return a?d:this}updateData(e,a){this._pendingWorkerUpdate.diff=u.a5(this._pendingWorkerUpdate.diff,e);const d=this._updateWorkerData();return a?d:this}getData(){return u._(this,void 0,void 0,(function*(){const e=u.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})}))}getBounds(){return u._(this,void 0,void 0,(function*(){return So(yield this.getData())}))}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(e.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,a,d){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:a,offset:d}})}_updateWorkerData(){return u._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void u.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:e,diff:a}=this._pendingWorkerUpdate,d=u.e({type:this.type},this.workerOptions);e?(typeof e=="string"?(d.request=this.map._requestManager.transformRequest(it.resolveURL(e),"Source"),d.request.collectResourceTiming=this._collectResourceTiming):d.data=e,this._pendingWorkerUpdate.data=void 0):a&&(d.dataDiff=a,this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,this._isUpdatingWorker=!0,this.fire(new u.l("dataloading",{dataType:"source"}));try{const g=yield this.actor.sendAsync({type:"LD",data:d});if(this._isUpdatingWorker=!1,this._removed||g.abandoned)return void this.fire(new u.l("dataabort",{dataType:"source"}));g.applyDiff?this._applyDiff(a):this._data={geojson:g.data};let x=null;g.resourceTiming&&g.resourceTiming[this.id]&&(x=g.resourceTiming[this.id].slice(0));const E={dataType:"source"};this._collectResourceTiming&&x&&x.length>0&&u.e(E,{resourceTiming:x}),this.fire(new u.l("data",Object.assign(Object.assign({},E),{sourceDataType:"metadata"}))),this.fire(new u.l("data",Object.assign(Object.assign({},E),{sourceDataType:"content",shouldReloadTileOptions:this._getShouldReloadTileOptions(a)})))}catch(g){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new u.l("dataabort",{dataType:"source"}));this.fire(new u.k(g))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}}))}_applyDiff(e){const a=typeof this.promoteId=="string"?this.promoteId:void 0;this._data.url||this._data.updateable||!u.a6(this._data.geojson,a)||(this._data={updateable:u.a7(this._data.geojson,a)}),e&&this._data.updateable?u.a8(this._data.updateable,e,a):u.w("Cannot apply GeoJSONSource#updateData due to internal error")}_getShouldReloadTileOptions(e){if(this._options.cluster||!e||e.removeAll)return;const{add:a=[],update:d=[],remove:g=[]}=e||{},x=new Set([...d.map((E=>E.id)),...g]);for(const E of x.values())if(typeof E!="number"&&this.promoteId==null)return void u.w(`GeoJSONSource "${this.id}": updateData is slower when using string GeoJSON feature IDs (e.g. "${E}"). Consider using promoteId or numeric IDs for better performance.`);return{nextBounds:[...d.map((E=>E.newGeometry)),...a.map((E=>E.geometry))].filter(Boolean).map((E=>So(E))),prevIds:x}}shouldReloadTile(e,{nextBounds:a,prevIds:d}){if(!e.latestFeatureIndex)return e.state!=="unloaded";const g=e.latestFeatureIndex.loadVTLayers();for(let R=0;R<e.latestFeatureIndex.featureIndexArray.length;R++){const O=e.latestFeatureIndex.featureIndexArray.get(R),j=g[u.a9].feature(O.featureIndex),$=e.latestFeatureIndex.getId(j,u.a9);if(d.has($))return!0}const{buffer:x,extent:E}=this.workerOptions.geojsonVtOptions,P=(function({x:R,y:O,z:j},$=0){const q=u.a2((R-$)/Math.pow(2,j)),Q=u.a3((O+1+$)/Math.pow(2,j)),nt=u.a2((R+1+$)/Math.pow(2,j)),lt=u.a3((O-$)/Math.pow(2,j));return new ui([q,Q],[nt,lt])})(e.tileID.canonical,x/E);for(const R of a)if(P.intersects(R))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(e){return u._(this,void 0,void 0,(function*(){const a=e.actor?"RT":"LT";e.actor=this.actor;const d={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const g=yield this.actor.sendAsync({type:a,data:d},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(g,this.map.painter,a==="RT")}))}abortTile(e){return u._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0}))}unloadTile(e){return u._(this,void 0,void 0,(function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return u.e({},this._options,{type:this.type,data:this._data.updateable?{type:"FeatureCollection",features:Array.from(this._data.updateable.values())}:this._data.url||this._data.geojson})}hasTransition(){return!1}}class Hr extends u.E{constructor(e,a,d,g){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=d,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(g),this.options=a}load(e){return u._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new u.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield Nt.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,e&&(this.coordinates=e),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,this.fire(new u.k(a))}}))}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const a=e.map(u.aa.fromLngLat);var d;return this.tileID=(function(g){const x=u.ab.fromPoints(g),E=x.width(),P=x.height(),R=Math.max(E,P),O=Math.max(0,Math.floor(-Math.log(R)/Math.LN2)),j=Math.pow(2,O);return new u.ad(O,Math.floor((x.minX+x.maxX)/2*j),Math.floor((x.minY+x.maxY)/2*j))})(a),this.terrainTileRanges=this._getOverlappingTileRanges(a),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=a.map((g=>this.tileID.getTilePoint(g)._round())),this.flippedWindingOrder=((d=this.tileCoords)[1].x-d[0].x)*(d[2].y-d[0].y)-(d[1].y-d[0].y)*(d[2].x-d[0].x)<0,this.fire(new u.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,a=e.gl;this.texture||(this.texture=new u.T(e,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let d=!1;for(const g in this.tiles){const x=this.tiles[g];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,d=!0)}d&&this.fire(new u.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return u._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){const{minX:a,minY:d,maxX:g,maxY:x}=u.ab.fromPoints(e),E={};for(let P=0;P<=u.ac;P++){const R=Math.pow(2,P),O=Math.floor(a*R),j=Math.floor(d*R),$=Math.floor(g*R),q=Math.floor(x*R);E[P]={minTileX:O,minTileY:j,maxTileX:$,maxTileY:q}}return E}}class nc extends Hr{constructor(e,a,d,g){super(e,a,d,g),this.roundZoom=!0,this.type="video",this.options=a}load(){return u._(this,void 0,void 0,(function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const a of e.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield u.ae(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new u.k(a))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const a=this.video.seekable;e<a.start(0)||e>a.end(0)?this.fire(new u.k(new u.af(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,a=e.gl;this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new u.T(e,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let d=!1;for(const g in this.tiles){const x=this.tiles[g];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,d=!0)}d&&this.fire(new u.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ic extends Hr{constructor(e,a,d,g){super(e,a,d,g),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some((x=>!Array.isArray(x)||x.length!==2||x.some((E=>typeof E!="number"))))||this.fire(new u.k(new u.af(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.k(new u.af(`sources.${e}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new u.k(new u.af(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new u.k(new u.af(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.k(new u.af(`sources.${e}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return u._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,d=a.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new u.T(a,this.canvas,d.RGBA,{premultiply:!0});let g=!1;for(const x in this.tiles){const E=this.tiles[x];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,g=!0)}g&&this.fire(new u.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",animate:this.animate,canvas:this.options.canvas,coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const pa={},rc=v=>{switch(v){case"geojson":return qi;case"image":return Hr;case"raster":return To;case"raster-dem":return da;case"vector":return Ss;case"video":return nc;case"canvas":return ic}return pa[v]},Ga="RTLPluginLoaded";class sc extends u.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=br()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch((a=>{throw this.status="error",a}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return u._(this,arguments,void 0,(function*(a,d=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=it.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!d)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return u._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new u.l(Ga))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let ol=null;function Ir(){return ol||(ol=new sc),ol}var ri,Ct;(function(v){v[v.Base=0]="Base",v[v.Parent=1]="Parent"})(ri||(ri={})),(function(v){v[v.Departing=0]="Departing",v[v.Incoming=1]="Incoming"})(Ct||(Ct={}));class K{constructor(e,a){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=e,this.uid=u.ag(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(e){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(e||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:e,fadingDirection:a,fadingParentID:d,fadeEndTime:g}){this.resetFadeLogic(),this.fadingRole=e,this.fadingDirection=a,this.fadingParentID=d,this.fadeEndTime=g}setSelfFadeLogic(e){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=e}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=rt(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,a,d){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData,this.latestFeatureIndex.encoding=e.encoding):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData,this.latestFeatureIndex.encoding=this.latestEncoding)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=(function(g,x){const E={};if(!x)return E;for(const P of g){const R=P.layerIds.map((O=>x.getLayer(O))).filter(Boolean);if(R.length!==0){P.layers=R,P.stateDependentLayerIds&&(P.stateDependentLayers=P.stateDependentLayerIds.map((O=>R.filter((j=>j.id===O))[0])));for(const O of R)E[O.id]=P}}return E})(e.buckets,a?.style),this.hasSymbolBuckets=!1;for(const g in this.buckets){const x=this.buckets[g];if(x instanceof u.ai){if(this.hasSymbolBuckets=!0,!d)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const g in this.buckets){const x=this.buckets[g];if(x instanceof u.ai&&x.hasRTLText){this.hasRTLText=!0,Ir().lazyLoad();break}}this.queryPadding=0;for(const g in this.buckets){const x=this.buckets[g];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(g).queryRadius(x))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),this.dashPositions=e.dashPositions}else this.collisionBoxArray=new u.ah}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const d in this.buckets){const g=this.buckets[d];g.uploadPending()&&g.upload(e)}const a=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new u.T(e,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new u.T(e,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,a,d,g,x,E,P,R,O,j,$){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:g,cameraQueryGeometry:x,scale:E,tileSize:this.tileSize,pixelPosMatrix:j,transform:R,params:P,queryPadding:this.queryPadding*O,getElevation:$},e,a,d):{}}querySourceFeatures(e,a){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const g=d.loadVTLayers(),x=a&&a.sourceLayer?a.sourceLayer:"",E=g[u.a9]||g[x];if(!E)return;const P=u.aj(a?.filter,a?.globalState),{z:R,x:O,y:j}=this.tileID.canonical,$={z:R,x:O,y:j};for(let q=0;q<E.length;q++){const Q=E.feature(q);if(P.needGeometry){const ut=u.ak(Q,!0);if(!P.filter(new u.H(this.tileID.overscaledZ),ut,this.tileID.canonical))continue}else if(!P.filter(new u.H(this.tileID.overscaledZ),Q))continue;const nt=d.getId(Q,x),lt=new u.al(Q,R,O,j,nt);lt.tile=$,e.push(lt)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const a=this.expirationTime;if(e.cacheControl){const d=u.am(e.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const d=Date.now();let g=!1;if(this.expirationTime>d)g=!1;else if(a)if(this.expirationTime<a)g=!0;else{const x=this.expirationTime-a;x?this.expirationTime=d+Math.max(x,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const d=this.latestFeatureIndex.loadVTLayers();for(const g in this.buckets){if(!a.style.hasLayer(g))continue;const x=this.buckets[g],E=x.layers[0].sourceLayer||u.a9,P=d[E],R=e[E];if(!P||!R||Object.keys(R).length===0)continue;x.update(R,P,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const O=a&&a.style&&a.style.getLayer(g);O&&(this.queryPadding=Math.max(this.queryPadding,O.queryRadius(x)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<rt()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(e){this.symbolFadeHoldUntil=rt()+e}setDependencies(e,a){const d={};for(const g of a)d[g]=!0;this.dependencies[e]=d}hasDependency(e,a){for(const d of e){const g=this.dependencies[d];if(g){for(const x of a)if(g[x])return!0}}return!1}}class et{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,a,d){const g=String(a);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][g]=this.stateChanges[e][g]||{},u.e(this.stateChanges[e][g],d),this.deletedStates[e]===null){this.deletedStates[e]={};for(const x in this.state[e])x!==g&&(this.deletedStates[e][x]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][g]===null){this.deletedStates[e][g]={};for(const x in this.state[e][g])d[x]||(this.deletedStates[e][g][x]=null)}else for(const x in d)this.deletedStates[e]&&this.deletedStates[e][g]&&this.deletedStates[e][g][x]===null&&delete this.deletedStates[e][g][x]}removeFeatureState(e,a,d){if(this.deletedStates[e]===null)return;const g=String(a);if(this.deletedStates[e]=this.deletedStates[e]||{},d&&a!==void 0)this.deletedStates[e][g]!==null&&(this.deletedStates[e][g]=this.deletedStates[e][g]||{},this.deletedStates[e][g][d]=null);else if(a!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][g])for(d in this.deletedStates[e][g]={},this.stateChanges[e][g])this.deletedStates[e][g][d]=null;else this.deletedStates[e][g]=null;else this.deletedStates[e]=null}getState(e,a){const d=String(a),g=u.e({},(this.state[e]||{})[d],(this.stateChanges[e]||{})[d]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const x=this.deletedStates[e][a];if(x===null)return{};for(const E in x)delete g[E]}return g}initializeTileState(e,a){e.setFeatureState(this.state,a)}coalesceChanges(e,a){const d={};for(const g in this.stateChanges){this.state[g]=this.state[g]||{};const x={};for(const E in this.stateChanges[g])this.state[g][E]||(this.state[g][E]={}),u.e(this.state[g][E],this.stateChanges[g][E]),x[E]=this.state[g][E];d[g]=x}for(const g in this.deletedStates){this.state[g]=this.state[g]||{};const x={};if(this.deletedStates[g]===null)for(const E in this.state[g])x[E]={},this.state[g][E]={};else for(const E in this.deletedStates[g]){if(this.deletedStates[g][E]===null)this.state[g][E]={};else for(const P of Object.keys(this.deletedStates[g][E]))delete this.state[g][E][P];x[E]=this.state[g][E]}d[g]=d[g]||{},u.e(d[g],x)}if(this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0)for(const g in e)e[g].setFeatureState(d,a)}}const st=89.25;function vt(v,e){const a=u.an(e.lat,-u.ao,u.ao);return new u.P(u.Y(e.lng)*v,u.X(a)*v)}function wt(v,e){return new u.aa(e.x/v,e.y/v).toLngLat()}function Ft(v){return v.cameraToCenterDistance*Math.min(.85*Math.tan(u.ap(90-v.pitch)),Math.tan(u.ap(st-v.pitch)))}function ht(v,e){const a=v.canonical,d=e/u.aq(a.z),g=a.x+Math.pow(2,a.z)*v.wrap,x=u.ar(new Float64Array(16));return u.O(x,x,[g*d,a.y*d,0]),u.Q(x,x,[d/u.a4,d/u.a4,1]),x}function It(v,e,a,d,g){const x=u.aa.fromLngLat(v,e),E=g*u.as(1,v.lat),P=E*Math.cos(u.ap(a)),R=Math.sqrt(E*E-P*P),O=R*Math.sin(u.ap(-d)),j=R*Math.cos(u.ap(-d));return new u.aa(x.x+O,x.y+j,x.z+P)}function Xt(v,e,a){const d=e.intersectsFrustum(v);if(!a||d===0)return d;const g=e.intersectsPlane(a);return g===0?0:d===2&&g===2?2:1}function Wt(v,e,a){let d=0;const g=(a-e)/10;for(let x=0;x<10;x++)d+=g*Math.pow(Math.cos(e+(x+.5)/10*(a-e)),v);return d}function te(v,e){return function(a,d,g,x,E){const P=2*((v-1)/u.at(Math.cos(u.ap(st-E))/Math.cos(u.ap(st)))-1),R=Math.acos(g/x),O=2*Wt(P-1,0,u.ap(E/2)),j=Math.min(u.ap(st),R+u.ap(E/2)),$=Wt(P-1,Math.min(j,R-u.ap(E/2)),j),q=Math.atan(d/g),Q=Math.hypot(d,g);let nt=a;return nt+=u.at(x/Q/Math.max(.5,Math.cos(u.ap(E/2)))),nt+=P*u.at(Math.cos(q))/2,nt-=u.at(Math.max(1,$/O/e))/2,nt}}const Pe=te(9.314,3);function Oe(v,e){const a=(e.roundZoom?Math.round:Math.floor)(v.zoom+u.at(v.tileSize/e.tileSize));return Math.max(0,a)}function Qe(v,e){const a=v.getCameraFrustum(),d=v.getClippingPlane(),g=v.screenPointToMercatorCoordinate(v.getCameraPoint()),x=u.aa.fromLngLat(v.center,v.elevation);g.z=x.z+Math.cos(v.pitchInRadians)*v.cameraToCenterDistance/v.worldSize;const E=v.getCoveringTilesDetailsProvider(),P=E.allowVariableZoom(v,e),R=Oe(v,e),O=e.minzoom||0,j=e.maxzoom!==void 0?e.maxzoom:v.maxZoom,$=Math.min(Math.max(0,R),j),q=Math.pow(2,$),Q=[q*g.x,q*g.y,0],nt=[q*x.x,q*x.y,0],lt=Math.hypot(x.x-g.x,x.y-g.y),ut=Math.abs(x.z-g.z),ft=Math.hypot(lt,ut),_t=St=>({zoom:0,x:0,y:0,wrap:St,fullyVisible:!1}),Tt=[],gt=[];if(v.renderWorldCopies&&E.allowWorldCopies())for(let St=1;St<=3;St++)Tt.push(_t(-St)),Tt.push(_t(St));for(Tt.push(_t(0));Tt.length>0;){const St=Tt.pop(),At=St.x,xt=St.y;let zt=St.fullyVisible;const $t={x:At,y:xt,z:St.zoom},Vt=E.getTileBoundingVolume($t,St.wrap,v.elevation,e);if(!zt){const ye=Xt(a,Vt,d);if(ye===0)continue;zt=ye===2}const Ut=E.distanceToTile2d(g.x,g.y,$t,Vt);let qt=R;P&&(qt=(e.calculateTileZoom||Pe)(v.zoom+u.at(v.tileSize/e.tileSize),Ut,ut,ft,v.fov)),qt=(e.roundZoom?Math.round:Math.floor)(qt),qt=Math.max(0,qt);const ge=Math.min(qt,j);if(St.wrap=E.getWrap(x,$t,St.wrap),St.zoom>=ge){if(St.zoom<O)continue;const ye=$-St.zoom,oe=Q[0]-.5-(At<<ye),De=Q[1]-.5-(xt<<ye),tn=e.reparseOverscaled?Math.max(St.zoom,qt):St.zoom;gt.push({tileID:new u.a1(St.zoom===j?tn:St.zoom,St.wrap,St.zoom,At,xt),distanceSq:u.au([nt[0]-.5-At,nt[1]-.5-xt]),tileDistanceToCamera:Math.sqrt(oe*oe+De*De)})}else for(let ye=0;ye<4;ye++)Tt.push({zoom:St.zoom+1,x:(At<<1)+ye%2,y:(xt<<1)+(ye>>1),wrap:St.wrap,fullyVisible:zt})}return gt.sort(((St,At)=>St.distanceSq-At.distanceSq)).map((St=>St.tileID))}const mi=u.ab.fromPoints([new u.P(0,0),new u.P(u.a4,u.a4)]);class ln extends u.E{constructor(e,a,d){super(),this.id=e,this.dispatcher=d,this.on("data",(g=>this._dataHandler(g))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((g,x,E,P)=>{const R=new(rc(x.type))(g,x,E,P);if(R.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${R.id}`);return R})(e,a,d,this),this._tiles={},this._cache=new u.av(0,(g=>this._unloadTile(g))),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new et,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const a=this._tiles[e];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,a,d){return u._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,a,d)}catch(g){e.state="errored",g.status!==404?this._source.fire(new u.k(g,{tile:e})):this.update(this.transform,this.terrain)}}))}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new u.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const d=this._tiles[a];d.upload(e),d.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((e=>e.tileID)).sort(En).map((e=>e.key))}getRenderableIds(e){const a=[];for(const d in this._tiles)this._isIdRenderable(d,e)&&a.push(this._tiles[d]);return e?a.sort(((d,g)=>{const x=d.tileID,E=g.tileID,P=new u.P(x.canonical.x,x.canonical.y)._rotate(-this.transform.bearingInRadians),R=new u.P(E.canonical.x,E.canonical.y)._rotate(-this.transform.bearingInRadians);return x.overscaledZ-E.overscaledZ||R.y-P.y||R.x-P.x})).map((d=>d.tileID.key)):a.map((d=>d.tileID)).sort(En).map((d=>d.key))}hasRenderableParent(e){const a=e.overscaledZ-1;if(a>=this._source.minzoom){const d=this.getLoadedTile(e.scaledTo(a));if(d)return this._isIdRenderable(d.tileID.key)}return!1}_isIdRenderable(e,a=!1){var d;return(d=this._tiles[e])===null||d===void 0?void 0:d.isRenderable(a)}reload(e,a=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const d in this._tiles)a&&this._source.shouldReloadTile&&!this._source.shouldReloadTile(this._tiles[d],a)||(e?this._reloadTile(d,"expired"):this._tiles[d].state!=="errored"&&this._reloadTile(d,"reloading"))}}_reloadTile(e,a){return u._(this,void 0,void 0,(function*(){const d=this._tiles[e];d&&(d.state!=="loading"&&(d.state=a),yield this._loadTile(d,e,a))}))}_tileLoaded(e,a,d){e.timeAdded=rt(),e.selfFading&&(e.fadeEndTime=e.timeAdded+this._rasterFadeDuration),d==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(a,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new u.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const a=this.getRenderableIds();for(let g=0;g<a.length;g++){const x=a[g];if(e.neighboringTiles&&e.neighboringTiles[x]){const E=this.getTileByID(x);d(e,E),d(E,e)}}function d(g,x){g.needsHillshadePrepare=!0,g.needsTerrainPrepare=!0;let E=x.tileID.canonical.x-g.tileID.canonical.x;const P=x.tileID.canonical.y-g.tileID.canonical.y,R=Math.pow(2,g.tileID.canonical.z),O=x.tileID.key;E===0&&P===0||Math.abs(P)>1||(Math.abs(E)>1&&(Math.abs(E+R)===1?E+=R:Math.abs(E-R)===1&&(E-=R)),x.dem&&g.dem&&(g.dem.backfillBorder(x.dem,E,P),g.neighboringTiles&&g.neighboringTiles[O]&&(g.neighboringTiles[O].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,a){const d=this._getLoadedDescendents(a),g=new Set;for(const x of a){const E=d[x.key];if(!E?.length){g.add(x);continue}const P=x.overscaledZ+ln.maxOverzooming,R=E.filter(($=>$.tileID.overscaledZ<=P));if(!R.length){g.add(x);continue}const O=Math.min(...R.map(($=>$.tileID.overscaledZ))),j=R.filter(($=>$.tileID.overscaledZ===O)).map(($=>$.tileID));for(const $ of j)e[$.key]=$;this._areDescendentsComplete(j,O,x.overscaledZ)||g.add(x)}return g}_getLoadedDescendents(e){var a;const d={};for(const g in this._tiles){const x=this._tiles[g];if(x.hasData())for(const E of e)x.tileID.isChildOf(E)&&(d[a=E.key]||(d[a]=[])).push(x)}return d}_areDescendentsComplete(e,a,d){return e.length===1&&e[0].isOverscaled()?e[0].overscaledZ===a:Math.pow(4,a-d)===e.length}getLoadedTile(e){const a=this._tiles[e.key];return a?.hasData()?a:null}updateCacheSize(e){const a=Math.ceil(e.width/this._source.tileSize)+1,d=Math.ceil(e.height/this._source.tileSize)+1,g=Math.floor(a*d*(this._maxTileCacheZoomLevels===null?u.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(x)}handleWrapJump(e){const a=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,a){const d={};for(const g in this._tiles){const x=this._tiles[g];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+a),d[x.tileID.key]=x}this._tiles=d,this._resetTileReloadTimers()}}update(e,a){if(!this._sourceLoaded||this._paused)return;let d;this.transform=e,this.terrain=a,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?d=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((R=>new u.a1(R.canonical.z,R.wrap,R.canonical.z,R.canonical.x,R.canonical.y))):(d=Qe(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.type==="vector"&&this.map._zoomLevelsToOverscale!==void 0?e.maxZoom-this.map._zoomLevelsToOverscale:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(d=d.filter((R=>this._source.hasTile(R))))):d=[],this.usedForTerrain&&(d=this._addTerrainIdealTiles(d));const g=d.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,g&&this.fire(new u.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const x=Oe(e,this._source),E=this._updateRetainedTiles(d,x),P=Un(this._source.type);P&&this._rasterFadeDuration>0&&!a&&this._updateFadingTiles(d,E),P?this._cleanUpRasterTiles(E):this._cleanUpVectorTiles(E)}_cleanUpRasterTiles(e){for(const a in this._tiles)e[a]||this._removeTile(a)}_cleanUpVectorTiles(e){for(const a in this._tiles){const d=this._tiles[a];e[a]?d.clearSymbolFadeHold():d.hasSymbolBuckets?d.holdingForSymbolFade()?d.symbolFadeFinished()&&this._removeTile(a):d.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(a)}}_addTerrainIdealTiles(e){const a=[];for(const d of e)if(d.canonical.z>this._source.minzoom){const g=d.scaledTo(d.canonical.z-1);a.push(g);const x=d.scaledTo(Math.max(this._source.minzoom,Math.min(d.canonical.z,5)));a.push(x)}return e.concat(a)}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForSymbolFade()&&this._removeTile(e)}_updateRetainedTiles(e,a){var d;const g=new Set;for(const O of e)this._addTile(O).hasData()||g.add(O);const x=e.reduce(((O,j)=>(O[j.key]=j,O)),{}),E=this._retainLoadedChildren(x,g),P={},R=Math.max(a-ln.maxUnderzooming,this._source.minzoom);for(const O of E){let j=this._tiles[O.key],$=j?.wasRequested();for(let q=O.overscaledZ-1;q>=R;--q){const Q=O.scaledTo(q);if(P[Q.key])break;if(P[Q.key]=!0,j=this.getTile(Q),!j&&$&&(j=this._addTile(Q)),j){const nt=j.hasData();if((nt||!(!((d=this.map)===null||d===void 0)&&d.cancelPendingTileRequestsWhileZooming)||$)&&(x[Q.key]=Q),$=j.wasRequested(),nt)break}}}return x}_updateFadingTiles(e,a){const d=rt(),g=u.aw(e);for(const x of e){const E=this._tiles[x.key];E.fadingDirection!==Ct.Departing&&E.fadeOpacity!==0||E.resetFadeLogic(),this._updateFadingAncestor(E,a,d)||this._updateFadingDescendents(E,a,d)||this._updateFadingEdge(E,g,d)||E.resetFadeLogic()}}_updateFadingAncestor(e,a,d){if(!e.hasData())return!1;const{tileID:g,fadingRole:x,fadingDirection:E,fadingParentID:P}=e;if(x===ri.Base&&E===Ct.Incoming&&P)return a[P.key]=P,!0;const R=Math.max(g.overscaledZ-this._maxFadingAncestorLevels,this._source.minzoom);for(let O=g.overscaledZ-1;O>=R;O--){const j=g.scaledTo(O),$=this.getLoadedTile(j);if($)return e.setCrossFadeLogic({fadingRole:ri.Base,fadingDirection:Ct.Incoming,fadingParentID:$.tileID,fadeEndTime:d+this._rasterFadeDuration}),$.setCrossFadeLogic({fadingRole:ri.Parent,fadingDirection:Ct.Departing,fadeEndTime:d+this._rasterFadeDuration}),a[j.key]=j,!0}return!1}_updateFadingDescendents(e,a,d){if(!e.hasData())return!1;const g=e.tileID.children(this._source.maxzoom);let x=this._updateFadingChildren(e,g,a,d);if(x)return!0;for(const E of g){const P=E.children(this._source.maxzoom);this._updateFadingChildren(e,P,a,d)&&(x=!0)}return x}_updateFadingChildren(e,a,d,g){if(a[0].overscaledZ>=this._source.maxzoom)return!1;let x=!1;for(const E of a){const P=this.getLoadedTile(E);if(!P)continue;const{fadingRole:R,fadingDirection:O,fadingParentID:j}=P;R===ri.Base&&O===Ct.Departing&&j||(P.setCrossFadeLogic({fadingRole:ri.Base,fadingDirection:Ct.Departing,fadingParentID:e.tileID,fadeEndTime:g+this._rasterFadeDuration}),e.setCrossFadeLogic({fadingRole:ri.Parent,fadingDirection:Ct.Incoming,fadeEndTime:g+this._rasterFadeDuration})),d[E.key]=E,x=!0}return x}_updateFadingEdge(e,a,d){const g=e.tileID;return!!e.selfFading||!e.hasData()&&!!a.has(g)&&(e.setSelfFadeLogic(d+this._rasterFadeDuration),!0)}_addTile(e){let a=this._tiles[e.key];if(a)return a;a=this._cache.getAndRemove(e),a&&(a.resetFadeLogic(),this._setTileReloadTimer(e.key,a),a.tileID=e,this._state.initializeTileState(a,this.map?this.map.painter:null));const d=a;return a||(a=new K(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(a,e.key,a.state)),a.uses++,this._tiles[e.key]=a,d||this._source.fire(new u.l("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(e,a){this._clearTileReloadTimer(e);const d=a.getExpiryTimeout();d&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),d))}_clearTileReloadTimer(e){const a=this._timers[e];a&&(clearTimeout(a),delete this._timers[e])}_resetTileReloadTimers(){for(const e in this._timers)clearTimeout(this._timers[e]),delete this._timers[e];for(const e in this._tiles)this._setTileReloadTimer(e,this._tiles[e])}refreshTiles(e){for(const a in this._tiles)(this._isIdRenderable(a)||this._tiles[a].state=="errored")&&e.some((d=>d.equals(this._tiles[a].tileID.canonical)))&&this._reloadTile(a,"expired")}_removeTile(e){const a=this._tiles[e];a&&(a.uses--,delete this._tiles[e],this._clearTileReloadTimer(e),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(e){e.dataType==="source"&&(e.sourceDataType!=="metadata"?e.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(e.sourceDataChanged,e.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,a,d){const g=[],x=this.transform;if(!x)return g;const E=x.getCoveringTilesDetailsProvider().allowWorldCopies(),P=d?x.getCameraQueryGeometry(e):e,R=Q=>x.screenPointToMercatorCoordinate(Q,this.terrain),O=this.transformBbox(e,R,!E),j=this.transformBbox(P,R,!E),$=this.getIds(),q=u.ab.fromPoints(j);for(let Q=0;Q<$.length;Q++){const nt=this._tiles[$[Q]];if(nt.holdingForSymbolFade())continue;const lt=E?[nt.tileID]:[nt.tileID.unwrapTo(-1),nt.tileID.unwrapTo(0)],ut=Math.pow(2,x.zoom-nt.tileID.overscaledZ),ft=a*nt.queryPadding*u.a4/nt.tileSize/ut;for(const _t of lt){const Tt=q.map((gt=>_t.getTilePoint(new u.aa(gt.x,gt.y))));if(Tt.expandBy(ft),Tt.intersects(mi)){const gt=O.map((At=>_t.getTilePoint(At))),St=j.map((At=>_t.getTilePoint(At)));g.push({tile:nt,tileID:E?_t:_t.unwrapTo(0),queryGeometry:gt,cameraQueryGeometry:St,scale:ut})}}}return g}transformBbox(e,a,d){let g=e.map(a);if(d){const x=u.ab.fromPoints(e);x.shrinkBy(.001*Math.min(x.width(),x.height()));const E=x.map(a);u.ab.fromPoints(g).covers(E)||(g=g.map((P=>P.x>.5?new u.aa(P.x-1,P.y,P.z):P)))}return g}getVisibleCoordinates(e){const a=this.getRenderableIds(e).map((d=>this._tiles[d].tileID));return this.transform&&this.transform.populateCache(a),a}hasTransition(){if(this._source.hasTransition())return!0;if(Un(this._source.type)&&this._rasterFadeDuration>0){const e=rt();for(const a in this._tiles)if(this._tiles[a].fadeEndTime>=e)return!0}return!1}setRasterFadeDuration(e){this._rasterFadeDuration=e}setFeatureState(e,a,d){this._state.updateState(e=e||u.a9,a,d)}removeFeatureState(e,a,d){this._state.removeFeatureState(e=e||u.a9,a,d)}getFeatureState(e,a){return this._state.getState(e=e||u.a9,a)}setDependencies(e,a,d){const g=this._tiles[e];g&&g.setDependencies(a,d)}reloadTilesForDependencies(e,a){for(const d in this._tiles)this._tiles[d].hasDependency(e,a)&&this._reloadTile(d,"reloading");this._cache.filter((d=>!d.hasDependency(e,a)))}}function En(v,e){const a=Math.abs(2*v.wrap)-+(v.wrap<0),d=Math.abs(2*e.wrap)-+(e.wrap<0);return v.overscaledZ-e.overscaledZ||d-a||e.canonical.y-v.canonical.y||e.canonical.x-v.canonical.x}function Un(v){return v==="raster"||v==="image"||v==="video"}ln.maxUnderzooming=10,ln.maxOverzooming=3;class pe{constructor(e,a){this.reset(e,a)}reset(e,a){this.points=e||[],this._distances=[0];for(let d=1;d<this.points.length;d++)this._distances[d]=this._distances[d-1]+this.points[d].dist(this.points[d-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=u.an(e,0,1);let a=1,d=this._distances[a];const g=e*this.paddedLength+this.padding;for(;d<g&&a<this._distances.length;)d=this._distances[++a];const x=a-1,E=this._distances[x],P=d-E,R=P>0?(g-E)/P:0;return this.points[x].mult(1-R).add(this.points[a].mult(R))}}function Gn(v,e){let a=!0;return v==="always"||v!=="never"&&e!=="never"||(a=!1),a}class qn{constructor(e,a,d){const g=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(e/d),this.yCellCount=Math.ceil(a/d);for(let E=0;E<this.xCellCount*this.yCellCount;E++)g.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=a,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,a,d,g,x){this._forEachCell(a,d,g,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(a),this.bboxes.push(d),this.bboxes.push(g),this.bboxes.push(x)}insertCircle(e,a,d,g){this._forEachCell(a-g,d-g,a+g,d+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(a),this.circles.push(d),this.circles.push(g)}_insertBoxCell(e,a,d,g,x,E){this.boxCells[x].push(E)}_insertCircleCell(e,a,d,g,x,E){this.circleCells[x].push(E)}_query(e,a,d,g,x,E,P){if(d<0||e>this.width||g<0||a>this.height)return[];const R=[];if(e<=0&&a<=0&&this.width<=d&&this.height<=g){if(x)return[{key:null,x1:e,y1:a,x2:d,y2:g}];for(let O=0;O<this.boxKeys.length;O++)R.push({key:this.boxKeys[O],x1:this.bboxes[4*O],y1:this.bboxes[4*O+1],x2:this.bboxes[4*O+2],y2:this.bboxes[4*O+3]});for(let O=0;O<this.circleKeys.length;O++){const j=this.circles[3*O],$=this.circles[3*O+1],q=this.circles[3*O+2];R.push({key:this.circleKeys[O],x1:j-q,y1:$-q,x2:j+q,y2:$+q})}}else this._forEachCell(e,a,d,g,this._queryCell,R,{hitTest:x,overlapMode:E,seenUids:{box:{},circle:{}}},P);return R}query(e,a,d,g){return this._query(e,a,d,g,!1,null)}hitTest(e,a,d,g,x,E){return this._query(e,a,d,g,!0,x,E).length>0}hitTestCircle(e,a,d,g,x){const E=e-d,P=e+d,R=a-d,O=a+d;if(P<0||E>this.width||O<0||R>this.height)return!1;const j=[];return this._forEachCell(E,R,P,O,this._queryCellCircle,j,{hitTest:!0,overlapMode:g,circle:{x:e,y:a,radius:d},seenUids:{box:{},circle:{}}},x),j.length>0}_queryCell(e,a,d,g,x,E,P,R){const{seenUids:O,hitTest:j,overlapMode:$}=P,q=this.boxCells[x];if(q!==null){const nt=this.bboxes;for(const lt of q)if(!O.box[lt]){O.box[lt]=!0;const ut=4*lt,ft=this.boxKeys[lt];if(e<=nt[ut+2]&&a<=nt[ut+3]&&d>=nt[ut+0]&&g>=nt[ut+1]&&(!R||R(ft))&&(!j||!Gn($,ft.overlapMode))&&(E.push({key:ft,x1:nt[ut],y1:nt[ut+1],x2:nt[ut+2],y2:nt[ut+3]}),j))return!0}}const Q=this.circleCells[x];if(Q!==null){const nt=this.circles;for(const lt of Q)if(!O.circle[lt]){O.circle[lt]=!0;const ut=3*lt,ft=this.circleKeys[lt];if(this._circleAndRectCollide(nt[ut],nt[ut+1],nt[ut+2],e,a,d,g)&&(!R||R(ft))&&(!j||!Gn($,ft.overlapMode))){const _t=nt[ut],Tt=nt[ut+1],gt=nt[ut+2];if(E.push({key:ft,x1:_t-gt,y1:Tt-gt,x2:_t+gt,y2:Tt+gt}),j)return!0}}}return!1}_queryCellCircle(e,a,d,g,x,E,P,R){const{circle:O,seenUids:j,overlapMode:$}=P,q=this.boxCells[x];if(q!==null){const nt=this.bboxes;for(const lt of q)if(!j.box[lt]){j.box[lt]=!0;const ut=4*lt,ft=this.boxKeys[lt];if(this._circleAndRectCollide(O.x,O.y,O.radius,nt[ut+0],nt[ut+1],nt[ut+2],nt[ut+3])&&(!R||R(ft))&&!Gn($,ft.overlapMode))return E.push(!0),!0}}const Q=this.circleCells[x];if(Q!==null){const nt=this.circles;for(const lt of Q)if(!j.circle[lt]){j.circle[lt]=!0;const ut=3*lt,ft=this.circleKeys[lt];if(this._circlesCollide(nt[ut],nt[ut+1],nt[ut+2],O.x,O.y,O.radius)&&(!R||R(ft))&&!Gn($,ft.overlapMode))return E.push(!0),!0}}}_forEachCell(e,a,d,g,x,E,P,R){const O=this._convertToXCellCoord(e),j=this._convertToYCellCoord(a),$=this._convertToXCellCoord(d),q=this._convertToYCellCoord(g);for(let Q=O;Q<=$;Q++)for(let nt=j;nt<=q;nt++)if(x.call(this,e,a,d,g,this.xCellCount*nt+Q,E,P,R))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,a,d,g,x,E){const P=g-e,R=x-a,O=d+E;return O*O>P*P+R*R}_circleAndRectCollide(e,a,d,g,x,E,P){const R=(E-g)/2,O=Math.abs(e-(g+R));if(O>R+d)return!1;const j=(P-x)/2,$=Math.abs(a-(x+j));if($>j+d)return!1;if(O<=R||$<=j)return!0;const q=O-R,Q=$-j;return q*q+Q*Q<=d*d}}function Ai(v,e,a){const d=u.N();if(!v){const{vecSouth:$,vecEast:q}=ce(e),Q=k();Q[0]=q[0],Q[1]=q[1],Q[2]=$[0],Q[3]=$[1],g=Q,(j=(E=(x=Q)[0])*(O=x[3])-(R=x[2])*(P=x[1]))&&(g[0]=O*(j=1/j),g[1]=-P*j,g[2]=-R*j,g[3]=E*j),d[0]=Q[0],d[1]=Q[1],d[4]=Q[2],d[5]=Q[3]}var g,x,E,P,R,O,j;return u.Q(d,d,[1/a,1/a,1]),d}function Cn(v,e,a,d){if(v){const g=u.N();if(!e){const{vecSouth:x,vecEast:E}=ce(a);g[0]=E[0],g[1]=E[1],g[4]=x[0],g[5]=x[1]}return u.Q(g,g,[d,d,1]),g}return a.pixelsToClipSpaceMatrix}function ce(v){const e=Math.cos(v.rollInRadians),a=Math.sin(v.rollInRadians),d=Math.cos(v.pitchInRadians),g=Math.cos(v.bearingInRadians),x=Math.sin(v.bearingInRadians),E=u.aB();E[0]=-g*d*a-x*e,E[1]=-x*d*a+g*e;const P=u.aC(E);P<1e-9?u.aD(E):u.aE(E,E,1/P);const R=u.aB();R[0]=g*d*e-x*a,R[1]=x*d*e+g*a;const O=u.aC(R);return O<1e-9?u.aD(R):u.aE(R,R,1/O),{vecEast:R,vecSouth:E}}function Ce(v,e,a,d){let g;d?(g=[v,e,d(v,e),1],u.aG(g,g,a)):(g=[v,e,0,1],nu(g,g,a));const x=g[3];return{point:new u.P(g[0]/x,g[1]/x),signedDistanceFromCamera:x,isOccluded:!1}}function Ne(v,e){return .5+v/e*.5}function wr(v,e){return v.x>=-e[0]&&v.x<=e[0]&&v.y>=-e[1]&&v.y<=e[1]}function ll(v,e,a,d,g,x,E,P,R,O,j,$,q){const Q=a?v.textSizeData:v.iconSizeData,nt=u.ax(Q,e.transform.zoom),lt=[256/e.width*2+1,256/e.height*2+1],ut=a?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;ut.clear();const ft=v.lineVertexArray,_t=a?v.text.placedSymbolArray:v.icon.placedSymbolArray,Tt=e.transform.width/e.transform.height;let gt=!1;for(let St=0;St<_t.length;St++){const At=_t.get(St);if(At.hidden||At.writingMode===u.ay.vertical&&!gt){zr(At.numGlyphs,ut);continue}gt=!1;const xt=new u.P(At.anchorX,At.anchorY),zt={getElevation:q,pitchedLabelPlaneMatrix:d,lineVertexArray:ft,pitchWithMap:x,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:xt,unwrappedTileID:R,width:O,height:j,translation:$},$t=Zs(At.anchorX,At.anchorY,zt);if(!wr($t.point,lt)){zr(At.numGlyphs,ut);continue}const Vt=Ne(e.transform.cameraToCenterDistance,$t.signedDistanceFromCamera),Ut=u.az(Q,nt,At),qt=x?Ut*e.transform.getPitchedTextCorrection(At.anchorX,At.anchorY,R)/Vt:Ut*Vt,ge=ls({projectionContext:zt,pitchedLabelPlaneMatrixInverse:g,symbol:At,fontSize:qt,flip:!1,keepUpright:E,glyphOffsetArray:v.glyphOffsetArray,dynamicLayoutVertexArray:ut,aspectRatio:Tt,rotateToLine:P});gt=ge.useVertical,(ge.notEnoughRoom||gt||ge.needsFlipping&&ls({projectionContext:zt,pitchedLabelPlaneMatrixInverse:g,symbol:At,fontSize:qt,flip:!0,keepUpright:E,glyphOffsetArray:v.glyphOffsetArray,dynamicLayoutVertexArray:ut,aspectRatio:Tt,rotateToLine:P}).notEnoughRoom)&&zr(At.numGlyphs,ut)}a?v.text.dynamicLayoutVertexBuffer.updateData(ut):v.icon.dynamicLayoutVertexBuffer.updateData(ut)}function nr(v,e,a,d,g,x,E,P){const R=x.glyphStartIndex+x.numGlyphs,O=x.lineStartIndex,j=x.lineStartIndex+x.lineLength,$=e.getoffsetX(x.glyphStartIndex),q=e.getoffsetX(R-1),Q=Zn(v*$,a,d,g,x.segment,O,j,P,E);if(!Q)return null;const nt=Zn(v*q,a,d,g,x.segment,O,j,P,E);return nt?P.projectionCache.anyProjectionOccluded?null:{first:Q,last:nt}:null}function Ye(v,e,a,d){return v===u.ay.horizontal&&Math.abs(a.y-e.y)>Math.abs(a.x-e.x)*d?{useVertical:!0}:(v===u.ay.vertical?e.y<a.y:e.x>a.x)?{needsFlipping:!0}:null}function ls(v){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:a,symbol:d,fontSize:g,flip:x,keepUpright:E,glyphOffsetArray:P,dynamicLayoutVertexArray:R,aspectRatio:O,rotateToLine:j}=v,$=g/24,q=d.lineOffsetX*$,Q=d.lineOffsetY*$;let nt;if(d.numGlyphs>1){const lt=d.glyphStartIndex+d.numGlyphs,ut=d.lineStartIndex,ft=d.lineStartIndex+d.lineLength,_t=nr($,P,q,Q,x,d,j,e);if(!_t)return{notEnoughRoom:!0};const Tt=qs(_t.first.point.x,_t.first.point.y,e,a),gt=qs(_t.last.point.x,_t.last.point.y,e,a);if(E&&!x){const St=Ye(d.writingMode,Tt,gt,O);if(St)return St}nt=[_t.first];for(let St=d.glyphStartIndex+1;St<lt-1;St++){const At=Zn($*P.getoffsetX(St),q,Q,x,d.segment,ut,ft,e,j);if(!At)return{notEnoughRoom:!0};nt.push(At)}nt.push(_t.last)}else{if(E&&!x){const ut=Tr(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,ft=d.lineStartIndex+d.segment+1,_t=new u.P(e.lineVertexArray.getx(ft),e.lineVertexArray.gety(ft)),Tt=Tr(_t.x,_t.y,e),gt=Tt.signedDistanceFromCamera>0?Tt.point:Eo(e.tileAnchorPoint,_t,ut,1,e),St=qs(ut.x,ut.y,e,a),At=qs(gt.x,gt.y,e,a),xt=Ye(d.writingMode,St,At,O);if(xt)return xt}const lt=Zn($*P.getoffsetX(d.glyphStartIndex),q,Q,x,d.segment,d.lineStartIndex,d.lineStartIndex+d.lineLength,e,j);if(!lt||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};nt=[lt]}for(const lt of nt)u.aF(R,lt.point,lt.angle);return{}}function Eo(v,e,a,d,g){const x=v.add(v.sub(e)._unit()),E=Tr(x.x,x.y,g).point,P=a.sub(E);return a.add(P._mult(d/P.mag()))}function Gs(v,e,a){const d=e.projectionCache;if(d.projections[v])return d.projections[v];const g=new u.P(e.lineVertexArray.getx(v),e.lineVertexArray.gety(v)),x=Tr(g.x,g.y,e);if(x.signedDistanceFromCamera>0)return d.projections[v]=x.point,d.anyProjectionOccluded=d.anyProjectionOccluded||x.isOccluded,x.point;const E=v-a.direction;return Eo(a.distanceFromAnchor===0?e.tileAnchorPoint:new u.P(e.lineVertexArray.getx(E),e.lineVertexArray.gety(E)),g,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,e)}function Tr(v,e,a){const d=v+a.translation[0],g=e+a.translation[1];let x;return a.pitchWithMap?(x=Ce(d,g,a.pitchedLabelPlaneMatrix,a.getElevation),x.isOccluded=!1):(x=a.transform.projectTileCoordinates(d,g,a.unwrappedTileID,a.getElevation),x.point.x=(.5*x.point.x+.5)*a.width,x.point.y=(.5*-x.point.y+.5)*a.height),x}function qs(v,e,a,d){if(a.pitchWithMap){const g=[v,e,0,1];return u.aG(g,g,d),a.transform.projectTileCoordinates(g[0]/g[3],g[1]/g[3],a.unwrappedTileID,a.getElevation).point}return{x:v/a.width*2-1,y:1-e/a.height*2}}function Zs(v,e,a){return a.transform.projectTileCoordinates(v,e,a.unwrappedTileID,a.getElevation)}function gi(v,e,a){return v._unit()._perp()._mult(e*a)}function Xr(v,e,a,d,g,x,E,P,R){if(P.projectionCache.offsets[v])return P.projectionCache.offsets[v];const O=a.add(e);if(v+R.direction<d||v+R.direction>=g)return P.projectionCache.offsets[v]=O,O;const j=Gs(v+R.direction,P,R),$=gi(j.sub(a),E,R.direction),q=a.add($),Q=j.add($);return P.projectionCache.offsets[v]=u.aH(x,O,q,Q)||O,P.projectionCache.offsets[v]}function Zn(v,e,a,d,g,x,E,P,R){const O=d?v-e:v+e;let j=O>0?1:-1,$=0;d&&(j*=-1,$=Math.PI),j<0&&($+=Math.PI);let q,Q=j>0?x+g:x+g+1;P.projectionCache.cachedAnchorPoint?q=P.projectionCache.cachedAnchorPoint:(q=Tr(P.tileAnchorPoint.x,P.tileAnchorPoint.y,P).point,P.projectionCache.cachedAnchorPoint=q);let nt,lt,ut=q,ft=q,_t=0,Tt=0;const gt=Math.abs(O),St=[];let At;for(;_t+Tt<=gt;){if(Q+=j,Q<x||Q>=E)return null;_t+=Tt,ft=ut,lt=nt;const $t={absOffsetX:gt,direction:j,distanceFromAnchor:_t,previousVertex:ft};if(ut=Gs(Q,P,$t),a===0)St.push(ft),At=ut.sub(ft);else{let Vt;const Ut=ut.sub(ft);Vt=Ut.mag()===0?gi(Gs(Q+j,P,$t).sub(ut),a,j):gi(Ut,a,j),lt||(lt=ft.add(Vt)),nt=Xr(Q,Vt,ut,x,E,lt,a,P,$t),St.push(lt),At=nt.sub(lt)}Tt=At.mag()}const xt=At._mult((gt-_t)/Tt)._add(lt||ft),zt=$+Math.atan2(ut.y-ft.y,ut.x-ft.x);return St.push(xt),{point:xt,angle:R?zt:0,path:St}}const cl=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function zr(v,e){for(let a=0;a<v;a++){const d=e.length;e.resize(d+4),e.float32.set(cl,3*d)}}function nu(v,e,a){const d=e[0],g=e[1];return v[0]=a[0]*d+a[4]*g+a[12],v[1]=a[1]*d+a[5]*g+a[13],v[3]=a[3]*d+a[7]*g+a[15],v}const si=100;class qa{constructor(e,a=new qn(e.width+200,e.height+200,25),d=new qn(e.width+200,e.height+200,25)){this.transform=e,this.grid=a,this.ignoredGrid=d,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+si,this.screenBottomBoundary=e.height+si,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,a,d,g,x,E,P,R,O,j,$,q){const Q=this.projectAndGetPerspectiveRatio(e.anchorPointX+R[0],e.anchorPointY+R[1],x,j,q),nt=d*Q.perspectiveRatio;let lt;if(E||P)lt=this._projectCollisionBox(e,nt,g,x,E,P,R,Q,j,$,q);else{const At=Q.x+($?$.x*nt:0),xt=Q.y+($?$.y*nt:0);lt={allPointsOccluded:!1,box:[At+e.x1*nt,xt+e.y1*nt,At+e.x2*nt,xt+e.y2*nt]}}const[ut,ft,_t,Tt]=lt.box,gt=E?lt.allPointsOccluded:Q.isOccluded;let St=gt;return St||(St=Q.perspectiveRatio<this.perspectiveRatioCutoff),St||(St=!this.isInsideGrid(ut,ft,_t,Tt)),St||a!=="always"&&this.grid.hitTest(ut,ft,_t,Tt,a,O)?{box:[ut,ft,_t,Tt],placeable:!1,offscreen:!1,occluded:gt}:{box:[ut,ft,_t,Tt],placeable:!0,offscreen:this.isOffscreen(ut,ft,_t,Tt),occluded:gt}}placeCollisionCircles(e,a,d,g,x,E,P,R,O,j,$,q,Q,nt){const lt=[],ut=new u.P(a.anchorX,a.anchorY),ft=this.getPerspectiveRatio(ut.x,ut.y,E,nt),_t=(O?x*this.transform.getPitchedTextCorrection(a.anchorX,a.anchorY,E)/ft:x*ft)/u.aL,Tt={getElevation:nt,pitchedLabelPlaneMatrix:P,lineVertexArray:d,pitchWithMap:O,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ut,unwrappedTileID:E,width:this.transform.width,height:this.transform.height,translation:Q},gt=nr(_t,g,a.lineOffsetX*_t,a.lineOffsetY*_t,!1,a,!1,Tt);let St=!1,At=!1,xt=!0;if(gt){const zt=.5*$*ft+q,$t=new u.P(-100,-100),Vt=new u.P(this.screenRightBoundary,this.screenBottomBoundary),Ut=new pe,qt=gt.first,ge=gt.last;let ye=[];for(let tn=qt.path.length-1;tn>=1;tn--)ye.push(qt.path[tn]);for(let tn=1;tn<ge.path.length;tn++)ye.push(ge.path[tn]);const oe=2.5*zt;if(O){const tn=this.projectPathToScreenSpace(ye,Tt);ye=tn.some((Ke=>Ke.signedDistanceFromCamera<=0))?[]:tn.map((Ke=>Ke.point))}let De=[];if(ye.length>0){const tn=ye[0].clone(),Ke=ye[0].clone();for(let ei=1;ei<ye.length;ei++)tn.x=Math.min(tn.x,ye[ei].x),tn.y=Math.min(tn.y,ye[ei].y),Ke.x=Math.max(Ke.x,ye[ei].x),Ke.y=Math.max(Ke.y,ye[ei].y);De=tn.x>=$t.x&&Ke.x<=Vt.x&&tn.y>=$t.y&&Ke.y<=Vt.y?[ye]:Ke.x<$t.x||tn.x>Vt.x||Ke.y<$t.y||tn.y>Vt.y?[]:u.aI([ye],$t.x,$t.y,Vt.x,Vt.y)}for(const tn of De){Ut.reset(tn,.25*zt);let Ke=0;Ke=Ut.length<=.5*zt?1:Math.ceil(Ut.paddedLength/oe)+1;for(let ei=0;ei<Ke;ei++){const Hn=ei/Math.max(Ke-1,1),li=Ut.lerp(Hn),Vn=li.x+si,Ii=li.y+si;lt.push(Vn,Ii,zt,0);const ii=Vn-zt,_i=Ii-zt,vi=Vn+zt,Ti=Ii+zt;if(xt=xt&&this.isOffscreen(ii,_i,vi,Ti),At=At||this.isInsideGrid(ii,_i,vi,Ti),e!=="always"&&this.grid.hitTestCircle(Vn,Ii,zt,e,j)&&(St=!0,!R))return{circles:[],offscreen:!1,collisionDetected:St}}}}return{circles:!R&&St||!At||ft<this.perspectiveRatioCutoff?[]:lt,offscreen:xt,collisionDetected:St}}projectPathToScreenSpace(e,a){const d=(function(g,x){const E=u.N();return u.aA(E,x.pitchedLabelPlaneMatrix),g.map((P=>{const R=Ce(P.x,P.y,E,x.getElevation),O=x.transform.projectTileCoordinates(R.point.x,R.point.y,x.unwrappedTileID,x.getElevation);return O.point.x=(.5*O.point.x+.5)*x.width,O.point.y=(.5*-O.point.y+.5)*x.height,O}))})(e,a);return(function(g){let x=0,E=0,P=0,R=0;for(let O=0;O<g.length;O++)g[O].isOccluded?(P=O+1,R=0):(R++,R>E&&(E=R,x=P));return g.slice(x,x+E)})(d)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[],d=new u.ab;for(const $ of e){const q=new u.P($.x+si,$.y+si);d.extend(q),a.push(q)}const{minX:g,minY:x,maxX:E,maxY:P}=d,R=this.grid.query(g,x,E,P).concat(this.ignoredGrid.query(g,x,E,P)),O={},j={};for(const $ of R){const q=$.key;if(O[q.bucketInstanceId]===void 0&&(O[q.bucketInstanceId]={}),O[q.bucketInstanceId][q.featureIndex])continue;const Q=[new u.P($.x1,$.y1),new u.P($.x2,$.y1),new u.P($.x2,$.y2),new u.P($.x1,$.y2)];u.aJ(a,Q)&&(O[q.bucketInstanceId][q.featureIndex]=!0,j[q.bucketInstanceId]===void 0&&(j[q.bucketInstanceId]=[]),j[q.bucketInstanceId].push(q.featureIndex))}return j}insertCollisionBox(e,a,d,g,x,E){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:x,collisionGroupID:E,overlapMode:a},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,a,d,g,x,E){const P=d?this.ignoredGrid:this.grid,R={bucketInstanceId:g,featureIndex:x,collisionGroupID:E,overlapMode:a};for(let O=0;O<e.length;O+=4)P.insertCircle(R,e[O],e[O+1],e[O+2])}projectAndGetPerspectiveRatio(e,a,d,g,x){if(x){let E;g?(E=[e,a,g(e,a),1],u.aG(E,E,x)):(E=[e,a,0,1],nu(E,E,x));const P=E[3];return{x:(E[0]/P+1)/2*this.transform.width+si,y:(-E[1]/P+1)/2*this.transform.height+si,perspectiveRatio:.5+this.transform.cameraToCenterDistance/P*.5,isOccluded:!1,signedDistanceFromCamera:P}}{const E=this.transform.projectTileCoordinates(e,a,d,g);return{x:(E.point.x+1)/2*this.transform.width+si,y:(1-E.point.y)/2*this.transform.height+si,perspectiveRatio:.5+this.transform.cameraToCenterDistance/E.signedDistanceFromCamera*.5,isOccluded:E.isOccluded,signedDistanceFromCamera:E.signedDistanceFromCamera}}}getPerspectiveRatio(e,a,d,g){const x=this.transform.projectTileCoordinates(e,a,d,g);return .5+this.transform.cameraToCenterDistance/x.signedDistanceFromCamera*.5}isOffscreen(e,a,d,g){return d<si||e>=this.screenRightBoundary||g<si||a>this.screenBottomBoundary}isInsideGrid(e,a,d,g){return d>=0&&e<this.gridRightBoundary&&g>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const e=u.ar([]);return u.O(e,e,[-100,-100,0]),e}_projectCollisionBox(e,a,d,g,x,E,P,R,O,j,$){let q=1,Q=0,nt=0,lt=1;const ut=e.anchorPointX+P[0],ft=e.anchorPointY+P[1];if(E&&!x){const ye=this.projectAndGetPerspectiveRatio(ut+1,ft,g,O,$),oe=ye.x-R.x,De=Math.atan((ye.y-R.y)/oe)+(oe<0?Math.PI:0),tn=Math.sin(De),Ke=Math.cos(De);q=Ke,Q=tn,nt=-tn,lt=Ke}else if(!E&&x){const ye=ce(this.transform);q=ye.vecEast[0],Q=ye.vecEast[1],nt=ye.vecSouth[0],lt=ye.vecSouth[1]}let _t=R.x,Tt=R.y,gt=a;x&&(_t=ut,Tt=ft,gt=Math.pow(2,-(this.transform.zoom-d.overscaledZ)),gt*=this.transform.getPitchedTextCorrection(ut,ft,g),j||(gt*=u.an(.5+R.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),j&&(_t+=q*j.x*gt+nt*j.y*gt,Tt+=Q*j.x*gt+lt*j.y*gt);const St=e.x1*gt,At=e.x2*gt,xt=(St+At)/2,zt=e.y1*gt,$t=e.y2*gt,Vt=(zt+$t)/2,Ut=[{offsetX:St,offsetY:zt},{offsetX:xt,offsetY:zt},{offsetX:At,offsetY:zt},{offsetX:At,offsetY:Vt},{offsetX:At,offsetY:$t},{offsetX:xt,offsetY:$t},{offsetX:St,offsetY:$t},{offsetX:St,offsetY:Vt}];let qt=[];for(const{offsetX:ye,offsetY:oe}of Ut)qt.push(new u.P(_t+q*ye+nt*oe,Tt+Q*ye+lt*oe));let ge=!1;if(x){const ye=qt.map((oe=>this.projectAndGetPerspectiveRatio(oe.x,oe.y,g,O,$)));ge=ye.some((oe=>!oe.isOccluded)),qt=ye.map((oe=>new u.P(oe.x,oe.y)))}else ge=!0;return{box:u.aK(qt),allPointsOccluded:!ge}}}class xd{constructor(e,a,d,g){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?a:-a))):g&&d?1:0,this.placed=d}isHidden(){return this.opacity===0&&!this.placed}}class Za{constructor(e,a,d,g,x){this.text=new xd(e?e.text:null,a,d,x),this.icon=new xd(e?e.icon:null,a,g,x)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ac{constructor(e,a,d){this.text=e,this.icon=a,this.skipFade=d}}class Yr{constructor(e,a,d,g,x){this.bucketInstanceId=e,this.featureIndex=a,this.sourceLayerIndex=d,this.bucketIndex=g,this.tileID=x}}class cs{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const a=++this.maxGroupID;this.collisionGroups[e]={ID:a,predicate:d=>d.collisionGroupID===a}}return this.collisionGroups[e]}}function bd(v,e,a,d,g){const{horizontalAlign:x,verticalAlign:E}=u.aR(v);return new u.P(-(x-.5)*e+d[0]*g,-(E-.5)*a+d[1]*g)}class Tm{constructor(e,a,d,g,x){this.transform=e.clone(),this.terrain=a,this.collisionIndex=new qa(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new cs(g),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const a=this.terrain;return a?(d,g)=>a.getElevation(e,d,g):null}getBucketParts(e,a,d,g){const x=d.getBucket(a),E=d.latestFeatureIndex;if(!x||!E||a.id!==x.layerIds[0])return;const P=d.collisionBoxArray,R=x.layers[0].layout,O=x.layers[0].paint,j=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),$=d.tileSize/u.a4,q=d.tileID.toUnwrapped(),Q=R.get("text-rotation-alignment")==="map",nt=u.aM(d,1,this.transform.zoom),lt=u.aN(this.collisionIndex.transform,d,O.get("text-translate"),O.get("text-translate-anchor")),ut=u.aN(this.collisionIndex.transform,d,O.get("icon-translate"),O.get("icon-translate-anchor")),ft=Ai(Q,this.transform,nt);this.retainedQueryData[x.bucketInstanceId]=new Yr(x.bucketInstanceId,E,x.sourceLayerIndex,x.index,d.tileID);const _t={bucket:x,layout:R,translationText:lt,translationIcon:ut,unwrappedTileID:q,pitchedLabelPlaneMatrix:ft,scale:j,textPixelRatio:$,holdingForFade:d.holdingForSymbolFade(),collisionBoxArray:P,partiallyEvaluatedTextSize:u.ax(x.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(g)for(const Tt of x.sortKeyRanges){const{sortKey:gt,symbolInstanceStart:St,symbolInstanceEnd:At}=Tt;e.push({sortKey:gt,symbolInstanceStart:St,symbolInstanceEnd:At,parameters:_t})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:_t})}attemptAnchorPlacement(e,a,d,g,x,E,P,R,O,j,$,q,Q,nt,lt,ut,ft,_t,Tt,gt){const St=u.aO[e.textAnchor],At=[e.textOffset0,e.textOffset1],xt=bd(St,d,g,At,x),zt=this.collisionIndex.placeCollisionBox(a,q,R,O,j,P,E,ut,$.predicate,Tt,xt,gt);if((!_t||this.collisionIndex.placeCollisionBox(_t,q,R,O,j,P,E,ft,$.predicate,Tt,xt,gt).placeable)&&zt.placeable){let $t;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Q.crossTileID]&&this.prevPlacement.placements[Q.crossTileID]&&this.prevPlacement.placements[Q.crossTileID].text&&($t=this.prevPlacement.variableOffsets[Q.crossTileID].anchor),Q.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Q.crossTileID]={textOffset:At,width:d,height:g,anchor:St,textBoxScale:x,prevAnchor:$t},this.markUsedJustification(nt,St,Q,lt),nt.allowVerticalPlacement&&(this.markUsedOrientation(nt,lt,Q),this.placedOrientations[Q.crossTileID]=lt),{shift:xt,placedGlyphBoxes:zt}}}placeLayerBucketPart(e,a,d){const{bucket:g,layout:x,translationText:E,translationIcon:P,unwrappedTileID:R,pitchedLabelPlaneMatrix:O,textPixelRatio:j,holdingForFade:$,collisionBoxArray:q,partiallyEvaluatedTextSize:Q,collisionGroup:nt}=e.parameters,lt=x.get("text-optional"),ut=x.get("icon-optional"),ft=u.aP(x,"text-overlap","text-allow-overlap"),_t=ft==="always",Tt=u.aP(x,"icon-overlap","icon-allow-overlap"),gt=Tt==="always",St=x.get("text-rotation-alignment")==="map",At=x.get("text-pitch-alignment")==="map",xt=x.get("icon-text-fit")!=="none",zt=x.get("symbol-z-order")==="viewport-y",$t=_t&&(gt||!g.hasIconData()||ut),Vt=gt&&(_t||!g.hasTextData()||lt);!g.collisionArrays&&q&&g.deserializeCollisionBoxes(q);const Ut=this.retainedQueryData[g.bucketInstanceId].tileID,qt=this._getTerrainElevationFunc(Ut),ge=this.transform.getFastPathSimpleProjectionMatrix(Ut),ye=(oe,De,tn)=>{var Ke,ei;if(a[oe.crossTileID])return;if($)return void(this.placements[oe.crossTileID]=new ac(!1,!1,!1));let Hn=!1,li=!1,Vn=!0,Ii=null,ii={box:null,placeable:!1,offscreen:null,occluded:!1},_i={placeable:!1},vi=null,Ti=null,Sr=null,ka=0,Js=0,qo=0;De.textFeatureIndex?ka=De.textFeatureIndex:oe.useRuntimeCollisionCircles&&(ka=oe.featureIndex),De.verticalTextFeatureIndex&&(Js=De.verticalTextFeatureIndex);const Oa=De.textBox;if(Oa){const is=fi=>{let Xn=u.ay.horizontal;if(g.allowVerticalPlacement&&!fi&&this.prevPlacement){const Si=this.prevPlacement.placedOrientations[oe.crossTileID];Si&&(this.placedOrientations[oe.crossTileID]=Si,Xn=Si,this.markUsedOrientation(g,Xn,oe))}return Xn},Na=(fi,Xn)=>{if(g.allowVerticalPlacement&&oe.numVerticalGlyphVertices>0&&De.verticalTextBox){for(const Si of g.writingModes)if(Si===u.ay.vertical?(ii=Xn(),_i=ii):ii=fi(),ii&&ii.placeable)break}else ii=fi()},Ll=oe.textAnchorOffsetStartIndex,kl=oe.textAnchorOffsetEndIndex;if(kl===Ll){const fi=(Xn,Si)=>{const On=this.collisionIndex.placeCollisionBox(Xn,ft,j,Ut,R,At,St,E,nt.predicate,qt,void 0,ge);return On&&On.placeable&&(this.markUsedOrientation(g,Si,oe),this.placedOrientations[oe.crossTileID]=Si),On};Na((()=>fi(Oa,u.ay.horizontal)),(()=>{const Xn=De.verticalTextBox;return g.allowVerticalPlacement&&oe.numVerticalGlyphVertices>0&&Xn?fi(Xn,u.ay.vertical):{box:null,offscreen:null}})),is(ii&&ii.placeable)}else{let fi=u.aO[(ei=(Ke=this.prevPlacement)===null||Ke===void 0?void 0:Ke.variableOffsets[oe.crossTileID])===null||ei===void 0?void 0:ei.anchor];const Xn=(On,ho,Zd)=>{const Cc=On.x2-On.x1,$d=On.y2-On.y1,fo=oe.textBoxScale,lp=xt&&Tt==="never"?ho:null;let Fa=null,Ac=ft==="never"?1:2,Oh="never";fi&&Ac++;for(let po=0;po<Ac;po++){for(let Br=Ll;Br<kl;Br++){const Nh=g.textAnchorOffsets.get(Br);if(fi&&Nh.textAnchor!==fi)continue;const Fh=this.attemptAnchorPlacement(Nh,On,Cc,$d,fo,St,At,j,Ut,R,nt,Oh,oe,g,Zd,E,P,lp,qt);if(Fh&&(Fa=Fh.placedGlyphBoxes,Fa&&Fa.placeable))return Hn=!0,Ii=Fh.shift,Fa}fi?fi=null:Oh=ft}return d&&!Fa&&(Fa={box:this.collisionIndex.placeCollisionBox(Oa,"always",j,Ut,R,At,St,E,nt.predicate,qt,void 0,ge).box,offscreen:!1,placeable:!1,occluded:!1}),Fa};Na((()=>Xn(Oa,De.iconBox,u.ay.horizontal)),(()=>{const On=De.verticalTextBox;return g.allowVerticalPlacement&&(!ii||!ii.placeable)&&oe.numVerticalGlyphVertices>0&&On?Xn(On,De.verticalIconBox,u.ay.vertical):{box:null,occluded:!0,offscreen:null}})),ii&&(Hn=ii.placeable,Vn=ii.offscreen);const Si=is(ii&&ii.placeable);if(!Hn&&this.prevPlacement){const On=this.prevPlacement.variableOffsets[oe.crossTileID];On&&(this.variableOffsets[oe.crossTileID]=On,this.markUsedJustification(g,On.anchor,oe,Si))}}}if(vi=ii,Hn=vi&&vi.placeable,Vn=vi&&vi.offscreen,oe.useRuntimeCollisionCircles&&oe.centerJustifiedTextSymbolIndex>=0){const is=g.text.placedSymbolArray.get(oe.centerJustifiedTextSymbolIndex),Na=u.az(g.textSizeData,Q,is),Ll=x.get("text-padding");Ti=this.collisionIndex.placeCollisionCircles(ft,is,g.lineVertexArray,g.glyphOffsetArray,Na,R,O,d,At,nt.predicate,oe.collisionCircleDiameter,Ll,E,qt),Ti.circles.length&&Ti.collisionDetected&&!d&&u.w("Collisions detected, but collision boxes are not shown"),Hn=_t||Ti.circles.length>0&&!Ti.collisionDetected,Vn=Vn&&Ti.offscreen}if(De.iconFeatureIndex&&(qo=De.iconFeatureIndex),De.iconBox){const is=Na=>this.collisionIndex.placeCollisionBox(Na,Tt,j,Ut,R,At,St,P,nt.predicate,qt,xt&&Ii?Ii:void 0,ge);_i&&_i.placeable&&De.verticalIconBox?(Sr=is(De.verticalIconBox),li=Sr.placeable):(Sr=is(De.iconBox),li=Sr.placeable),Vn=Vn&&Sr.offscreen}const Zo=lt||oe.numHorizontalGlyphVertices===0&&oe.numVerticalGlyphVertices===0,fs=ut||oe.numIconVertices===0;Zo||fs?fs?Zo||(li=li&&Hn):Hn=li&&Hn:li=Hn=li&&Hn;const ta=li&&Sr.placeable;if(Hn&&vi.placeable&&this.collisionIndex.insertCollisionBox(vi.box,ft,x.get("text-ignore-placement"),g.bucketInstanceId,_i&&_i.placeable&&Js?Js:ka,nt.ID),ta&&this.collisionIndex.insertCollisionBox(Sr.box,Tt,x.get("icon-ignore-placement"),g.bucketInstanceId,qo,nt.ID),Ti&&Hn&&this.collisionIndex.insertCollisionCircles(Ti.circles,ft,x.get("text-ignore-placement"),g.bucketInstanceId,ka,nt.ID),d&&this.storeCollisionData(g.bucketInstanceId,tn,De,vi,Sr,Ti),oe.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(g.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[oe.crossTileID]=new ac((Hn||$t)&&!vi?.occluded,(li||Vt)&&!Sr?.occluded,Vn||g.justReloaded),a[oe.crossTileID]=!0};if(zt){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const oe=g.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let De=oe.length-1;De>=0;--De){const tn=oe[De];ye(g.symbolInstances.get(tn),g.collisionArrays[tn],tn)}}else for(let oe=e.symbolInstanceStart;oe<e.symbolInstanceEnd;oe++)ye(g.symbolInstances.get(oe),g.collisionArrays[oe],oe);g.justReloaded=!1}storeCollisionData(e,a,d,g,x,E){if(d.textBox||d.iconBox){let P,R;this.collisionBoxArrays.has(e)?P=this.collisionBoxArrays.get(e):(P=new Map,this.collisionBoxArrays.set(e,P)),P.has(a)?R=P.get(a):(R={text:null,icon:null},P.set(a,R)),d.textBox&&(R.text=g.box),d.iconBox&&(R.icon=x.box)}if(E){let P=this.collisionCircleArrays[e];P===void 0&&(P=this.collisionCircleArrays[e]=[]);for(let R=0;R<E.circles.length;R+=4)P.push(E.circles[R+0]-si),P.push(E.circles[R+1]-si),P.push(E.circles[R+2]),P.push(E.collisionDetected?1:0)}}markUsedJustification(e,a,d,g){let x;x=g===u.ay.vertical?d.verticalPlacedTextSymbolIndex:{left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex}[u.aQ(a)];const E=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex,d.verticalPlacedTextSymbolIndex];for(const P of E)P>=0&&(e.text.placedSymbolArray.get(P).crossTileID=x>=0&&P!==x?0:d.crossTileID)}markUsedOrientation(e,a,d){const g=a===u.ay.horizontal||a===u.ay.horizontalOnly?a:0,x=a===u.ay.vertical?a:0,E=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex];for(const P of E)e.text.placedSymbolArray.get(P).placedOrientation=g;d.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).placedOrientation=x)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let d=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const g=a?a.symbolFadeChange(e):1,x=a?a.opacities:{},E=a?a.variableOffsets:{},P=a?a.placedOrientations:{};for(const R in this.placements){const O=this.placements[R],j=x[R];j?(this.opacities[R]=new Za(j,g,O.text,O.icon),d=d||O.text!==j.text.placed||O.icon!==j.icon.placed):(this.opacities[R]=new Za(null,g,O.text,O.icon,O.skipFade),d=d||O.text||O.icon)}for(const R in x){const O=x[R];if(!this.opacities[R]){const j=new Za(O,g,!1,!1);j.isHidden()||(this.opacities[R]=j,d=d||O.text.placed||O.icon.placed)}}for(const R in E)this.variableOffsets[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.variableOffsets[R]=E[R]);for(const R in P)this.placedOrientations[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.placedOrientations[R]=P[R]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");d?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:e)}updateLayerOpacities(e,a){const d={};for(const g of a){const x=g.getBucket(e);x&&g.latestFeatureIndex&&e.id===x.layerIds[0]&&this.updateBucketOpacities(x,g.tileID,d,g.collisionBoxArray)}}updateBucketOpacities(e,a,d,g){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const x=e.layers[0],E=x.layout,P=new Za(null,0,!1,!1,!0),R=E.get("text-allow-overlap"),O=E.get("icon-allow-overlap"),j=x._unevaluatedLayout.hasValue("text-variable-anchor")||x._unevaluatedLayout.hasValue("text-variable-anchor-offset"),$=E.get("text-rotation-alignment")==="map",q=E.get("text-pitch-alignment")==="map",Q=E.get("icon-text-fit")!=="none",nt=new Za(null,0,R&&(O||!e.hasIconData()||E.get("icon-optional")),O&&(R||!e.hasTextData()||E.get("text-optional")),!0);!e.collisionArrays&&g&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(g);const lt=(ft,_t,Tt)=>{for(let gt=0;gt<_t/4;gt++)ft.opacityVertexArray.emplaceBack(Tt);ft.hasVisibleVertices=ft.hasVisibleVertices||Tt!==ma},ut=this.collisionBoxArrays.get(e.bucketInstanceId);for(let ft=0;ft<e.symbolInstances.length;ft++){const _t=e.symbolInstances.get(ft),{numHorizontalGlyphVertices:Tt,numVerticalGlyphVertices:gt,crossTileID:St}=_t;let At=this.opacities[St];d[St]?At=P:At||(At=nt,this.opacities[St]=At),d[St]=!0;const xt=_t.numIconVertices>0,zt=this.placedOrientations[_t.crossTileID],$t=zt===u.ay.vertical,Vt=zt===u.ay.horizontal||zt===u.ay.horizontalOnly;if(Tt>0||gt>0){const qt=ul(At.text);lt(e.text,Tt,$t?ma:qt),lt(e.text,gt,Vt?ma:qt);const ge=At.text.isHidden();[_t.rightJustifiedTextSymbolIndex,_t.centerJustifiedTextSymbolIndex,_t.leftJustifiedTextSymbolIndex].forEach((De=>{De>=0&&(e.text.placedSymbolArray.get(De).hidden=ge||$t?1:0)})),_t.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(_t.verticalPlacedTextSymbolIndex).hidden=ge||Vt?1:0);const ye=this.variableOffsets[_t.crossTileID];ye&&this.markUsedJustification(e,ye.anchor,_t,zt);const oe=this.placedOrientations[_t.crossTileID];oe&&(this.markUsedJustification(e,"left",_t,oe),this.markUsedOrientation(e,oe,_t))}if(xt){const qt=ul(At.icon),ge=!(Q&&_t.verticalPlacedIconSymbolIndex&&$t);_t.placedIconSymbolIndex>=0&&(lt(e.icon,_t.numIconVertices,ge?qt:ma),e.icon.placedSymbolArray.get(_t.placedIconSymbolIndex).hidden=At.icon.isHidden()),_t.verticalPlacedIconSymbolIndex>=0&&(lt(e.icon,_t.numVerticalIconVertices,ge?ma:qt),e.icon.placedSymbolArray.get(_t.verticalPlacedIconSymbolIndex).hidden=At.icon.isHidden())}const Ut=ut&&ut.has(ft)?ut.get(ft):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const qt=e.collisionArrays[ft];if(qt){let ge=new u.P(0,0);if(qt.textBox||qt.verticalTextBox){let ye=!0;if(j){const oe=this.variableOffsets[St];oe?(ge=bd(oe.anchor,oe.width,oe.height,oe.textOffset,oe.textBoxScale),$&&ge._rotate(q?-this.transform.bearingInRadians:this.transform.bearingInRadians)):ye=!1}if(qt.textBox||qt.verticalTextBox){let oe;qt.textBox&&(oe=$t),qt.verticalTextBox&&(oe=Vt),lh(e.textCollisionBox.collisionVertexArray,At.text.placed,!ye||oe,Ut.text,ge.x,ge.y)}}if(qt.iconBox||qt.verticalIconBox){const ye=!!(!Vt&&qt.verticalIconBox);let oe;qt.iconBox&&(oe=ye),qt.verticalIconBox&&(oe=!ye),lh(e.iconCollisionBox.collisionVertexArray,At.icon.placed,oe,Ut.icon,Q?ge.x:0,Q?ge.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,a){const d=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*d>e}setStale(){this.stale=!0}}function lh(v,e,a,d,g,x){d&&d.length!==0||(d=[0,0,0,0]);const E=d[0]-si,P=d[1]-si,R=d[2]-si,O=d[3]-si;v.emplaceBack(e?1:0,a?1:0,g||0,x||0,E,P),v.emplaceBack(e?1:0,a?1:0,g||0,x||0,R,P),v.emplaceBack(e?1:0,a?1:0,g||0,x||0,R,O),v.emplaceBack(e?1:0,a?1:0,g||0,x||0,E,O)}const wd=Math.pow(2,25),iu=Math.pow(2,24),Td=Math.pow(2,17),Wr=Math.pow(2,16),ch=Math.pow(2,9),uh=Math.pow(2,8),ru=Math.pow(2,1);function ul(v){if(v.opacity===0&&!v.placed)return 0;if(v.opacity===1&&v.placed)return 4294967295;const e=v.placed?1:0,a=Math.floor(127*v.opacity);return a*wd+e*iu+a*Td+e*Wr+a*ch+e*uh+a*ru+e}const ma=0;class su{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,a,d,g,x){const E=this._bucketParts;for(;this._currentTileIndex<e.length;)if(a.getBucketParts(E,g,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort(((P,R)=>P.sortKey-R.sortKey)));this._currentPartIndex<E.length;)if(a.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,d),this._currentPartIndex++,x())return!0;return!1}}class hl{constructor(e,a,d,g,x,E,P,R){this.placement=new Tm(e,a,E,P,R),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(e,a,d){const g=rt(),x=()=>!this._forceFullPlacement&&rt()-g>2;for(;this._currentPlacementIndex>=0;){const E=a[e[this._currentPlacementIndex]],P=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=P)&&(!E.maxzoom||E.maxzoom>P)){if(this._inProgressLayer||(this._inProgressLayer=new su(E)),this._inProgressLayer.continuePlacement(d[E.source],this.placement,this._showCollisionBoxes,E,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const ga=512/u.a4/2;class Sd{constructor(e,a,d){this.tileID=e,this.bucketInstanceId=d,this._symbolsByKey={};const g=new Map;for(let x=0;x<a.length;x++){const E=a.get(x),P=E.key,R=g.get(P);R?R.push(E):g.set(P,[E])}for(const[x,E]of g){const P={positions:E.map((R=>({x:Math.floor(R.anchorX*ga),y:Math.floor(R.anchorY*ga)}))),crossTileIDs:E.map((R=>R.crossTileID))};if(P.positions.length>128){const R=new u.aS(P.positions.length,16,Uint16Array);for(const{x:O,y:j}of P.positions)R.add(O,j);R.finish(),delete P.positions,P.index=R}this._symbolsByKey[x]=P}}getScaledCoordinates(e,a){const{x:d,y:g,z:x}=this.tileID.canonical,{x:E,y:P,z:R}=a.canonical,O=ga/Math.pow(2,R-x),j=(P*u.a4+e.anchorY)*O,$=g*u.a4*ga;return{x:Math.floor((E*u.a4+e.anchorX)*O-d*u.a4*ga),y:Math.floor(j-$)}}findMatches(e,a,d){const g=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let x=0;x<e.length;x++){const E=e.get(x);if(E.crossTileID)continue;const P=this._symbolsByKey[E.key];if(!P)continue;const R=this.getScaledCoordinates(E,a);if(P.index){const O=P.index.range(R.x-g,R.y-g,R.x+g,R.y+g).sort();for(const j of O){const $=P.crossTileIDs[j];if(!d[$]){d[$]=!0,E.crossTileID=$;break}}}else if(P.positions)for(let O=0;O<P.positions.length;O++){const j=P.positions[O],$=P.crossTileIDs[O];if(Math.abs(j.x-R.x)<=g&&Math.abs(j.y-R.y)<=g&&!d[$]){d[$]=!0,E.crossTileID=$;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:e})=>e))}}class Gf{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ya{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const a=Math.round((e-this.lng)/360);if(a!==0)for(const d in this.indexes){const g=this.indexes[d],x={};for(const E in g){const P=g[E];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+a),x[P.tileID.key]=P}this.indexes[d]=x}this.lng=e}addBucket(e,a,d){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let x=0;x<a.symbolInstances.length;x++)a.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const g=this.usedCrossTileIDs[e.overscaledZ];for(const x in this.indexes){const E=this.indexes[x];if(Number(x)>e.overscaledZ)for(const P in E){const R=E[P];R.tileID.isChildOf(e)&&R.findMatches(a.symbolInstances,e,g)}else{const P=E[e.scaledTo(Number(x)).key];P&&P.findMatches(a.symbolInstances,e,g)}}for(let x=0;x<a.symbolInstances.length;x++){const E=a.symbolInstances.get(x);E.crossTileID||(E.crossTileID=d.generate(),g[E.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Sd(e,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(e,a){for(const d of a.getCrossTileIDsLists())for(const g of d)delete this.usedCrossTileIDs[e][g]}removeStaleBuckets(e){let a=!1;for(const d in this.indexes){const g=this.indexes[d];for(const x in g)e[g[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,g[x]),delete g[x],a=!0)}return a}}class dl{constructor(){this.layerIndexes={},this.crossTileIDs=new Gf,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,a,d){let g=this.layerIndexes[e.id];g===void 0&&(g=this.layerIndexes[e.id]=new ya);let x=!1;const E={};g.handleWrapJump(d);for(const P of a){const R=P.getBucket(e);R&&e.id===R.layerIds[0]&&(R.bucketInstanceId||(R.bucketInstanceId=++this.maxBucketInstanceId),g.addBucket(P.tileID,R,this.crossTileIDs)&&(x=!0),E[R.bucketInstanceId]=!0)}return g.removeStaleBuckets(E)&&(x=!0),x}pruneUnusedLayers(e){const a={};e.forEach((d=>{a[d]=!0}));for(const d in this.layerIndexes)a[d]||delete this.layerIndexes[d]}}var hn="void main() {fragColor=vec4(1.0);}";const Lr={prelude:rn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:rn("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:rn("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:rn(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:rn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:rn(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:rn(hn,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:rn(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:rn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:rn("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:rn("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:rn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:rn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:rn(hn,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:rn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:rn(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:rn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:rn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:rn(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:rn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:rn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:rn(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:rn(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:rn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:rn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:rn(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:rn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:rn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:rn(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:rn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:rn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:rn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:rn("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:rn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:rn("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:rn(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:rn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function rn(v,e){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d=e.match(/in ([\w]+) ([\w]+)/g),g=v.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=x?x.concat(g):g,P={};return{fragmentSource:v=v.replace(a,((R,O,j,$,q)=>(P[q]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_${q}
in ${j} ${$} ${q};
#else
uniform ${j} ${$} u_${q};
#endif
`:`
#ifdef HAS_UNIFORM_u_${q}
    ${j} ${$} ${q} = u_${q};
#endif
`))),vertexSource:e=e.replace(a,((R,O,j,$,q)=>{const Q=$==="float"?"vec2":"vec4",nt=q.match(/color/)?"color":Q;return P[q]?O==="define"?`
#ifndef HAS_UNIFORM_u_${q}
uniform lowp float u_${q}_t;
in ${j} ${Q} a_${q};
out ${j} ${$} ${q};
#else
uniform ${j} ${$} u_${q};
#endif
`:nt==="vec4"?`
#ifndef HAS_UNIFORM_u_${q}
    ${q} = a_${q};
#else
    ${j} ${$} ${q} = u_${q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${q}
    ${q} = unpack_mix_${nt}(a_${q}, u_${q}_t);
#else
    ${j} ${$} ${q} = u_${q};
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_${q}
uniform lowp float u_${q}_t;
in ${j} ${Q} a_${q};
#else
uniform ${j} ${$} u_${q};
#endif
`:nt==="vec4"?`
#ifndef HAS_UNIFORM_u_${q}
    ${j} ${$} ${q} = a_${q};
#else
    ${j} ${$} ${q} = u_${q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${q}
    ${j} ${$} ${q} = unpack_mix_${nt}(a_${q}, u_${q}_t);
#else
    ${j} ${$} ${q} = u_${q};
#endif
`})),staticAttributes:d,staticUniforms:E}}class _a{constructor(e,a,d){this.vertexBuffer=e,this.indexBuffer=a,this.segments=d}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var bi=u.aT([{name:"a_pos",type:"Int16",components:2}]);const Mi="#define PROJECTION_MERCATOR",Pi="mercator";class Li{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Pi}get shaderDefine(){return Mi}get shaderPreludeCode(){return Lr.projectionMercator}get vertexShaderPreludeCode(){return Lr.projectionMercator.vertexSource}get subdivisionGranularity(){return u.aU.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,a,d,g,x){if(this._cachedMesh)return this._cachedMesh;const E=new u.aV;E.emplaceBack(0,0),E.emplaceBack(u.a4,0),E.emplaceBack(0,u.a4),E.emplaceBack(u.a4,u.a4);const P=e.createVertexBuffer(E,bi.members),R=u.aW.simpleSegment(0,0,4,2),O=new u.aX;O.emplaceBack(1,0,2),O.emplaceBack(1,2,3);const j=e.createIndexBuffer(O);return this._cachedMesh=new _a(P,j,R),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class Bn{constructor(e=0,a=0,d=0,g=0){if(isNaN(e)||e<0||isNaN(a)||a<0||isNaN(d)||d<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=a,this.left=d,this.right=g}interpolate(e,a,d){return a.top!=null&&e.top!=null&&(this.top=u.G.number(e.top,a.top,d)),a.bottom!=null&&e.bottom!=null&&(this.bottom=u.G.number(e.bottom,a.bottom,d)),a.left!=null&&e.left!=null&&(this.left=u.G.number(e.left,a.left,d)),a.right!=null&&e.right!=null&&(this.right=u.G.number(e.right,a.right,d)),this}getCenter(e,a){const d=u.an((this.left+e-this.right)/2,0,e),g=u.an((this.top+a-this.bottom)/2,0,a);return new u.P(d,g)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Bn(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function au(v,e){if(!v.renderWorldCopies||v.lngRange)return;const a=e.lng-v.center.lng;e.lng+=a>180?-360:a<-180?360:0}function Zi(v){return Math.max(0,Math.floor(v))}class wi{constructor(e,a){var d;this.applyConstrain=(g,x)=>this._constrainOverride!==null?this._constrainOverride(g,x):this._callbacks.defaultConstrain(g,x),this._callbacks=e,this._tileSize=512,this._renderWorldCopies=a?.renderWorldCopies===void 0||!!a?.renderWorldCopies,this._minZoom=a?.minZoom||0,this._maxZoom=a?.maxZoom||22,this._minPitch=a?.minPitch==null?0:a?.minPitch,this._maxPitch=a?.maxPitch==null?60:a?.maxPitch,this._constrainOverride=(d=a?.constrainOverride)!==null&&d!==void 0?d:null,this.setMaxBounds(),this._width=0,this._height=0,this._center=new u.V(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Zi(this._zoom),this._scale=u.aq(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Bn,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,a,d){this._constrainOverride=e.constrainOverride,this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Zi(this._zoom),this._scale=u.aq(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new Bn(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!d&&e.autoCalculateNearFarZ,a&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get constrainOverride(){return this._constrainOverride}setConstrainOverride(e){e===void 0&&(e=null),this._constrainOverride!==e&&(this._constrainOverride=e,this.constrainInternal(),this._calcMatrices())}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new u.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const a=u.W(e,-180,180)*Math.PI/180;var d,g,x,E,P,R,O,j,$;this._bearingInRadians!==a&&(this._unmodified=!1,this._bearingInRadians=a,this._calcMatrices(),this._rotationMatrix=k(),d=this._rotationMatrix,x=-this._bearingInRadians,E=(g=this._rotationMatrix)[0],P=g[1],R=g[2],O=g[3],j=Math.sin(x),$=Math.cos(x),d[0]=E*$+R*j,d[1]=P*$+O*j,d[2]=E*-j+R*$,d[3]=P*-j+O*$)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const a=u.an(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==a&&(this._unmodified=!1,this._pitchInRadians=a,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const a=e/180*Math.PI;this._rollInRadians!==a&&(this._unmodified=!1,this._rollInRadians=a,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return u.aY(this._fovInRadians)}setFov(e){e=u.an(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=u.ap(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const a=this.applyConstrain(this._center,e).zoom;this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this._tileZoom=Math.max(0,Math.floor(a)),this._scale=u.aq(a),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,a){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=a,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,a,d){this._unmodified=!1,this._edgeInsets.interpolate(e,a,d),this.constrainInternal(),this._calcMatrices()}resize(e,a,d=!0){this._width=e,this._height=a,d&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new ui([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-u.ao,u.ao])}getCameraQueryGeometry(e,a){if(a.length===1)return[a[0],e];{const{minX:d,minY:g,maxX:x,maxY:E}=u.ab.fromPoints(a).extend(e);return[new u.P(d,g),new u.P(x,g),new u.P(x,E),new u.P(d,E),new u.P(d,g)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:a,zoom:d}=this.applyConstrain(this.center,this.zoom);this.setCenter(a),this.setZoom(d),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=u.ar(new Float64Array(16));u.Q(e,e,[this._width/2,-this._height/2,1]),u.O(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=u.ar(new Float64Array(16)),u.Q(e,e,[1,-1,1]),u.O(e,e,[-1,-1,0]),u.Q(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,a,d,g){const x=d!==void 0?d:this.bearing,E=g=g!==void 0?g:this.pitch,P=u.aa.fromLngLat(e,a),R=-Math.cos(u.ap(E)),O=Math.sin(u.ap(E)),j=O*Math.sin(u.ap(x)),$=-O*Math.cos(u.ap(x));let q=this.elevation;const Q=a-q;let nt;R*Q>=0||Math.abs(R)<.1?(nt=1e4,q=a+nt*R):nt=-Q/R;let lt,ut,ft=u.aZ(1,P.y),_t=0;do{if(_t+=1,_t>10)break;ut=nt/ft,lt=new u.aa(P.x+j*ut,P.y+$*ut),ft=1/lt.meterInMercatorCoordinateUnits()}while(Math.abs(nt-ut*ft)>1e-12);return{center:lt.toLngLat(),elevation:q,zoom:u.at(this.height/2/Math.tan(this.fovInRadians/2)/ut/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const a=u.as(1,this.center.lat)*this.worldSize,d=this.cameraToCenterDistance/a,g=u.aa.fromLngLat(this.center,this.elevation),x=It(this.center,this.elevation,this.pitch,this.bearing,d);this._elevation=e;const E=this.calculateCenterFromCameraLngLatAlt(x.toLngLat(),u.aZ(x.z,g.y),this.bearing,this.pitch);this._elevation=E.elevation,this._center=E.center,this.setZoom(E.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=u.as(1,this.center.lat)*this.worldSize;return It(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const a=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/a,e.canonical.y/a,1/a/u.a4,1/a/u.a4]}}class ir{constructor(e,a){this.min=e,this.max=a,this.center=u.a_([],u.a$([],this.min,this.max),.5)}quadrant(e){const a=[e%2==0,e<2],d=u.b0(this.min),g=u.b0(this.max);for(let x=0;x<a.length;x++)d[x]=a[x]?this.min[x]:this.center[x],g[x]=a[x]?this.center[x]:this.max[x];return g[2]=this.max[2],new ir(d,g)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let a=!0;for(let d=0;d<e.planes.length;d++){const g=this.intersectsPlane(e.planes[d]);if(g===0)return 0;g===1&&(a=!1)}return a?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let a=e[3],d=e[3];for(let g=0;g<3;g++)e[g]>0?(a+=e[g]*this.min[g],d+=e[g]*this.max[g]):(d+=e[g]*this.min[g],a+=e[g]*this.max[g]);return a>=0?2:d<0?0:1}}class oc{distanceToTile2d(e,a,d,g){const x=g.distanceX([e,a]),E=g.distanceY([e,a]);return Math.hypot(x,E)}getWrap(e,a,d){return d}getTileBoundingVolume(e,a,d,g){var x,E;let P=0,R=0;if(g?.terrain){const j=new u.a1(e.z,a,e.z,e.x,e.y),$=g.terrain.getMinMaxElevation(j);P=(x=$.minElevation)!==null&&x!==void 0?x:Math.min(0,d),R=(E=$.maxElevation)!==null&&E!==void 0?E:Math.max(0,d)}const O=1<<e.z;return new ir([a+e.x/O,e.y/O,P],[a+(e.x+1)/O,(e.y+1)/O,R])}allowVariableZoom(e,a){const d=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,g=u.an(78.5-d/2,0,60);return!!a.terrain||e.pitch>g}allowWorldCopies(){return!0}prepareNextFrame(){}}class kr{constructor(e,a,d){this.points=e,this.planes=a,this.aabb=d}static fromInvProjectionMatrix(e,a=1,d=0,g,x){const E=x?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],P=Math.pow(2,d),R=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((q=>(function(Q,nt,lt,ut){const ft=u.aG([],Q,nt),_t=1/ft[3]/lt*ut;return u.b5(ft,ft,[_t,_t,1/ft[3],_t])})(q,e,a,P)));g&&(function(q,Q,nt,lt){const ut=lt?4:0,ft=lt?0:4;let _t=0;const Tt=[],gt=[];for(let xt=0;xt<4;xt++){const zt=u.b1([],q[xt+ft],q[xt+ut]),$t=u.b6(zt);u.a_(zt,zt,1/$t),Tt.push($t),gt.push(zt)}for(let xt=0;xt<4;xt++){const zt=u.b7(q[xt+ut],gt[xt],nt);_t=zt!==null&&zt>=0?Math.max(_t,zt):Math.max(_t,Tt[xt])}const St=(function(xt,zt){const $t=u.b1([],xt[zt[0]],xt[zt[1]]),Vt=u.b1([],xt[zt[2]],xt[zt[1]]),Ut=[0,0,0,0];return u.b2(Ut,u.b3([],$t,Vt)),Ut[3]=-u.b4(Ut,xt[zt[0]]),Ut})(q,Q),At=(function(xt,zt){const $t=u.b8(xt),Vt=u.b9([],xt,1/$t),Ut=u.b1([],zt,u.a_([],Vt,u.b4(zt,Vt))),qt=u.b8(Ut);if(qt>0){const ge=Math.sqrt(1-Vt[3]*Vt[3]),ye=u.a_([],Vt,-Vt[3]),oe=u.a$([],ye,u.a_([],Ut,ge/qt));return u.ba(zt,oe)}return null})(nt,St);if(At!==null){const xt=At/u.b4(gt[0],St);_t=Math.min(_t,xt)}for(let xt=0;xt<4;xt++){const zt=Math.min(_t,Tt[xt]);q[xt+ft]=[q[xt+ut][0]+gt[xt][0]*zt,q[xt+ut][1]+gt[xt][1]*zt,q[xt+ut][2]+gt[xt][2]*zt,1]}})(R,E[0],g,x);const O=E.map((q=>{const Q=u.b1([],R[q[0]],R[q[1]]),nt=u.b1([],R[q[2]],R[q[1]]),lt=u.b2([],u.b3([],Q,nt)),ut=-u.b4(lt,R[q[1]]);return lt.concat(ut)})),j=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],$=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const q of R)for(let Q=0;Q<3;Q++)j[Q]=Math.min(j[Q],q[Q]),$[Q]=Math.max($[Q],q[Q]);return new kr(R,O,new ir(j,$))}}class $n{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,a,d){return this._helper.interpolatePadding(e,a,d)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,a,d=!0){this._helper.resize(e,a,d)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}setConstrainOverride(e){this._helper.setConstrainOverride(e)}overrideNearFarZ(e,a){this._helper.overrideNearFarZ(e,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,a){}constructor(e){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(a,d)=>{d=u.an(+d,this.minZoom,this.maxZoom);const g={center:new u.V(a.lng,a.lat),zoom:d};let x=this._helper._lngRange;if(!this._helper._renderWorldCopies&&x===null){const gt=179.9999999999;x=[-gt,gt]}const E=this.tileSize*u.aq(g.zoom);let P=0,R=E,O=0,j=E,$=0,q=0;const{x:Q,y:nt}=this.size;if(this._helper._latRange){const gt=this._helper._latRange;P=u.X(gt[1])*E,R=u.X(gt[0])*E,R-P<nt&&($=nt/(R-P))}x&&(O=u.W(u.Y(x[0])*E,0,E),j=u.W(u.Y(x[1])*E,0,E),j<O&&(j+=E),j-O<Q&&(q=Q/(j-O)));const{x:lt,y:ut}=vt(E,a);let ft,_t;const Tt=Math.max(q||0,$||0);if(Tt){const gt=new u.P(q?(j+O)/2:lt,$?(R+P)/2:ut);return g.center=wt(E,gt).wrap(),g.zoom+=u.at(Tt),g}if(this._helper._latRange){const gt=nt/2;ut-gt<P&&(_t=P+gt),ut+gt>R&&(_t=R-gt)}if(x){const gt=(O+j)/2;let St=lt;this._helper._renderWorldCopies&&(St=u.W(lt,gt-E/2,gt+E/2));const At=Q/2;St-At<O&&(ft=O+At),St+At>j&&(ft=j-At)}if(ft!==void 0||_t!==void 0){const gt=new u.P(ft??lt,_t??ut);g.center=wt(E,gt).wrap()}return g},this.applyConstrain=(a,d)=>this._helper.applyConstrain(a,d),this._helper=new wi({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(a,d)=>this.defaultConstrain(a,d)},e),this._coveringTilesDetailsProvider=new oc}clone(){const e=new $n;return e.apply(this),e}apply(e,a,d){this._helper.apply(e,a,d)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const a=[new u.bb(0,e)];if(this._helper._renderWorldCopies){const d=this.screenPointToMercatorCoordinate(new u.P(0,0)),g=this.screenPointToMercatorCoordinate(new u.P(this._helper._width,0)),x=this.screenPointToMercatorCoordinate(new u.P(this._helper._width,this._helper._height)),E=this.screenPointToMercatorCoordinate(new u.P(0,this._helper._height)),P=Math.floor(Math.min(d.x,g.x,x.x,E.x)),R=Math.floor(Math.max(d.x,g.x,x.x,E.x)),O=1;for(let j=P-O;j<=R+O;j++)j!==0&&a.push(new u.bb(j,e))}return a}getCameraFrustum(){return kr.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const a=this.screenPointToLocation(this.centerPoint,e),d=e?e.getElevationForLngLatZoom(a,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(d)}setLocationAtPoint(e,a){const d=u.as(this.elevation,this.center.lat),g=this.screenPointToMercatorCoordinateAtZ(a,d),x=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,d),E=u.aa.fromLngLat(e),P=new u.aa(E.x-(g.x-x.x),E.y-(g.y-x.y));this.setCenter(P?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,a){return a?this.coordinatePoint(u.aa.fromLngLat(e),a.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(u.aa.fromLngLat(e))}screenPointToLocation(e,a){var d;return(d=this.screenPointToMercatorCoordinate(e,a))===null||d===void 0?void 0:d.toLngLat()}screenPointToMercatorCoordinate(e,a){if(a){const d=a.pointCoordinate(e);if(d!=null)return d}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,a){const d=a||0,g=[e.x,e.y,0,1],x=[e.x,e.y,1,1];u.aG(g,g,this._pixelMatrixInverse),u.aG(x,x,this._pixelMatrixInverse);const E=g[3],P=x[3],R=g[1]/E,O=x[1]/P,j=g[2]/E,$=x[2]/P,q=j===$?0:(d-j)/($-j);return new u.aa(u.G.number(g[0]/E,x[0]/P,q)/this.worldSize,u.G.number(R,O,q)/this.worldSize,d)}coordinatePoint(e,a=0,d=this._pixelMatrix){const g=[e.x*this.worldSize,e.y*this.worldSize,a,1];return u.aG(g,g,d),new u.P(g[0]/g[3],g[1]/g[3])}getBounds(){const e=Math.max(0,this._helper._height/2-Ft(this));return new ui().extend(this.screenPointToLocation(new u.P(0,e))).extend(this.screenPointToLocation(new u.P(this._helper._width,e))).extend(this.screenPointToLocation(new u.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new u.P(0,this._helper._height)))}isPointOnMapSurface(e,a){return a?a.pointCoordinate(e)!=null:e.y>this.height/2-Ft(this)}calculatePosMatrix(e,a=!1,d){var g;const x=(g=e.key)!==null&&g!==void 0?g:u.bc(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),E=a?this._alignedPosMatrixCache:this._posMatrixCache;if(E.has(x)){const O=E.get(x);return d?O.f32:O.f64}const P=ht(e,this.worldSize);u.S(P,a?this._alignedProjMatrix:this._viewProjMatrix,P);const R={f64:P,f32:new Float32Array(P)};return E.set(x,R),d?R.f32:R.f64}calculateFogMatrix(e){const a=e.key,d=this._fogMatrixCacheF32;if(d.has(a))return d.get(a);const g=ht(e,this.worldSize);return u.S(g,this._fogMatrix,g),d.set(a,new Float32Array(g)),d.get(a)}calculateCenterFromCameraLngLatAlt(e,a,d,g){return this._helper.calculateCenterFromCameraLngLatAlt(e,a,d,g)}_calculateNearFarZIfNeeded(e,a,d){if(!this._helper.autoCalculateNearFarZ)return;const g=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),x=e-g*this._helper._pixelPerMeter/Math.cos(a),E=g<0?x:e,P=Math.PI/2+this.pitchInRadians,R=u.ap(this.fov)*(Math.abs(Math.cos(u.ap(this.roll)))*this.height+Math.abs(Math.sin(u.ap(this.roll)))*this.width)/this.height*(.5+d.y/this.height),O=Math.sin(R)*E/Math.sin(u.an(Math.PI-P-R,.01,Math.PI-.01)),j=Ft(this),$=Math.atan(j/this._helper.cameraToCenterDistance),q=u.ap(.75),Q=$>q?2*$*(.5+d.y/(2*j)):q,nt=Math.sin(Q)*E/Math.sin(u.an(Math.PI-P-Q,.01,Math.PI-.01)),lt=Math.min(O,nt);this._helper._farZ=1.01*(Math.cos(Math.PI/2-a)*lt+E),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,a=vt(this.worldSize,this.center),d=a.x,g=a.y;this._helper._pixelPerMeter=u.as(1,this.center.lat)*this.worldSize;const x=u.ap(Math.min(this.pitch,st)),E=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(x));let P;this._calculateNearFarZIfNeeded(E,x,e),P=new Float64Array(16),u.bd(P,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),u.aA(this._invProjMatrix,P),P[8]=2*-e.x/this._helper._width,P[9]=2*e.y/this._helper._height,this._projectionMatrix=u.be(P),u.Q(P,P,[1,-1,1]),u.O(P,P,[0,0,-this._helper.cameraToCenterDistance]),u.bf(P,P,-this.rollInRadians),u.bg(P,P,this.pitchInRadians),u.bf(P,P,-this.bearingInRadians),u.O(P,P,[-d,-g,0]),this._mercatorMatrix=u.Q([],P,[this.worldSize,this.worldSize,this.worldSize]),u.Q(P,P,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=u.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,P),u.O(P,P,[0,0,-this.elevation]),this._viewProjMatrix=P,this._invViewProjMatrix=u.aA([],P);const R=[0,0,-1,1];u.aG(R,R,this._invViewProjMatrix),this._cameraPosition=[R[0]/R[3],R[1]/R[3],R[2]/R[3]],this._fogMatrix=new Float64Array(16),u.bd(this._fogMatrix,this.fovInRadians,this.width/this.height,E,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,u.Q(this._fogMatrix,this._fogMatrix,[1,-1,1]),u.O(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),u.bf(this._fogMatrix,this._fogMatrix,-this.rollInRadians),u.bg(this._fogMatrix,this._fogMatrix,this.pitchInRadians),u.bf(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),u.O(this._fogMatrix,this._fogMatrix,[-d,-g,0]),u.Q(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),u.O(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=u.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,P);const O=this._helper._width%2/2,j=this._helper._height%2/2,$=Math.cos(this.bearingInRadians),q=Math.sin(-this.bearingInRadians),Q=d-Math.round(d)+$*O+q*j,nt=g-Math.round(g)+$*j+q*O,lt=new Float64Array(P);if(u.O(lt,lt,[Q>.5?Q-1:Q,nt>.5?nt-1:nt,0]),this._alignedProjMatrix=lt,P=u.aA(new Float64Array(16),this._pixelMatrix),!P)throw new Error("failed to invert matrix");this._pixelMatrixInverse=P,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new u.P(0,0)),a=[e.x*this.worldSize,e.y*this.worldSize,0,1];return u.aG(a,a,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=u.as(1,this.center.lat)*this.worldSize;return It(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,a){const d=u.aa.fromLngLat(e),g=[d.x*this.worldSize,d.y*this.worldSize,a,1];return u.aG(g,g,this._viewProjMatrix),g[2]/g[3]}getProjectionData(e){const{overscaledTileID:a,aligned:d,applyTerrainMatrix:g}=e,x=this._helper.getMercatorTileCoordinates(a),E=a?this.calculatePosMatrix(a,d,!0):null;let P;return P=a&&a.terrainRttPosMatrix32f&&g?a.terrainRttPosMatrix32f:E||u.bh(),{mainMatrix:P,tileMercatorCoords:x,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:P}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,a,d){return 1}transformLightDirection(e){return u.b0(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,a,d,g){const x=this.calculatePosMatrix(d);let E;g?(E=[e,a,g(e,a),1],u.aG(E,E,x)):(E=[e,a,0,1],nu(E,E,x));const P=E[3];return{point:new u.P(E[0]/P,E[1]/P),signedDistanceFromCamera:P,isOccluded:!1}}populateCache(e){for(const a of e)this.calculatePosMatrix(a)}getMatrixForModel(e,a){const d=u.aa.fromLngLat(e,a),g=d.meterInMercatorCoordinateUnits(),x=u.bi();return u.O(x,x,[d.x,d.y,d.z]),u.bf(x,x,Math.PI),u.bg(x,x,Math.PI/2),u.Q(x,x,[-g,g,g]),x}getProjectionDataForCustomLayer(e=!0){const a=new u.a1(0,0,0,0,0),d=this.getProjectionData({overscaledTileID:a,applyGlobeMatrix:e}),g=ht(a,this.worldSize);u.S(g,this._viewProjMatrix,g),d.tileMercatorCoords=[0,0,1,1];const x=[u.a4,u.a4,this.worldSize/this._helper.pixelsPerMeter],E=u.bj();return u.Q(E,g,x),d.fallbackMatrix=E,d.mainMatrix=E,d}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function $a(){u.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Ha(v){if(v.useSlerp)if(v.k<1){const e=u.bk(v.startEulerAngles.roll,v.startEulerAngles.pitch,v.startEulerAngles.bearing),a=u.bk(v.endEulerAngles.roll,v.endEulerAngles.pitch,v.endEulerAngles.bearing),d=new Float64Array(4);u.bl(d,e,a,v.k);const g=u.bm(d);v.tr.setRoll(g.roll),v.tr.setPitch(g.pitch),v.tr.setBearing(g.bearing)}else v.tr.setRoll(v.endEulerAngles.roll),v.tr.setPitch(v.endEulerAngles.pitch),v.tr.setBearing(v.endEulerAngles.bearing);else v.tr.setRoll(u.G.number(v.startEulerAngles.roll,v.endEulerAngles.roll,v.k)),v.tr.setPitch(u.G.number(v.startEulerAngles.pitch,v.endEulerAngles.pitch,v.k)),v.tr.setBearing(u.G.number(v.startEulerAngles.bearing,v.endEulerAngles.bearing,v.k))}function Co(v,e,a,d,g){const x=g.padding,E=vt(g.worldSize,a.getNorthWest()),P=vt(g.worldSize,a.getNorthEast()),R=vt(g.worldSize,a.getSouthEast()),O=vt(g.worldSize,a.getSouthWest()),j=u.ap(-d),$=E.rotate(j),q=P.rotate(j),Q=R.rotate(j),nt=O.rotate(j),lt=new u.P(Math.max($.x,q.x,nt.x,Q.x),Math.max($.y,q.y,nt.y,Q.y)),ut=new u.P(Math.min($.x,q.x,nt.x,Q.x),Math.min($.y,q.y,nt.y,Q.y)),ft=lt.sub(ut),_t=(g.width-(x.left+x.right+e.left+e.right))/ft.x,Tt=(g.height-(x.top+x.bottom+e.top+e.bottom))/ft.y;if(Tt<0||_t<0)return void $a();const gt=Math.min(u.at(g.scale*Math.min(_t,Tt)),v.maxZoom),St=u.P.convert(v.offset),At=new u.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(u.ap(d)),xt=St.add(At).mult(g.scale/u.aq(gt));return{center:wt(g.worldSize,E.add(R).div(2).sub(xt)),zoom:gt,bearing:d}}class ur{get useGlobeControls(){return!1}handlePanInertia(e,a){const d=e.mag(),g=Math.abs(Ft(a));return{easingOffset:e.mult(Math.min(.75*g/d,1)),easingCenter:a.center}}handleMapControlsRollPitchBearingZoom(e,a){e.bearingDelta&&a.setBearing(a.bearing+e.bearingDelta),e.pitchDelta&&a.setPitch(a.pitch+e.pitchDelta),e.rollDelta&&a.setRoll(a.roll+e.rollDelta),e.zoomDelta&&a.setZoom(a.zoom+e.zoomDelta)}handleMapControlsPan(e,a,d){e.around.distSqr(a.centerPoint)<.01||a.setLocationAtPoint(d,e.around)}cameraForBoxAndBearing(e,a,d,g,x){return Co(e,a,d,g,x)}handleJumpToCenterZoom(e,a){e.zoom!==(a.zoom!==void 0?+a.zoom:e.zoom)&&e.setZoom(+a.zoom),a.center!==void 0&&e.setCenter(u.V.convert(a.center))}handleEaseTo(e,a){const d=e.zoom,g=e.padding,x={roll:e.roll,pitch:e.pitch,bearing:e.bearing},E={roll:a.roll===void 0?e.roll:a.roll,pitch:a.pitch===void 0?e.pitch:a.pitch,bearing:a.bearing===void 0?e.bearing:a.bearing},P=a.zoom!==void 0,R=!e.isPaddingEqual(a.padding);let O=!1;const j=P?+a.zoom:e.zoom;let $=e.centerPoint.add(a.offsetAsPoint);const q=e.screenPointToLocation($),{center:Q,zoom:nt}=e.applyConstrain(u.V.convert(a.center||q),j??d);au(e,Q);const lt=vt(e.worldSize,q),ut=vt(e.worldSize,Q).sub(lt),ft=u.aq(nt-d);return O=nt!==d,{easeFunc:_t=>{if(O&&e.setZoom(u.G.number(d,nt,_t)),u.bn(x,E)||Ha({startEulerAngles:x,endEulerAngles:E,tr:e,k:_t,useSlerp:x.roll!=E.roll}),R&&(e.interpolatePadding(g,a.padding,_t),$=e.centerPoint.add(a.offsetAsPoint)),a.around)e.setLocationAtPoint(a.around,a.aroundPoint);else{const Tt=u.aq(e.zoom-d),gt=nt>d?Math.min(2,ft):Math.max(.5,ft),St=Math.pow(gt,1-_t),At=wt(e.worldSize,lt.add(ut.mult(_t*St)).mult(Tt));e.setLocationAtPoint(e.renderWorldCopies?At.wrap():At,$)}},isZooming:O,elevationCenter:Q}}handleFlyTo(e,a){const d=a.zoom!==void 0,g=e.zoom,x=e.applyConstrain(u.V.convert(a.center||a.locationAtOffset),d?+a.zoom:g),E=x.center,P=x.zoom;au(e,E);const R=vt(e.worldSize,a.locationAtOffset),O=vt(e.worldSize,E).sub(R),j=O.mag(),$=u.aq(P-g);let q;if(a.minZoom!==void 0){const Q=Math.min(+a.minZoom,g,P),nt=e.applyConstrain(E,Q).zoom;q=u.aq(nt-g)}return{easeFunc:(Q,nt,lt,ut)=>{e.setZoom(Q===1?P:g+u.at(nt));const ft=Q===1?E:wt(e.worldSize,R.add(O.mult(lt)).mult(nt));e.setLocationAtPoint(e.renderWorldCopies?ft.wrap():ft,ut)},scaleOfZoom:$,targetCenter:E,scaleOfMinZoom:q,pixelPathLength:j}}}class Qn{constructor(e,a,d){this.blendFunction=e,this.blendColor=a,this.mask=d}}Qn.Replace=[1,0],Qn.disabled=new Qn(Qn.Replace,u.bo.transparent,[!1,!1,!1,!1]),Qn.unblended=new Qn(Qn.Replace,u.bo.transparent,[!0,!0,!0,!0]),Qn.alphaBlended=new Qn([1,771],u.bo.transparent,[!0,!0,!0,!0]);const yi=2305;class cn{constructor(e,a,d){this.enable=e,this.mode=a,this.frontFace=d}}cn.disabled=new cn(!1,1029,yi),cn.backCCW=new cn(!0,1029,yi),cn.frontCCW=new cn(!0,1028,yi);class en{constructor(e,a,d){this.func=e,this.mask=a,this.range=d}}en.ReadOnly=!1,en.ReadWrite=!0,en.disabled=new en(519,en.ReadOnly,[0,1]);const va=7680;class gn{constructor(e,a,d,g,x,E){this.test=e,this.ref=a,this.mask=d,this.fail=g,this.depthFail=x,this.pass=E}}gn.disabled=new gn({func:519,mask:0},0,0,va,va,va);const Ao=new WeakMap;function us(v){var e;if(Ao.has(v))return Ao.get(v);{const a=(e=v.getParameter(v.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return Ao.set(v,a),a}}class Xa{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const a=e.context,d=a.gl;this._texFormat=d.RGBA,this._texType=d.UNSIGNED_BYTE;const g=new u.aV;g.emplaceBack(-1,-1),g.emplaceBack(2,-1),g.emplaceBack(-1,2);const x=new u.aX;x.emplaceBack(0,1,2),this._fullscreenTriangle=new _a(a.createVertexBuffer(g,bi.members),a.createIndexBuffer(x),u.aW.simpleSegment(0,0,g.length,x.length)),this._resultBuffer=new Uint8Array(4),a.activeTexture.set(d.TEXTURE1);const E=d.createTexture();d.bindTexture(d.TEXTURE_2D,E),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST),d.texImage2D(d.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=a.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(E),us(d)&&(this._pbo=d.createBuffer(),d.bindBuffer(d.PIXEL_PACK_BUFFER,this._pbo),d.bufferData(d.PIXEL_PACK_BUFFER,4,d.STREAM_READ),d.bindBuffer(d.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,a){const d=this._updateCount;return this._readbackQueue?d>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():d>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,a),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,a=e.gl;e.activeTexture.set(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,a){const d=this._cachedRenderContext.context,g=d.gl;if(this._bindFramebuffer(),d.viewport.set([0,0,this._texWidth,this._texHeight]),d.clear({color:u.bo.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(d,g.TRIANGLES,en.disabled,gn.disabled,Qn.unblended,cn.disabled,((x,E)=>({u_input:x,u_output_expected:E}))(e,a),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&us(g)){g.bindBuffer(g.PIXEL_PACK_BUFFER,this._pbo),g.readBuffer(g.COLOR_ATTACHMENT0),g.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),g.bindBuffer(g.PIXEL_PACK_BUFFER,null);const x=g.fenceSync(g.SYNC_GPU_COMMANDS_COMPLETE,0);g.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:x}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&us(e)){const a=e.clientWaitSync(this._readbackQueue.sync,0,0);if(a===e.WAIT_FAILED)return u.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(a===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Xa._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let a=0;return a+=e[0]/256,a+=e[1]/65536,a+=e[2]/16777216,e[3]<127&&(a=-a),a/128}}const xa=u.a4/128;function ou(v,e){const a=v.granularity!==void 0?Math.max(v.granularity,1):1,d=a+(v.generateBorders?2:0),g=a+(v.extendToNorthPole||v.generateBorders?1:0)+(v.extendToSouthPole||v.generateBorders?1:0),x=d+1,E=g+1,P=v.generateBorders?-1:0,R=v.generateBorders||v.extendToNorthPole?-1:0,O=a+(v.generateBorders?1:0),j=a+(v.generateBorders||v.extendToSouthPole?1:0),$=x*E,q=d*g*6,Q=x*E>65536;if(Q&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const nt=Q||e==="32bit",lt=new Int16Array(2*$);let ut=0;for(let Tt=R;Tt<=j;Tt++)for(let gt=P;gt<=O;gt++){let St=gt/a*u.a4;gt===-1&&(St=-xa),gt===a+1&&(St=u.a4+xa);let At=Tt/a*u.a4;Tt===-1&&(At=v.extendToNorthPole?u.bq:-xa),Tt===a+1&&(At=v.extendToSouthPole?u.br:u.a4+xa),lt[ut++]=St,lt[ut++]=At}const ft=nt?new Uint32Array(q):new Uint16Array(q);let _t=0;for(let Tt=0;Tt<g;Tt++)for(let gt=0;gt<d;gt++){const St=gt+1+Tt*x,At=gt+(Tt+1)*x,xt=gt+1+(Tt+1)*x;ft[_t++]=gt+Tt*x,ft[_t++]=At,ft[_t++]=St,ft[_t++]=St,ft[_t++]=At,ft[_t++]=xt}return{vertices:lt.buffer.slice(0),indices:ft.buffer.slice(0),uses32bitIndices:nt}}const lu=new u.aU({fill:new u.bs(128,2),line:new u.bs(512,0),tile:new u.bs(128,32),stencil:new u.bs(128,1),circle:3});class cu{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Lr.projectionGlobe}get vertexShaderPreludeCode(){return Lr.projectionMercator.vertexSource}get subdivisionGranularity(){return lu}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new Xa(e));const a=u.X(this._errorQueryLatitudeDegrees),d=2*Math.atan(Math.exp(Math.PI-a*Math.PI*2))-.5*Math.PI,g=this._errorMeasurement.updateErrorLoop(a,d),x=rt();g!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=g,this._errorMeasurementLastChangeTime=x);const E=Math.min(Math.max((x-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=u.bt(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,u.bu(E))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,a,d,g,x){const E=(x==="stencil"?lu.stencil:lu.tile).getGranularityForZoomLevel(a.z);return this._getMesh(e,{granularity:E,generateBorders:d,extendToNorthPole:a.y===0&&g,extendToSouthPole:a.y===(1<<a.z)-1&&g})}_getMesh(e,a){const d=this._getMeshKey(a);if(d in this._tileMeshCache)return this._tileMeshCache[d];const g=(function(x,E){const P=ou(E,"16bit"),R=u.aV.deserialize({arrayBuffer:P.vertices,length:P.vertices.byteLength/2/2}),O=u.aX.deserialize({arrayBuffer:P.indices,length:P.indices.byteLength/2/3});return new _a(x.createVertexBuffer(R,bi.members),x.createIndexBuffer(O),u.aW.simpleSegment(0,0,R.length,O.length))})(e,a);return this._tileMeshCache[d]=g,g}recalculate(e){}hasTransition(){const e=rt();let a=!1;return a=a||(e-this._errorMeasurementLastChangeTime)/1e3<.7,a=a||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,a}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const hh=new u.t({type:new u.D(u.u.projection.type)});class Mo extends u.E{constructor(e){super(),this._transitionable=new u.x(hh,void 0),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new u.H(0)),this._mercatorProjection=new Li,this._verticalPerspectiveProjection=new cu}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof u.bv){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,a,d,g,x){return this.currentProjection.getMeshFromTileID(e,a,d,g,x)}setProjection(e){this._transitionable.setValue("type",e?.type||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function qf(v){const e=dh(v.worldSize,v.center.lat);return 2*Math.PI*e}function ba(v,e,a,d,g){const x=1/(1<<g),E=e/u.a4*x+d*x,P=u.bx((v/u.a4*x+a*x)*Math.PI*2+Math.PI,2*Math.PI),R=2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI,O=Math.cos(R),j=new Float64Array(3);return j[0]=Math.sin(P)*O,j[1]=Math.sin(R),j[2]=Math.cos(P)*O,j}function hr(v){return(function(e,a){const d=Math.cos(a),g=new Float64Array(3);return g[0]=Math.sin(e)*d,g[1]=Math.sin(a),g[2]=Math.cos(e)*d,g})(v.lng*Math.PI/180,v.lat*Math.PI/180)}function dh(v,e){return v/(2*Math.PI)/Math.cos(e*Math.PI/180)}function Zf(v){const e=Math.asin(v[1])/Math.PI*180,a=Math.sqrt(v[0]*v[0]+v[2]*v[2]);if(a>1e-6){const d=v[0]/a,g=Math.acos(v[2]/a),x=(d>0?g:-g)/Math.PI*180;return new u.V(u.W(x,-180,180),e)}return new u.V(0,e)}function rr(v){return Math.cos(v*Math.PI/180)}function ki(v,e){const a=rr(v),d=rr(e);return u.at(d/a)}function $s(v,e){const a=v.rotate(e.bearingInRadians),d=e.zoom+ki(e.center.lat,0),g=u.bt(1/rr(e.center.lat),1/rr(Math.min(Math.abs(e.center.lat),60)),u.bw(d,7,3,0,1)),x=360/qf({worldSize:e.worldSize,center:{lat:e.center.lat}});return new u.V(e.center.lng-a.x*x*g,u.an(e.center.lat+a.y*x,-u.ao,u.ao))}function lc(v){const e=.5*v,a=Math.sin(e),d=Math.cos(e);return Math.log(a+d)-Math.log(d-a)}function Ed(v,e,a,d){const g=v.lat+a*d;if(Math.abs(a)>1){const x=(Math.sign(v.lat+a)!==Math.sign(v.lat)?-Math.abs(v.lat):Math.abs(v.lat))*Math.PI/180,E=Math.abs(v.lat+a)*Math.PI/180,P=lc(x+d*(E-x)),R=lc(x),O=lc(E);return new u.V(v.lng+e*((P-R)/(O-R)),g)}return new u.V(v.lng+e*d,g)}class fh{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=e}swapBuffers(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(e,a,d,g){const x=`${e.z}_${e.x}_${e.y}_${g?.terrain?"t":""}`,E=this._cache.get(x);if(E)return E;const P=this._cachePrevious.get(x);if(P)return this._cache.set(x,P),P;const R=this._boundingVolumeFactory(e,a,d,g);return this._cache.set(x,R),this._hadAnyChanges=!0,R}}class Hs{constructor(e,a,d,g){this.min=d,this.max=g,this.points=e,this.planes=a}static fromAabb(e,a){const d=[];for(let g=0;g<8;g++)d.push([1&~g?e[0]:a[0],(g>>1&1)==1?a[1]:e[1],(g>>2&1)==1?a[2]:e[2]]);return new Hs(d,[[-1,0,0,a[0]],[1,0,0,-e[0]],[0,-1,0,a[1]],[0,1,0,-e[1]],[0,0,-1,a[2]],[0,0,1,-e[2]]],e,a)}static fromCenterSizeAngles(e,a,d){const g=u.bA([],d[0],d[1],d[2]),x=u.bB([],[a[0],0,0],g),E=u.bB([],[0,a[1],0],g),P=u.bB([],[0,0,a[2]],g),R=[...e],O=[...e];for(let $=0;$<8;$++)for(let q=0;q<3;q++){const Q=e[q]+x[q]*(1&~$?-1:1)+E[q]*(($>>1&1)==1?1:-1)+P[q]*(($>>2&1)==1?1:-1);R[q]=Math.min(R[q],Q),O[q]=Math.max(O[q],Q)}const j=[];for(let $=0;$<8;$++){const q=[...e];u.a$(q,q,u.a_([],x,1&~$?-1:1)),u.a$(q,q,u.a_([],E,($>>1&1)==1?1:-1)),u.a$(q,q,u.a_([],P,($>>2&1)==1?1:-1)),j.push(q)}return new Hs(j,[[...x,-u.b4(x,j[0])],[...E,-u.b4(E,j[0])],[...P,-u.b4(P,j[0])],[-x[0],-x[1],-x[2],-u.b4(x,j[7])],[-E[0],-E[1],-E[2],-u.b4(E,j[7])],[-P[0],-P[1],-P[2],-u.b4(P,j[7])]],R,O)}intersectsFrustum(e){let a=!0;const d=this.points.length,g=this.planes.length,x=e.planes.length,E=e.points.length;for(let P=0;P<x;P++){const R=e.planes[P];let O=0;for(let j=0;j<d;j++){const $=this.points[j];R[0]*$[0]+R[1]*$[1]+R[2]*$[2]+R[3]>=0&&O++}if(O===0)return 0;O<d&&(a=!1)}if(a)return 2;for(let P=0;P<g;P++){const R=this.planes[P];let O=0;for(let j=0;j<E;j++){const $=e.points[j];R[0]*$[0]+R[1]*$[1]+R[2]*$[2]+R[3]>=0&&O++}if(O===0)return 0}return 1}intersectsPlane(e){const a=this.points.length;let d=0;for(let g=0;g<a;g++){const x=this.points[g];e[0]*x[0]+e[1]*x[1]+e[2]*x[2]+e[3]>=0&&d++}return d===a?2:d===0?0:1}}function ph(v,e,a){const d=v-e;return d<0?-d:Math.max(0,d-a)}function Cd(v,e,a,d,g){const x=v-a;let E;return E=x<0?Math.min(-x,1+x-g):x>1?Math.min(Math.max(x-g,0),1-x):0,Math.max(E,ph(e,d,g))}class $f{constructor(){this._boundingVolumeCache=new fh(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(e,a,d,g){const x=1<<d.z,E=1/x,P=d.x/x,R=d.y/x;let O=2;return O=Math.min(O,Cd(e,a,P,R,E)),O=Math.min(O,Cd(e,a,P+.5,-R-E,E)),O=Math.min(O,Cd(e,a,P+.5,2-R-E,E)),O}getWrap(e,a,d){const g=1<<a.z,x=1/g,E=a.x/g,P=ph(e.x,E,x),R=ph(e.x,E-1,x),O=ph(e.x,E+1,x),j=Math.min(P,R,O);return j===O?1:j===R?-1:0}allowVariableZoom(e,a){return Oe(e,a)>4}allowWorldCopies(){return!1}getTileBoundingVolume(e,a,d,g){return this._boundingVolumeCache.getTileBoundingVolume(e,a,d,g)}_computeTileBoundingVolume(e,a,d,g){var x,E;let P=0,R=0;if(g?.terrain){const O=new u.a1(e.z,a,e.z,e.x,e.y),j=g.terrain.getMinMaxElevation(O);P=(x=j.minElevation)!==null&&x!==void 0?x:Math.min(0,d),R=(E=j.maxElevation)!==null&&E!==void 0?E:Math.max(0,d)}if(P/=u.bD,R/=u.bD,P+=1,R+=1,e.z<=0)return Hs.fromAabb([-R,-R,-R],[R,R,R]);if(e.z===1)return Hs.fromAabb([e.x===0?-R:0,e.y===0?0:-R,-R],[e.x===0?0:R,e.y===0?R:0,R]);{const O=[ba(0,0,e.x,e.y,e.z),ba(u.a4,0,e.x,e.y,e.z),ba(u.a4,u.a4,e.x,e.y,e.z),ba(0,u.a4,e.x,e.y,e.z)],j=[];for(const Ut of O)j.push(u.a_([],Ut,R));if(R!==P)for(const Ut of O)j.push(u.a_([],Ut,P));e.y===0&&j.push([0,1,0]),e.y===(1<<e.z)-1&&j.push([0,-1,0]);const $=[1,1,1],q=[-1,-1,-1];for(const Ut of j)for(let qt=0;qt<3;qt++)$[qt]=Math.min($[qt],Ut[qt]),q[qt]=Math.max(q[qt],Ut[qt]);const Q=ba(u.a4/2,u.a4/2,e.x,e.y,e.z),nt=u.b3([],[0,1,0],Q);u.b2(nt,nt);const lt=u.b3([],Q,nt);u.b2(lt,lt);const ut=u.b3([],O[2],O[1]);u.b2(ut,ut);const ft=u.b3([],O[0],O[3]);u.b2(ft,ft),j.push(u.a_([],Q,R)),e.y>=(1<<e.z)/2&&j.push(u.a_([],ba(u.a4/2,0,e.x,e.y,e.z),R)),e.y<(1<<e.z)/2&&j.push(u.a_([],ba(u.a4/2,u.a4,e.x,e.y,e.z),R));const _t=Hf(Q,j),Tt=Hf(lt,j),gt=[-Q[0],-Q[1],-Q[2],_t.max],St=[Q[0],Q[1],Q[2],-_t.min],At=[-lt[0],-lt[1],-lt[2],Tt.max],xt=[lt[0],lt[1],lt[2],-Tt.min],zt=[...ut,0],$t=[...ft,0],Vt=[];return e.y===0?Vt.push(u.bC($t,zt,gt),u.bC($t,zt,St)):Vt.push(u.bC(At,zt,gt),u.bC(At,zt,St),u.bC(At,$t,gt),u.bC(At,$t,St)),e.y===(1<<e.z)-1?Vt.push(u.bC($t,zt,gt),u.bC($t,zt,St)):Vt.push(u.bC(xt,zt,gt),u.bC(xt,zt,St),u.bC(xt,$t,gt),u.bC(xt,$t,St)),new Hs(Vt,[gt,St,At,xt,zt,$t],$,q)}}}function Hf(v,e){let a=1/0,d=-1/0;for(const g of e){const x=u.b4(v,g);a=Math.min(a,x),d=Math.max(d,x)}return{min:a,max:d}}class mh{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,a,d){return this._helper.interpolatePadding(e,a,d)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,a){this._helper.resize(e,a)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}setConstrainOverride(e){this._helper.setConstrainOverride(e)}overrideNearFarZ(e,a){this._helper.overrideNearFarZ(e,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(e){this._cachedClippingPlane=u.bE(),this._projectionMatrix=u.bi(),this._globeViewProjMatrix32f=u.bh(),this._globeViewProjMatrixNoCorrection=u.bi(),this._globeViewProjMatrixNoCorrectionInverted=u.bi(),this._globeProjMatrixInverted=u.bi(),this._cameraPosition=u.by(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(a,d)=>{const g=u.an(a.lat,-u.ao,u.ao),x=u.an(+d,this.minZoom+ki(0,g),this.maxZoom);return{center:new u.V(a.lng,g),zoom:x}},this.applyConstrain=(a,d)=>this._helper.applyConstrain(a,d),this._helper=new wi({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(a,d)=>this.defaultConstrain(a,d)},e),this._coveringTilesDetailsProvider=new $f}clone(){const e=new mh;return e.apply(this),e}apply(e,a){this._globeLatitudeErrorCorrectionRadians=a||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=u.by();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:a,applyGlobeMatrix:d}=e,g=this._helper.getMercatorTileCoordinates(a);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:g,clippingPlane:this._cachedClippingPlane,projectionTransition:d?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const a=this.pitchInRadians,d=this.cameraToCenterDistance/e,g=Math.sin(a)*d,x=Math.cos(a)*d+1,E=1/Math.sqrt(g*g+x*x)*1;let P=-g,R=x;const O=Math.sqrt(P*P+R*R);P/=O,R/=O;const j=[0,P,R];u.bF(j,j,[0,0,0],-this.bearingInRadians),u.bG(j,j,[0,0,0],-1*this.center.lat*Math.PI/180),u.bH(j,j,[0,0,0],this.center.lng*Math.PI/180);const $=1/u.b6(j);return u.a_(j,j,$),[...j,-E*$]}isLocationOccluded(e){return!this.isSurfacePointVisible(hr(e))}transformLightDirection(e){const a=this._helper._center.lng*Math.PI/180,d=this._helper._center.lat*Math.PI/180,g=Math.cos(d),x=[Math.sin(a)*g,Math.sin(d),Math.cos(a)*g],E=[x[2],0,-x[0]],P=[0,0,0];u.b3(P,E,x),u.b2(E,E),u.b2(P,P);const R=[0,0,0];return u.b2(R,[E[0]*e[0]+P[0]*e[1]+x[0]*e[2],E[1]*e[0]+P[1]*e[1]+x[1]*e[2],E[2]*e[0]+P[2]*e[1]+x[2]*e[2]]),R}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,a,d){const g=(function(P,R,O){const j=1/(1<<O.z);return new u.aa(P/u.a4*j+O.x*j,R/u.a4*j+O.y*j)})(e,a,d.canonical),x=(E=g.y,[u.bx(g.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI]);var E;return this.getCircleRadiusCorrection()/Math.cos(x[1])}projectTileCoordinates(e,a,d,g){const x=d.canonical,E=ba(e,a,x.x,x.y,x.z),P=1+(g?g(e,a):0)/u.bD,R=[E[0]*P,E[1]*P,E[2]*P,1];u.aG(R,R,this._globeViewProjMatrixNoCorrection);const O=this._cachedClippingPlane,j=O[0]*E[0]+O[1]*E[1]+O[2]*E[2]+O[3]<0;return{point:new u.P(R[0]/R[3],R[1]/R[3]),signedDistanceFromCamera:R[3],isOccluded:j}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=dh(this.worldSize,this.center.lat),a=u.bj(),d=u.bj();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),u.bd(a,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const g=this.centerOffset;a[8]=2*-g.x/this._helper._width,a[9]=2*g.y/this._helper._height,this._projectionMatrix=u.be(a),this._globeProjMatrixInverted=u.bj(),u.aA(this._globeProjMatrixInverted,a),u.O(a,a,[0,0,-this.cameraToCenterDistance]),u.bf(a,a,this.rollInRadians),u.bg(a,a,-this.pitchInRadians),u.bf(a,a,this.bearingInRadians),u.O(a,a,[0,0,-e]);const x=u.by();x[0]=e,x[1]=e,x[2]=e,u.bg(d,a,this.center.lat*Math.PI/180),u.bI(d,d,-this.center.lng*Math.PI/180),u.Q(d,d,x),this._globeViewProjMatrixNoCorrection=d,u.bg(a,a,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),u.bI(a,a,-this.center.lng*Math.PI/180),u.Q(a,a,x),this._globeViewProjMatrix32f=new Float32Array(a),this._globeViewProjMatrixNoCorrectionInverted=u.bj(),u.aA(this._globeViewProjMatrixNoCorrectionInverted,d);const E=u.by();this._cameraPosition=u.by(),this._cameraPosition[2]=this.cameraToCenterDistance/e,u.bF(this._cameraPosition,this._cameraPosition,E,-this.rollInRadians),u.bG(this._cameraPosition,this._cameraPosition,E,this.pitchInRadians),u.bF(this._cameraPosition,this._cameraPosition,E,-this.bearingInRadians),u.a$(this._cameraPosition,this._cameraPosition,[0,0,1]),u.bG(this._cameraPosition,this._cameraPosition,E,-this.center.lat*Math.PI/180),u.bH(this._cameraPosition,this._cameraPosition,E,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const P=u.be(this._globeViewProjMatrixNoCorrectionInverted);u.Q(P,P,[1,1,-1]),this._cachedFrustum=kr.fromInvProjectionMatrix(P,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(e){u.w("calculateFogMatrix is not supported on globe projection.");const a=u.bj();return u.ar(a),a}getVisibleUnwrappedCoordinates(e){return[new u.bb(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&u.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,a){if(!this._globeViewProjMatrixNoCorrection)return 1;const d=hr(e);u.a_(d,d,1+a/u.bD);const g=u.bE();return u.aG(g,[d[0],d[1],d[2],1],this._globeViewProjMatrixNoCorrection),g[2]/g[3]}populateCache(e){}getBounds(){const e=.5*this.width,a=.5*this.height,d=[new u.P(0,0),new u.P(e,0),new u.P(this.width,0),new u.P(this.width,a),new u.P(this.width,this.height),new u.P(e,this.height),new u.P(0,this.height),new u.P(0,a)],g=[];for(const $ of d)g.push(this.unprojectScreenPoint($));let x=0,E=0,P=0,R=0;const O=this.center;for(const $ of g){const q=u.bJ(O.lng,$.lng),Q=u.bJ(O.lat,$.lat);q<E&&(E=q),q>x&&(x=q),Q<R&&(R=Q),Q>P&&(P=Q)}const j=[O.lng+E,O.lat+R,O.lng+x,O.lat+P];return this.isSurfacePointOnScreen([0,1,0])&&(j[3]=90,j[0]=-180,j[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(j[1]=-90,j[0]=-180,j[2]=180),new ui(j)}calculateCenterFromCameraLngLatAlt(e,a,d,g){return this._helper.calculateCenterFromCameraLngLatAlt(e,a,d,g)}setLocationAtPoint(e,a){const d=hr(this.unprojectScreenPoint(a)),g=hr(e),x=u.by();u.bK(x);const E=u.by();u.bH(E,d,x,-this.center.lng*Math.PI/180),u.bG(E,E,x,this.center.lat*Math.PI/180);const P=g[0]*g[0]+g[2]*g[2],R=E[0]*E[0];if(P<R)return;const O=Math.sqrt(P-R),j=-O,$=u.bL(g[0],g[2],E[0],O),q=u.bL(g[0],g[2],E[0],j),Q=u.by();u.bH(Q,g,x,-$);const nt=u.bL(Q[1],Q[2],E[1],E[2]),lt=u.by();u.bH(lt,g,x,-q);const ut=u.bL(lt[1],lt[2],E[1],E[2]),ft=.5*Math.PI,_t=nt>=-ft&&nt<=ft,Tt=ut>=-ft&&ut<=ft;let gt,St;if(_t&&Tt){const $t=this.center.lng*Math.PI/180,Vt=this.center.lat*Math.PI/180;u.bM($,$t)+u.bM(nt,Vt)<u.bM(q,$t)+u.bM(ut,Vt)?(gt=$,St=nt):(gt=q,St=ut)}else if(_t)gt=$,St=nt;else{if(!Tt)return;gt=q,St=ut}const At=gt/Math.PI*180,xt=St/Math.PI*180,zt=this.center.lat;this.setCenter(new u.V(At,u.an(xt,-90,90))),this.setZoom(this.zoom+ki(zt,this.center.lat))}locationToScreenPoint(e,a){const d=hr(e);if(a){const g=a.getElevationForLngLatZoom(e,this._helper._tileZoom);u.a_(d,d,1+g/u.bD)}return this._projectSurfacePointToScreen(d)}_projectSurfacePointToScreen(e){const a=u.bE();return u.aG(a,[...e,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],new u.P((.5*a[0]+.5)*this.width,(.5*-a[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,a){if(a){const d=a.pointCoordinate(e);if(d)return d}return u.aa.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,a){var d;return(d=this.screenPointToMercatorCoordinate(e,a))===null||d===void 0?void 0:d.toLngLat()}isPointOnMapSurface(e,a){const d=this._cameraPosition,g=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(d,g)}getRayDirectionFromPixel(e){const a=u.bE();a[0]=e.x/this.width*2-1,a[1]=-1*(e.y/this.height*2-1),a[2]=1,a[3]=1,u.aG(a,a,this._globeViewProjMatrixNoCorrectionInverted),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3];const d=u.by();d[0]=a[0]-this._cameraPosition[0],d[1]=a[1]-this._cameraPosition[1],d[2]=a[2]-this._cameraPosition[2];const g=u.by();return u.b2(g,d),g}isSurfacePointVisible(e){const a=this._cachedClippingPlane;return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]+a[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const a=u.bE();return u.aG(a,[...e,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3],a[0]>-1&&a[0]<1&&a[1]>-1&&a[1]<1&&a[2]>-1&&a[2]<1}rayPlanetIntersection(e,a){const d=u.b4(e,a),g=u.by(),x=u.by();u.a_(x,a,d),u.b1(g,e,x);const E=1-u.b4(g,g);if(E<0)return null;const P=u.b4(e,e)-1,R=-d+(d<0?1:-1)*Math.sqrt(E),O=P/R,j=R;return{tMin:Math.min(O,j),tMax:Math.max(O,j)}}unprojectScreenPoint(e){const a=this._cameraPosition,d=this.getRayDirectionFromPixel(e),g=this.rayPlanetIntersection(a,d);if(g){const j=u.by();u.a$(j,a,[d[0]*g.tMin,d[1]*g.tMin,d[2]*g.tMin]);const $=u.by();return u.b2($,j),Zf($)}const x=this._cachedClippingPlane,E=x[0]*d[0]+x[1]*d[1]+x[2]*d[2],P=-u.ba(x,a)/E,R=u.by();if(P>0)u.a$(R,a,[d[0]*P,d[1]*P,d[2]*P]);else{const j=u.by();u.a$(j,a,[2*d[0],2*d[1],2*d[2]]);const $=u.ba(this._cachedClippingPlane,j);u.b1(R,j,[this._cachedClippingPlane[0]*$,this._cachedClippingPlane[1]*$,this._cachedClippingPlane[2]*$])}const O=(function(j){const $=u.by();return $[0]=j[0]*-j[3],$[1]=j[1]*-j[3],$[2]=j[2]*-j[3],{center:$,radius:Math.sqrt(1-j[3]*j[3])}})(x);return Zf((function(j,$,q){const Q=u.by();u.b1(Q,q,j);const nt=u.by();return u.bz(nt,j,Q,$/u.b8(Q)),nt})(O.center,O.radius,R))}getMatrixForModel(e,a){const d=u.V.convert(e),g=1/u.bD,x=u.bi();return u.bI(x,x,d.lng/180*Math.PI),u.bg(x,x,-d.lat/180*Math.PI),u.O(x,x,[0,0,1+a/u.bD]),u.bg(x,x,.5*Math.PI),u.Q(x,x,[g,g,g]),x}getProjectionDataForCustomLayer(e=!0){const a=this.getProjectionData({overscaledTileID:new u.a1(0,0,0,0,0),applyGlobeMatrix:e});return a.tileMercatorCoords=[0,0,1,1],a}getFastPathSimpleProjectionMatrix(e){}}class gh{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,a,d){return this._helper.interpolatePadding(e,a,d)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,a,d=!0){this._helper.resize(e,a,d)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}setConstrainOverride(e){this._helper.setConstrainOverride(e)}overrideNearFarZ(e,a){this._helper.overrideNearFarZ(e,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,a){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=a,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(e){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(a,d)=>this.currentTransform.defaultConstrain(a,d),this.applyConstrain=(a,d)=>this._helper.applyConstrain(a,d),this._helper=new wi({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(a,d)=>this.defaultConstrain(a,d)},e),this._globeness=1,this._mercatorTransform=new $n,this._verticalPerspectiveTransform=new mh}clone(){const e=new gh;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const a=this._mercatorTransform.getProjectionData(e),d=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?d.mainMatrix:a.mainMatrix,clippingPlane:d.clippingPlane,tileMercatorCoords:d.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:a.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return u.bt(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return u.bt(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,a,d){const g=this._mercatorTransform.getPitchedTextCorrection(e,a,d),x=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,a,d);return u.bt(g,x,this._globeness)}projectTileCoordinates(e,a,d,g){return this.currentTransform.projectTileCoordinates(e,a,d,g)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,a){return this.currentTransform.lngLatToCameraDepth(e,a)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(e,a,d,g){return this._helper.calculateCenterFromCameraLngLatAlt(e,a,d,g)}setLocationAtPoint(e,a){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,a),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,a),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,a){return this.currentTransform.locationToScreenPoint(e,a)}screenPointToMercatorCoordinate(e,a){return this.currentTransform.screenPointToMercatorCoordinate(e,a)}screenPointToLocation(e,a){return this.currentTransform.screenPointToLocation(e,a)}isPointOnMapSurface(e,a){return this.currentTransform.isPointOnMapSurface(e,a)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,a){return this.currentTransform.getMatrixForModel(e,a)}getProjectionDataForCustomLayer(e=!0){const a=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return a;const d=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return d.fallbackMatrix=a.mainMatrix,d}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class Kr{get useGlobeControls(){return!0}handlePanInertia(e,a){const d=$s(e,a);return Math.abs(d.lng-a.center.lng)>180&&(d.lng=a.center.lng+179.5*Math.sign(d.lng-a.center.lng)),{easingCenter:d,easingOffset:new u.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,a){const d=e.around,g=a.screenPointToLocation(d);e.bearingDelta&&a.setBearing(a.bearing+e.bearingDelta),e.pitchDelta&&a.setPitch(a.pitch+e.pitchDelta),e.rollDelta&&a.setRoll(a.roll+e.rollDelta);const x=a.zoom;e.zoomDelta&&a.setZoom(a.zoom+e.zoomDelta);const E=a.zoom-x;if(E===0)return;const P=u.bJ(a.center.lng,g.lng),R=P/(Math.abs(P/180)+1),O=u.bJ(a.center.lat,g.lat),j=a.getRayDirectionFromPixel(d),$=a.cameraPosition,q=-1*u.b4($,j),Q=u.by();u.a$(Q,$,[j[0]*q,j[1]*q,j[2]*q]);const nt=u.b6(Q)-1,lt=Math.exp(.5*-Math.max(nt-.3,0)),ut=dh(a.worldSize,a.center.lat)/Math.min(a.width,a.height),ft=u.bw(ut,.9,.5,1,.25),_t=(1-u.aq(-E))*Math.min(lt,ft),Tt=a.center.lat,gt=a.zoom,St=new u.V(a.center.lng+R*_t,u.an(a.center.lat+O*_t,-u.ao,u.ao));a.setLocationAtPoint(g,d);const At=a.center,xt=u.bw(Math.abs(P),45,85,0,1),zt=u.bw(ut,.75,.35,0,1),$t=Math.pow(Math.max(xt,zt),.25),Vt=u.bJ(At.lng,St.lng),Ut=u.bJ(At.lat,St.lat);a.setCenter(new u.V(At.lng+Vt*$t,At.lat+Ut*$t).wrap()),a.setZoom(gt+ki(Tt,a.center.lat))}handleMapControlsPan(e,a,d){if(!e.panDelta)return;const g=a.center.lat,x=a.zoom;a.setCenter($s(e.panDelta,a).wrap()),a.setZoom(x+ki(g,a.center.lat))}cameraForBoxAndBearing(e,a,d,g,x){const E=Co(e,a,d,g,x),P=a.left/x.width*2-1,R=(x.width-a.right)/x.width*2-1,O=a.top/x.height*-2+1,j=(x.height-a.bottom)/x.height*-2+1,$=u.bJ(d.getWest(),d.getEast())<0,q=$?d.getEast():d.getWest(),Q=$?d.getWest():d.getEast(),nt=Math.max(d.getNorth(),d.getSouth()),lt=Math.min(d.getNorth(),d.getSouth()),ut=q+.5*u.bJ(q,Q),ft=nt+.5*u.bJ(nt,lt),_t=x.clone();_t.setCenter(E.center),_t.setBearing(E.bearing),_t.setPitch(0),_t.setRoll(0),_t.setZoom(E.zoom);const Tt=_t.modelViewProjectionMatrix,gt=[hr(d.getNorthWest()),hr(d.getNorthEast()),hr(d.getSouthWest()),hr(d.getSouthEast()),hr(new u.V(Q,ft)),hr(new u.V(q,ft)),hr(new u.V(ut,nt)),hr(new u.V(ut,lt))],St=hr(E.center);let At=Number.POSITIVE_INFINITY;for(const xt of gt)P<0&&(At=Kr.getLesserNonNegativeNonNull(At,Kr.solveVectorScale(xt,St,Tt,"x",P))),R>0&&(At=Kr.getLesserNonNegativeNonNull(At,Kr.solveVectorScale(xt,St,Tt,"x",R))),O>0&&(At=Kr.getLesserNonNegativeNonNull(At,Kr.solveVectorScale(xt,St,Tt,"y",O))),j<0&&(At=Kr.getLesserNonNegativeNonNull(At,Kr.solveVectorScale(xt,St,Tt,"y",j)));if(Number.isFinite(At)&&At!==0)return E.zoom=_t.zoom+u.at(At),E;$a()}handleJumpToCenterZoom(e,a){const d=e.center.lat,g=e.applyConstrain(a.center?u.V.convert(a.center):e.center,e.zoom).center;e.setCenter(g.wrap());const x=a.zoom!==void 0?+a.zoom:e.zoom+ki(d,g.lat);e.zoom!==x&&e.setZoom(x)}handleEaseTo(e,a){const d=e.zoom,g=e.center,x=e.padding,E={roll:e.roll,pitch:e.pitch,bearing:e.bearing},P={roll:a.roll===void 0?e.roll:a.roll,pitch:a.pitch===void 0?e.pitch:a.pitch,bearing:a.bearing===void 0?e.bearing:a.bearing},R=a.zoom!==void 0,O=!e.isPaddingEqual(a.padding);let j=!1;const $=a.center?u.V.convert(a.center):g,q=e.applyConstrain($,d).center;au(e,q);const Q=e.clone();Q.setCenter(q),Q.setZoom(R?+a.zoom:d+ki(g.lat,$.lat)),Q.setBearing(a.bearing);const nt=new u.P(u.an(e.centerPoint.x+a.offsetAsPoint.x,0,e.width),u.an(e.centerPoint.y+a.offsetAsPoint.y,0,e.height));Q.setLocationAtPoint(q,nt);const lt=(a.offset&&a.offsetAsPoint.mag())>0?Q.center:q,ut=R?+a.zoom:d+ki(g.lat,lt.lat),ft=d+ki(g.lat,0),_t=ut+ki(lt.lat,0),Tt=u.bJ(g.lng,lt.lng),gt=u.bJ(g.lat,lt.lat),St=u.aq(_t-ft);return j=ut!==d,{easeFunc:At=>{if(u.bn(E,P)||Ha({startEulerAngles:E,endEulerAngles:P,tr:e,k:At,useSlerp:E.roll!=P.roll}),O&&e.interpolatePadding(x,a.padding,At),a.around)u.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(a.around,a.aroundPoint);else{const xt=_t>ft?Math.min(2,St):Math.max(.5,St),zt=Math.pow(xt,1-At),$t=Ed(g,Tt,gt,At*zt);e.setCenter($t.wrap())}if(j){const xt=u.G.number(ft,_t,At)+ki(0,e.center.lat);e.setZoom(xt)}},isZooming:j,elevationCenter:lt}}handleFlyTo(e,a){const d=a.zoom!==void 0,g=e.center,x=e.zoom,E=e.padding,P=!e.isPaddingEqual(a.padding),R=e.applyConstrain(u.V.convert(a.center||a.locationAtOffset),x).center,O=d?+a.zoom:e.zoom+ki(e.center.lat,R.lat),j=e.clone();j.setCenter(R),j.setZoom(O),j.setBearing(a.bearing);const $=new u.P(u.an(e.centerPoint.x+a.offsetAsPoint.x,0,e.width),u.an(e.centerPoint.y+a.offsetAsPoint.y,0,e.height));j.setLocationAtPoint(R,$);const q=j.center;au(e,q);const Q=(function(gt,St,At){const xt=hr(St),zt=hr(At),$t=u.b4(xt,zt),Vt=Math.acos($t),Ut=qf(gt);return Vt/(2*Math.PI)*Ut})(e,g,q),nt=x+ki(g.lat,0),lt=O+ki(q.lat,0),ut=u.aq(lt-nt);let ft;if(typeof a.minZoom=="number"){const gt=+a.minZoom+ki(q.lat,0),St=Math.min(gt,nt,lt)+ki(0,q.lat),At=e.applyConstrain(q,St).zoom+ki(q.lat,0);ft=u.aq(At-nt)}const _t=u.bJ(g.lng,q.lng),Tt=u.bJ(g.lat,q.lat);return{easeFunc:(gt,St,At,xt)=>{const zt=Ed(g,_t,Tt,At);P&&e.interpolatePadding(E,a.padding,gt);const $t=gt===1?q:zt;e.setCenter($t.wrap());const Vt=nt+u.at(St);e.setZoom(gt===1?O:Vt+ki(0,$t.lat))},scaleOfZoom:ut,targetCenter:q,scaleOfMinZoom:ft,pixelPathLength:Q}}static solveVectorScale(e,a,d,g,x){const E=g==="x"?[d[0],d[4],d[8],d[12]]:[d[1],d[5],d[9],d[13]],P=[d[3],d[7],d[11],d[15]],R=e[0]*E[0]+e[1]*E[1]+e[2]*E[2],O=e[0]*P[0]+e[1]*P[1]+e[2]*P[2],j=a[0]*E[0]+a[1]*E[1]+a[2]*E[2],$=a[0]*P[0]+a[1]*P[1]+a[2]*P[2];return j+x*O===R+x*$||P[3]*(R-j)+E[3]*($-O)+R*$==j*O?null:(j+E[3]-x*$-x*P[3])/(j-R-x*$+x*O)}static getLesserNonNegativeNonNull(e,a){return a!==null&&a>=0&&a<e?a:e}}class yh{constructor(e){this._globe=e,this._mercatorCameraHelper=new ur,this._verticalPerspectiveCameraHelper=new Kr}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,a){return this.currentHelper.handlePanInertia(e,a)}handleMapControlsRollPitchBearingZoom(e,a){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,a)}handleMapControlsPan(e,a,d){this.currentHelper.handleMapControlsPan(e,a,d)}cameraForBoxAndBearing(e,a,d,g,x){return this.currentHelper.cameraForBoxAndBearing(e,a,d,g,x)}handleJumpToCenterZoom(e,a){this.currentHelper.handleJumpToCenterZoom(e,a)}handleEaseTo(e,a){return this.currentHelper.handleEaseTo(e,a)}handleFlyTo(e,a){return this.currentHelper.handleFlyTo(e,a)}}const fl=(v,e)=>u.B(v,e&&e.filter((a=>a.identifier!=="source.canvas"))),Ad=u.bN();class uu extends u.E{constructor(e,a={}){var d,g;super(),this._rtlPluginLoaded=()=>{for(const E in this.tileManagers){const P=this.tileManagers[E].getSource().type;P!=="vector"&&P!=="geojson"||this.tileManagers[E].reload()}},this.map=e,this.dispatcher=new Gi(Mn(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",((E,P)=>this.getGlyphs(E,P))),this.dispatcher.registerMessageHandler("GI",((E,P)=>this.getImages(E,P))),this.dispatcher.registerMessageHandler("GDA",((E,P)=>this.getDashes(E,P))),this.imageManager=new ze,this.imageManager.setEventedParent(this);const x=((d=e._container)===null||d===void 0?void 0:d.lang)||typeof document<"u"&&((g=document.documentElement)===null||g===void 0?void 0:g.lang)||void 0;this.glyphManager=new Qt(e._requestManager,a.localIdeographFontFamily,x),this.lineAtlas=new be(256,512),this.crossTileSymbolIndex=new dl,this._setInitialValues(),this._resetUpdates(),this.dispatcher.broadcast("SR",u.bO()),Ir().on(Ga,this._rtlPluginLoaded),this.on("data",(E=>{if(E.dataType!=="source"||E.sourceDataType!=="metadata")return;const P=this.tileManagers[E.sourceId];if(!P)return;const R=P.getSource();if(R&&R.vectorLayerIds)for(const O in this._layers){const j=this._layers[O];j.source===R.id&&this._validateLayer(j)}}))}_setInitialValues(){var e;this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new u.bP,this._availableImages=[],this._globalState={},this._serializedLayers={},this.stylesheet=null,this.light=null,this.sky=null,this.projection&&(this.projection.destroy(),delete this.projection),this._loaded=!1,this._changed=!1,this._updatedLayers={},this._updatedSources={},this._changedImages={},this._glyphsDidChange=!1,this._updatedPaintProps={},this._layerOrderChanged=!1,this.crossTileSymbolIndex=new(((e=this.crossTileSymbolIndex)===null||e===void 0?void 0:e.constructor)||Object),this.pauseablePlacement=void 0,this.placement=void 0,this.z=0}setGlobalStateProperty(e,a){var d,g,x;this._checkLoaded();const E=a===null?(x=(g=(d=this.stylesheet.state)===null||d===void 0?void 0:d[e])===null||g===void 0?void 0:g.default)!==null&&x!==void 0?x:null:a;if(u.bQ(E,this._globalState[e]))return this;this._globalState[e]=E,this._applyGlobalStateChanges([e])}getGlobalState(){return this._globalState}setGlobalState(e){this._checkLoaded();const a=[];for(const d in e)!u.bQ(this._globalState[d],e[d].default)&&(a.push(d),this._globalState[d]=e[d].default);this._applyGlobalStateChanges(a)}_applyGlobalStateChanges(e){if(e.length===0)return;const a=new Set,d={};for(const g of e){d[g]=this._globalState[g];for(const x in this._layers){const E=this._layers[x],P=E.getLayoutAffectingGlobalStateRefs(),R=E.getPaintAffectingGlobalStateRefs();if(P.has(g)&&a.add(E.source),R.has(g))for(const{name:O,value:j}of R.get(g))this._updatePaintProperty(E,O,j)}}this.dispatcher.broadcast("UGS",d);for(const g in this.tileManagers)a.has(g)&&(this._reloadSource(g),this._changed=!0)}loadURL(e,a={},d){this.fire(new u.l("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const g=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const x=this._loadStyleRequest;u.j(g,this._loadStyleRequest).then((E=>{this._loadStyleRequest=null,this._load(E.data,a,d)})).catch((E=>{this._loadStyleRequest=null,E&&!x.signal.aborted&&this.fire(new u.k(E))}))}loadJSON(e,a={},d){this.fire(new u.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,it.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(e,a,d)})).catch((()=>{}))}loadEmpty(){this.fire(new u.l("dataloading",{dataType:"style"})),this._load(Ad,{validate:!1})}_load(e,a,d){var g,x;let E=a.transformStyle?a.transformStyle(d,e):e;if(!a.validate||!fl(this,u.C(E))){E=Object.assign({},E),this._loaded=!0,this.stylesheet=E;for(const P in E.sources)this.addSource(P,E.sources[P],{validate:!1});E.sprite?this._loadSprite(E.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(E.glyphs),this._createLayers(),this.light=new He(this.stylesheet.light),this._setProjectionInternal(((g=this.stylesheet.projection)===null||g===void 0?void 0:g.type)||"mercator"),this.sky=new se(this.stylesheet.sky),this.map.setTerrain((x=this.stylesheet.terrain)!==null&&x!==void 0?x:null),this.fire(new u.l("data",{dataType:"style"})),this.fire(new u.l("style.load"))}}_createLayers(){var e,a,d;const g=u.bR(this.stylesheet.layers);this.setGlobalState((e=this.stylesheet.state)!==null&&e!==void 0?e:null),this.dispatcher.broadcast("SL",g),this._order=g.map((x=>x.id)),this._layers={},this._serializedLayers=null;for(const x of g){const E=u.bS(x,this._globalState);if(E.setEventedParent(this,{layer:{id:x.id}}),this._layers[x.id]=E,u.bT(E)&&this.tileManagers[E.source]){const P=(d=(a=x.paint)===null||a===void 0?void 0:a["raster-fade-duration"])!==null&&d!==void 0?d:E.paint.get("raster-fade-duration");this.tileManagers[E.source].setRasterFadeDuration(P)}}}_loadSprite(e,a=!1,d=void 0){let g;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(x,E,P,R){return u._(this,void 0,void 0,(function*(){const O=xe(x),j=P>1?"@2x":"",$={},q={};for(const{id:Q,url:nt}of O){const lt=E.transformRequest(Ae(nt,j,".json"),"SpriteJSON");$[Q]=u.j(lt,R);const ut=E.transformRequest(Ae(nt,j,".png"),"SpriteImage");q[Q]=Nt.getImage(ut,R)}return yield Promise.all([...Object.values($),...Object.values(q)]),(function(Q,nt){return u._(this,void 0,void 0,(function*(){const lt={};for(const ut in Q){lt[ut]={};const ft=it.getImageCanvasContext((yield nt[ut]).data),_t=(yield Q[ut]).data;for(const Tt in _t){const{width:gt,height:St,x:At,y:xt,sdf:zt,pixelRatio:$t,stretchX:Vt,stretchY:Ut,content:qt,textFitWidth:ge,textFitHeight:ye}=_t[Tt];lt[ut][Tt]={data:null,pixelRatio:$t,sdf:zt,stretchX:Vt,stretchY:Ut,content:qt,textFitWidth:ge,textFitHeight:ye,spriteData:{width:gt,height:St,x:At,y:xt,context:ft}}}}return lt}))})($,q)}))})(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((x=>{if(this._spriteRequest=null,x)for(const E in x){this._spritesImagesIds[E]=[];const P=this._spritesImagesIds[E]?this._spritesImagesIds[E].filter((R=>!(R in x))):[];for(const R of P)this.imageManager.removeImage(R),this._changedImages[R]=!0;for(const R in x[E]){const O=E==="default"?R:`${E}:${R}`;this._spritesImagesIds[E].push(O),O in this.imageManager.images?this.imageManager.updateImage(O,x[E][R],!1):this.imageManager.addImage(O,x[E][R]),a&&(this._changedImages[O]=!0)}}})).catch((x=>{this._spriteRequest=null,g=x,this.fire(new u.k(g))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.l("data",{dataType:"style"})),d&&d(g)}))}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.l("data",{dataType:"style"}))}_validateLayer(e){const a=this.tileManagers[e.source];if(!a)return;const d=e.sourceLayer;if(!d)return;const g=a.getSource();(g.type==="geojson"||g.vectorLayerIds&&g.vectorLayerIds.indexOf(d)===-1)&&this.fire(new u.k(new Error(`Source layer "${d}" does not exist on source "${g.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.tileManagers)if(!this.tileManagers[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,a=!1){const d=this._serializedAllLayers();if(!e||e.length===0)return Object.values(a?u.bU(d):d);const g=[];for(const x of e)if(d[x]){const E=a?u.bU(d[x]):d[x];g.push(E)}return g}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const a=Object.keys(this._layers);for(const d of a){const g=this._layers[d];g.type!=="custom"&&(e[d]=g.serialize())}return e}hasTransitions(){var e,a,d;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((a=this.sky)===null||a===void 0)&&a.hasTransition()||!((d=this.projection)===null||d===void 0)&&d.hasTransition())return!0;for(const g in this.tileManagers)if(this.tileManagers[g].hasTransition())return!0;for(const g in this._layers)if(this._layers[g].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const a=this._changed;if(a){const g=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(g.length||x.length)&&this._updateWorkerLayers(g,x);for(const E in this._updatedSources){const P=this._updatedSources[E];if(P==="reload")this._reloadSource(E);else{if(P!=="clear")throw new Error(`Invalid action ${P}`);this._clearSource(E)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const d={};for(const g in this.tileManagers){const x=this.tileManagers[g];d[g]=x.used,x.used=!1}for(const g of this._order){const x=this._layers[g];x.recalculate(e,this._availableImages),!x.isHidden(e.zoom)&&x.source&&(this.tileManagers[x.source].used=!0)}for(const g in d){const x=this.tileManagers[g];!!d[g]!=!!x.used&&x.fire(new u.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:g}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,a&&this.fire(new u.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const a in this.tileManagers)this.tileManagers[a].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.tileManagers)this.tileManagers[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,a={}){var d;this._checkLoaded();const g=this.serialize();if(e=a.transformStyle?a.transformStyle(g,e):e,((d=a.validate)===null||d===void 0||d)&&fl(this,u.C(e)))return!1;(e=u.bU(e)).layers=u.bR(e.layers);const x=u.bV(g,e),E=this._getOperationsToPerform(x);if(E.unimplemented.length>0)throw new Error(`Unimplemented: ${E.unimplemented.join(", ")}.`);if(E.operations.length===0)return!1;for(const P of E.operations)P();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const a=[],d=[];for(const g of e)switch(g.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":a.push((()=>this.addLayer.apply(this,g.args)));break;case"removeLayer":a.push((()=>this.removeLayer.apply(this,g.args)));break;case"setPaintProperty":a.push((()=>this.setPaintProperty.apply(this,g.args)));break;case"setLayoutProperty":a.push((()=>this.setLayoutProperty.apply(this,g.args)));break;case"setFilter":a.push((()=>this.setFilter.apply(this,g.args)));break;case"addSource":a.push((()=>this.addSource.apply(this,g.args)));break;case"removeSource":a.push((()=>this.removeSource.apply(this,g.args)));break;case"setLayerZoomRange":a.push((()=>this.setLayerZoomRange.apply(this,g.args)));break;case"setLight":a.push((()=>this.setLight.apply(this,g.args)));break;case"setGeoJSONSourceData":a.push((()=>this.setGeoJSONSourceData.apply(this,g.args)));break;case"setGlyphs":a.push((()=>this.setGlyphs.apply(this,g.args)));break;case"setSprite":a.push((()=>this.setSprite.apply(this,g.args)));break;case"setTerrain":a.push((()=>this.map.setTerrain.apply(this,g.args)));break;case"setSky":a.push((()=>this.setSky.apply(this,g.args)));break;case"setProjection":this.setProjection.apply(this,g.args);break;case"setGlobalState":a.push((()=>this.setGlobalState.apply(this,g.args)));break;case"setTransition":a.push((()=>{}));break;default:d.push(g.command)}return{operations:a,unimplemented:d}}addImage(e,a){if(this.getImage(e))return this.fire(new u.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,a),this._afterImageUpdated(e)}updateImage(e,a){this.imageManager.updateImage(e,a)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new u.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,a,d={}){if(this._checkLoaded(),this.tileManagers[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(u.C.source,`sources.${e}`,a,null,d))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const g=this.tileManagers[e]=new ln(e,a,this.dispatcher);g.style=this,g.setEventedParent(this,(()=>({isSourceLoaded:g.loaded(),source:g.serialize(),sourceId:e}))),g.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.tileManagers[e]===void 0)throw new Error("There is no source with this ID");for(const d in this._layers)if(this._layers[d].source===e)return this.fire(new u.k(new Error(`Source "${e}" cannot be removed while layer "${d}" is using it.`)));const a=this.tileManagers[e];delete this.tileManagers[e],delete this._updatedSources[e],a.fire(new u.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,a){if(this._checkLoaded(),this.tileManagers[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const d=this.tileManagers[e].getSource();if(d.type!=="geojson")throw new Error(`geojsonSource.type is ${d.type}, which is !== 'geojson`);d.setData(a),this._changed=!0}getSource(e){return this.tileManagers[e]&&this.tileManagers[e].getSource()}addLayer(e,a,d={}){this._checkLoaded();const g=e.id;if(this.getLayer(g))return void this.fire(new u.k(new Error(`Layer "${g}" already exists on this map.`)));let x;if(e.type==="custom"){if(fl(this,u.bW(e)))return;x=u.bS(e,this._globalState)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(g,e.source),e=u.bU(e),e=u.e(e,{source:g})),this._validate(u.C.layer,`layers.${g}`,e,{arrayIndex:-1},d))return;x=u.bS(e,this._globalState),this._validateLayer(x),x.setEventedParent(this,{layer:{id:g}})}const E=a?this._order.indexOf(a):this._order.length;if(a&&E===-1)this.fire(new u.k(new Error(`Cannot add layer "${g}" before non-existing layer "${a}".`)));else{if(this._order.splice(E,0,g),this._layerOrderChanged=!0,this._layers[g]=x,this._removedLayers[g]&&x.source&&x.type!=="custom"){const P=this._removedLayers[g];delete this._removedLayers[g],P.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",this.tileManagers[x.source].pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map)}}moveLayer(e,a){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new u.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===a)return;const d=this._order.indexOf(e);this._order.splice(d,1);const g=a?this._order.indexOf(a):this._order.length;a&&g===-1?this.fire(new u.k(new Error(`Cannot move layer "${e}" before non-existing layer "${a}".`))):(this._order.splice(g,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const a=this._layers[e];if(!a)return void this.fire(new u.k(new Error(`Cannot remove non-existing layer "${e}".`)));a.setEventedParent(null);const d=this._order.indexOf(e);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=a,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],a.onRemove&&a.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,a,d){this._checkLoaded();const g=this.getLayer(e);g?g.minzoom===a&&g.maxzoom===d||(a!=null&&(g.minzoom=a),d!=null&&(g.maxzoom=d),this._updateLayer(g)):this.fire(new u.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,a,d={}){this._checkLoaded();const g=this.getLayer(e);if(g){if(!u.bQ(g.filter,a))return a==null?(g.setFilter(void 0),void this._updateLayer(g)):void(this._validate(u.C.filter,`layers.${g.id}.filter`,a,null,d)||(g.setFilter(u.bU(a)),this._updateLayer(g)))}else this.fire(new u.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return u.bU(this.getLayer(e).filter)}setLayoutProperty(e,a,d,g={}){this._checkLoaded();const x=this.getLayer(e);x?u.bQ(x.getLayoutProperty(a),d)||(x.setLayoutProperty(a,d,g),this._updateLayer(x)):this.fire(new u.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,a){const d=this.getLayer(e);if(d)return d.getLayoutProperty(a);this.fire(new u.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,a,d,g={}){this._checkLoaded();const x=this.getLayer(e);x?u.bQ(x.getPaintProperty(a),d)||this._updatePaintProperty(x,a,d,g):this.fire(new u.k(new Error(`Cannot style non-existing layer "${e}".`)))}_updatePaintProperty(e,a,d,g={}){e.setPaintProperty(a,d,g)&&this._updateLayer(e),u.bT(e)&&a==="raster-fade-duration"&&this.tileManagers[e.source].setRasterFadeDuration(d),this._changed=!0,this._updatedPaintProps[e.id]=!0,this._serializedLayers=null}getPaintProperty(e,a){return this.getLayer(e).getPaintProperty(a)}setFeatureState(e,a){this._checkLoaded();const d=e.source,g=e.sourceLayer,x=this.tileManagers[d];if(x===void 0)return void this.fire(new u.k(new Error(`The source '${d}' does not exist in the map's style.`)));const E=x.getSource().type;E==="geojson"&&g?this.fire(new u.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||g?(e.id===void 0&&this.fire(new u.k(new Error("The feature id parameter must be provided."))),x.setFeatureState(g,e.id,a)):this.fire(new u.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,a){this._checkLoaded();const d=e.source,g=this.tileManagers[d];if(g===void 0)return void this.fire(new u.k(new Error(`The source '${d}' does not exist in the map's style.`)));const x=g.getSource().type,E=x==="vector"?e.sourceLayer:void 0;x!=="vector"||E?a&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new u.k(new Error("A feature id is required to remove its specific state property."))):g.removeFeatureState(E,e.id,a):this.fire(new u.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const a=e.source,d=e.sourceLayer,g=this.tileManagers[a];if(g!==void 0)return g.getSource().type!=="vector"||d?(e.id===void 0&&this.fire(new u.k(new Error("The feature id parameter must be provided."))),g.getFeatureState(d,e.id)):void this.fire(new u.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new u.k(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return u.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=u.bX(this.tileManagers,(x=>x.serialize())),a=this._serializeByIds(this._order,!0),d=this.map.getTerrain()||void 0,g=this.stylesheet;return u.bY({version:g.version,name:g.name,metadata:g.metadata,light:g.light,sky:g.sky,center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch,sprite:g.sprite,glyphs:g.glyphs,transition:g.transition,projection:g.projection,sources:e,layers:a,terrain:d},(x=>x!==void 0))}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.tileManagers[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.tileManagers[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const a=E=>this._layers[E].type==="fill-extrusion",d={},g=[];for(let E=this._order.length-1;E>=0;E--){const P=this._order[E];if(a(P)){d[P]=E;for(const R of e){const O=R[P];if(O)for(const j of O)g.push(j)}}}g.sort(((E,P)=>P.intersectionZ-E.intersectionZ));const x=[];for(let E=this._order.length-1;E>=0;E--){const P=this._order[E];if(a(P))for(let R=g.length-1;R>=0;R--){const O=g[R].feature;if(d[O.layer.id]<E)break;x.push(O),g.pop()}else for(const R of e){const O=R[P];if(O)for(const j of O)x.push(j.feature)}}return x}queryRenderedFeatures(e,a,d){a&&a.filter&&this._validate(u.C.filter,"queryRenderedFeatures.filter",a.filter,null,a);const g={};if(a&&a.layers){if(!(Array.isArray(a.layers)||a.layers instanceof Set))return this.fire(new u.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const O of a.layers){const j=this._layers[O];if(!j)return this.fire(new u.k(new Error(`The layer '${O}' does not exist in the map's style and cannot be queried for features.`))),[];g[j.source]=!0}}const x=[];a.availableImages=this._availableImages;const E=this._serializedAllLayers(),P=a.layers instanceof Set?a.layers:Array.isArray(a.layers)?new Set(a.layers):null,R=Object.assign(Object.assign({},a),{layers:P,globalState:this._globalState});for(const O in this.tileManagers)a.layers&&!g[O]||x.push(Vs(this.tileManagers[O],this._layers,E,e,R,d,this.map.terrain?(j,$,q)=>this.map.terrain.getElevation(j,$,q):void 0));return this.placement&&x.push((function(O,j,$,q,Q,nt,lt){const ut={},ft=nt.queryRenderedSymbols(q),_t=[];for(const Tt of Object.keys(ft).map(Number))_t.push(lt[Tt]);_t.sort(Nn);for(const Tt of _t){const gt=Tt.featureIndex.lookupSymbolFeatures(ft[Tt.bucketInstanceId],j,Tt.bucketIndex,Tt.sourceLayerIndex,{filterSpec:Q.filter,globalState:Q.globalState},Q.layers,Q.availableImages,O);for(const St in gt){const At=ut[St]=ut[St]||[],xt=gt[St];xt.sort(((zt,$t)=>{const Vt=Tt.featureSortOrder;if(Vt){const Ut=Vt.indexOf(zt.featureIndex);return Vt.indexOf($t.featureIndex)-Ut}return $t.featureIndex-zt.featureIndex}));for(const zt of xt)At.push(zt)}}return(function(Tt,gt,St){for(const At in Tt)for(const xt of Tt[At])os(xt,St[gt[At].source]);return Tt})(ut,O,$)})(this._layers,E,this.tileManagers,e,R,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(e,a){a?.filter&&this._validate(u.C.filter,"querySourceFeatures.filter",a.filter,null,a);const d=this.tileManagers[e];return d?(function(g,x){const E=g.getRenderableIds().map((O=>g.getTileByID(O))),P=[],R={};for(let O=0;O<E.length;O++){const j=E[O],$=j.tileID.canonical.key;R[$]||(R[$]=!0,j.querySourceFeatures(P,x))}return P})(d,a?Object.assign(Object.assign({},a),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(e,a={}){this._checkLoaded();const d=this.light.getLight();let g=!1;for(const E in e)if(!u.bQ(e[E],d[E])){g=!0;break}if(!g)return;const x={now:rt(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,a),this.light.updateTransitions(x)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,a={}){this._checkLoaded();const d=this.getSky();let g=!1;if(!e&&!d)return;if(e&&!d)g=!0;else if(!e&&d)g=!0;else for(const E in e)if(!u.bQ(e[E],d[E])){g=!0;break}if(!g)return;const x={now:rt(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,a),this.sky.updateTransitions(x)}_setProjectionInternal(e){const a=(function(d,g){const x={constrainOverride:g};if(Array.isArray(d)){const E=new Mo({type:d});return{projection:E,transform:new gh(x),cameraHelper:new yh(E)}}switch(d){case"mercator":return{projection:new Li,transform:new $n(x),cameraHelper:new ur};case"globe":{const E=new Mo({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:E,transform:new gh(x),cameraHelper:new yh(E)}}case"vertical-perspective":return{projection:new cu,transform:new mh(x),cameraHelper:new Kr};default:return u.w(`Unknown projection name: ${d}. Falling back to mercator projection.`),{projection:new Li,transform:new $n(x),cameraHelper:new ur}}})(e,this.map.transformConstrain);this.projection=a.projection,this.map.migrateProjection(a.transform,a.cameraHelper);for(const d in this.tileManagers)this.tileManagers[d].reload()}_validate(e,a,d,g,x={}){return(!x||x.validate!==!1)&&fl(this,e.call(u.C,u.e({key:a,style:this.serialize(),value:d,styleSpec:u.u},g)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Ir().off(Ga,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.tileManagers){const d=this.tileManagers[a];d.setEventedParent(null),d.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.tileManagers[e].clearTiles()}_reloadSource(e){this.tileManagers[e].resume(),this.tileManagers[e].reload()}_updateSources(e){for(const a in this.tileManagers)this.tileManagers[a].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.tileManagers)this._reloadSource(e)}_updatePlacement(e,a,d,g,x=!1){let E=!1,P=!1;const R={};for(const O of this._order){const j=this._layers[O];if(j.type!=="symbol")continue;if(!R[j.source]){const q=this.tileManagers[j.source];R[j.source]=q.getRenderableIds(!0).map((Q=>q.getTileByID(Q))).sort(((Q,nt)=>nt.tileID.overscaledZ-Q.tileID.overscaledZ||(Q.tileID.isLessThan(nt.tileID)?-1:1)))}const $=this.crossTileSymbolIndex.addLayer(j,R[j.source],e.center.lng);E=E||$}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((x=x||this._layerOrderChanged||d===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(rt(),e.zoom))&&(this.pauseablePlacement=new hl(e,this.map.terrain,this._order,x,a,d,g,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,R),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(rt()),P=!0),E&&this.pauseablePlacement.placement.setStale()),P||E)for(const O of this._order){const j=this._layers[O];j.type==="symbol"&&this.placement.updateLayerOpacities(j,R[j.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(rt())}_releaseSymbolFadeTiles(){for(const e in this.tileManagers)this.tileManagers[e].releaseSymbolFadeTiles()}getImages(e,a){return u._(this,void 0,void 0,(function*(){const d=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const g=this.tileManagers[a.source];return g&&g.setDependencies(a.tileID.key,a.type,a.icons),d}))}getGlyphs(e,a){return u._(this,void 0,void 0,(function*(){const d=yield this.glyphManager.getGlyphs(a.stacks),g=this.tileManagers[a.source];return g&&g.setDependencies(a.tileID.key,a.type,[""]),d}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,a={}){this._checkLoaded(),e&&this._validate(u.C.glyphs,"glyphs",e,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}getDashes(e,a){return u._(this,void 0,void 0,(function*(){const d={};for(const[g,x]of Object.entries(a.dashes))d[g]=this.lineAtlas.getDash(x.dasharray,x.round);return d}))}addSprite(e,a,d={},g){this._checkLoaded();const x=[{id:e,url:a}],E=[...xe(this.stylesheet.sprite),...x];this._validate(u.C.sprite,"sprite",E,null,d)||(this.stylesheet.sprite=E,this._loadSprite(x,!0,g))}removeSprite(e){this._checkLoaded();const a=xe(this.stylesheet.sprite);if(a.find((d=>d.id===e))){if(this._spritesImagesIds[e])for(const d of this._spritesImagesIds[e])this.imageManager.removeImage(d),this._changedImages[d]=!0;a.splice(a.findIndex((d=>d.id===e)),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.l("data",{dataType:"style"}))}else this.fire(new u.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return xe(this.stylesheet.sprite)}setSprite(e,a={},d){this._checkLoaded(),e&&this._validate(u.C.sprite,"sprite",e,null,a)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,d):(this._unloadSprite(),d&&d(null)))}destroy(){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null);for(const e in this.tileManagers){const a=this.tileManagers[e];if(a.setEventedParent(null),a._tiles){for(const d in a._tiles)a._tiles[d].unloadVectorData();a._tiles={}}a._cache.reset(),a.onRemove(this.map)}this.tileManagers={},this.imageManager&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this._availableImages=[],this._spritesImagesIds={}),this.glyphManager&&this.glyphManager.destroy();for(const e in this._layers){const a=this._layers[e];a.setEventedParent(null),a.onRemove&&a.onRemove(this.map)}this._setInitialValues(),this.setEventedParent(null),this.dispatcher.unregisterMessageHandler("GG"),this.dispatcher.unregisterMessageHandler("GI"),this.dispatcher.unregisterMessageHandler("GDA"),this.dispatcher.remove(!0),this._listeners={},this._oneTimeListeners={}}}var wa=u.aT([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Md{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,a,d,g,x,E,P,R,O){this.context=e;let j=this.boundPaintVertexBuffers.length!==g.length;for(let $=0;!j&&$<g.length;$++)this.boundPaintVertexBuffers[$]!==g[$]&&(j=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==d||j||this.boundIndexBuffer!==x||this.boundVertexOffset!==E||this.boundDynamicVertexBuffer!==P||this.boundDynamicVertexBuffer2!==R||this.boundDynamicVertexBuffer3!==O?this.freshBind(a,d,g,x,E,P,R,O):(e.bindVertexArray.set(this.vao),P&&P.bind(),x&&x.dynamicDraw&&x.bind(),R&&R.bind(),O&&O.bind())}freshBind(e,a,d,g,x,E,P,R){const O=e.numAttributes,j=this.context,$=j.gl;this.vao&&this.destroy(),this.vao=j.createVertexArray(),j.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=d,this.boundIndexBuffer=g,this.boundVertexOffset=x,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=P,this.boundDynamicVertexBuffer3=R,a.enableAttributes($,e);for(const q of d)q.enableAttributes($,e);E&&E.enableAttributes($,e),P&&P.enableAttributes($,e),R&&R.enableAttributes($,e),a.bind(),a.setVertexAttribPointers($,e,x);for(const q of d)q.bind(),q.setVertexAttribPointers($,e,x);E&&(E.bind(),E.setVertexAttribPointers($,e,x)),g&&g.bind(),P&&(P.bind(),P.setVertexAttribPointers($,e,x)),R&&(R.bind(),R.setVertexAttribPointers($,e,x)),j.currentNumAttributes=O}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const pl=(v,e,a,d,g)=>({u_texture:0,u_ele_delta:v,u_fog_matrix:e,u_fog_color:a?a.properties.get("fog-color"):u.bo.white,u_fog_ground_blend:a?a.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:g?0:a?a.calculateFogBlendOpacity(d):0,u_horizon_color:a?a.properties.get("horizon-color"):u.bo.white,u_horizon_fog_blend:a?a.properties.get("horizon-fog-blend"):1,u_is_globe_mode:g?1:0}),hu={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Ya(v){const e=[];for(let a=0;a<v.length;a++){if(v[a]===null)continue;const d=v[a].split(" ");e.push(d.pop())}return e}class Xf{constructor(e,a,d,g,x,E,P,R,O=[]){const j=e.gl;this.program=j.createProgram();const $=Ya(a.staticAttributes),q=d?d.getBinderAttributes():[],Q=$.concat(q),nt=Lr.prelude.staticUniforms?Ya(Lr.prelude.staticUniforms):[],lt=P.staticUniforms?Ya(P.staticUniforms):[],ut=a.staticUniforms?Ya(a.staticUniforms):[],ft=d?d.getBinderUniforms():[],_t=nt.concat(lt).concat(ut).concat(ft),Tt=[];for(const Vt of _t)Tt.indexOf(Vt)<0&&Tt.push(Vt);const gt=d?d.defines():[];us(j)&&gt.unshift("#version 300 es"),x&&gt.push("#define OVERDRAW_INSPECTOR;"),E&&gt.push("#define TERRAIN3D;"),R&&gt.push(R),O&&gt.push(...O);let St=gt.concat(Lr.prelude.fragmentSource,P.fragmentSource,a.fragmentSource).join(`
`),At=gt.concat(Lr.prelude.vertexSource,P.vertexSource,a.vertexSource).join(`
`);us(j)||(St=(function(Vt){return Vt.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(St),At=(function(Vt){return Vt.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(At));const xt=j.createShader(j.FRAGMENT_SHADER);if(j.isContextLost())return void(this.failedToCreate=!0);if(j.shaderSource(xt,St),j.compileShader(xt),!j.getShaderParameter(xt,j.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${j.getShaderInfoLog(xt)}`);j.attachShader(this.program,xt);const zt=j.createShader(j.VERTEX_SHADER);if(j.isContextLost())return void(this.failedToCreate=!0);if(j.shaderSource(zt,At),j.compileShader(zt),!j.getShaderParameter(zt,j.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${j.getShaderInfoLog(zt)}`);j.attachShader(this.program,zt),this.attributes={};const $t={};this.numAttributes=Q.length;for(let Vt=0;Vt<this.numAttributes;Vt++)Q[Vt]&&(j.bindAttribLocation(this.program,Vt,Q[Vt]),this.attributes[Q[Vt]]=Vt);if(j.linkProgram(this.program),!j.getProgramParameter(this.program,j.LINK_STATUS))throw new Error(`Program failed to link: ${j.getProgramInfoLog(this.program)}`);j.deleteShader(zt),j.deleteShader(xt);for(let Vt=0;Vt<Tt.length;Vt++){const Ut=Tt[Vt];if(Ut&&!$t[Ut]){const qt=j.getUniformLocation(this.program,Ut);qt&&($t[Ut]=qt)}}this.fixedUniforms=g(e,$t),this.terrainUniforms=((Vt,Ut)=>({u_depth:new u.bZ(Vt,Ut.u_depth),u_terrain:new u.bZ(Vt,Ut.u_terrain),u_terrain_dim:new u.bp(Vt,Ut.u_terrain_dim),u_terrain_matrix:new u.b$(Vt,Ut.u_terrain_matrix),u_terrain_unpack:new u.c0(Vt,Ut.u_terrain_unpack),u_terrain_exaggeration:new u.bp(Vt,Ut.u_terrain_exaggeration)}))(e,$t),this.projectionUniforms=((Vt,Ut)=>({u_projection_matrix:new u.b$(Vt,Ut.u_projection_matrix),u_projection_tile_mercator_coords:new u.c0(Vt,Ut.u_projection_tile_mercator_coords),u_projection_clipping_plane:new u.c0(Vt,Ut.u_projection_clipping_plane),u_projection_transition:new u.bp(Vt,Ut.u_projection_transition),u_projection_fallback_matrix:new u.b$(Vt,Ut.u_projection_fallback_matrix)}))(e,$t),this.binderUniforms=d?d.getUniforms(e,$t):[]}draw(e,a,d,g,x,E,P,R,O,j,$,q,Q,nt,lt,ut,ft,_t,Tt){const gt=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(d),e.setStencilMode(g),e.setColorMode(x),e.setCullFace(E),R){e.activeTexture.set(gt.TEXTURE2),gt.bindTexture(gt.TEXTURE_2D,R.depthTexture),e.activeTexture.set(gt.TEXTURE3),gt.bindTexture(gt.TEXTURE_2D,R.texture);for(const At in this.terrainUniforms)this.terrainUniforms[At].set(R[At])}if(O)for(const At in O)this.projectionUniforms[hu[At]].set(O[At]);if(P)for(const At in this.fixedUniforms)this.fixedUniforms[At].set(P[At]);ut&&ut.setUniforms(e,this.binderUniforms,nt,{zoom:lt});let St=0;switch(a){case gt.LINES:St=2;break;case gt.TRIANGLES:St=3;break;case gt.LINE_STRIP:St=1}for(const At of Q.get()){const xt=At.vaos||(At.vaos={});(xt[j]||(xt[j]=new Md)).bind(e,this,$,ut?ut.getPaintVertexBuffers():[],q,At.vertexOffset,ft,_t,Tt),gt.drawElements(a,At.primitiveLength*St,gt.UNSIGNED_SHORT,At.primitiveOffset*St*2)}}}function cc(v,e,a){const d=1/u.aM(a,1,e.transform.tileZoom),g=Math.pow(2,a.tileID.overscaledZ),x=a.tileSize*Math.pow(2,e.transform.tileZoom)/g,E=x*(a.tileID.canonical.x+a.tileID.wrap*g),P=x*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[d,v.fromScale,v.toScale],u_fade:v.t,u_pixel_coord_upper:[E>>16,P>>16],u_pixel_coord_lower:[65535&E,65535&P]}}const Pd=(v,e,a,d)=>{const g=v.style.light,x=g.properties.get("position"),E=[x.x,x.y,x.z],P=u.c3();g.properties.get("anchor")==="viewport"&&u.c4(P,v.transform.bearingInRadians),u.c5(E,E,P);const R=v.transform.transformLightDirection(E),O=g.properties.get("color");return{u_lightpos:E,u_lightpos_globe:R,u_lightintensity:g.properties.get("intensity"),u_lightcolor:[O.r,O.g,O.b],u_vertical_gradient:+e,u_opacity:a,u_fill_translate:d}},ml=(v,e,a,d,g,x,E)=>u.e(Pd(v,e,a,d),cc(x,v,E),{u_height_factor:-Math.pow(2,g.overscaledZ)/E.tileSize/8}),gl=(v,e,a,d)=>u.e(cc(e,v,a),{u_fill_translate:d}),Yf=(v,e)=>({u_world:v,u_fill_translate:e}),Sm=(v,e,a,d,g)=>u.e(gl(v,e,a,g),{u_world:d}),Wf=(v,e,a,d,g)=>{const x=v.transform;let E,P,R=0;if(a.paint.get("circle-pitch-alignment")==="map"){const O=u.aM(e,1,x.zoom);E=!0,P=[O,O],R=O/(u.a4*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*g}else E=!1,P=x.pixelsToGLUnits;return{u_camera_to_center_distance:x.cameraToCenterDistance,u_scale_with_map:+(a.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+E,u_device_pixel_ratio:v.pixelRatio,u_extrude_scale:P,u_globe_extrude_scale:R,u_translate:d}},_h=v=>({u_pixel_extrude_scale:[1/v.width,1/v.height]}),Dd=v=>({u_viewport_size:[v.width,v.height]}),yl=(v,e=1)=>({u_color:v,u_overlay:0,u_overlay_scale:e}),_l=(v,e,a,d)=>{const g=u.aM(v,1,e)/(u.a4*Math.pow(2,v.tileID.overscaledZ))*2*Math.PI*d;return{u_extrude_scale:u.aM(v,1,e),u_intensity:a,u_globe_extrude_scale:g}},Rd=(v,e,a,d)=>{const g=u.N();u.c6(g,0,v.width,v.height,0,0,1);const x=v.context.gl;return{u_matrix:g,u_world:[x.drawingBufferWidth,x.drawingBufferHeight],u_image:a,u_color_ramp:d,u_opacity:e.paint.get("heatmap-opacity")}},Ta=(v,e,a)=>{const d=a.paint.get("hillshade-accent-color");let g;switch(a.paint.get("hillshade-method")){case"basic":g=4;break;case"combined":g=1;break;case"igor":g=2;break;case"multidirectional":g=3;break;default:g=0}const x=a.getIlluminationProperties();for(let E=0;E<x.directionRadians.length;E++)a.paint.get("hillshade-illumination-anchor")==="viewport"&&(x.directionRadians[E]+=v.transform.bearingInRadians);return{u_image:0,u_latrange:zd(0,e.tileID),u_exaggeration:a.paint.get("hillshade-exaggeration"),u_altitudes:x.altitudeRadians,u_azimuths:x.directionRadians,u_accent:d,u_method:g,u_highlights:x.highlightColor,u_shadows:x.shadowColor}},Id=(v,e)=>{const a=e.stride,d=u.N();return u.c6(d,0,u.a4,-u.a4,0,0,1),u.O(d,d,[0,-u.a4,0]),{u_matrix:d,u_image:1,u_dimension:[a,a],u_zoom:v.overscaledZ,u_unpack:e.getUnpackVector()}};function zd(v,e){const a=Math.pow(2,e.canonical.z),d=e.canonical.y;return[new u.aa(0,d/a).toLngLat().lat,new u.aa(0,(d+1)/a).toLngLat().lat]}const vl=(v,e,a=0)=>({u_image:0,u_unpack:e.getUnpackVector(),u_dimension:[e.stride,e.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:a,u_opacity:v.paint.get("color-relief-opacity")}),uc=(v,e,a,d)=>{const g=v.transform;return{u_translation:Ld(v,e,a),u_ratio:d/u.aM(e,1,g.zoom),u_device_pixel_ratio:v.pixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},hc=(v,e,a,d,g)=>u.e(uc(v,e,a,d),{u_image:0,u_image_height:g}),Kf=(v,e,a,d,g)=>{const x=v.transform,E=vh(e,x);return{u_translation:Ld(v,e,a),u_texsize:e.imageAtlasTexture.size,u_ratio:d/u.aM(e,1,x.zoom),u_device_pixel_ratio:v.pixelRatio,u_image:0,u_scale:[E,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},Qf=(v,e,a,d,g)=>{const x=vh(e,v.transform);return u.e(uc(v,e,a,d),{u_tileratio:x,u_crossfade_from:g.fromScale,u_crossfade_to:g.toScale,u_image:0,u_mix:g.t,u_lineatlas_width:v.lineAtlas.width,u_lineatlas_height:v.lineAtlas.height})},Jf=(v,e,a,d,g,x)=>{const E=vh(e,v.transform);return u.e(uc(v,e,a,d),{u_image:0,u_image_height:x,u_tileratio:E,u_crossfade_from:g.fromScale,u_crossfade_to:g.toScale,u_image_dash:1,u_mix:g.t,u_lineatlas_width:v.lineAtlas.width,u_lineatlas_height:v.lineAtlas.height})};function vh(v,e){return 1/u.aM(v,1,e.tileZoom)}function Ld(v,e,a){return u.aN(v.transform,e,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const kd=(v,e,a,d,g)=>{return{u_tl_parent:v,u_scale_parent:e,u_buffer_scale:1,u_fade_t:a.mix,u_opacity:a.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(E=d.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(x=d.paint.get("raster-contrast"),x>0?1/(1-x):1+x),u_spin_weights:tp(d.paint.get("raster-hue-rotate")),u_coords_top:[g[0].x,g[0].y,g[1].x,g[1].y],u_coords_bottom:[g[3].x,g[3].y,g[2].x,g[2].y]};var x,E};function tp(v){v*=Math.PI/180;const e=Math.sin(v),a=Math.cos(v);return[(2*a+1)/3,(-Math.sqrt(3)*e-a+1)/3,(Math.sqrt(3)*e-a+1)/3]}const dr=(v,e,a,d,g,x,E,P,R,O,j,$,q)=>{const Q=E.transform;return{u_is_size_zoom_constant:+(v==="constant"||v==="source"),u_is_size_feature_constant:+(v==="constant"||v==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:Q.cameraToCenterDistance,u_pitch:Q.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:Q.width/Q.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_label_plane_matrix:P,u_coord_matrix:R,u_is_text:+j,u_pitch_with_map:+d,u_is_along_line:g,u_is_variable_anchor:x,u_texsize:$,u_texture:0,u_translation:O,u_pitched_scale:q}},Qr=(v,e,a,d,g,x,E,P,R,O,j,$,q,Q)=>{const nt=E.transform;return u.e(dr(v,e,a,d,g,x,E,P,R,O,j,$,Q),{u_gamma_scale:d?Math.cos(nt.pitch*Math.PI/180)*nt.cameraToCenterDistance:1,u_device_pixel_ratio:E.pixelRatio,u_is_halo:1})},xh=(v,e,a,d,g,x,E,P,R,O,j,$,q)=>u.e(Qr(v,e,a,d,g,x,E,P,R,O,!0,j,0,q),{u_texsize_icon:$,u_texture_icon:1}),bh=(v,e)=>({u_opacity:v,u_color:e}),wh=(v,e,a,d,g)=>u.e((function(x,E,P,R){const O=P.imageManager.getPattern(x.from.toString()),j=P.imageManager.getPattern(x.to.toString()),{width:$,height:q}=P.imageManager.getPixelSize(),Q=Math.pow(2,R.tileID.overscaledZ),nt=R.tileSize*Math.pow(2,P.transform.tileZoom)/Q,lt=nt*(R.tileID.canonical.x+R.tileID.wrap*Q),ut=nt*R.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:O.tl,u_pattern_br_a:O.br,u_pattern_tl_b:j.tl,u_pattern_br_b:j.br,u_texsize:[$,q],u_mix:E.t,u_pattern_size_a:O.displaySize,u_pattern_size_b:j.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/u.aM(R,1,P.transform.tileZoom),u_pixel_coord_upper:[lt>>16,ut>>16],u_pixel_coord_lower:[65535&lt,65535&ut]}})(a,g,e,d),{u_opacity:v}),Th=(v,e)=>{},du={fillExtrusion:(v,e)=>({u_lightpos:new u.c1(v,e.u_lightpos),u_lightpos_globe:new u.c1(v,e.u_lightpos_globe),u_lightintensity:new u.bp(v,e.u_lightintensity),u_lightcolor:new u.c1(v,e.u_lightcolor),u_vertical_gradient:new u.bp(v,e.u_vertical_gradient),u_opacity:new u.bp(v,e.u_opacity),u_fill_translate:new u.c2(v,e.u_fill_translate)}),fillExtrusionPattern:(v,e)=>({u_lightpos:new u.c1(v,e.u_lightpos),u_lightpos_globe:new u.c1(v,e.u_lightpos_globe),u_lightintensity:new u.bp(v,e.u_lightintensity),u_lightcolor:new u.c1(v,e.u_lightcolor),u_vertical_gradient:new u.bp(v,e.u_vertical_gradient),u_height_factor:new u.bp(v,e.u_height_factor),u_opacity:new u.bp(v,e.u_opacity),u_fill_translate:new u.c2(v,e.u_fill_translate),u_image:new u.bZ(v,e.u_image),u_texsize:new u.c2(v,e.u_texsize),u_pixel_coord_upper:new u.c2(v,e.u_pixel_coord_upper),u_pixel_coord_lower:new u.c2(v,e.u_pixel_coord_lower),u_scale:new u.c1(v,e.u_scale),u_fade:new u.bp(v,e.u_fade)}),fill:(v,e)=>({u_fill_translate:new u.c2(v,e.u_fill_translate)}),fillPattern:(v,e)=>({u_image:new u.bZ(v,e.u_image),u_texsize:new u.c2(v,e.u_texsize),u_pixel_coord_upper:new u.c2(v,e.u_pixel_coord_upper),u_pixel_coord_lower:new u.c2(v,e.u_pixel_coord_lower),u_scale:new u.c1(v,e.u_scale),u_fade:new u.bp(v,e.u_fade),u_fill_translate:new u.c2(v,e.u_fill_translate)}),fillOutline:(v,e)=>({u_world:new u.c2(v,e.u_world),u_fill_translate:new u.c2(v,e.u_fill_translate)}),fillOutlinePattern:(v,e)=>({u_world:new u.c2(v,e.u_world),u_image:new u.bZ(v,e.u_image),u_texsize:new u.c2(v,e.u_texsize),u_pixel_coord_upper:new u.c2(v,e.u_pixel_coord_upper),u_pixel_coord_lower:new u.c2(v,e.u_pixel_coord_lower),u_scale:new u.c1(v,e.u_scale),u_fade:new u.bp(v,e.u_fade),u_fill_translate:new u.c2(v,e.u_fill_translate)}),circle:(v,e)=>({u_camera_to_center_distance:new u.bp(v,e.u_camera_to_center_distance),u_scale_with_map:new u.bZ(v,e.u_scale_with_map),u_pitch_with_map:new u.bZ(v,e.u_pitch_with_map),u_extrude_scale:new u.c2(v,e.u_extrude_scale),u_device_pixel_ratio:new u.bp(v,e.u_device_pixel_ratio),u_globe_extrude_scale:new u.bp(v,e.u_globe_extrude_scale),u_translate:new u.c2(v,e.u_translate)}),collisionBox:(v,e)=>({u_pixel_extrude_scale:new u.c2(v,e.u_pixel_extrude_scale)}),collisionCircle:(v,e)=>({u_viewport_size:new u.c2(v,e.u_viewport_size)}),debug:(v,e)=>({u_color:new u.b_(v,e.u_color),u_overlay:new u.bZ(v,e.u_overlay),u_overlay_scale:new u.bp(v,e.u_overlay_scale)}),depth:Th,clippingMask:Th,heatmap:(v,e)=>({u_extrude_scale:new u.bp(v,e.u_extrude_scale),u_intensity:new u.bp(v,e.u_intensity),u_globe_extrude_scale:new u.bp(v,e.u_globe_extrude_scale)}),heatmapTexture:(v,e)=>({u_matrix:new u.b$(v,e.u_matrix),u_world:new u.c2(v,e.u_world),u_image:new u.bZ(v,e.u_image),u_color_ramp:new u.bZ(v,e.u_color_ramp),u_opacity:new u.bp(v,e.u_opacity)}),hillshade:(v,e)=>({u_image:new u.bZ(v,e.u_image),u_latrange:new u.c2(v,e.u_latrange),u_exaggeration:new u.bp(v,e.u_exaggeration),u_altitudes:new u.c8(v,e.u_altitudes),u_azimuths:new u.c8(v,e.u_azimuths),u_accent:new u.b_(v,e.u_accent),u_method:new u.bZ(v,e.u_method),u_shadows:new u.c7(v,e.u_shadows),u_highlights:new u.c7(v,e.u_highlights)}),hillshadePrepare:(v,e)=>({u_matrix:new u.b$(v,e.u_matrix),u_image:new u.bZ(v,e.u_image),u_dimension:new u.c2(v,e.u_dimension),u_zoom:new u.bp(v,e.u_zoom),u_unpack:new u.c0(v,e.u_unpack)}),colorRelief:(v,e)=>({u_image:new u.bZ(v,e.u_image),u_unpack:new u.c0(v,e.u_unpack),u_dimension:new u.c2(v,e.u_dimension),u_elevation_stops:new u.bZ(v,e.u_elevation_stops),u_color_stops:new u.bZ(v,e.u_color_stops),u_color_ramp_size:new u.bZ(v,e.u_color_ramp_size),u_opacity:new u.bp(v,e.u_opacity)}),line:(v,e)=>({u_translation:new u.c2(v,e.u_translation),u_ratio:new u.bp(v,e.u_ratio),u_device_pixel_ratio:new u.bp(v,e.u_device_pixel_ratio),u_units_to_pixels:new u.c2(v,e.u_units_to_pixels)}),lineGradient:(v,e)=>({u_translation:new u.c2(v,e.u_translation),u_ratio:new u.bp(v,e.u_ratio),u_device_pixel_ratio:new u.bp(v,e.u_device_pixel_ratio),u_units_to_pixels:new u.c2(v,e.u_units_to_pixels),u_image:new u.bZ(v,e.u_image),u_image_height:new u.bp(v,e.u_image_height)}),linePattern:(v,e)=>({u_translation:new u.c2(v,e.u_translation),u_texsize:new u.c2(v,e.u_texsize),u_ratio:new u.bp(v,e.u_ratio),u_device_pixel_ratio:new u.bp(v,e.u_device_pixel_ratio),u_image:new u.bZ(v,e.u_image),u_units_to_pixels:new u.c2(v,e.u_units_to_pixels),u_scale:new u.c1(v,e.u_scale),u_fade:new u.bp(v,e.u_fade)}),lineSDF:(v,e)=>({u_translation:new u.c2(v,e.u_translation),u_ratio:new u.bp(v,e.u_ratio),u_device_pixel_ratio:new u.bp(v,e.u_device_pixel_ratio),u_units_to_pixels:new u.c2(v,e.u_units_to_pixels),u_image:new u.bZ(v,e.u_image),u_mix:new u.bp(v,e.u_mix),u_tileratio:new u.bp(v,e.u_tileratio),u_crossfade_from:new u.bp(v,e.u_crossfade_from),u_crossfade_to:new u.bp(v,e.u_crossfade_to),u_lineatlas_width:new u.bp(v,e.u_lineatlas_width),u_lineatlas_height:new u.bp(v,e.u_lineatlas_height)}),lineGradientSDF:(v,e)=>({u_translation:new u.c2(v,e.u_translation),u_ratio:new u.bp(v,e.u_ratio),u_device_pixel_ratio:new u.bp(v,e.u_device_pixel_ratio),u_units_to_pixels:new u.c2(v,e.u_units_to_pixels),u_image:new u.bZ(v,e.u_image),u_image_height:new u.bp(v,e.u_image_height),u_tileratio:new u.bp(v,e.u_tileratio),u_crossfade_from:new u.bp(v,e.u_crossfade_from),u_crossfade_to:new u.bp(v,e.u_crossfade_to),u_image_dash:new u.bZ(v,e.u_image_dash),u_mix:new u.bp(v,e.u_mix),u_lineatlas_width:new u.bp(v,e.u_lineatlas_width),u_lineatlas_height:new u.bp(v,e.u_lineatlas_height)}),raster:(v,e)=>({u_tl_parent:new u.c2(v,e.u_tl_parent),u_scale_parent:new u.bp(v,e.u_scale_parent),u_buffer_scale:new u.bp(v,e.u_buffer_scale),u_fade_t:new u.bp(v,e.u_fade_t),u_opacity:new u.bp(v,e.u_opacity),u_image0:new u.bZ(v,e.u_image0),u_image1:new u.bZ(v,e.u_image1),u_brightness_low:new u.bp(v,e.u_brightness_low),u_brightness_high:new u.bp(v,e.u_brightness_high),u_saturation_factor:new u.bp(v,e.u_saturation_factor),u_contrast_factor:new u.bp(v,e.u_contrast_factor),u_spin_weights:new u.c1(v,e.u_spin_weights),u_coords_top:new u.c0(v,e.u_coords_top),u_coords_bottom:new u.c0(v,e.u_coords_bottom)}),symbolIcon:(v,e)=>({u_is_size_zoom_constant:new u.bZ(v,e.u_is_size_zoom_constant),u_is_size_feature_constant:new u.bZ(v,e.u_is_size_feature_constant),u_size_t:new u.bp(v,e.u_size_t),u_size:new u.bp(v,e.u_size),u_camera_to_center_distance:new u.bp(v,e.u_camera_to_center_distance),u_pitch:new u.bp(v,e.u_pitch),u_rotate_symbol:new u.bZ(v,e.u_rotate_symbol),u_aspect_ratio:new u.bp(v,e.u_aspect_ratio),u_fade_change:new u.bp(v,e.u_fade_change),u_label_plane_matrix:new u.b$(v,e.u_label_plane_matrix),u_coord_matrix:new u.b$(v,e.u_coord_matrix),u_is_text:new u.bZ(v,e.u_is_text),u_pitch_with_map:new u.bZ(v,e.u_pitch_with_map),u_is_along_line:new u.bZ(v,e.u_is_along_line),u_is_variable_anchor:new u.bZ(v,e.u_is_variable_anchor),u_texsize:new u.c2(v,e.u_texsize),u_texture:new u.bZ(v,e.u_texture),u_translation:new u.c2(v,e.u_translation),u_pitched_scale:new u.bp(v,e.u_pitched_scale)}),symbolSDF:(v,e)=>({u_is_size_zoom_constant:new u.bZ(v,e.u_is_size_zoom_constant),u_is_size_feature_constant:new u.bZ(v,e.u_is_size_feature_constant),u_size_t:new u.bp(v,e.u_size_t),u_size:new u.bp(v,e.u_size),u_camera_to_center_distance:new u.bp(v,e.u_camera_to_center_distance),u_pitch:new u.bp(v,e.u_pitch),u_rotate_symbol:new u.bZ(v,e.u_rotate_symbol),u_aspect_ratio:new u.bp(v,e.u_aspect_ratio),u_fade_change:new u.bp(v,e.u_fade_change),u_label_plane_matrix:new u.b$(v,e.u_label_plane_matrix),u_coord_matrix:new u.b$(v,e.u_coord_matrix),u_is_text:new u.bZ(v,e.u_is_text),u_pitch_with_map:new u.bZ(v,e.u_pitch_with_map),u_is_along_line:new u.bZ(v,e.u_is_along_line),u_is_variable_anchor:new u.bZ(v,e.u_is_variable_anchor),u_texsize:new u.c2(v,e.u_texsize),u_texture:new u.bZ(v,e.u_texture),u_gamma_scale:new u.bp(v,e.u_gamma_scale),u_device_pixel_ratio:new u.bp(v,e.u_device_pixel_ratio),u_is_halo:new u.bZ(v,e.u_is_halo),u_translation:new u.c2(v,e.u_translation),u_pitched_scale:new u.bp(v,e.u_pitched_scale)}),symbolTextAndIcon:(v,e)=>({u_is_size_zoom_constant:new u.bZ(v,e.u_is_size_zoom_constant),u_is_size_feature_constant:new u.bZ(v,e.u_is_size_feature_constant),u_size_t:new u.bp(v,e.u_size_t),u_size:new u.bp(v,e.u_size),u_camera_to_center_distance:new u.bp(v,e.u_camera_to_center_distance),u_pitch:new u.bp(v,e.u_pitch),u_rotate_symbol:new u.bZ(v,e.u_rotate_symbol),u_aspect_ratio:new u.bp(v,e.u_aspect_ratio),u_fade_change:new u.bp(v,e.u_fade_change),u_label_plane_matrix:new u.b$(v,e.u_label_plane_matrix),u_coord_matrix:new u.b$(v,e.u_coord_matrix),u_is_text:new u.bZ(v,e.u_is_text),u_pitch_with_map:new u.bZ(v,e.u_pitch_with_map),u_is_along_line:new u.bZ(v,e.u_is_along_line),u_is_variable_anchor:new u.bZ(v,e.u_is_variable_anchor),u_texsize:new u.c2(v,e.u_texsize),u_texsize_icon:new u.c2(v,e.u_texsize_icon),u_texture:new u.bZ(v,e.u_texture),u_texture_icon:new u.bZ(v,e.u_texture_icon),u_gamma_scale:new u.bp(v,e.u_gamma_scale),u_device_pixel_ratio:new u.bp(v,e.u_device_pixel_ratio),u_is_halo:new u.bZ(v,e.u_is_halo),u_translation:new u.c2(v,e.u_translation),u_pitched_scale:new u.bp(v,e.u_pitched_scale)}),background:(v,e)=>({u_opacity:new u.bp(v,e.u_opacity),u_color:new u.b_(v,e.u_color)}),backgroundPattern:(v,e)=>({u_opacity:new u.bp(v,e.u_opacity),u_image:new u.bZ(v,e.u_image),u_pattern_tl_a:new u.c2(v,e.u_pattern_tl_a),u_pattern_br_a:new u.c2(v,e.u_pattern_br_a),u_pattern_tl_b:new u.c2(v,e.u_pattern_tl_b),u_pattern_br_b:new u.c2(v,e.u_pattern_br_b),u_texsize:new u.c2(v,e.u_texsize),u_mix:new u.bp(v,e.u_mix),u_pattern_size_a:new u.c2(v,e.u_pattern_size_a),u_pattern_size_b:new u.c2(v,e.u_pattern_size_b),u_scale_a:new u.bp(v,e.u_scale_a),u_scale_b:new u.bp(v,e.u_scale_b),u_pixel_coord_upper:new u.c2(v,e.u_pixel_coord_upper),u_pixel_coord_lower:new u.c2(v,e.u_pixel_coord_lower),u_tile_units_to_pixels:new u.bp(v,e.u_tile_units_to_pixels)}),terrain:(v,e)=>({u_texture:new u.bZ(v,e.u_texture),u_ele_delta:new u.bp(v,e.u_ele_delta),u_fog_matrix:new u.b$(v,e.u_fog_matrix),u_fog_color:new u.b_(v,e.u_fog_color),u_fog_ground_blend:new u.bp(v,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new u.bp(v,e.u_fog_ground_blend_opacity),u_horizon_color:new u.b_(v,e.u_horizon_color),u_horizon_fog_blend:new u.bp(v,e.u_horizon_fog_blend),u_is_globe_mode:new u.bp(v,e.u_is_globe_mode)}),terrainDepth:(v,e)=>({u_ele_delta:new u.bp(v,e.u_ele_delta)}),terrainCoords:(v,e)=>({u_texture:new u.bZ(v,e.u_texture),u_terrain_coords_id:new u.bp(v,e.u_terrain_coords_id),u_ele_delta:new u.bp(v,e.u_ele_delta)}),projectionErrorMeasurement:(v,e)=>({u_input:new u.bp(v,e.u_input),u_output_expected:new u.bp(v,e.u_output_expected)}),atmosphere:(v,e)=>({u_sun_pos:new u.c1(v,e.u_sun_pos),u_atmosphere_blend:new u.bp(v,e.u_atmosphere_blend),u_globe_position:new u.c1(v,e.u_globe_position),u_globe_radius:new u.bp(v,e.u_globe_radius),u_inv_proj_matrix:new u.b$(v,e.u_inv_proj_matrix)}),sky:(v,e)=>({u_sky_color:new u.b_(v,e.u_sky_color),u_horizon_color:new u.b_(v,e.u_horizon_color),u_horizon:new u.c2(v,e.u_horizon),u_horizon_normal:new u.c2(v,e.u_horizon_normal),u_sky_horizon_blend:new u.bp(v,e.u_sky_horizon_blend),u_sky_blend:new u.bp(v,e.u_sky_blend)})};class xl{constructor(e,a,d){this.context=e;const g=e.gl;this.buffer=g.createBuffer(),this.dynamicDraw=!!d,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Po={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Od{constructor(e,a,d,g){this.length=a.length,this.attributes=d,this.itemSize=a.bytesPerElement,this.dynamicDraw=g,this.context=e;const x=e.gl;this.buffer=x.createBuffer(),e.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,a){for(let d=0;d<this.attributes.length;d++){const g=a.attributes[this.attributes[d].name];g!==void 0&&e.enableVertexAttribArray(g)}}setVertexAttribPointers(e,a,d){for(let g=0;g<this.attributes.length;g++){const x=this.attributes[g],E=a.attributes[x.name];E!==void 0&&e.vertexAttribPointer(E,x.components,e[Po[x.type]],!1,this.itemSize,x.offset+this.itemSize*(d||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class _n{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Nd extends _n{getDefault(){return u.bo.transparent}set(e){const a=this.current;(e.r!==a.r||e.g!==a.g||e.b!==a.b||e.a!==a.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class ep extends _n{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Do extends _n{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class dc extends _n{getDefault(){return[!0,!0,!0,!0]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||e[3]!==a[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Sh extends _n{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class fu extends _n{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Sa extends _n{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const a=this.current;(e.func!==a.func||e.ref!==a.ref||e.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class pu extends _n{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Eh extends _n{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=e,this.dirty=!1}}class Ro extends _n{getDefault(){return[0,1]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class mu extends _n{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=e,this.dirty=!1}}class fc extends _n{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Es extends _n{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.BLEND):a.disable(a.BLEND),this.current=e,this.dirty=!1}}class Fd extends _n{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class jd extends _n{getDefault(){return u.bo.transparent}set(e){const a=this.current;(e.r!==a.r||e.g!==a.g||e.b!==a.b||e.a!==a.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class gu extends _n{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class fr extends _n{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=e,this.dirty=!1}}class bl extends _n{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Or extends _n{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class Ea extends _n{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class pc extends _n{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class yu extends _n{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||e[3]!==a[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Wa extends _n{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class Io extends _n{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class zo extends _n{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Ch extends _n{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class an extends _n{getDefault(){return null}set(e){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Ka extends _n{getDefault(){return null}set(e){var a;if(e===this.current&&!this.dirty)return;const d=this.gl;us(d)?d.bindVertexArray(e):(a=d.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class Em extends _n{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class Jr extends _n{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class wl extends _n{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Xs extends _n{constructor(e,a){super(e),this.context=e,this.parent=a}getDefault(){return null}}class np extends Xs{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class _u extends Xs{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Tl extends Xs{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const mc="Framebuffer is not complete";class vu{constructor(e,a,d,g,x){this.context=e,this.width=a,this.height=d;const E=e.gl,P=this.framebuffer=E.createFramebuffer();if(this.colorAttachment=new np(e,P),g)this.depthAttachment=x?new Tl(e,P):new _u(e,P);else if(x)throw new Error("Stencil cannot be set without depth");if(E.checkFramebufferStatus(E.FRAMEBUFFER)!==E.FRAMEBUFFER_COMPLETE)throw new Error(mc)}destroy(){const e=this.context.gl,a=this.colorAttachment.get();if(a&&e.deleteTexture(a),this.depthAttachment){const d=this.depthAttachment.get();d&&e.deleteRenderbuffer(d)}e.deleteFramebuffer(this.framebuffer)}}class gc{constructor(e){var a,d;if(this.gl=e,this.clearColor=new Nd(this),this.clearDepth=new ep(this),this.clearStencil=new Do(this),this.colorMask=new dc(this),this.depthMask=new Sh(this),this.stencilMask=new fu(this),this.stencilFunc=new Sa(this),this.stencilOp=new pu(this),this.stencilTest=new Eh(this),this.depthRange=new Ro(this),this.depthTest=new mu(this),this.depthFunc=new fc(this),this.blend=new Es(this),this.blendFunc=new Fd(this),this.blendColor=new jd(this),this.blendEquation=new gu(this),this.cullFace=new fr(this),this.cullFaceSide=new bl(this),this.frontFace=new Or(this),this.program=new Ea(this),this.activeTexture=new pc(this),this.viewport=new yu(this),this.bindFramebuffer=new Wa(this),this.bindRenderbuffer=new Io(this),this.bindTexture=new zo(this),this.bindVertexBuffer=new Ch(this),this.bindElementBuffer=new an(this),this.bindVertexArray=new Ka(this),this.pixelStoreUnpack=new Em(this),this.pixelStoreUnpackPremultiplyAlpha=new Jr(this),this.pixelStoreUnpackFlipY=new wl(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),us(e)){this.HALF_FLOAT=e.HALF_FLOAT;const g=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=e.RGBA16F)!==null&&a!==void 0?a:g?.RGBA16F_EXT,this.RGB16F=(d=e.RGB16F)!==null&&d!==void 0?d:g?.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const g=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=g?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,a){return new xl(this,e,a)}createVertexBuffer(e,a,d){return new Od(this,e,a,d)}createRenderbuffer(e,a,d){const g=this.gl,x=g.createRenderbuffer();return this.bindRenderbuffer.set(x),g.renderbufferStorage(g.RENDERBUFFER,e,a,d),this.bindRenderbuffer.set(null),x}createFramebuffer(e,a,d,g){return new vu(this,e,a,d,g)}clear({color:e,depth:a,stencil:d}){const g=this.gl;let x=0;e&&(x|=g.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(x|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),d!==void 0&&(x|=g.STENCIL_BUFFER_BIT,this.clearStencil.set(d),this.stencilMask.set(255)),g.clear(x)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){u.bQ(e.blendFunction,Qn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return us(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var a;return us(this.gl)?this.gl.deleteVertexArray(e):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let Lo;function Nr(v,e,a,d,g){const x=v.context,E=v.transform,P=x.gl,R=v.useProgram("collisionBox"),O=[];let j=0,$=0;for(let ft=0;ft<d.length;ft++){const _t=d[ft],Tt=e.getTile(_t).getBucket(a);if(!Tt)continue;const gt=g?Tt.textCollisionBox:Tt.iconCollisionBox,St=Tt.collisionCircleArray;St.length>0&&(O.push({circleArray:St,circleOffset:$,coord:_t}),j+=St.length/4,$=j),gt&&R.draw(x,P.LINES,en.disabled,gn.disabled,v.colorModeForRenderPass(),cn.disabled,_h(v.transform),v.style.map.terrain&&v.style.map.terrain.getTerrainData(_t),E.getProjectionData({overscaledTileID:_t,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),a.id,gt.layoutVertexBuffer,gt.indexBuffer,gt.segments,null,v.transform.zoom,null,null,gt.collisionVertexBuffer)}if(!g||!O.length)return;const q=v.useProgram("collisionCircle"),Q=new u.c9;Q.resize(4*j),Q._trim();let nt=0;for(const ft of O)for(let _t=0;_t<ft.circleArray.length/4;_t++){const Tt=4*_t,gt=ft.circleArray[Tt+0],St=ft.circleArray[Tt+1],At=ft.circleArray[Tt+2],xt=ft.circleArray[Tt+3];Q.emplace(nt++,gt,St,At,xt,0),Q.emplace(nt++,gt,St,At,xt,1),Q.emplace(nt++,gt,St,At,xt,2),Q.emplace(nt++,gt,St,At,xt,3)}(!Lo||Lo.length<2*j)&&(Lo=(function(ft){const _t=2*ft,Tt=new u.cb;Tt.resize(_t),Tt._trim();for(let gt=0;gt<_t;gt++){const St=6*gt;Tt.uint16[St+0]=4*gt+0,Tt.uint16[St+1]=4*gt+1,Tt.uint16[St+2]=4*gt+2,Tt.uint16[St+3]=4*gt+2,Tt.uint16[St+4]=4*gt+3,Tt.uint16[St+5]=4*gt+0}return Tt})(j));const lt=x.createIndexBuffer(Lo,!0),ut=x.createVertexBuffer(Q,u.ca.members,!0);for(const ft of O){const _t=Dd(v.transform);q.draw(x,P.TRIANGLES,en.disabled,gn.disabled,v.colorModeForRenderPass(),cn.disabled,_t,v.style.map.terrain&&v.style.map.terrain.getTerrainData(ft.coord),null,a.id,ut,lt,u.aW.simpleSegment(0,2*ft.circleOffset,ft.circleArray.length,ft.circleArray.length/2),null,v.transform.zoom,null,null,null)}ut.destroy(),lt.destroy()}const Sl=u.ar(new Float32Array(16));function Qa(v,e,a,d,g,x){const{horizontalAlign:E,verticalAlign:P}=u.aR(v);return new u.P((-(E-.5)*e/g+d[0])*x,(-(P-.5)*a/g+d[1])*x)}function El(v,e,a,d,g,x){const E=e.tileAnchorPoint.add(new u.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let P=d.mult(x);a||(P=P.rotate(-g));const R=E.add(P);return Ce(R.x,R.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(a){const P=Tr(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(v),R=Math.atan(P.y/P.x)+(P.x<0?Math.PI:0);return v.add(d.rotate(R))}return v.add(d)}function ko(v,e,a,d,g,x,E,P,R,O,j,$){const q=v.text.placedSymbolArray,Q=v.text.dynamicLayoutVertexArray,nt=v.icon.dynamicLayoutVertexArray,lt={};Q.clear();for(let ut=0;ut<q.length;ut++){const ft=q.get(ut),_t=ft.hidden||!ft.crossTileID||v.allowVerticalPlacement&&!ft.placedOrientation?null:d[ft.crossTileID];if(_t){const Tt=new u.P(ft.anchorX,ft.anchorY),gt={getElevation:$,width:g.width,height:g.height,pitchedLabelPlaneMatrix:x,pitchWithMap:a,transform:g,tileAnchorPoint:Tt,translation:O,unwrappedTileID:j},St=a?Zs(Tt.x,Tt.y,gt):Tr(Tt.x,Tt.y,gt),At=Ne(g.cameraToCenterDistance,St.signedDistanceFromCamera);let xt=u.az(v.textSizeData,P,ft)*At/u.aL;a&&(xt*=v.tilePixelRatio/E);const{width:zt,height:$t,anchor:Vt,textOffset:Ut,textBoxScale:qt}=_t,ge=Qa(Vt,zt,$t,Ut,qt,xt),ye=g.getPitchedTextCorrection(Tt.x+O[0],Tt.y+O[1],j),oe=El(St.point,gt,e,ge,-g.bearingInRadians,ye),De=v.allowVerticalPlacement&&ft.placedOrientation===u.ay.vertical?Math.PI/2:0;for(let tn=0;tn<ft.numGlyphs;tn++)u.aF(Q,oe,De);R&&ft.associatedIconIndex>=0&&(lt[ft.associatedIconIndex]={shiftedAnchor:oe,angle:De})}else zr(ft.numGlyphs,Q)}if(R){nt.clear();const ut=v.icon.placedSymbolArray;for(let ft=0;ft<ut.length;ft++){const _t=ut.get(ft);if(_t.hidden)zr(_t.numGlyphs,nt);else{const Tt=lt[ft];if(Tt)for(let gt=0;gt<_t.numGlyphs;gt++)u.aF(nt,Tt.shiftedAnchor,Tt.angle);else zr(_t.numGlyphs,nt)}}v.icon.dynamicLayoutVertexBuffer.updateData(nt)}v.text.dynamicLayoutVertexBuffer.updateData(Q)}function pr(v,e,a){return a.iconsInText&&e?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function Fr(v,e,a,d,g,x,E,P,R,O,j,$,q){const Q=v.context,nt=Q.gl,lt=v.transform,ut=P==="map",ft=R==="map",_t=P!=="viewport"&&a.layout.get("symbol-placement")!=="point",Tt=ut&&!ft&&!_t,gt=!a.layout.get("symbol-sort-key").isConstant();let St=!1;const At=v.getDepthModeForSublayer(0,en.ReadOnly),xt=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),zt=[],$t=lt.getCircleRadiusCorrection();for(const Vt of d){const Ut=e.getTile(Vt),qt=Ut.getBucket(a);if(!qt)continue;const ge=g?qt.text:qt.icon;if(!ge||!ge.segments.get().length||!ge.hasVisibleVertices)continue;const ye=ge.programConfigurations.get(a.id),oe=g||qt.sdfIcons,De=g?qt.textSizeData:qt.iconSizeData,tn=ft||lt.pitch!==0,Ke=v.useProgram(pr(oe,g,qt),ye),ei=u.ax(De,lt.zoom),Hn=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Vt);let li,Vn,Ii,ii,_i=[0,0],vi=null;if(g)Vn=Ut.glyphAtlasTexture,Ii=nt.LINEAR,li=Ut.glyphAtlasTexture.size,qt.iconsInText&&(_i=Ut.imageAtlasTexture.size,vi=Ut.imageAtlasTexture,ii=tn||v.options.rotating||v.options.zooming||De.kind==="composite"||De.kind==="camera"?nt.LINEAR:nt.NEAREST);else{const fi=a.layout.get("icon-size").constantOr(0)!==1||qt.iconsNeedLinear;Vn=Ut.imageAtlasTexture,Ii=oe||v.options.rotating||v.options.zooming||fi||tn?nt.LINEAR:nt.NEAREST,li=Ut.imageAtlasTexture.size}const Ti=u.aM(Ut,1,v.transform.zoom),Sr=Ai(ut,v.transform,Ti),ka=u.N();u.aA(ka,Sr);const Js=Cn(ft,ut,v.transform,Ti),qo=u.aN(lt,Ut,x,E),Oa=lt.getProjectionData({overscaledTileID:Vt,applyGlobeMatrix:!q,applyTerrainMatrix:!0}),Zo=xt&&qt.hasTextData(),fs=a.layout.get("icon-text-fit")!=="none"&&Zo&&qt.hasIconData();if(_t){const fi=v.style.map.terrain?(Si,On)=>v.style.map.terrain.getElevation(Vt,Si,On):null,Xn=a.layout.get("text-rotation-alignment")==="map";ll(qt,v,g,Sr,ka,ft,O,Xn,Vt.toUnwrapped(),lt.width,lt.height,qo,fi)}const ta=g&&xt||fs,is=_t||ta?Sl:ft?Sr:v.transform.clipSpaceToPixelsMatrix,Na=oe&&a.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ll;Ll=oe?qt.iconsInText?xh(De.kind,ei,Tt,ft,_t,ta,v,is,Js,qo,li,_i,$t):Qr(De.kind,ei,Tt,ft,_t,ta,v,is,Js,qo,g,li,0,$t):dr(De.kind,ei,Tt,ft,_t,ta,v,is,Js,qo,g,li,$t);const kl={program:Ke,buffers:ge,uniformValues:Ll,projectionData:Oa,atlasTexture:Vn,atlasTextureIcon:vi,atlasInterpolation:Ii,atlasInterpolationIcon:ii,isSDF:oe,hasHalo:Na};if(gt&&qt.canOverlap){St=!0;const fi=ge.segments.get();for(const Xn of fi)zt.push({segments:new u.aW([Xn]),sortKey:Xn.sortKey,state:kl,terrainData:Hn})}else zt.push({segments:ge.segments,sortKey:0,state:kl,terrainData:Hn})}St&&zt.sort(((Vt,Ut)=>Vt.sortKey-Ut.sortKey));for(const Vt of zt){const Ut=Vt.state;if(Q.activeTexture.set(nt.TEXTURE0),Ut.atlasTexture.bind(Ut.atlasInterpolation,nt.CLAMP_TO_EDGE),Ut.atlasTextureIcon&&(Q.activeTexture.set(nt.TEXTURE1),Ut.atlasTextureIcon&&Ut.atlasTextureIcon.bind(Ut.atlasInterpolationIcon,nt.CLAMP_TO_EDGE)),Ut.isSDF){const qt=Ut.uniformValues;Ut.hasHalo&&(qt.u_is_halo=1,Ja(Ut.buffers,Vt.segments,a,v,Ut.program,At,j,$,qt,Ut.projectionData,Vt.terrainData)),qt.u_is_halo=0}Ja(Ut.buffers,Vt.segments,a,v,Ut.program,At,j,$,Ut.uniformValues,Ut.projectionData,Vt.terrainData)}}function Ja(v,e,a,d,g,x,E,P,R,O,j){const $=d.context;g.draw($,$.gl.TRIANGLES,x,E,P,cn.backCCW,R,j,O,a.id,v.layoutVertexBuffer,v.indexBuffer,e,a.paint,d.transform.zoom,v.programConfigurations.get(a.id),v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer)}function ts(v,e,a,d,g){const x=v.context,E=x.gl,P=gn.disabled,R=new Qn([E.ONE,E.ONE],u.bo.transparent,[!0,!0,!0,!0]),O=e.getBucket(a);if(!O)return;const j=d.key;let $=a.heatmapFbos.get(j);$||($=Ys(x,e.tileSize,e.tileSize),a.heatmapFbos.set(j,$)),x.bindFramebuffer.set($.framebuffer),x.viewport.set([0,0,e.tileSize,e.tileSize]),x.clear({color:u.bo.transparent});const q=O.programConfigurations.get(a.id),Q=v.useProgram("heatmap",q,!g),nt=v.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),lt=v.style.map.terrain.getTerrainData(d);Q.draw(x,E.TRIANGLES,en.disabled,P,R,cn.disabled,_l(e,v.transform.zoom,a.paint.get("heatmap-intensity"),1),lt,nt,a.id,O.layoutVertexBuffer,O.indexBuffer,O.segments,a.paint,v.transform.zoom,q)}function Ca(v,e,a,d,g){const x=v.context,E=x.gl,P=v.transform;x.setColorMode(v.colorModeForRenderPass());const R=yc(x,e),O=a.key,j=e.heatmapFbos.get(O);if(!j)return;x.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,j.colorAttachment.get()),x.activeTexture.set(E.TEXTURE1),R.bind(E.LINEAR,E.CLAMP_TO_EDGE);const $=P.getProjectionData({overscaledTileID:a,applyTerrainMatrix:g,applyGlobeMatrix:!d});v.useProgram("heatmapTexture").draw(x,E.TRIANGLES,en.disabled,gn.disabled,v.colorModeForRenderPass(),cn.disabled,Rd(v,e,0,1),null,$,e.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments,e.paint,P.zoom),j.destroy(),e.heatmapFbos.delete(O)}function Ys(v,e,a){var d,g;const x=v.gl,E=x.createTexture();x.bindTexture(x.TEXTURE_2D,E),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,x.LINEAR),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,x.LINEAR);const P=(d=v.HALF_FLOAT)!==null&&d!==void 0?d:x.UNSIGNED_BYTE,R=(g=v.RGBA16F)!==null&&g!==void 0?g:x.RGBA;x.texImage2D(x.TEXTURE_2D,0,R,e,a,0,x.RGBA,P,null);const O=v.createFramebuffer(e,a,!1,!1);return O.colorAttachment.set(E),O}function yc(v,e){return e.colorRampTexture||(e.colorRampTexture=new u.T(v,e.colorRamp,v.gl.RGBA)),e.colorRampTexture}function _c(v,e,a,d,g,x,E,P){let R=256;if(g.stepInterpolant){const O=e.getSource().maxzoom,j=E.canonical.z===O?Math.ceil(1<<v.transform.maxZoom-E.canonical.z):1;R=u.an(u.cd(x.maxLineLength/u.a4*1024*j),256,a.maxTextureSize)}return P.gradient=u.ce({expression:g.gradientExpression(),evaluationKey:"lineProgress",resolution:R,image:P.gradient||void 0,clips:x.lineClipsArray}),P.texture?P.texture.update(P.gradient):P.texture=new u.T(a,P.gradient,d.RGBA),P.version=g.gradientVersion,P.texture}function Ah(v,e,a,d,g){v.activeTexture.set(e.TEXTURE0),a.imageAtlasTexture.bind(e.LINEAR,e.CLAMP_TO_EDGE),d.updatePaintBuffers(g)}function Bd(v,e,a,d,g,x){(g||v.lineAtlas.dirty)&&(e.activeTexture.set(a.TEXTURE0),v.lineAtlas.bind(e)),d.updatePaintBuffers(x)}function Oi(v,e,a,d,g,x,E){const P=x.gradients[g.id];let R=P.texture;g.gradientVersion!==P.version&&(R=_c(v,e,a,d,g,x,E,P)),a.activeTexture.set(d.TEXTURE0),R.bind(g.stepInterpolant?d.NEAREST:d.LINEAR,d.CLAMP_TO_EDGE)}function Jn(v,e,a,d,g,x,E,P,R){const O=x.gradients[g.id];let j=O.texture;g.gradientVersion!==O.version&&(j=_c(v,e,a,d,g,x,E,O)),a.activeTexture.set(d.TEXTURE0),j.bind(g.stepInterpolant?d.NEAREST:d.LINEAR,d.CLAMP_TO_EDGE),a.activeTexture.set(d.TEXTURE1),v.lineAtlas.bind(a),P.updatePaintBuffers(R)}function vn(v,e,a,d,g){if(!a||!d||!d.imageAtlas)return;const x=d.imageAtlas.patternPositions;let E=x[a.to.toString()],P=x[a.from.toString()];if(!E&&P&&(E=P),!P&&E&&(P=E),!E||!P){const R=g.getPaintProperty(e);E=x[R],P=x[R]}E&&P&&v.setConstantPatternPositions(E,P)}function Aa(v,e,a,d,g,x,E,P){const R=v.context.gl,O="fill-pattern",j=a.paint.get(O),$=j&&j.constantOr(1),q=a.getCrossfadeParameters();let Q,nt,lt,ut,ft;const _t=v.transform,Tt=a.paint.get("fill-translate"),gt=a.paint.get("fill-translate-anchor");E?(nt=$&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Q=R.LINES):(nt=$?"fillPattern":"fill",Q=R.TRIANGLES);const St=j.constantOr(null);for(const At of d){const xt=e.getTile(At);if($&&!xt.patternsLoaded())continue;const zt=xt.getBucket(a);if(!zt)continue;const $t=zt.programConfigurations.get(a.id),Vt=v.useProgram(nt,$t),Ut=v.style.map.terrain&&v.style.map.terrain.getTerrainData(At);$&&(v.context.activeTexture.set(R.TEXTURE0),xt.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),$t.updatePaintBuffers(q)),vn($t,O,St,xt,a);const qt=_t.getProjectionData({overscaledTileID:At,applyGlobeMatrix:!P,applyTerrainMatrix:!0}),ge=u.aN(_t,xt,Tt,gt);if(E){ut=zt.indexBuffer2,ft=zt.segments2;const oe=[R.drawingBufferWidth,R.drawingBufferHeight];lt=nt==="fillOutlinePattern"&&$?Sm(v,q,xt,oe,ge):Yf(oe,ge)}else ut=zt.indexBuffer,ft=zt.segments,lt=$?gl(v,q,xt,ge):{u_fill_translate:ge};const ye=v.stencilModeForClipping(At);Vt.draw(v.context,Q,g,ye,x,cn.backCCW,lt,Ut,qt,a.id,zt.layoutVertexBuffer,ut,ft,a.paint,v.transform.zoom,$t)}}function wn(v,e,a,d,g,x,E,P){const R=v.context,O=R.gl,j="fill-extrusion-pattern",$=a.paint.get(j),q=$.constantOr(1),Q=a.getCrossfadeParameters(),nt=a.paint.get("fill-extrusion-opacity"),lt=$.constantOr(null),ut=v.transform;for(const ft of d){const _t=e.getTile(ft),Tt=_t.getBucket(a);if(!Tt)continue;const gt=v.style.map.terrain&&v.style.map.terrain.getTerrainData(ft),St=Tt.programConfigurations.get(a.id),At=v.useProgram(q?"fillExtrusionPattern":"fillExtrusion",St);q&&(v.context.activeTexture.set(O.TEXTURE0),_t.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),St.updatePaintBuffers(Q));const xt=ut.getProjectionData({overscaledTileID:ft,applyGlobeMatrix:!P,applyTerrainMatrix:!0});vn(St,j,lt,_t,a);const zt=u.aN(ut,_t,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),$t=a.paint.get("fill-extrusion-vertical-gradient"),Vt=q?ml(v,$t,nt,zt,ft,Q,_t):Pd(v,$t,nt,zt);At.draw(R,R.gl.TRIANGLES,g,x,E,cn.backCCW,Vt,gt,xt,a.id,Tt.layoutVertexBuffer,Tt.indexBuffer,Tt.segments,a.paint,v.transform.zoom,St,v.style.map.terrain&&Tt.centroidVertexBuffer)}}function Ws(v,e,a,d,g,x,E,P,R){var O;const j=v.style.projection,$=v.context,q=v.transform,Q=$.gl,nt=[`#define NUM_ILLUMINATION_SOURCES ${a.paint.get("hillshade-highlight-color").values.length}`],lt=v.useProgram("hillshade",null,!1,nt),ut=!v.options.moving;for(const ft of d){const _t=e.getTile(ft),Tt=_t.fbo;if(!Tt)continue;const gt=j.getMeshFromTileID($,ft.canonical,P,!0,"raster"),St=(O=v.style.map.terrain)===null||O===void 0?void 0:O.getTerrainData(ft);$.activeTexture.set(Q.TEXTURE0),Q.bindTexture(Q.TEXTURE_2D,Tt.colorAttachment.get());const At=q.getProjectionData({overscaledTileID:ft,aligned:ut,applyGlobeMatrix:!R,applyTerrainMatrix:!0});lt.draw($,Q.TRIANGLES,x,g[ft.overscaledZ],E,cn.backCCW,Ta(v,_t,a),St,At,a.id,gt.vertexBuffer,gt.indexBuffer,gt.segments)}}function Di(v,e,a,d,g,x,E,P,R){var O;const j=v.style.projection,$=v.context,q=v.transform,Q=$.gl,nt=v.useProgram("colorRelief"),lt=!v.options.moving;let ut=!0,ft=0;for(const _t of d){const Tt=e.getTile(_t),gt=Tt.dem;if(ut){const Vt=Q.getParameter(Q.MAX_TEXTURE_SIZE),{elevationTexture:Ut,colorTexture:qt}=a.getColorRampTextures($,Vt,gt.getUnpackVector());$.activeTexture.set(Q.TEXTURE1),Ut.bind(Q.NEAREST,Q.CLAMP_TO_EDGE),$.activeTexture.set(Q.TEXTURE4),qt.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),ut=!1,ft=Ut.size[0]}if(!gt||!gt.data)continue;const St=gt.stride,At=gt.getPixels();if($.activeTexture.set(Q.TEXTURE0),$.pixelStoreUnpackPremultiplyAlpha.set(!1),Tt.demTexture=Tt.demTexture||v.getTileTexture(St),Tt.demTexture){const Vt=Tt.demTexture;Vt.update(At,{premultiply:!1}),Vt.bind(Q.LINEAR,Q.CLAMP_TO_EDGE)}else Tt.demTexture=new u.T($,At,Q.RGBA,{premultiply:!1}),Tt.demTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);const xt=j.getMeshFromTileID($,_t.canonical,P,!0,"raster"),zt=(O=v.style.map.terrain)===null||O===void 0?void 0:O.getTerrainData(_t),$t=q.getProjectionData({overscaledTileID:_t,aligned:lt,applyGlobeMatrix:!R,applyTerrainMatrix:!0});nt.draw($,Q.TRIANGLES,x,g[_t.overscaledZ],E,cn.backCCW,vl(a,Tt.dem,ft),zt,$t,a.id,xt.vertexBuffer,xt.indexBuffer,xt.segments)}}const vc=[new u.P(0,0),new u.P(u.a4,0),new u.P(u.a4,u.a4),new u.P(0,u.a4)];function Oo(v,e,a,d,g,x,E,P,R=!1,O=!1){const j=d[d.length-1].overscaledZ,$=v.context,q=$.gl,Q=v.useProgram("raster"),nt=v.transform,lt=v.style.projection,ut=v.colorModeForRenderPass(),ft=!v.options.moving,_t=a.paint.get("raster-opacity"),Tt=a.paint.get("raster-resampling"),gt=a.paint.get("raster-fade-duration"),St=!!v.style.map.terrain;for(const At of d){const xt=v.getDepthModeForSublayer(At.overscaledZ-j,_t===1?en.ReadWrite:en.ReadOnly,q.LESS),zt=e.getTile(At),$t=Tt==="nearest"?q.NEAREST:q.LINEAR;$.activeTexture.set(q.TEXTURE0),zt.texture.bind($t,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST),$.activeTexture.set(q.TEXTURE1);const{parentTile:Vt,parentScaleBy:Ut,parentTopLeft:qt,fadeValues:ge}=Cl(zt,e,gt,St);zt.fadeOpacity=ge.tileOpacity,Vt?(Vt.fadeOpacity=ge.parentTileOpacity,Vt.texture.bind($t,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST)):zt.texture.bind($t,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST),zt.texture.useMipmap&&$.extTextureFilterAnisotropic&&v.transform.pitch>20&&q.texParameterf(q.TEXTURE_2D,$.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,$.extTextureFilterAnisotropicMax);const ye=v.style.map.terrain&&v.style.map.terrain.getTerrainData(At),oe=nt.getProjectionData({overscaledTileID:At,aligned:ft,applyGlobeMatrix:!O,applyTerrainMatrix:!0}),De=kd(qt,Ut,ge.fadeMix,a,P),tn=lt.getMeshFromTileID($,At.canonical,x,E,"raster");Q.draw($,q.TRIANGLES,xt,g?g[At.overscaledZ]:gn.disabled,ut,R?cn.frontCCW:cn.backCCW,De,ye,oe,a.id,tn.vertexBuffer,tn.indexBuffer,tn.segments)}}function Cl(v,e,a,d){const g={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(a===0||d)return g;if(v.fadingParentID){const x=e.getLoadedTile(v.fadingParentID);if(!x)return g;const E=Math.pow(2,x.tileID.overscaledZ-v.tileID.overscaledZ),P=[v.tileID.canonical.x*E%1,v.tileID.canonical.y*E%1],R=(function(O,j,$){const q=rt(),Q=(q-j.timeAdded)/$,nt=O.fadingDirection===Ct.Incoming,lt=u.an((q-O.timeAdded)/$,0,1),ut=u.an(1-Q,0,1),ft=nt?lt:ut;return{tileOpacity:ft,parentTileOpacity:nt?ut:lt,fadeMix:{opacity:1,mix:1-ft}}})(v,x,a);return{parentTile:x,parentScaleBy:E,parentTopLeft:P,fadeValues:R}}if(v.selfFading){const x=(function(E,P){const R=(rt()-E.timeAdded)/P,O=u.an(R,0,1);return{tileOpacity:O,fadeMix:{opacity:O,mix:0}}})(v,a);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:x}}return g}const Cs=new u.bo(1,0,0,1),xu=new u.bo(0,1,0,1),to=new u.bo(0,0,1,1),bu=new u.bo(1,0,1,1),No=new u.bo(0,1,1,1);function Ks(v,e,a,d){hs(v,0,e+a/2,v.transform.width,a,d)}function Ma(v,e,a,d){hs(v,e-a/2,0,a,v.transform.height,d)}function hs(v,e,a,d,g,x){const E=v.context,P=E.gl;P.enable(P.SCISSOR_TEST),P.scissor(e*v.pixelRatio,a*v.pixelRatio,d*v.pixelRatio,g*v.pixelRatio),E.clear({color:x}),P.disable(P.SCISSOR_TEST)}function Mh(v,e,a){const d=v.context,g=d.gl,x=v.useProgram("debug"),E=en.disabled,P=gn.disabled,R=v.colorModeForRenderPass(),O="$debug",j=v.style.map.terrain&&v.style.map.terrain.getTerrainData(a);d.activeTexture.set(g.TEXTURE0);const $=e.getTileByID(a.key).latestRawTileData,q=Math.floor(($&&$.byteLength||0)/1024),Q=e.getTile(a).tileSize,nt=512/Math.min(Q,512)*(a.overscaledZ/v.transform.zoom)*.5;let lt=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(lt+=` => ${a.overscaledZ}`),(function(ft,_t){ft.initDebugOverlayCanvas();const Tt=ft.debugOverlayCanvas,gt=ft.context.gl,St=ft.debugOverlayCanvas.getContext("2d");St.clearRect(0,0,Tt.width,Tt.height),St.shadowColor="white",St.shadowBlur=2,St.lineWidth=1.5,St.strokeStyle="white",St.textBaseline="top",St.font="bold 36px Open Sans, sans-serif",St.fillText(_t,5,5),St.strokeText(_t,5,5),ft.debugOverlayTexture.update(Tt),ft.debugOverlayTexture.bind(gt.LINEAR,gt.CLAMP_TO_EDGE)})(v,`${lt} ${q}kB`);const ut=v.transform.getProjectionData({overscaledTileID:a,applyGlobeMatrix:!0,applyTerrainMatrix:!0});x.draw(d,g.TRIANGLES,E,P,Qn.alphaBlended,cn.disabled,yl(u.bo.transparent,nt),null,ut,O,v.debugBuffer,v.quadTriangleIndexBuffer,v.debugSegments),x.draw(d,g.LINE_STRIP,E,P,R,cn.disabled,yl(u.bo.red),j,ut,O,v.debugBuffer,v.tileBorderIndexBuffer,v.debugSegments)}function Pa(v,e,a,d){const{isRenderingGlobe:g}=d,x=v.context,E=x.gl,P=v.transform,R=v.colorModeForRenderPass(),O=v.getDepthModeFor3D(),j=v.useProgram("terrain");x.bindFramebuffer.set(null),x.viewport.set([0,0,v.width,v.height]);for(const $ of a){const q=e.getTerrainMesh($.tileID),Q=v.renderToTexture.getTexture($),nt=e.getTerrainData($.tileID);x.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,Q.texture);const lt=e.getMeshFrameDelta(P.zoom),ut=P.calculateFogMatrix($.tileID.toUnwrapped()),ft=pl(lt,ut,v.style.sky,P.pitch,g),_t=P.getProjectionData({overscaledTileID:$.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});j.draw(x,E.TRIANGLES,O,gn.disabled,R,cn.backCCW,ft,nt,_t,"terrain",q.vertexBuffer,q.indexBuffer,q.segments)}}function Fo(v,e){if(!e.mesh){const a=new u.aV;a.emplaceBack(-1,-1),a.emplaceBack(1,-1),a.emplaceBack(1,1),a.emplaceBack(-1,1);const d=new u.aX;d.emplaceBack(0,1,2),d.emplaceBack(0,2,3),e.mesh=new _a(v.createVertexBuffer(a,bi.members),v.createIndexBuffer(d),u.aW.simpleSegment(0,0,a.length,d.length))}return e.mesh}class wu{constructor(e,a){this.context=new gc(e),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:u.ar(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=ln.maxOverzooming+ln.maxUnderzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new dl}resize(e,a,d){if(this.width=Math.floor(e*d),this.height=Math.floor(a*d),this.pixelRatio=d,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style._order)this.style._layers[g].resize()}setup(){const e=this.context,a=new u.aV;a.emplaceBack(0,0),a.emplaceBack(u.a4,0),a.emplaceBack(0,u.a4),a.emplaceBack(u.a4,u.a4),this.tileExtentBuffer=e.createVertexBuffer(a,bi.members),this.tileExtentSegments=u.aW.simpleSegment(0,0,4,2);const d=new u.aV;d.emplaceBack(0,0),d.emplaceBack(u.a4,0),d.emplaceBack(0,u.a4),d.emplaceBack(u.a4,u.a4),this.debugBuffer=e.createVertexBuffer(d,bi.members),this.debugSegments=u.aW.simpleSegment(0,0,4,5);const g=new u.cg;g.emplaceBack(0,0,0,0),g.emplaceBack(u.a4,0,u.a4,0),g.emplaceBack(0,u.a4,0,u.a4),g.emplaceBack(u.a4,u.a4,u.a4,u.a4),this.rasterBoundsBuffer=e.createVertexBuffer(g,wa.members),this.rasterBoundsSegments=u.aW.simpleSegment(0,0,4,2);const x=new u.aV;x.emplaceBack(0,0),x.emplaceBack(u.a4,0),x.emplaceBack(0,u.a4),x.emplaceBack(u.a4,u.a4),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(x,bi.members),this.rasterBoundsSegmentsPosOnly=u.aW.simpleSegment(0,0,4,5);const E=new u.aV;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(E,bi.members),this.viewportSegments=u.aW.simpleSegment(0,0,4,2);const P=new u.ch;P.emplaceBack(0),P.emplaceBack(1),P.emplaceBack(3),P.emplaceBack(2),P.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(P);const R=new u.aX;R.emplaceBack(1,0,2),R.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(R);const O=this.context.gl;this.stencilClearMode=new gn({func:O.ALWAYS,mask:0},0,255,O.ZERO,O.ZERO,O.ZERO),this.tileExtentMesh=new _a(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,a=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const d=u.N();u.c6(d,0,this.width,this.height,0,0,1),u.Q(d,d,[a.drawingBufferWidth,a.drawingBufferHeight,0]);const g={mainMatrix:d,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:d};this.useProgram("clippingMask",null,!0).draw(e,a.TRIANGLES,en.disabled,this.stencilClearMode,Qn.disabled,cn.disabled,null,null,g,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,a,d){if(this.currentStencilSource===e.source||!e.isTileClipped()||!a||!a.length)return;this.currentStencilSource=e.source,this.nextStencilID+a.length>256&&this.clearStencil();const g=this.context;g.setColorMode(Qn.disabled),g.setDepthMode(en.disabled);const x={};for(const E of a)x[E.key]=this.nextStencilID++;this._renderTileMasks(x,a,d,!0),this._renderTileMasks(x,a,d,!1),this._tileClippingMaskIDs=x}_renderTileMasks(e,a,d,g){const x=this.context,E=x.gl,P=this.style.projection,R=this.transform,O=this.useProgram("clippingMask");for(const j of a){const $=e[j.key],q=this.style.map.terrain&&this.style.map.terrain.getTerrainData(j),Q=P.getMeshFromTileID(this.context,j.canonical,g,!0,"stencil"),nt=R.getProjectionData({overscaledTileID:j,applyGlobeMatrix:!d,applyTerrainMatrix:!0});O.draw(x,E.TRIANGLES,en.disabled,new gn({func:E.ALWAYS,mask:0},$,255,E.KEEP,E.KEEP,E.REPLACE),Qn.disabled,d?cn.disabled:cn.backCCW,null,q,nt,"$clipping",Q.vertexBuffer,Q.indexBuffer,Q.segments)}}_renderTilesDepthBuffer(){const e=this.context,a=e.gl,d=this.style.projection,g=this.transform,x=this.useProgram("depth"),E=this.getDepthModeFor3D(),P=Qe(g,{tileSize:g.tileSize});for(const R of P){const O=this.style.map.terrain&&this.style.map.terrain.getTerrainData(R),j=d.getMeshFromTileID(this.context,R.canonical,!0,!0,"raster"),$=g.getProjectionData({overscaledTileID:R,applyGlobeMatrix:!0,applyTerrainMatrix:!0});x.draw(e,a.TRIANGLES,E,gn.disabled,Qn.disabled,cn.backCCW,null,O,$,"$clipping",j.vertexBuffer,j.indexBuffer,j.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,a=this.context.gl;return new gn({func:a.NOTEQUAL,mask:255},e,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(e){const a=this.context.gl;return new gn({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,a.KEEP,a.KEEP,a.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const a=this.context.gl,d=e.sort(((E,P)=>P.overscaledZ-E.overscaledZ)),g=d[d.length-1].overscaledZ,x=d[0].overscaledZ-g+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const E={};for(let P=0;P<x;P++)E[P+g]=new gn({func:a.GEQUAL,mask:255},P+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=x,[E,d]}return[{[g]:gn.disabled},d]}stencilConfigForOverlapTwoPass(e){const a=this.context.gl,d=e.sort(((E,P)=>P.overscaledZ-E.overscaledZ)),g=d[d.length-1].overscaledZ,x=d[0].overscaledZ-g+1;if(this.clearStencil(),x>1){const E={},P={};for(let R=0;R<x;R++)E[R+g]=new gn({func:a.GREATER,mask:255},x+1+R,255,a.KEEP,a.KEEP,a.REPLACE),P[R+g]=new gn({func:a.GREATER,mask:255},1+R,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID=2*x+1,[E,P,d]}return this.nextStencilID=3,[{[g]:new gn({func:a.GREATER,mask:255},2,255,a.KEEP,a.KEEP,a.REPLACE)},{[g]:new gn({func:a.GREATER,mask:255},1,255,a.KEEP,a.KEEP,a.REPLACE)},d]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Qn([e.CONSTANT_COLOR,e.ONE],new u.bo(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Qn.unblended:Qn.alphaBlended}getDepthModeForSublayer(e,a,d){if(!this.opaquePassEnabledForLayer())return en.disabled;const g=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new en(d||this.context.gl.LEQUAL,a,[g,g])}getDepthModeFor3D(){return new en(this.context.gl.LEQUAL,en.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,a){var d,g;this.style=e,this.options=a,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(rt()),this.imageManager.beginFrame();const x=this.style._order,E=this.style.tileManagers,P={},R={},O={},j={isRenderingToTexture:!1,isRenderingGlobe:((d=e.projection)===null||d===void 0?void 0:d.transitionState)>0};for(const q in E){const Q=E[q];Q.used&&Q.prepare(this.context),P[q]=Q.getVisibleCoordinates(!1),R[q]=P[q].slice().reverse(),O[q]=Q.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let q=0;q<x.length;q++)if(this.style._layers[x[q]].is3D()){this.opaquePassCutoff=q;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const q of x){const Q=this.style._layers[q];if(!Q.hasOffscreenPass()||Q.isHidden(this.transform.zoom))continue;const nt=R[Q.source];(Q.type==="custom"||nt.length)&&this.renderLayer(this,E[Q.source],Q,nt,j)}if((g=this.style.projection)===null||g===void 0||g.updateGPUdependent({context:this.context,useProgram:q=>this.useProgram(q)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?u.bo.black:u.bo.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(q,Q){const nt=q.context,lt=nt.gl,ut=((At,xt,zt)=>{const $t=Math.cos(xt.rollInRadians),Vt=Math.sin(xt.rollInRadians),Ut=Ft(xt),qt=xt.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:At.properties.get("sky-color"),u_horizon_color:At.properties.get("horizon-color"),u_horizon:[(xt.width/2-Ut*Vt)*zt,(xt.height/2+Ut*$t)*zt],u_horizon_normal:[-Vt,$t],u_sky_horizon_blend:At.properties.get("sky-horizon-blend")*xt.height/2*zt,u_sky_blend:qt}})(Q,q.style.map.transform,q.pixelRatio),ft=new en(lt.LEQUAL,en.ReadWrite,[0,1]),_t=gn.disabled,Tt=q.colorModeForRenderPass(),gt=q.useProgram("sky"),St=Fo(nt,Q);gt.draw(nt,lt.TRIANGLES,ft,_t,Tt,cn.disabled,ut,null,void 0,"sky",St.vertexBuffer,St.indexBuffer,St.segments)})(this,this.style.sky),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){const q=this.style._layers[x[this.currentLayer]],Q=E[q.source],nt=P[q.source];this._renderTileClippingMasks(q,nt,!1),this.renderLayer(this,Q,q,nt,j)}this.renderPass="translucent";let $=!1;for(this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){const q=this.style._layers[x[this.currentLayer]],Q=E[q.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(q,j))continue;this.opaquePassEnabledForLayer()||$||($=!0,j.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const nt=(q.type==="symbol"?O:R)[q.source];this._renderTileClippingMasks(q,P[q.source],!!this.renderToTexture),this.renderLayer(this,Q,q,nt,j)}if(j.isRenderingGlobe&&(function(q,Q,nt){const lt=q.context,ut=lt.gl,ft=q.useProgram("atmosphere"),_t=new en(ut.LEQUAL,en.ReadOnly,[0,1]),Tt=q.transform,gt=(function(qt,ge){const ye=qt.properties.get("position"),oe=[-ye.x,-ye.y,-ye.z],De=u.ar(new Float64Array(16));return qt.properties.get("anchor")==="map"&&(u.bf(De,De,ge.rollInRadians),u.bg(De,De,-ge.pitchInRadians),u.bf(De,De,ge.bearingInRadians),u.bg(De,De,ge.center.lat*Math.PI/180),u.bI(De,De,-ge.center.lng*Math.PI/180)),u.cf(oe,oe,De),oe})(nt,q.transform),St=Tt.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),At=Q.properties.get("atmosphere-blend")*St.projectionTransition;if(At===0)return;const xt=dh(Tt.worldSize,Tt.center.lat),zt=Tt.inverseProjectionMatrix,$t=new Float64Array(4);$t[3]=1,u.aG($t,$t,Tt.modelViewProjectionMatrix),$t[0]/=$t[3],$t[1]/=$t[3],$t[2]/=$t[3],$t[3]=1,u.aG($t,$t,zt),$t[0]/=$t[3],$t[1]/=$t[3],$t[2]/=$t[3],$t[3]=1;const Vt=((qt,ge,ye,oe,De)=>({u_sun_pos:qt,u_atmosphere_blend:ge,u_globe_position:ye,u_globe_radius:oe,u_inv_proj_matrix:De}))(gt,At,[$t[0],$t[1],$t[2]],xt,zt),Ut=Fo(lt,Q);ft.draw(lt,ut.TRIANGLES,_t,gn.disabled,Qn.alphaBlended,cn.disabled,Vt,null,null,"atmosphere",Ut.vertexBuffer,Ut.indexBuffer,Ut.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const q=(function(Q,nt){let lt=null;const ut=Object.values(Q._layers).flatMap((gt=>gt.source&&!gt.isHidden(nt)?[Q.tileManagers[gt.source]]:[])),ft=ut.filter((gt=>gt.getSource().type==="vector")),_t=ut.filter((gt=>gt.getSource().type!=="vector")),Tt=gt=>{(!lt||lt.getSource().maxzoom<gt.getSource().maxzoom)&&(lt=gt)};return ft.forEach((gt=>Tt(gt))),lt||_t.forEach((gt=>Tt(gt))),lt})(this.style,this.transform.zoom);q&&(function(Q,nt,lt){for(let ut=0;ut<lt.length;ut++)Mh(Q,nt,lt[ut])})(this,q,q.getVisibleCoordinates())}this.options.showPadding&&(function(q){const Q=q.transform.padding;Ks(q,q.transform.height-(Q.top||0),3,Cs),Ks(q,Q.bottom||0,3,xu),Ma(q,Q.left||0,3,to),Ma(q,q.transform.width-(Q.right||0),3,bu);const nt=q.transform.centerPoint;(function(lt,ut,ft,_t){hs(lt,ut-1,ft-10,2,20,_t),hs(lt,ut-10,ft-1,20,2,_t)})(q,nt.x,q.transform.height-nt.y,No)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,d=this.transform.modelViewProjectionMatrix;let g=this.terrainFacilitator.dirty;g||(g=e?!u.ci(a,d):!u.cj(a,d)),g||(g=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),g&&(u.ck(a,d),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(x,E){const P=x.context,R=P.gl,O=x.transform,j=Qn.unblended,$=new en(R.LEQUAL,en.ReadWrite,[0,1]),q=E.tileManager.getRenderableTiles(),Q=x.useProgram("terrainDepth");P.bindFramebuffer.set(E.getFramebuffer("depth").framebuffer),P.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),P.clear({color:u.bo.transparent,depth:1});for(const nt of q){const lt=E.getTerrainMesh(nt.tileID),ut=E.getTerrainData(nt.tileID),ft=O.getProjectionData({overscaledTileID:nt.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),_t={u_ele_delta:E.getMeshFrameDelta(O.zoom)};Q.draw(P,R.TRIANGLES,$,gn.disabled,j,cn.backCCW,_t,ut,ft,"terrain",lt.vertexBuffer,lt.indexBuffer,lt.segments)}P.bindFramebuffer.set(null),P.viewport.set([0,0,x.width,x.height])})(this,this.style.map.terrain),(function(x,E){const P=x.context,R=P.gl,O=x.transform,j=Qn.unblended,$=new en(R.LEQUAL,en.ReadWrite,[0,1]),q=E.getCoordsTexture(),Q=E.tileManager.getRenderableTiles(),nt=x.useProgram("terrainCoords");P.bindFramebuffer.set(E.getFramebuffer("coords").framebuffer),P.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),P.clear({color:u.bo.transparent,depth:1}),E.coordsIndex=[];for(const lt of Q){const ut=E.getTerrainMesh(lt.tileID),ft=E.getTerrainData(lt.tileID);P.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,q.texture);const _t={u_terrain_coords_id:(255-E.coordsIndex.length)/255,u_texture:0,u_ele_delta:E.getMeshFrameDelta(O.zoom)},Tt=O.getProjectionData({overscaledTileID:lt.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});nt.draw(P,R.TRIANGLES,$,gn.disabled,j,cn.backCCW,_t,ft,Tt,"terrain",ut.vertexBuffer,ut.indexBuffer,ut.segments),E.coordsIndex.push(lt.tileID.key)}P.bindFramebuffer.set(null),P.viewport.set([0,0,x.width,x.height])})(this,this.style.map.terrain))}renderLayer(e,a,d,g,x){d.isHidden(this.transform.zoom)||(d.type==="background"||d.type==="custom"||(g||[]).length)&&(this.id=d.id,u.cl(d)?(function(E,P,R,O,j,$){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:q}=$,Q=gn.disabled,nt=E.colorModeForRenderPass();(R._unevaluatedLayout.hasValue("text-variable-anchor")||R._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(lt,ut,ft,_t,Tt,gt,St,At,xt){const zt=ut.transform,$t=ut.style.map.terrain,Vt=Tt==="map",Ut=gt==="map";for(const qt of lt){const ge=_t.getTile(qt),ye=ge.getBucket(ft);if(!ye||!ye.text||!ye.text.segments.get().length)continue;const oe=u.ax(ye.textSizeData,zt.zoom),De=u.aM(ge,1,ut.transform.zoom),tn=Ai(Vt,ut.transform,De),Ke=ft.layout.get("icon-text-fit")!=="none"&&ye.hasIconData();if(oe){const ei=Math.pow(2,zt.zoom-ge.tileID.overscaledZ),Hn=$t?(li,Vn)=>$t.getElevation(qt,li,Vn):null;ko(ye,Vt,Ut,xt,zt,tn,ei,oe,Ke,u.aN(zt,ge,St,At),qt.toUnwrapped(),Hn)}}})(O,E,R,P,R.layout.get("text-rotation-alignment"),R.layout.get("text-pitch-alignment"),R.paint.get("text-translate"),R.paint.get("text-translate-anchor"),j),R.paint.get("icon-opacity").constantOr(1)!==0&&Fr(E,P,R,O,!1,R.paint.get("icon-translate"),R.paint.get("icon-translate-anchor"),R.layout.get("icon-rotation-alignment"),R.layout.get("icon-pitch-alignment"),R.layout.get("icon-keep-upright"),Q,nt,q),R.paint.get("text-opacity").constantOr(1)!==0&&Fr(E,P,R,O,!0,R.paint.get("text-translate"),R.paint.get("text-translate-anchor"),R.layout.get("text-rotation-alignment"),R.layout.get("text-pitch-alignment"),R.layout.get("text-keep-upright"),Q,nt,q),P.map.showCollisionBoxes&&(Nr(E,P,R,O,!0),Nr(E,P,R,O,!1))})(e,a,d,g,this.style.placement.variableOffsets,x):u.cm(d)?(function(E,P,R,O,j){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:$}=j,q=R.paint.get("circle-opacity"),Q=R.paint.get("circle-stroke-width"),nt=R.paint.get("circle-stroke-opacity"),lt=!R.layout.get("circle-sort-key").isConstant();if(q.constantOr(1)===0&&(Q.constantOr(1)===0||nt.constantOr(1)===0))return;const ut=E.context,ft=ut.gl,_t=E.transform,Tt=E.getDepthModeForSublayer(0,en.ReadOnly),gt=gn.disabled,St=E.colorModeForRenderPass(),At=[],xt=_t.getCircleRadiusCorrection();for(let zt=0;zt<O.length;zt++){const $t=O[zt],Vt=P.getTile($t),Ut=Vt.getBucket(R);if(!Ut)continue;const qt=R.paint.get("circle-translate"),ge=R.paint.get("circle-translate-anchor"),ye=u.aN(_t,Vt,qt,ge),oe=Ut.programConfigurations.get(R.id),De=E.useProgram("circle",oe),tn=Ut.layoutVertexBuffer,Ke=Ut.indexBuffer,ei=E.style.map.terrain&&E.style.map.terrain.getTerrainData($t),Hn={programConfiguration:oe,program:De,layoutVertexBuffer:tn,indexBuffer:Ke,uniformValues:Wf(E,Vt,R,ye,xt),terrainData:ei,projectionData:_t.getProjectionData({overscaledTileID:$t,applyGlobeMatrix:!$,applyTerrainMatrix:!0})};if(lt){const li=Ut.segments.get();for(const Vn of li)At.push({segments:new u.aW([Vn]),sortKey:Vn.sortKey,state:Hn})}else At.push({segments:Ut.segments,sortKey:0,state:Hn})}lt&&At.sort(((zt,$t)=>zt.sortKey-$t.sortKey));for(const zt of At){const{programConfiguration:$t,program:Vt,layoutVertexBuffer:Ut,indexBuffer:qt,uniformValues:ge,terrainData:ye,projectionData:oe}=zt.state;Vt.draw(ut,ft.TRIANGLES,Tt,gt,St,cn.backCCW,ge,ye,oe,R.id,Ut,qt,zt.segments,R.paint,E.transform.zoom,$t)}})(e,a,d,g,x):u.cn(d)?(function(E,P,R,O,j){if(R.paint.get("heatmap-opacity")===0)return;const $=E.context,{isRenderingToTexture:q,isRenderingGlobe:Q}=j;if(E.style.map.terrain){for(const nt of O){const lt=P.getTile(nt);P.hasRenderableParent(nt)||(E.renderPass==="offscreen"?ts(E,lt,R,nt,Q):E.renderPass==="translucent"&&Ca(E,R,nt,q,Q))}$.viewport.set([0,0,E.width,E.height])}else E.renderPass==="offscreen"?(function(nt,lt,ut,ft){const _t=nt.context,Tt=_t.gl,gt=nt.transform,St=gn.disabled,At=new Qn([Tt.ONE,Tt.ONE],u.bo.transparent,[!0,!0,!0,!0]);(function(xt,zt,$t){const Vt=xt.gl;xt.activeTexture.set(Vt.TEXTURE1),xt.viewport.set([0,0,zt.width/4,zt.height/4]);let Ut=$t.heatmapFbos.get(u.cc);Ut?(Vt.bindTexture(Vt.TEXTURE_2D,Ut.colorAttachment.get()),xt.bindFramebuffer.set(Ut.framebuffer)):(Ut=Ys(xt,zt.width/4,zt.height/4),$t.heatmapFbos.set(u.cc,Ut))})(_t,nt,ut),_t.clear({color:u.bo.transparent});for(let xt=0;xt<ft.length;xt++){const zt=ft[xt];if(lt.hasRenderableParent(zt))continue;const $t=lt.getTile(zt),Vt=$t.getBucket(ut);if(!Vt)continue;const Ut=Vt.programConfigurations.get(ut.id),qt=nt.useProgram("heatmap",Ut),ge=gt.getProjectionData({overscaledTileID:zt,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),ye=gt.getCircleRadiusCorrection();qt.draw(_t,Tt.TRIANGLES,en.disabled,St,At,cn.backCCW,_l($t,gt.zoom,ut.paint.get("heatmap-intensity"),ye),null,ge,ut.id,Vt.layoutVertexBuffer,Vt.indexBuffer,Vt.segments,ut.paint,gt.zoom,Ut)}_t.viewport.set([0,0,nt.width,nt.height])})(E,P,R,O):E.renderPass==="translucent"&&(function(nt,lt){const ut=nt.context,ft=ut.gl;ut.setColorMode(nt.colorModeForRenderPass());const _t=lt.heatmapFbos.get(u.cc);_t&&(ut.activeTexture.set(ft.TEXTURE0),ft.bindTexture(ft.TEXTURE_2D,_t.colorAttachment.get()),ut.activeTexture.set(ft.TEXTURE1),yc(ut,lt).bind(ft.LINEAR,ft.CLAMP_TO_EDGE),nt.useProgram("heatmapTexture").draw(ut,ft.TRIANGLES,en.disabled,gn.disabled,nt.colorModeForRenderPass(),cn.disabled,Rd(nt,lt,0,1),null,null,lt.id,nt.viewportBuffer,nt.quadTriangleIndexBuffer,nt.viewportSegments,lt.paint,nt.transform.zoom))})(E,R)})(e,a,d,g,x):u.co(d)?(function(E,P,R,O,j){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:$}=j,q=R.paint.get("line-opacity"),Q=R.paint.get("line-width");if(q.constantOr(1)===0||Q.constantOr(1)===0)return;const nt=E.getDepthModeForSublayer(0,en.ReadOnly),lt=E.colorModeForRenderPass(),ut=R.paint.get("line-dasharray"),ft=ut.constantOr(1),_t=R.paint.get("line-pattern"),Tt=_t.constantOr(1),gt=R.paint.get("line-gradient"),St=R.getCrossfadeParameters();let At;At=Tt?"linePattern":ft&&gt?"lineGradientSDF":ft?"lineSDF":gt?"lineGradient":"line";const xt=E.context,zt=xt.gl,$t=E.transform;let Vt=!0;for(const Ut of O){const qt=P.getTile(Ut);if(Tt&&!qt.patternsLoaded())continue;const ge=qt.getBucket(R);if(!ge)continue;const ye=ge.programConfigurations.get(R.id),oe=E.context.program.get(),De=E.useProgram(At,ye),tn=Vt||De.program!==oe,Ke=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Ut),ei=_t.constantOr(null),Hn=ut&&ut.constantOr(null);if(ei&&qt.imageAtlas){const _i=qt.imageAtlas,vi=_i.patternPositions[ei.to.toString()],Ti=_i.patternPositions[ei.from.toString()];vi&&Ti&&ye.setConstantPatternPositions(vi,Ti)}else if(Hn){const _i=R.layout.get("line-cap")==="round",vi=E.lineAtlas.getDash(Hn.to,_i),Ti=E.lineAtlas.getDash(Hn.from,_i);ye.setConstantDashPositions(vi,Ti)}const li=$t.getProjectionData({overscaledTileID:Ut,applyGlobeMatrix:!$,applyTerrainMatrix:!0}),Vn=$t.getPixelScale();let Ii;Tt?(Ii=Kf(E,qt,R,Vn,St),Ah(xt,zt,qt,ye,St)):ft&&gt?(Ii=Jf(E,qt,R,Vn,St,ge.lineClipsArray.length),Jn(E,P,xt,zt,R,ge,Ut,ye,St)):ft?(Ii=Qf(E,qt,R,Vn,St),Bd(E,xt,zt,ye,tn,St)):gt?(Ii=hc(E,qt,R,Vn,ge.lineClipsArray.length),Oi(E,P,xt,zt,R,ge,Ut)):Ii=uc(E,qt,R,Vn);const ii=E.stencilModeForClipping(Ut);De.draw(xt,zt.TRIANGLES,nt,ii,lt,cn.disabled,Ii,Ke,li,R.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,R.paint,E.transform.zoom,ye,ge.layoutVertexBuffer2),Vt=!1}})(e,a,d,g,x):u.cp(d)?(function(E,P,R,O,j){const $=R.paint.get("fill-color"),q=R.paint.get("fill-opacity");if(q.constantOr(1)===0)return;const{isRenderingToTexture:Q}=j,nt=E.colorModeForRenderPass(),lt=R.paint.get("fill-pattern"),ut=E.opaquePassEnabledForLayer()&&!lt.constantOr(1)&&$.constantOr(u.bo.transparent).a===1&&q.constantOr(0)===1?"opaque":"translucent";if(E.renderPass===ut){const ft=E.getDepthModeForSublayer(1,E.renderPass==="opaque"?en.ReadWrite:en.ReadOnly);Aa(E,P,R,O,ft,nt,!1,Q)}if(E.renderPass==="translucent"&&R.paint.get("fill-antialias")){const ft=E.getDepthModeForSublayer(R.getPaintProperty("fill-outline-color")?2:0,en.ReadOnly);Aa(E,P,R,O,ft,nt,!0,Q)}})(e,a,d,g,x):u.cq(d)?(function(E,P,R,O,j){const $=R.paint.get("fill-extrusion-opacity");if($===0)return;const{isRenderingToTexture:q}=j;if(E.renderPass==="translucent"){const Q=new en(E.context.gl.LEQUAL,en.ReadWrite,E.depthRangeFor3D);if($!==1||R.paint.get("fill-extrusion-pattern").constantOr(1))wn(E,P,R,O,Q,gn.disabled,Qn.disabled,q),wn(E,P,R,O,Q,E.stencilModeFor3D(),E.colorModeForRenderPass(),q);else{const nt=E.colorModeForRenderPass();wn(E,P,R,O,Q,gn.disabled,nt,q)}}})(e,a,d,g,x):u.cr(d)?(function(E,P,R,O,j){if(E.renderPass!=="offscreen"&&E.renderPass!=="translucent")return;const{isRenderingToTexture:$}=j,q=E.context,Q=E.style.projection.useSubdivision,nt=E.getDepthModeForSublayer(0,en.ReadOnly),lt=E.colorModeForRenderPass();if(E.renderPass==="offscreen")(function(ut,ft,_t,Tt,gt,St,At){const xt=ut.context,zt=xt.gl;for(const $t of _t){const Vt=ft.getTile($t),Ut=Vt.dem;if(!Ut||!Ut.data||!Vt.needsHillshadePrepare)continue;const qt=Ut.dim,ge=Ut.stride,ye=Ut.getPixels();if(xt.activeTexture.set(zt.TEXTURE1),xt.pixelStoreUnpackPremultiplyAlpha.set(!1),Vt.demTexture=Vt.demTexture||ut.getTileTexture(ge),Vt.demTexture){const De=Vt.demTexture;De.update(ye,{premultiply:!1}),De.bind(zt.NEAREST,zt.CLAMP_TO_EDGE)}else Vt.demTexture=new u.T(xt,ye,zt.RGBA,{premultiply:!1}),Vt.demTexture.bind(zt.NEAREST,zt.CLAMP_TO_EDGE);xt.activeTexture.set(zt.TEXTURE0);let oe=Vt.fbo;if(!oe){const De=new u.T(xt,{width:qt,height:qt,data:null},zt.RGBA);De.bind(zt.LINEAR,zt.CLAMP_TO_EDGE),oe=Vt.fbo=xt.createFramebuffer(qt,qt,!0,!1),oe.colorAttachment.set(De.texture)}xt.bindFramebuffer.set(oe.framebuffer),xt.viewport.set([0,0,qt,qt]),ut.useProgram("hillshadePrepare").draw(xt,zt.TRIANGLES,gt,St,At,cn.disabled,Id(Vt.tileID,Ut),null,null,Tt.id,ut.rasterBoundsBuffer,ut.quadTriangleIndexBuffer,ut.rasterBoundsSegments),Vt.needsHillshadePrepare=!1}})(E,P,O,R,nt,gn.disabled,lt),q.viewport.set([0,0,E.width,E.height]);else if(E.renderPass==="translucent")if(Q){const[ut,ft,_t]=E.stencilConfigForOverlapTwoPass(O);Ws(E,P,R,_t,ut,nt,lt,!1,$),Ws(E,P,R,_t,ft,nt,lt,!0,$)}else{const[ut,ft]=E.getStencilConfigForOverlapAndUpdateStencilID(O);Ws(E,P,R,ft,ut,nt,lt,!1,$)}})(e,a,d,g,x):u.cs(d)?(function(E,P,R,O,j){if(E.renderPass!=="translucent"||!O.length)return;const{isRenderingToTexture:$}=j,q=E.style.projection.useSubdivision,Q=E.getDepthModeForSublayer(0,en.ReadOnly),nt=E.colorModeForRenderPass();if(q){const[lt,ut,ft]=E.stencilConfigForOverlapTwoPass(O);Di(E,P,R,ft,lt,Q,nt,!1,$),Di(E,P,R,ft,ut,Q,nt,!0,$)}else{const[lt,ut]=E.getStencilConfigForOverlapAndUpdateStencilID(O);Di(E,P,R,ut,lt,Q,nt,!1,$)}})(e,a,d,g,x):u.bT(d)?(function(E,P,R,O,j){if(E.renderPass!=="translucent"||R.paint.get("raster-opacity")===0||!O.length)return;const{isRenderingToTexture:$}=j,q=P.getSource(),Q=E.style.projection.useSubdivision;if(q instanceof Hr)Oo(E,P,R,O,null,!1,!1,q.tileCoords,q.flippedWindingOrder,$);else if(Q){const[nt,lt,ut]=E.stencilConfigForOverlapTwoPass(O);Oo(E,P,R,ut,nt,!1,!0,vc,!1,$),Oo(E,P,R,ut,lt,!0,!0,vc,!1,$)}else{const[nt,lt]=E.getStencilConfigForOverlapAndUpdateStencilID(O);Oo(E,P,R,lt,nt,!1,!0,vc,!1,$)}})(e,a,d,g,x):u.ct(d)?(function(E,P,R,O,j){const $=R.paint.get("background-color"),q=R.paint.get("background-opacity");if(q===0)return;const{isRenderingToTexture:Q}=j,nt=E.context,lt=nt.gl,ut=E.style.projection,ft=E.transform,_t=ft.tileSize,Tt=R.paint.get("background-pattern");if(E.isPatternMissing(Tt))return;const gt=!Tt&&$.a===1&&q===1&&E.opaquePassEnabledForLayer()?"opaque":"translucent";if(E.renderPass!==gt)return;const St=gn.disabled,At=E.getDepthModeForSublayer(0,gt==="opaque"?en.ReadWrite:en.ReadOnly),xt=E.colorModeForRenderPass(),zt=E.useProgram(Tt?"backgroundPattern":"background"),$t=O||Qe(ft,{tileSize:_t,terrain:E.style.map.terrain});Tt&&(nt.activeTexture.set(lt.TEXTURE0),E.imageManager.bind(E.context));const Vt=R.getCrossfadeParameters();for(const Ut of $t){const qt=ft.getProjectionData({overscaledTileID:Ut,applyGlobeMatrix:!Q,applyTerrainMatrix:!0}),ge=Tt?wh(q,E,Tt,{tileID:Ut,tileSize:_t},Vt):bh(q,$),ye=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Ut),oe=ut.getMeshFromTileID(nt,Ut.canonical,!1,!0,"raster");zt.draw(nt,lt.TRIANGLES,At,St,xt,cn.backCCW,ge,ye,qt,R.id,oe.vertexBuffer,oe.indexBuffer,oe.segments)}})(e,0,d,g,x):u.cu(d)&&(function(E,P,R,O){const{isRenderingGlobe:j}=O,$=E.context,q=R.implementation,Q=E.style.projection,nt=E.transform,lt=nt.getProjectionDataForCustomLayer(j),ut={farZ:nt.farZ,nearZ:nt.nearZ,fov:nt.fov*Math.PI/180,modelViewProjectionMatrix:nt.modelViewProjectionMatrix,projectionMatrix:nt.projectionMatrix,shaderData:{variantName:Q.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${Q.shaderPreludeCode.vertexSource}`,define:Q.shaderDefine},defaultProjectionData:lt},ft=q.renderingMode?q.renderingMode:"2d";if(E.renderPass==="offscreen"){const _t=q.prerender;_t&&(E.setCustomLayerDefaults(),$.setColorMode(E.colorModeForRenderPass()),_t.call(q,$.gl,ut),$.setDirty(),E.setBaseState())}else if(E.renderPass==="translucent"){E.setCustomLayerDefaults(),$.setColorMode(E.colorModeForRenderPass()),$.setStencilMode(gn.disabled);const _t=ft==="3d"?E.getDepthModeFor3D():E.getDepthModeForSublayer(0,en.ReadOnly);$.setDepthMode(_t),q.render($.gl,ut),$.setDirty(),E.setBaseState(),$.bindFramebuffer.set(null)}})(e,0,d,x))}saveTileTexture(e){const a=this._tileTextures[e.size[0]];a?a.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const a=this._tileTextures[e];return a&&a.length>0?a.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const a=this.imageManager.getPattern(e.from.toString()),d=this.imageManager.getPattern(e.to.toString());return!a||!d}useProgram(e,a,d=!1,g=[]){this.cache=this.cache||{};const x=!!this.style.map.terrain,E=this.style.projection,P=d?Lr.projectionMercator:E.shaderPreludeCode,R=d?Mi:E.shaderDefine,O=e+(a?a.cacheKey:"")+`/${d?Pi:E.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(x?"/terrain":"")+(g?`/${g.join("/")}`:"");return this.cache[O]||(this.cache[O]=new Xf(this.context,Lr[e],a,du[e],this._showOverdrawInspector,x,P,R,g)),this.cache[O]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new u.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){var e,a;if(this._tileTextures){for(const d in this._tileTextures){const g=this._tileTextures[d];if(g)for(const x of g)x.destroy()}this._tileTextures={}}if(this.tileExtentBuffer&&this.tileExtentBuffer.destroy(),this.debugBuffer&&this.debugBuffer.destroy(),this.rasterBoundsBuffer&&this.rasterBoundsBuffer.destroy(),this.rasterBoundsBufferPosOnly&&this.rasterBoundsBufferPosOnly.destroy(),this.viewportBuffer&&this.viewportBuffer.destroy(),this.tileBorderIndexBuffer&&this.tileBorderIndexBuffer.destroy(),this.quadTriangleIndexBuffer&&this.quadTriangleIndexBuffer.destroy(),this.tileExtentMesh&&((e=this.tileExtentMesh.vertexBuffer)===null||e===void 0||e.destroy()),this.tileExtentMesh&&((a=this.tileExtentMesh.indexBuffer)===null||a===void 0||a.destroy()),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.cache){for(const d in this.cache){const g=this.cache[d];g&&g.program&&this.context.gl.deleteProgram(g.program)}this.cache={}}this.context&&this.context.setDefault()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:a}=this.context.gl;return this.width!==e||this.height!==a}}function eo(v,e){let a,d=!1,g=null,x=null;const E=()=>{g=null,d&&(v.apply(x,a),g=setTimeout(E,e),d=!1)};return(...P)=>(d=!0,x=this,a=P,g||E(),g)}class $i{constructor(e){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let d;return a.split("&").map((g=>g.split("="))).forEach((g=>{g[0]===this._hashName&&(d=g)})),(d&&d[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(!this._isValidHash(a))return!1;const d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:d,pitch:+(a[4]||0)}),!0},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,a)},this._removeHash=()=>{const a=this._getCurrentHash();if(a.length===0)return;const d=a.join("/");let g=d;g.split("&").length>0&&(g=g.split("&")[0]),this._hashName&&(g=`${this._hashName}=${d}`);let x=window.location.hash.replace(g,"");x.startsWith("#&")?x=x.slice(0,1)+x.slice(2):x==="#"&&(x="");let E=window.location.href.replace(/(#.+)?$/,x);E=E.replace("&&","&"),window.history.replaceState(window.history.state,null,E)},this._updateHash=eo(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const a=this._map.getCenter(),d=Math.round(100*this._map.getZoom())/100,g=Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,g),E=Math.round(a.lng*x)/x,P=Math.round(a.lat*x)/x,R=this._map.getBearing(),O=this._map.getPitch();let j="";if(j+=e?`/${E}/${P}/${d}`:`${d}/${P}/${E}`,(R||O)&&(j+="/"+Math.round(10*R)/10),O&&(j+=`/${Math.round(O)}`),this._hashName){const $=this._hashName;let q=!1;const Q=window.location.hash.slice(1).split("&").map((nt=>{const lt=nt.split("=")[0];return lt===$?(q=!0,`${lt}=${j}`):nt})).filter((nt=>nt));return q||Q.push(`${$}=${j}`),`#${Q.join("&")}`}return`#${j}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new u.V(+e[2],+e[1])}catch{return!1}const a=+e[0],d=+(e[3]||0),g=+(e[4]||0);return a>=this._map.getMinZoom()&&a<=this._map.getMaxZoom()&&d>=-180&&d<=180&&g>=this._map.getMinPitch()&&g<=this._map.getMaxPitch()}}const no={linearity:.3,easing:u.cv(0,0,.3,1)},Vd=u.e({deceleration:2500,maxSpeed:1400},no),ip=u.e({deceleration:20,maxSpeed:1400},no),rp=u.e({deceleration:1e3,maxSpeed:360},no),Ph=u.e({deceleration:1e3,maxSpeed:90},no),Ri=u.e({deceleration:1e3,maxSpeed:360},no);class es{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:rt(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,a=rt();for(;e.length>0&&a-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,roll:0,pan:new u.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)a.zoom+=x.zoomDelta||0,a.bearing+=x.bearingDelta||0,a.pitch+=x.pitchDelta||0,a.roll+=x.rollDelta||0,x.panDelta&&a.pan._add(x.panDelta),x.around&&(a.around=x.around),x.pinchAround&&(a.pinchAround=x.pinchAround);const d=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(a.pan.mag()){const x=Da(a.pan.mag(),d,u.e({},Vd,e||{})),E=a.pan.mult(x.amount/a.pan.mag()),P=this._map.cameraHelper.handlePanInertia(E,this._map.transform);g.center=P.easingCenter,g.offset=P.easingOffset,Hi(g,x)}if(a.zoom){const x=Da(a.zoom,d,ip);g.zoom=this._map.transform.zoom+x.amount,Hi(g,x)}if(a.bearing){const x=Da(a.bearing,d,rp);g.bearing=this._map.transform.bearing+u.an(x.amount,-179,179),Hi(g,x)}if(a.pitch){const x=Da(a.pitch,d,Ph);g.pitch=this._map.transform.pitch+x.amount,Hi(g,x)}if(a.roll){const x=Da(a.roll,d,Ri);g.roll=this._map.transform.roll+u.an(x.amount,-179,179),Hi(g,x)}if(g.zoom||g.bearing){const x=a.pinchAround===void 0?a.around:a.pinchAround;g.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),u.e(g,{noMoveStart:!0})}}function Hi(v,e){(!v.duration||v.duration<e.duration)&&(v.duration=e.duration,v.easing=e.easing)}function Da(v,e,a){const{maxSpeed:d,linearity:g,deceleration:x}=a,E=u.an(v*g/(e/1e3),-d,d),P=Math.abs(E)/(x*g);return{easing:a.easing,duration:1e3*P,amount:E*(P/2)}}class ai extends u.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,d,g={}){d=d instanceof MouseEvent?d:new MouseEvent(e,d);const x=J.mousePos(a.getCanvas(),d),E=a.unproject(x);super(e,u.e({point:x,lngLat:E,originalEvent:d},g)),this._defaultPrevented=!1,this.target=a}}class Ra extends u.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,d){const g=e==="touchend"?d.changedTouches:d.touches,x=J.touchPos(a.getCanvasContainer(),g),E=x.map((R=>a.unproject(R))),P=x.reduce(((R,O,j,$)=>R.add(O.div($.length))),new u.P(0,0));super(e,{points:x,point:P,lngLats:E,lngLat:a.unproject(P),originalEvent:d}),this._defaultPrevented=!1}}class As extends u.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,d){super(e,{originalEvent:d}),this._defaultPrevented=!1}}class Cm{constructor(e,a){this._map=e,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new As(e.type,this._map,e))}mousedown(e,a){return this._mousedownPos=a,this._firePreventable(new ai(e.type,this._map,e))}mouseup(e){this._map.fire(new ai(e.type,this._map,e))}click(e,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new ai(e.type,this._map,e))}dblclick(e){return this._firePreventable(new ai(e.type,this._map,e))}mouseover(e){this._map.fire(new ai(e.type,this._map,e))}mouseout(e){this._map.fire(new ai(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Ra(e.type,this._map,e))}touchmove(e){this._map.fire(new Ra(e.type,this._map,e))}touchend(e){this._map.fire(new Ra(e.type,this._map,e))}touchcancel(e){this._map.fire(new Ra(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class sp{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new ai(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ai("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new ai(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Tu{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(u.P.convert(e),this._map.terrain)}}class Ud{constructor(e,a){this._map=e,this._tr=new Tu(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,a){this.isEnabled()&&e.shiftKey&&e.button===0&&(J.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(e,a){if(!this._active)return;const d=a;if(this._lastPos.equals(d)||!this._box&&d.dist(this._startPos)<this._clickTolerance)return;const g=this._startPos;this._lastPos=d,this._box||(this._box=J.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const x=Math.min(g.x,d.x),E=Math.max(g.x,d.x),P=Math.min(g.y,d.y),R=Math.max(g.y,d.y);J.setTransform(this._box,`translate(${x}px,${P}px)`),this._box.style.width=E-x+"px",this._box.style.height=R-P+"px"}mouseupWindow(e,a){if(!this._active||e.button!==0)return;const d=this._startPos,g=a;if(this.reset(),J.suppressClick(),d.x!==g.x||d.y!==g.y)return this._map.fire(new u.l("boxzoomend",{originalEvent:e})),{cameraAnimation:x=>x.fitScreenCoordinates(d,g,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(J.remove(this._box),this._box=null),J.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,a){return this._map.fire(new u.l(e,{originalEvent:a}))}}function Ia(v,e){if(v.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${v.length}, points ${e.length}`);const a={};for(let d=0;d<v.length;d++)a[v[d].identifier]=e[d];return a}class Al{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,a,d){(this.centroid||d.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),d.length===this.numTouches&&(this.centroid=(function(g){const x=new u.P(0,0);for(const E of g)x._add(E);return x.div(g.length)})(a),this.touches=Ia(d,a)))}touchmove(e,a,d){if(this.aborted||!this.centroid)return;const g=Ia(d,a);for(const x in this.touches){const E=g[x];(!E||E.dist(this.touches[x])>30)&&(this.aborted=!0)}}touchend(e,a,d){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),d.length===0){const g=!this.aborted&&this.centroid;if(this.reset(),g)return g}}}class ns{constructor(e){this.singleTap=new Al(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,a,d){this.singleTap.touchstart(e,a,d)}touchmove(e,a,d){this.singleTap.touchmove(e,a,d)}touchend(e,a,d){const g=this.singleTap.touchend(e,a,d);if(g){const x=e.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(g)<30;if(x&&E||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}}}class Me{constructor(e){this._tr=new Tu(e),this._zoomIn=new ns({numTouches:1,numTaps:2}),this._zoomOut=new ns({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,a,d){this._zoomIn.touchstart(e,a,d),this._zoomOut.touchstart(e,a,d)}touchmove(e,a,d){this._zoomIn.touchmove(e,a,d),this._zoomOut.touchmove(e,a,d)}touchend(e,a,d){const g=this._zoomIn.touchend(e,a,d),x=this._zoomOut.touchend(e,a,d),E=this._tr;return g?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:E.zoom+1,around:E.unproject(g)},{originalEvent:e})}):x?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:E.zoom-1,around:E.unproject(x)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qs{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const a=this._moveFunction(...e);if(a.bearingDelta||a.pitchDelta||a.rollDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(e,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(a)?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,a){if(!this.isEnabled())return;const d=this._lastPoint;if(!d)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const g=Array.isArray(a)?a[0]:a;return!this._moved&&g.dist(d)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=g,this._move(d,g))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&J.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Su=0,Eu=2,jo={[Su]:1,[Eu]:2};class za{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const a=J.mouseButton(e);this._eventButton=a}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!(function(a,d){const g=jo[d];return a.buttons===void 0||(a.buttons&g)!==g})(e,this._eventButton)}isValidEndEvent(e){return J.mouseButton(e)===this._eventButton}}class Dh{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Ml{constructor(e=new za({checkCorrectEvent:()=>!0}),a=new Dh){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=a}_executeRelevantHandler(e,a,d){return e instanceof MouseEvent?a(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?d(e):void 0}startMove(e){this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.startMove(a)),(a=>this.oneFingerTouchMoveStateManager.startMove(a)))}endMove(e){this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.endMove(a)),(a=>this.oneFingerTouchMoveStateManager.endMove(a)))}isValidStartEvent(e){return this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.isValidStartEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidStartEvent(a)))}isValidMoveEvent(e){return this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.isValidMoveEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(a)))}isValidEndEvent(e){return this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.isValidEndEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidEndEvent(a)))}}const Ms=v=>{v.mousedown=v.dragStart,v.mousemoveWindow=v.dragMove,v.mouseup=v.dragEnd,v.contextmenu=e=>{e.preventDefault()}};class Gd{constructor(e,a){this._clickTolerance=e.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new u.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,a,d){return this._calculateTransform(e,a,d)}touchmove(e,a,d){if(this._active){if(!this._shouldBePrevented(d.length))return e.preventDefault(),this._calculateTransform(e,a,d);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,a,d){this._calculateTransform(e,a,d),this._active&&this._shouldBePrevented(d.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,a,d){d.length>0&&(this._active=!0);const g=Ia(d,a),x=new u.P(0,0),E=new u.P(0,0);let P=0;for(const O in g){const j=g[O],$=this._touches[O];$&&(x._add(j),E._add(j.sub($)),P++,g[O]=j)}if(this._touches=g,this._shouldBePrevented(P)||!E.mag())return;const R=E.div(P);return this._sum._add(R),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(P),panDelta:R}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xc{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,a,d){this._firstTwoTouches||d.length<2||(this._firstTwoTouches=[d[0].identifier,d[1].identifier],this._start([a[0],a[1]]))}touchmove(e,a,d){if(!this._firstTwoTouches)return;e.preventDefault();const[g,x]=this._firstTwoTouches,E=io(d,a,g),P=io(d,a,x);if(!E||!P)return;const R=this._aroundCenter?null:E.add(P).div(2);return this._move([E,P],R,e)}touchend(e,a,d){if(!this._firstTwoTouches)return;const[g,x]=this._firstTwoTouches,E=io(d,a,g),P=io(d,a,x);E&&P||(this._active&&J.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function io(v,e,a){for(let d=0;d<v.length;d++)if(v[d].identifier===a)return e[d]}function Pl(v,e){return Math.log(v/e)/Math.LN2}class Cu extends xc{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,a){const d=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Pl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Pl(this._distance,d),pinchAround:a}}}function bc(v,e){return 180*v.angleWith(e)/Math.PI}class wc extends xc{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,a,d){const g=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:bc(this._vector,g),pinchAround:a}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const a=25/(Math.PI*this._minDiameter)*360,d=bc(e,this._startVector);return Math.abs(d)<a}}function Rh(v){return Math.abs(v.y)>Math.abs(v.x)}class ro extends xc{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,a,d){super.touchstart(e,a,d),this._currentTouchCount=d.length}_start(e){this._lastPoints=e,Rh(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,a,d){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const g=e[0].sub(this._lastPoints[0]),x=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(g,x,d.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(g.y+x.y)/2*-.5}):void 0}gestureBeginsVertically(e,a,d){if(this._valid!==void 0)return this._valid;const g=e.mag()>=2,x=a.mag()>=2;if(!g&&!x)return;if(!g||!x)return this._firstMove===void 0&&(this._firstMove=d),d-this._firstMove<100&&void 0;const E=e.y>0==a.y>0;return Rh(e)&&Rh(a)&&E}}const ap={panStep:100,bearingStep:15,pitchStep:10};class so{constructor(e){this._tr=new Tu(e);const a=ap;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let a=0,d=0,g=0,x=0,E=0;switch(e.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:e.shiftKey?d=-1:(e.preventDefault(),x=-1);break;case 39:e.shiftKey?d=1:(e.preventDefault(),x=1);break;case 38:e.shiftKey?g=1:(e.preventDefault(),E=-1);break;case 40:e.shiftKey?g=-1:(e.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(d=0,g=0),{cameraAnimation:P=>{const R=this._tr;P.easeTo({duration:300,easeId:"keyboardHandler",easing:La,zoom:a?Math.round(R.zoom)+a*(e.shiftKey?2:1):R.zoom,bearing:R.bearing+d*this._bearingStep,pitch:R.pitch+g*this._pitchStep,offset:[-x*this._panStep,-E*this._panStep],center:R.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function La(v){return v*(2-v)}const kn=4.000244140625,Bo=1/450;class Ps{constructor(e,a){this._onTimeout=d=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},this._map=e,this._tr=new Tu(e),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Bo}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let a=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const d=rt(),g=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,a!==0&&a%kn==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(g*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),e.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=e,this._delta-=a,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=J.mousePos(this._map.getCanvas(),e),d=this._tr;this._aroundPoint=this._aroundCenter?d.transform.locationToScreenPoint(u.V.convert(d.center)):a,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const P=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=P),typeof this._targetZoom=="number"&&(this._targetZoom+=P)}if(this._delta!==0){const P=this._type==="wheel"&&Math.abs(this._delta)>kn?this._wheelZoomRate:this._defaultZoomRate;let R=2/(1+Math.exp(-Math.abs(this._delta*P)));this._delta<0&&R!==0&&(R=1/R);const O=typeof this._targetZoom!="number"?e.scale:u.aq(this._targetZoom);this._targetZoom=e.applyConstrain(e.getCameraLngLat(),u.at(O*R)).zoom,this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,d=this._startZoom,g=this._easing;let x,E=!1;if(this._type==="wheel"&&d&&g){const P=rt()-this._lastWheelEventTime,R=Math.min((P+5)/200,1),O=g(R);x=u.G.number(d,a,O),R<1?this._frameId||(this._frameId=!0):E=!0}else x=a,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=x,{noInertia:!0,needsRenderFrame:!E,zoomDelta:x-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let a=u.cx;if(this._prevEase){const d=this._prevEase,g=(rt()-d.start)/d.duration,x=d.easing(g+.01)-d.easing(g),E=.27/Math.sqrt(x*x+1e-4)*.01,P=Math.sqrt(.0729-E*E);a=u.cv(E,P,.25,1)}return this._prevEase={start:rt(),duration:e,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class ao{constructor(e,a){this._clickZoom=e,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Au{constructor(e){this._tr=new Tu(e),this.reset()}reset(){this._active=!1}dblclick(e,a){return e.preventDefault(),{cameraAnimation:d=>{d.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ih{constructor(){this._tap=new ns({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,a,d){if(!this._swipePoint)if(this._tapTime){const g=a[0],x=e.timeStamp-this._tapTime<500,E=this._tapPoint.dist(g)<30;x&&E?d.length>0&&(this._swipePoint=g,this._swipeTouch=d[0].identifier):this.reset()}else this._tap.touchstart(e,a,d)}touchmove(e,a,d){if(this._tapTime){if(this._swipePoint){if(d[0].identifier!==this._swipeTouch)return;const g=a[0],x=g.y-this._swipePoint.y;return this._swipePoint=g,e.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(e,a,d)}touchend(e,a,d){if(this._tapTime)this._swipePoint&&d.length===0&&this.reset();else{const g=this._tap.touchend(e,a,d);g&&(this._tapTime=e.timeStamp,this._tapPoint=g)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Dl{constructor(e,a,d){this._el=e,this._mousePan=a,this._touchPan=d}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Rl{constructor(e,a,d,g){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=a,this._mousePitch=d,this._mouseRoll=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class qd{constructor(e,a,d,g){this._el=e,this._touchZoom=a,this._touchRotate=d,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Ds{constructor(e,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=J.create("div","maplibregl-cooperative-gesture-screen",e);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const d=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),g=document.createElement("div");g.className="maplibregl-desktop-message",g.textContent=a,this._container.appendChild(g);const x=document.createElement("div");x.className="maplibregl-mobile-message",x.textContent=d,this._container.appendChild(x),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(J.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,a){this._enabled&&(this._map.fire(new u.l("cooperativegestureprevented",{gestureType:e,originalEvent:a})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Rs=v=>v.zoom||v.drag||v.roll||v.pitch||v.rotate;class Re extends u.l{}function Ve(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta||v.rollDelta}class Il{constructor(e,a){this.handleWindowEvent=g=>{this.handleEvent(g,`${g.type}Window`)},this.handleEvent=(g,x)=>{if(g.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const E=g.type==="renderFrame"?void 0:g,P={needsRenderFrame:!1},R={},O={};for(const{handlerName:q,handler:Q,allowed:nt}of this._handlers){if(!Q.isEnabled())continue;let lt;if(this._blockedByActive(O,nt,q))Q.reset();else if(Q[x||g.type]){if(u.cy(g,x||g.type)){const ut=J.mousePos(this._map.getCanvas(),g);lt=Q[x||g.type](g,ut)}else if(u.cz(g,x||g.type)){const ut=this._getMapTouches(g.touches),ft=J.touchPos(this._map.getCanvas(),ut);lt=Q[x||g.type](g,ft,ut)}else u.cA(x||g.type)||(lt=Q[x||g.type](g));this.mergeHandlerResult(P,R,lt,q,E),lt&&lt.needsRenderFrame&&this._triggerRenderFrame()}(lt||Q.isActive())&&(O[q]=Q)}const j={};for(const q in this._previousActiveHandlers)O[q]||(j[q]=E);this._previousActiveHandlers=O,(Object.keys(j).length||Ve(P))&&(this._changes.push([P,R,j]),this._triggerRenderFrame()),(Object.keys(O).length||Ve(P))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:$}=P;$&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],$(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new es(e),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const d=this._el;this._listeners=[[d,"touchstart",{passive:!0}],[d,"touchmove",{passive:!1}],[d,"touchend",void 0],[d,"touchcancel",void 0],[d,"mousedown",void 0],[d,"mousemove",void 0],[d,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[d,"mouseover",void 0],[d,"mouseout",void 0],[d,"dblclick",void 0],[d,"click",void 0],[d,"keydown",{capture:!1}],[d,"keyup",void 0],[d,"wheel",{passive:!1}],[d,"contextmenu",void 0],[window,"blur",void 0]];for(const[g,x,E]of this._listeners)J.addEventListener(g,x,g===document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[e,a,d]of this._listeners)J.removeEventListener(e,a,e===document?this.handleWindowEvent:this.handleEvent,d)}_addDefaultHandlers(e){const a=this._map,d=a.getCanvasContainer();this._add("mapEvent",new Cm(a,e));const g=a.boxZoom=new Ud(a,e);this._add("boxZoom",g),e.interactive&&e.boxZoom&&g.enable();const x=a.cooperativeGestures=new Ds(a,e.cooperativeGestures);this._add("cooperativeGestures",x),e.cooperativeGestures&&x.enable();const E=new Me(a),P=new Au(a);a.doubleClickZoom=new ao(P,E),this._add("tapZoom",E),this._add("clickZoom",P),e.interactive&&e.doubleClickZoom&&a.doubleClickZoom.enable();const R=new Ih;this._add("tapDragZoom",R);const O=a.touchPitch=new ro(a);this._add("touchPitch",O),e.interactive&&e.touchPitch&&a.touchPitch.enable(e.touchPitch);const j=()=>a.project(a.getCenter()),$=(function({enable:gt,clickTolerance:St,aroundCenter:At=!0,minPixelCenterThreshold:xt=100,rotateDegreesPerPixelMoved:zt=.8},$t){const Vt=new za({checkCorrectEvent:Ut=>J.mouseButton(Ut)===0&&Ut.ctrlKey||J.mouseButton(Ut)===2&&!Ut.ctrlKey});return new Qs({clickTolerance:St,move:(Ut,qt)=>{const ge=$t();if(At&&Math.abs(ge.y-Ut.y)>xt)return{bearingDelta:u.cw(new u.P(Ut.x,qt.y),qt,ge)};let ye=(qt.x-Ut.x)*zt;return At&&qt.y<ge.y&&(ye=-ye),{bearingDelta:ye}},moveStateManager:Vt,enable:gt,assignEvents:Ms})})(e,j),q=(function({enable:gt,clickTolerance:St,pitchDegreesPerPixelMoved:At=-.5}){const xt=new za({checkCorrectEvent:zt=>J.mouseButton(zt)===0&&zt.ctrlKey||J.mouseButton(zt)===2});return new Qs({clickTolerance:St,move:(zt,$t)=>({pitchDelta:($t.y-zt.y)*At}),moveStateManager:xt,enable:gt,assignEvents:Ms})})(e),Q=(function({enable:gt,clickTolerance:St,rollDegreesPerPixelMoved:At=.3},xt){const zt=new za({checkCorrectEvent:$t=>J.mouseButton($t)===2&&$t.ctrlKey});return new Qs({clickTolerance:St,move:($t,Vt)=>{const Ut=xt();let qt=(Vt.x-$t.x)*At;return Vt.y<Ut.y&&(qt=-qt),{rollDelta:qt}},moveStateManager:zt,enable:gt,assignEvents:Ms})})(e,j);a.dragRotate=new Rl(e,$,q,Q),this._add("mouseRotate",$,["mousePitch"]),this._add("mousePitch",q,["mouseRotate","mouseRoll"]),this._add("mouseRoll",Q,["mousePitch"]),e.interactive&&e.dragRotate&&a.dragRotate.enable();const nt=(function({enable:gt,clickTolerance:St}){const At=new za({checkCorrectEvent:xt=>J.mouseButton(xt)===0&&!xt.ctrlKey});return new Qs({clickTolerance:St,move:(xt,zt)=>({around:zt,panDelta:zt.sub(xt)}),activateOnStart:!0,moveStateManager:At,enable:gt,assignEvents:Ms})})(e),lt=new Gd(e,a);a.dragPan=new Dl(d,nt,lt),this._add("mousePan",nt),this._add("touchPan",lt,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&a.dragPan.enable(e.dragPan);const ut=new wc,ft=new Cu;a.touchZoomRotate=new qd(d,ft,ut,R),this._add("touchRotate",ut,["touchPan","touchZoom"]),this._add("touchZoom",ft,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&a.touchZoomRotate.enable(e.touchZoomRotate),this._add("blockableMapEvent",new sp(a));const _t=a.scrollZoom=new Ps(a,(()=>this._triggerRenderFrame()));this._add("scrollZoom",_t,["mousePan"]),e.interactive&&e.scrollZoom&&a.scrollZoom.enable(e.scrollZoom);const Tt=a.keyboard=new so(a);this._add("keyboard",Tt),e.interactive&&e.keyboard&&a.keyboard.enable()}_add(e,a,d){this._handlers.push({handlerName:e,handler:a,allowed:d}),this._handlersById[e]=a}stop(e){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Rs(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,a,d){for(const g in e)if(g!==d&&(!a||a.indexOf(g)<0))return!0;return!1}_getMapTouches(e){const a=[];for(const d of e)this._el.contains(d.target)&&a.push(d);return a}mergeHandlerResult(e,a,d,g,x){if(!d)return;u.e(e,d);const E={handlerName:g,originalEvent:d.originalEvent||x};d.zoomDelta!==void 0&&(a.zoom=E),d.panDelta!==void 0&&(a.drag=E),d.rollDelta!==void 0&&(a.roll=E),d.pitchDelta!==void 0&&(a.pitch=E),d.bearingDelta!==void 0&&(a.rotate=E)}_applyChanges(){const e={},a={},d={};for(const[g,x,E]of this._changes)g.panDelta&&(e.panDelta=(e.panDelta||new u.P(0,0))._add(g.panDelta)),g.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+g.pitchDelta),g.rollDelta&&(e.rollDelta=(e.rollDelta||0)+g.rollDelta),g.around!==void 0&&(e.around=g.around),g.pinchAround!==void 0&&(e.pinchAround=g.pinchAround),g.noInertia&&(e.noInertia=g.noInertia),u.e(a,x),u.e(d,E);this._updateMapTransform(e,a,d),this._changes=[]}_updateMapTransform(e,a,d){const g=this._map,x=g._getTransformForUpdate(),E=g.terrain;if(!(Ve(e)||E&&this._terrainMovement))return this._fireEvents(a,d,!0);g._stop(!0);let{panDelta:P,zoomDelta:R,bearingDelta:O,pitchDelta:j,rollDelta:$,around:q,pinchAround:Q}=e;Q!==void 0&&(q=Q),q=q||g.transform.centerPoint,E&&!x.isPointOnMapSurface(q)&&(q=x.centerPoint);const nt={panDelta:P,zoomDelta:R,rollDelta:$,pitchDelta:j,bearingDelta:O,around:q};this._map.cameraHelper.useGlobeControls&&!x.isPointOnMapSurface(q)&&(q=x.centerPoint);const lt=q.distSqr(x.centerPoint)<.01?x.center:x.screenPointToLocation(P?q.sub(P):q);this._handleMapControls({terrain:E,tr:x,deltasForHelper:nt,preZoomAroundLoc:lt,combinedEventsInProgress:a,panDelta:P}),g._applyUpdatedTransform(x),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(a,d,!0)}_handleMapControls({terrain:e,tr:a,deltasForHelper:d,preZoomAroundLoc:g,combinedEventsInProgress:x,panDelta:E}){const P=this._map.cameraHelper;if(P.handleMapControlsRollPitchBearingZoom(d,a),e)return P.useGlobeControls?(this._terrainMovement||!x.drag&&!x.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void P.handleMapControlsPan(d,a,g)):this._terrainMovement||!x.drag&&!x.zoom?void(x.drag&&this._terrainMovement&&E?a.setCenter(a.screenPointToLocation(a.centerPoint.sub(E))):P.handleMapControlsPan(d,a,g)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void P.handleMapControlsPan(d,a,g));P.handleMapControlsPan(d,a,g)}_fireEvents(e,a,d){const g=Rs(this._eventsInProgress),x=Rs(e),E={};for(const $ in e){const{originalEvent:q}=e[$];this._eventsInProgress[$]||(E[`${$}start`]=q),this._eventsInProgress[$]=e[$]}!g&&x&&this._fireEvent("movestart",x.originalEvent);for(const $ in E)this._fireEvent($,E[$]);x&&this._fireEvent("move",x.originalEvent);for(const $ in e){const{originalEvent:q}=e[$];this._fireEvent($,q)}const P={};let R;for(const $ in this._eventsInProgress){const{handlerName:q,originalEvent:Q}=this._eventsInProgress[$];this._handlersById[q].isActive()||(delete this._eventsInProgress[$],R=a[q]||Q,P[`${$}end`]=R)}for(const $ in P)this._fireEvent($,P[$]);const O=Rs(this._eventsInProgress),j=(g||x)&&!O;if(j&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const $=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&$.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform($)}if(d&&j){this._updatingCamera=!0;const $=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),q=Q=>Q!==0&&-this._bearingSnap<Q&&Q<this._bearingSnap;!$||!$.essential&&it.prefersReducedMotion?(this._map.fire(new u.l("moveend",{originalEvent:R})),q(this._map.getBearing())&&this._map.resetNorth()):(q($.bearing||this._map.getBearing())&&($.bearing=0),$.freezeElevation=!0,this._map.easeTo($,{originalEvent:R})),this._updatingCamera=!1}}_fireEvent(e,a){this._map.fire(new u.l(e,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((e=>{delete this._frameId,this.handleEvent(new Re("renderFrame",{timeStamp:e})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class zh extends u.E{constructor(e,a,d){super(),this._renderFrameCallback=()=>{const g=Math.min((rt()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(g)),g<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=d.bearingSnap,this.cameraHelper=a,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(e,a){e.apply(this.transform),this.transform=e,this.cameraHelper=a}getCenter(){return new u.V(this.transform.center.lng,this.transform.center.lat)}setCenter(e,a){return this.jumpTo({center:e},a)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,a){return this.jumpTo({elevation:e},a),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,a,d){return e=u.P.convert(e).mult(-1),this.panTo(this.transform.center,u.e({offset:e},a),d)}panTo(e,a,d){return this.easeTo(u.e({center:e},a),d)}getZoom(){return this.transform.zoom}setZoom(e,a){return this.jumpTo({zoom:e},a),this}zoomTo(e,a,d){return this.easeTo(u.e({zoom:e},a),d)}zoomIn(e,a){return this.zoomTo(this.getZoom()+1,e,a),this}zoomOut(e,a){return this.zoomTo(this.getZoom()-1,e,a),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,a){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new u.l("movestart",a)).fire(new u.l("move",a)).fire(new u.l("moveend",a))),this}getBearing(){return this.transform.bearing}setBearing(e,a){return this.jumpTo({bearing:e},a),this}getPadding(){return this.transform.padding}setPadding(e,a){return this.jumpTo({padding:e},a),this}rotateTo(e,a,d){return this.easeTo(u.e({bearing:e},a),d)}resetNorth(e,a){return this.rotateTo(0,u.e({duration:1e3},e),a),this}resetNorthPitch(e,a){return this.easeTo(u.e({bearing:0,pitch:0,roll:0,duration:1e3},e),a),this}snapToNorth(e,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,a):this}getPitch(){return this.transform.pitch}setPitch(e,a){return this.jumpTo({pitch:e},a),this}getRoll(){return this.transform.roll}setRoll(e,a){return this.jumpTo({roll:e},a),this}cameraForBounds(e,a){e=ui.convert(e).adjustAntiMeridian();const d=a&&a.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),d,a)}_cameraForBoxAndBearing(e,a,d,g){const x={top:0,bottom:0,right:0,left:0};if(typeof(g=u.e({padding:x,offset:[0,0],maxZoom:this.transform.maxZoom},g)).padding=="number"){const O=g.padding;g.padding={top:O,bottom:O,right:O,left:O}}const E=u.e(x,g.padding);g.padding=E;const P=this.transform,R=new ui(e,a);return this.cameraHelper.cameraForBoxAndBearing(g,E,R,d,P)}fitBounds(e,a,d){return this._fitInternal(this.cameraForBounds(e,a),a,d)}fitScreenCoordinates(e,a,d,g,x){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(u.P.convert(e)),this.transform.screenPointToLocation(u.P.convert(a)),d,g),g,x)}_fitInternal(e,a,d){return e?(delete(a=u.e(e,a)).padding,a.linear?this.easeTo(a,d):this.flyTo(a,d)):this}jumpTo(e,a){this.stop();const d=this._getTransformForUpdate();let g=!1,x=!1,E=!1;const P=d.zoom;this.cameraHelper.handleJumpToCenterZoom(d,e);const R=d.zoom!==P;return"elevation"in e&&d.elevation!==+e.elevation&&d.setElevation(+e.elevation),"bearing"in e&&d.bearing!==+e.bearing&&(g=!0,d.setBearing(+e.bearing)),"pitch"in e&&d.pitch!==+e.pitch&&(x=!0,d.setPitch(+e.pitch)),"roll"in e&&d.roll!==+e.roll&&(E=!0,d.setRoll(+e.roll)),e.padding==null||d.isPaddingEqual(e.padding)||d.setPadding(e.padding),this._applyUpdatedTransform(d),this.fire(new u.l("movestart",a)).fire(new u.l("move",a)),R&&this.fire(new u.l("zoomstart",a)).fire(new u.l("zoom",a)).fire(new u.l("zoomend",a)),g&&this.fire(new u.l("rotatestart",a)).fire(new u.l("rotate",a)).fire(new u.l("rotateend",a)),x&&this.fire(new u.l("pitchstart",a)).fire(new u.l("pitch",a)).fire(new u.l("pitchend",a)),E&&this.fire(new u.l("rollstart",a)).fire(new u.l("roll",a)).fire(new u.l("rollend",a)),this.fire(new u.l("moveend",a))}calculateCameraOptionsFromTo(e,a,d,g=0){const x=u.aa.fromLngLat(e,a),E=u.aa.fromLngLat(d,g),P=E.x-x.x,R=E.y-x.y,O=E.z-x.z,j=Math.hypot(P,R,O);if(j===0)throw new Error("Can't calculate camera options with same From and To");const $=Math.hypot(P,R),q=u.at(this.transform.cameraToCenterDistance/j/this.transform.tileSize),Q=180*Math.atan2(P,-R)/Math.PI;let nt=180*Math.acos($/j)/Math.PI;return nt=O<0?90-nt:90+nt,{center:E.toLngLat(),elevation:g,zoom:q,pitch:nt,bearing:Q}}calculateCameraOptionsFromCameraLngLatAltRotation(e,a,d,g,x){const E=this.transform.calculateCenterFromCameraLngLatAlt(e,a,d,g);return{center:E.center,elevation:E.elevation,zoom:E.zoom,bearing:d,pitch:g,roll:x}}easeTo(e,a){this._stop(!1,e.easeId),((e=u.e({offset:[0,0],duration:500,easing:u.cx},e)).animate===!1||!e.essential&&it.prefersReducedMotion)&&(e.duration=0);const d=this._getTransformForUpdate(),g=this.getBearing(),x=d.pitch,E=d.roll,P="bearing"in e?this._normalizeBearing(e.bearing,g):g,R="pitch"in e?+e.pitch:x,O="roll"in e?this._normalizeBearing(e.roll,E):E,j="padding"in e?e.padding:d.padding,$=u.P.convert(e.offset);let q,Q;e.around&&(q=u.V.convert(e.around),Q=d.locationToScreenPoint(q));const nt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},lt=this.cameraHelper.handleEaseTo(d,{bearing:P,pitch:R,roll:O,padding:j,around:q,aroundPoint:Q,offsetAsPoint:$,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||g!==P,this._pitching=this._pitching||R!==x,this._rolling=this._rolling||O!==E,this._padding=!d.isPaddingEqual(j),this._zooming=this._zooming||lt.isZooming,this._easeId=e.easeId,this._prepareEase(a,e.noMoveStart,nt),this.terrain&&this._prepareElevation(lt.elevationCenter),this._ease((ut=>{lt.easeFunc(ut),this.terrain&&!e.freezeElevation&&this._updateElevation(ut),this._applyUpdatedTransform(d),this._fireMoveEvents(a)}),(ut=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(a,ut)}),e),this}_prepareEase(e,a,d={}){this._moving=!0,a||d.moving||this.fire(new u.l("movestart",e)),this._zooming&&!d.zooming&&this.fire(new u.l("zoomstart",e)),this._rotating&&!d.rotating&&this.fire(new u.l("rotatestart",e)),this._pitching&&!d.pitching&&this.fire(new u.l("pitchstart",e)),this._rolling&&!d.rolling&&this.fire(new u.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&a!==this._elevationTarget){const d=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(d-(a-(d*e+this._elevationStart))/(1-e)),this._elevationTarget=a}this.transform.setElevation(u.G.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const a=e.getCameraLngLat(),d=e.getCameraAltitude(),g=this.terrain?this.terrain.getElevationForLngLatZoom(a,e.zoom):0;if(d<g){const x=this.calculateCameraOptionsFromTo(a,g,e.center,e.elevation);return{pitch:x.pitch,zoom:x.zoom}}return{}}_applyUpdatedTransform(e){const a=[];if(a.push((g=>this._elevateCameraIfInsideTerrain(g))),this.transformCameraUpdate&&a.push((g=>this.transformCameraUpdate(g))),!a.length)return;const d=e.clone();for(const g of a){const x=d.clone(),{center:E,zoom:P,roll:R,pitch:O,bearing:j,elevation:$}=g(x);E&&x.setCenter(E),$!==void 0&&x.setElevation($),P!==void 0&&x.setZoom(P),R!==void 0&&x.setRoll(R),O!==void 0&&x.setPitch(O),j!==void 0&&x.setBearing(j),d.apply(x)}this.transform.apply(d)}_fireMoveEvents(e){this.fire(new u.l("move",e)),this._zooming&&this.fire(new u.l("zoom",e)),this._rotating&&this.fire(new u.l("rotate",e)),this._pitching&&this.fire(new u.l("pitch",e)),this._rolling&&this.fire(new u.l("roll",e))}_afterEase(e,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const d=this._zooming,g=this._rotating,x=this._pitching,E=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,d&&this.fire(new u.l("zoomend",e)),g&&this.fire(new u.l("rotateend",e)),x&&this.fire(new u.l("pitchend",e)),E&&this.fire(new u.l("rollend",e)),this.fire(new u.l("moveend",e))}flyTo(e,a){if(!e.essential&&it.prefersReducedMotion){const qt=u.U(e,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(qt,a)}this.stop(),e=u.e({offset:[0,0],speed:1.2,curve:1.42,easing:u.cx},e);const d=this._getTransformForUpdate(),g=d.bearing,x=d.pitch,E=d.roll,P=d.padding,R="bearing"in e?this._normalizeBearing(e.bearing,g):g,O="pitch"in e?+e.pitch:x,j="roll"in e?this._normalizeBearing(e.roll,E):E,$="padding"in e?e.padding:d.padding,q=u.P.convert(e.offset);let Q=d.centerPoint.add(q);const nt=d.screenPointToLocation(Q),lt=this.cameraHelper.handleFlyTo(d,{bearing:R,pitch:O,roll:j,padding:$,locationAtOffset:nt,offsetAsPoint:q,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let ut=e.curve;const ft=Math.max(d.width,d.height),_t=ft/lt.scaleOfZoom,Tt=lt.pixelPathLength;typeof lt.scaleOfMinZoom=="number"&&(ut=Math.sqrt(ft/lt.scaleOfMinZoom/Tt*2));const gt=ut*ut;function St(qt){const ge=(_t*_t-ft*ft+(qt?-1:1)*gt*gt*Tt*Tt)/(2*(qt?_t:ft)*gt*Tt);return Math.log(Math.sqrt(ge*ge+1)-ge)}function At(qt){return(Math.exp(qt)-Math.exp(-qt))/2}function xt(qt){return(Math.exp(qt)+Math.exp(-qt))/2}const zt=St(!1);let $t=function(qt){return xt(zt)/xt(zt+ut*qt)},Vt=function(qt){return ft*((xt(zt)*(At(ge=zt+ut*qt)/xt(ge))-At(zt))/gt)/Tt;var ge},Ut=(St(!0)-zt)/ut;if(Math.abs(Tt)<2e-6||!isFinite(Ut)){if(Math.abs(ft-_t)<1e-6)return this.easeTo(e,a);const qt=_t<ft?-1:1;Ut=Math.abs(Math.log(_t/ft))/ut,Vt=()=>0,$t=ge=>Math.exp(qt*ut*ge)}return e.duration="duration"in e?+e.duration:1e3*Ut/("screenSpeed"in e?+e.screenSpeed/ut:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=g!==R,this._pitching=O!==x,this._rolling=j!==E,this._padding=!d.isPaddingEqual($),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(lt.targetCenter),this._ease((qt=>{const ge=qt*Ut,ye=1/$t(ge),oe=Vt(ge);this._rotating&&d.setBearing(u.G.number(g,R,qt)),this._pitching&&d.setPitch(u.G.number(x,O,qt)),this._rolling&&d.setRoll(u.G.number(E,j,qt)),this._padding&&(d.interpolatePadding(P,$,qt),Q=d.centerPoint.add(q)),lt.easeFunc(qt,ye,oe,Q),this.terrain&&!e.freezeElevation&&this._updateElevation(qt),this._applyUpdatedTransform(d),this._fireMoveEvents(a)}),(()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(a)}),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,a){var d;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const g=this._onEaseEnd;delete this._onEaseEnd,g.call(this,a)}return e||(d=this.handlers)===null||d===void 0||d.stop(!1),this}_ease(e,a,d){d.animate===!1||d.duration===0?(e(1),a()):(this._easeStart=rt(),this._easeOptions=d,this._onEaseFrame=e,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,a){e=u.W(e,-180,180);const d=Math.abs(e-a);return Math.abs(e-360-a)<d&&(e-=360),Math.abs(e+360-a)<d&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(u.V.convert(e),this.transform.tileZoom):null}}const mr={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class ti{constructor(e=mr){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=J.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=J.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=J.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){J.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,a){const d=this._map._getUIString(`AttributionControl.${a}`);e.title=d,e.setAttribute("aria-label",d)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map((g=>typeof g!="string"?"":g))):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const g=this._map.style.stylesheet;this.styleOwner=g.owner,this.styleId=g.id}const a=this._map.style.tileManagers;for(const g in a){const x=a[g];if(x.used||x.usedForTerrain){const E=x.getSource();E.attribution&&e.indexOf(E.attribution)<0&&e.push(E.attribution)}}e=e.filter((g=>String(g).trim())),e.sort(((g,x)=>g.length-x.length)),e=e.filter(((g,x)=>{for(let E=x+1;E<e.length;E++)if(e[E].indexOf(g)>=0)return!1;return!0}));const d=e.join(" | ");d!==this._attribHTML&&(this._attribHTML=d,e.length?(this._innerContainer.innerHTML=J.sanitize(d),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Xi{constructor(e={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const d=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&d.classList.add("maplibregl-compact"):d.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=J.create("div","maplibregl-ctrl");const a=J.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){J.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Lh{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const a=++this._id;return this._queue.push({callback:e,id:a,cancelled:!1}),a}remove(e){const a=this._currentlyRunning,d=a?this._queue.concat(a):this._queue;for(const g of d)if(g.id===e)return void(g.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const d of a)if(!d.cancelled&&(d.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var op=u.aT([{name:"a_pos3d",type:"Int16",components:3}]);class Vo extends u.E{constructor(e){super(),this._lastTilesetChange=rt(),this.tileManager=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(e,a){this.tileManager.update(e,a),this._renderableTilesKeys=[];const d={};for(const g of Qe(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a,calculateTileZoom:this.tileManager._source.calculateTileZoom}))d[g.key]=!0,this._renderableTilesKeys.push(g.key),this._tiles[g.key]||(g.terrainRttPosMatrix32f=new Float64Array(16),u.c6(g.terrainRttPosMatrix32f,0,u.a4,u.a4,0,0,1),this._tiles[g.key]=new K(g,this.tileSize),this._lastTilesetChange=rt());for(const g in this._tiles)d[g]||delete this._tiles[g]}freeRtt(e){for(const a in this._tiles){const d=this._tiles[a];(!e||d.tileID.equals(e)||d.tileID.isChildOf(e)||e.isChildOf(d.tileID))&&(d.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((e=>this.getTileByID(e)))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,a){return a?this._getTerrainCoordsForTileRanges(e,a):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const a={};for(const d of this._renderableTilesKeys){const g=this._tiles[d].tileID,x=e.clone(),E=u.bj();if(g.canonical.equals(e.canonical))u.c6(E,0,u.a4,u.a4,0,0,1);else if(g.canonical.isChildOf(e.canonical)){const P=g.canonical.z-e.canonical.z,R=g.canonical.x-(g.canonical.x>>P<<P),O=g.canonical.y-(g.canonical.y>>P<<P),j=u.a4>>P;u.c6(E,0,j,j,0,0,1),u.O(E,E,[-R*j,-O*j,0])}else{if(!e.canonical.isChildOf(g.canonical))continue;{const P=e.canonical.z-g.canonical.z,R=e.canonical.x-(e.canonical.x>>P<<P),O=e.canonical.y-(e.canonical.y>>P<<P),j=u.a4>>P;u.c6(E,0,u.a4,u.a4,0,0,1),u.O(E,E,[R*j,O*j,0]),u.Q(E,E,[1/2**P,1/2**P,0])}}x.terrainRttPosMatrix32f=new Float32Array(E),a[d]=x}return a}_getTerrainCoordsForTileRanges(e,a){const d={};for(const g of this._renderableTilesKeys){const x=this._tiles[g].tileID;if(!this._isWithinTileRanges(x,a))continue;const E=e.clone(),P=u.bj();if(x.canonical.z===e.canonical.z){const R=e.canonical.x-x.canonical.x,O=e.canonical.y-x.canonical.y;u.c6(P,0,u.a4,u.a4,0,0,1),u.O(P,P,[R*u.a4,O*u.a4,0])}else if(x.canonical.z>e.canonical.z){const R=x.canonical.z-e.canonical.z,O=x.canonical.x-(x.canonical.x>>R<<R),j=x.canonical.y-(x.canonical.y>>R<<R),$=e.canonical.x-(x.canonical.x>>R),q=e.canonical.y-(x.canonical.y>>R),Q=u.a4>>R;u.c6(P,0,Q,Q,0,0,1),u.O(P,P,[-O*Q+$*u.a4,-j*Q+q*u.a4,0])}else{const R=e.canonical.z-x.canonical.z,O=e.canonical.x-(e.canonical.x>>R<<R),j=e.canonical.y-(e.canonical.y>>R<<R),$=(e.canonical.x>>R)-x.canonical.x,q=(e.canonical.y>>R)-x.canonical.y,Q=u.a4<<R;u.c6(P,0,Q,Q,0,0,1),u.O(P,P,[O*u.a4+$*Q,j*u.a4+q*Q,0])}E.terrainRttPosMatrix32f=new Float32Array(P),d[g]=E}return d}getSourceTile(e,a){const d=this.tileManager._source;let g=e.overscaledZ-this.deltaZoom;if(g>d.maxzoom&&(g=d.maxzoom),g<d.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(g).key);let x=this.tileManager.getTileByID(this._sourceTileCache[e.key]);if((!x||!x.dem)&&a)for(;g>=d.minzoom&&(!x||!x.dem);)x=this.tileManager.getTileByID(e.scaledTo(g--).key);return x}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,a){return a[e.canonical.z]&&e.canonical.x>=a[e.canonical.z].minTileX&&e.canonical.x<=a[e.canonical.z].maxTileX&&e.canonical.y>=a[e.canonical.z].minTileY&&e.canonical.y<=a[e.canonical.z].maxTileY}}class ds{constructor(e,a,d){this._meshCache={},this.painter=e,this.tileManager=new Vo(a),this.options=d,this.exaggeration=typeof d.exaggeration=="number"?d.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,a,d,g=u.a4){var x;if(!(a>=0&&a<g&&d>=0&&d<g))return 0;const E=this.getTerrainData(e),P=(x=E.tile)===null||x===void 0?void 0:x.dem;if(!P)return 0;const R=u.cB([],[a/g*u.a4,d/g*u.a4],E.u_terrain_matrix),O=[R[0]*P.dim,R[1]*P.dim],j=Math.floor(O[0]),$=Math.floor(O[1]),q=O[0]-j,Q=O[1]-$;return P.get(j,$)*(1-q)*(1-Q)+P.get(j+1,$)*q*(1-Q)+P.get(j,$+1)*(1-q)*Q+P.get(j+1,$+1)*q*Q}getElevationForLngLatZoom(e,a){if(!u.cC(a,e.wrap()))return 0;const{tileID:d,mercatorX:g,mercatorY:x}=this._getOverscaledTileIDFromLngLatZoom(e,a);return this.getElevation(d,g%u.a4,x%u.a4,u.a4)}getElevation(e,a,d,g=u.a4){return this.getDEMElevation(e,a,d,g)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const g=this.painter.context,x=new u.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new u.T(g,x,g.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new u.T(g,new u.R({width:1,height:1}),g.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=u.ar([])}const a=this.tileManager.getSourceTile(e,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const g=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new u.T(g,a.dem.getPixels(),g.gl.RGBA,{premultiply:!1}),a.demTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const d=a&&a+a.tileID.key+e.key;if(d&&!this._demMatrixCache[d]){const g=this.tileManager.getSource().maxzoom;let x=e.canonical.z-a.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=g?x=e.canonical.z-g:u.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const E=e.canonical.x-(e.canonical.x>>x<<x),P=e.canonical.y-(e.canonical.y>>x<<x),R=u.cD(new Float64Array(16),[1/(u.a4<<x),1/(u.a4<<x),0]);u.O(R,R,[E*u.a4,P*u.a4,0]),this._demMatrixCache[e.key]={matrix:R,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:d?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(e){const a=this.painter,d=a.width/devicePixelRatio,g=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===d&&this._fbo.height===g||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new u.T(a.context,{width:d,height:g,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new u.T(a.context,{width:d,height:g,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(d,g,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,d,g))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let x=0,E=0;x<this._coordsTextureSize;x++)for(let P=0;P<this._coordsTextureSize;P++,E+=4)a[E+0]=255&P,a[E+1]=255&x,a[E+2]=P>>8<<4|x>>8,a[E+3]=0;const d=new u.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),g=new u.T(e,d,e.gl.RGBA,{premultiply:!1});return g.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=g,g}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),d=this.painter.context,g=d.gl,x=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),E=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),P=Math.round(this.painter.height/devicePixelRatio);d.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),g.readPixels(x,P-E-1,1,1,g.RGBA,g.UNSIGNED_BYTE,a),d.bindFramebuffer.set(null);const R=a[0]+(a[2]>>4<<8),O=a[1]+((15&a[2])<<8),j=this.coordsIndex[255-a[3]],$=j&&this.tileManager.getTileByID(j);if(!$)return null;const q=this._coordsTextureSize,Q=(1<<$.tileID.canonical.z)*q;return new u.aa(($.tileID.canonical.x*q+R)/Q+$.tileID.wrap,($.tileID.canonical.y*q+O)/Q,this.getElevation($.tileID,R,O,q))}depthAtPoint(e){const a=new Uint8Array(4),d=this.painter.context,g=d.gl;return d.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),g.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,g.RGBA,g.UNSIGNED_BYTE,a),d.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(e){var a;const d=((a=this.painter.style.projection)===null||a===void 0?void 0:a.transitionState)>0,g=d&&e.canonical.y===0,x=d&&e.canonical.y===(1<<e.canonical.z)-1,E=`m_${g?"n":""}_${x?"s":""}`;if(this._meshCache[E])return this._meshCache[E];const P=this.painter.context,R=new u.cE,O=new u.aX,j=this.meshSize,$=u.a4/j,q=j*j;for(let xt=0;xt<=j;xt++)for(let zt=0;zt<=j;zt++)R.emplaceBack(zt*$,xt*$,0);for(let xt=0;xt<q;xt+=j+1)for(let zt=0;zt<j;zt++)O.emplaceBack(zt+xt,j+zt+xt+1,j+zt+xt+2),O.emplaceBack(zt+xt,j+zt+xt+2,zt+xt+1);const Q=R.length,nt=Q+(j+1),lt=(j+1)*j,ut=g?u.bq:0,ft=g?0:1,_t=x?u.br:u.a4,Tt=x?0:1;for(let xt=0;xt<=j;xt++)R.emplaceBack(xt*$,ut,ft);for(let xt=0;xt<=j;xt++)R.emplaceBack(xt*$,_t,Tt);for(let xt=0;xt<j;xt++)O.emplaceBack(lt+xt,nt+xt,nt+xt+1),O.emplaceBack(lt+xt,nt+xt+1,lt+xt+1),O.emplaceBack(0+xt,Q+xt+1,Q+xt),O.emplaceBack(0+xt,0+xt+1,Q+xt+1);const gt=R.length,St=gt+2*(j+1);for(const xt of[0,1])for(let zt=0;zt<=j;zt++)for(const $t of[0,1])R.emplaceBack(xt*u.a4,zt*$,$t);for(let xt=0;xt<2*j;xt+=2)O.emplaceBack(gt+xt,gt+xt+1,gt+xt+3),O.emplaceBack(gt+xt,gt+xt+3,gt+xt+2),O.emplaceBack(St+xt,St+xt+3,St+xt+1),O.emplaceBack(St+xt,St+xt+2,St+xt+3);const At=new _a(P.createVertexBuffer(R,op.members),P.createIndexBuffer(O),u.aW.simpleSegment(0,0,R.length,O.length));return this._meshCache[E]=At,At}getMeshFrameDelta(e){return 2*Math.PI*u.bD/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,a){var d;const{tileID:g}=this._getOverscaledTileIDFromLngLatZoom(e,a);return(d=this.getMinMaxElevation(g).minElevation)!==null&&d!==void 0?d:0}getMinMaxElevation(e){const a=this.getTerrainData(e).tile,d={minElevation:null,maxElevation:null};return a&&a.dem&&(d.minElevation=a.dem.min*this.exaggeration,d.maxElevation=a.dem.max*this.exaggeration),d}_getOverscaledTileIDFromLngLatZoom(e,a){const d=u.aa.fromLngLat(e.wrap()),g=(1<<a)*u.a4,x=d.x*g,E=d.y*g,P=Math.floor(x/u.a4),R=Math.floor(E/u.a4);return{tileID:new u.a1(a,0,a,P,R),mercatorX:x,mercatorY:E}}}class oi{constructor(e,a,d){this._context=e,this._size=a,this._tileSize=d,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),d=new u.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return d.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(d.texture),{id:e,fbo:a,texture:d,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((a=>e.id!==a)),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((e=>!e.inUse))===!1}}const In={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Fn{constructor(e,a){this.painter=e,this.terrain=a,this.pool=new oi(e.context,30,a.tileManager.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=e._order.filter((d=>!e._layers[d].isHidden(a))),this._coordsAscending={};for(const d in e.tileManagers){this._coordsAscending[d]={};const g=e.tileManagers[d].getVisibleCoordinates(),x=e.tileManagers[d].getSource(),E=x instanceof Hr?x.terrainTileRanges:null;for(const P of g){const R=this.terrain.tileManager.getTerrainCoords(P,E);for(const O in R)this._coordsAscending[d][O]||(this._coordsAscending[d][O]=[]),this._coordsAscending[d][O].push(R[O])}}this._coordsAscendingStr={};for(const d of e._order){const g=e._layers[d],x=g.source;if(In[g.type]&&!this._coordsAscendingStr[x]){this._coordsAscendingStr[x]={};for(const E in this._coordsAscending[x])this._coordsAscendingStr[x][E]=this._coordsAscending[x][E].map((P=>P.key)).sort().join()}}for(const d of this._renderableTiles)for(const g in this._coordsAscendingStr){const x=this._coordsAscendingStr[g][d.tileID.key];x&&x!==d.rttCoords[g]&&(d.rtt=[])}}renderLayer(e,a){if(e.isHidden(this.painter.transform.zoom))return!1;const d=Object.assign(Object.assign({},a),{isRenderingToTexture:!0}),g=e.type,x=this.painter,E=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(In[g]&&(this._prevType&&In[this._prevType]||this._stacks.push([]),this._prevType=g,this._stacks[this._stacks.length-1].push(e.id),!E))return!0;if(In[this._prevType]||In[g]&&E){this._prevType=g;const P=this._stacks.length-1,R=this._stacks[P]||[];for(const O of this._renderableTiles){if(this.pool.isFull()&&(Pa(this.painter,this.terrain,this._rttTiles,d),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(O),O.rtt[P]){const $=this.pool.getObjectForId(O.rtt[P].id);if($.stamp===O.rtt[P].stamp){this.pool.useObject($);continue}}const j=this.pool.getOrCreateFreeObject();this.pool.useObject(j),this.pool.stampObject(j),O.rtt[P]={id:j.id,stamp:j.stamp},x.context.bindFramebuffer.set(j.fbo.framebuffer),x.context.clear({color:u.bo.transparent,stencil:0}),x.currentStencilSource=void 0;for(let $=0;$<R.length;$++){const q=x.style._layers[R[$]],Q=q.source?this._coordsAscending[q.source][O.tileID.key]:[O.tileID];x.context.viewport.set([0,0,j.fbo.width,j.fbo.height]),x._renderTileClippingMasks(q,Q,!0),x.renderLayer(x,x.style.tileManagers[q.source],q,Q,d),q.source&&(O.rttCoords[q.source]=this._coordsAscendingStr[q.source][O.tileID.key])}}return Pa(this.painter,this.terrain,this._rttTiles,d),this._rttTiles=[],this.pool.freeAllObjects(),In[g]}return!1}}const on={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},zn=L,hi={hash:!1,interactive:!0,bearingSnap:7,attributionControl:mr,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:u.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,reduceMotion:void 0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0,experimentalZoomLevelsToOverscale:void 0},Tc={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Uo{constructor(e,a,d=!1){this.mousedown=x=>{this.startMove(x,J.mousePos(this.element,x)),J.addEventListener(window,"mousemove",this.mousemove),J.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=x=>{this.move(x,J.mousePos(this.element,x))},this.mouseup=x=>{this._rotatePitchHandler.dragEnd(x),this.offTemp()},this.touchstart=x=>{x.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=J.touchPos(this.element,x.targetTouches)[0],this.startMove(x,this._startPos),J.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),J.addEventListener(window,"touchend",this.touchend))},this.touchmove=x=>{x.targetTouches.length!==1?this.reset():(this._lastPos=J.touchPos(this.element,x.targetTouches)[0],this.move(x,this._lastPos))},this.touchend=x=>{x.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=a;const g=new Ml;this._rotatePitchHandler=new Qs({clickTolerance:3,move:(x,E)=>{const P=a.getBoundingClientRect(),R=new u.P((P.bottom-P.top)/2,(P.right-P.left)/2);return{bearingDelta:u.cw(new u.P(x.x,E.y),E,R),pitchDelta:d?-.5*(E.y-x.y):void 0}},moveStateManager:g,enable:!0,assignEvents:()=>{}}),this.map=e,J.addEventListener(a,"mousedown",this.mousedown),J.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),J.addEventListener(a,"touchcancel",this.reset)}startMove(e,a){this._rotatePitchHandler.dragStart(e,a),J.disableDrag()}move(e,a){const d=this.map,{bearingDelta:g,pitchDelta:x}=this._rotatePitchHandler.dragMove(e,a)||{};g&&d.setBearing(d.getBearing()+g),x&&d.setPitch(d.getPitch()+x)}off(){const e=this.element;J.removeEventListener(e,"mousedown",this.mousedown),J.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),J.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),J.removeEventListener(window,"touchend",this.touchend),J.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){J.enableDrag(),J.removeEventListener(window,"mousemove",this.mousemove),J.removeEventListener(window,"mouseup",this.mouseup),J.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),J.removeEventListener(window,"touchend",this.touchend)}}let jr;function oo(v,e,a,d=!1){if(d||!a.getCoveringTilesDetailsProvider().allowWorldCopies())return v?.wrap();const g=new u.V(v.lng,v.lat);if(v=new u.V(v.lng,v.lat),e){const x=new u.V(v.lng-360,v.lat),E=new u.V(v.lng+360,v.lat),P=a.locationToScreenPoint(v).distSqr(e);a.locationToScreenPoint(x).distSqr(e)<P?v=x:a.locationToScreenPoint(E).distSqr(e)<P&&(v=E)}for(;Math.abs(v.lng-a.center.lng)>180;){const x=a.locationToScreenPoint(v);if(x.x>=0&&x.y>=0&&x.x<=a.width&&x.y<=a.height)break;v.lng>a.center.lng?v.lng-=360:v.lng+=360}return v.lng!==g.lng&&a.isPointOnMapSurface(a.locationToScreenPoint(v))?v:g}const lo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function co(v,e,a){const d=v.classList;for(const g in lo)d.remove(`maplibregl-${a}-anchor-${g}`);d.add(`maplibregl-${a}-anchor-${e}`)}class Mu extends u.E{constructor(e){if(super(),this._onKeyPress=a=>{const d=a.code,g=a.charCode||a.keyCode;d!=="Space"&&d!=="Enter"&&g!==32&&g!==13||this.togglePopup()},this._onMapClick=a=>{const d=a.originalEvent.target,g=this._element;this._popup&&(d===g||g.contains(d))&&this.togglePopup()},this._update=a=>{if(!this._map)return;const d=this._map.loaded()&&!this._map.isMoving();(a?.type==="terrain"||a?.type==="render"&&!d)&&this._map.once("render",this._update),this._lngLat=oo(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let g="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?g=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(g=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let x="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?x="rotateX(0deg)":this._pitchAlignment==="map"&&(x=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||a&&a.type!=="moveend"||(this._pos=this._pos.round()),J.setTransform(this._element,`${lo[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${x} ${g}`),it.frameAsync(new AbortController).then((()=>{this._updateOpacity(a&&a.type==="moveend")})).catch((()=>{}))},this._onMove=a=>{if(!this._isDragging){const d=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new u.l("dragstart"))),this.fire(new u.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new u.l("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e?.opacity,e?.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=u.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=J.create("div");const a=J.createNS("http://www.w3.org/2000/svg","svg"),d=41,g=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${d}px`),a.setAttributeNS(null,"width",`${g}px`),a.setAttributeNS(null,"viewBox",`0 0 ${g} ${d}`);const x=J.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");const E=J.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const P=J.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"transform","translate(3.0, 29.0)"),P.setAttributeNS(null,"fill","#000000");const R=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ft of R){const _t=J.createNS("http://www.w3.org/2000/svg","ellipse");_t.setAttributeNS(null,"opacity","0.04"),_t.setAttributeNS(null,"cx","10.5"),_t.setAttributeNS(null,"cy","5.80029008"),_t.setAttributeNS(null,"rx",ft.rx),_t.setAttributeNS(null,"ry",ft.ry),P.appendChild(_t)}const O=J.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"fill",this._color);const j=J.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),O.appendChild(j);const $=J.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"opacity","0.25"),$.setAttributeNS(null,"fill","#000000");const q=J.createNS("http://www.w3.org/2000/svg","path");q.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),$.appendChild(q);const Q=J.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Q.setAttributeNS(null,"fill","#FFFFFF");const nt=J.createNS("http://www.w3.org/2000/svg","g");nt.setAttributeNS(null,"transform","translate(8.0, 8.0)");const lt=J.createNS("http://www.w3.org/2000/svg","circle");lt.setAttributeNS(null,"fill","#000000"),lt.setAttributeNS(null,"opacity","0.25"),lt.setAttributeNS(null,"cx","5.5"),lt.setAttributeNS(null,"cy","5.5"),lt.setAttributeNS(null,"r","5.4999962");const ut=J.createNS("http://www.w3.org/2000/svg","circle");ut.setAttributeNS(null,"fill","#FFFFFF"),ut.setAttributeNS(null,"cx","5.5"),ut.setAttributeNS(null,"cy","5.5"),ut.setAttributeNS(null,"r","5.4999962"),nt.appendChild(lt),nt.appendChild(ut),E.appendChild(P),E.appendChild(O),E.appendChild($),E.appendChild(Q),E.appendChild(nt),a.appendChild(E),a.setAttributeNS(null,"height",d*this._scale+"px"),a.setAttributeNS(null,"width",g*this._scale+"px"),this._element.appendChild(a),this._offset=u.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(a=>{a.preventDefault()})),this._element.addEventListener("mousedown",(a=>{a.preventDefault()})),co(this._element,this._anchor,"marker"),e&&e.className)for(const a of e.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),J.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=u.V.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const g=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(38.1-13.5+g)],"bottom-right":[-g,-1*(38.1-13.5+g)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var a,d;const g=(a=this._map)===null||a===void 0?void 0:a.terrain,x=this._map.transform.isLocationOccluded(this._lngLat);if(!g||x){const Q=x?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==Q&&(this._element.style.opacity=Q))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const E=this._map,P=E.terrain.depthAtPoint(this._pos),R=E.terrain.getElevationForLngLatZoom(this._lngLat,E.transform.tileZoom);if(E.transform.lngLatToCameraDepth(this._lngLat,R)-P<.006)return void(this._element.style.opacity=this._opacity);const O=-this._offset.y/E.transform.pixelsPerMeter,j=Math.sin(E.getPitch()*Math.PI/180)*O,$=E.terrain.depthAtPoint(new u.P(this._pos.x,this._pos.y-this._offset.y)),q=E.transform.lngLatToCameraDepth(this._lngLat,R+j)-$>.006;!((d=this._popup)===null||d===void 0)&&d.isOpen()&&q&&this._popup.remove(),this._element.style.opacity=q?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=u.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,a){return(this._opacity===void 0||e===void 0&&a===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const di={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Go=0,uo=!1;const kh={maxWidth:100,unit:"metric"};function Pu(v,e,a){const d=a&&a.maxWidth||100,g=v._container.clientHeight/2,x=v._container.clientWidth/2,E=v.unproject([x-d/2,g]),P=v.unproject([x+d/2,g]),R=Math.round(v.project(P).x-v.project(E).x),O=Math.min(d,R,v._container.clientWidth),j=E.distanceTo(P);if(a&&a.unit==="imperial"){const $=3.2808*j;$>5280?zl(e,O,$/5280,v._getUIString("ScaleControl.Miles")):zl(e,O,$,v._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?zl(e,O,j/1852,v._getUIString("ScaleControl.NauticalMiles")):j>=1e3?zl(e,O,j/1e3,v._getUIString("ScaleControl.Kilometers")):zl(e,O,j,v._getUIString("ScaleControl.Meters"))}function zl(v,e,a,d){const g=(function(x){const E=Math.pow(10,`${Math.floor(x)}`.length-1);let P=x/E;return P=P>=10?10:P>=5?5:P>=3?3:P>=2?2:P>=1?1:(function(R){const O=Math.pow(10,Math.ceil(-Math.log(R)/Math.LN10));return Math.round(R*O)/O})(P),E*P})(a);v.style.width=e*(g/a)+"px",v.innerHTML=`${g}&nbsp;${d}`}const Sc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Du=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ec(v){if(v){if(typeof v=="number"){const e=Math.round(Math.abs(v)/Math.SQRT2);return{center:new u.P(0,0),top:new u.P(0,v),"top-left":new u.P(e,e),"top-right":new u.P(-e,e),bottom:new u.P(0,-v),"bottom-left":new u.P(e,-e),"bottom-right":new u.P(-e,-e),left:new u.P(v,0),right:new u.P(-v,0)}}if(v instanceof u.P||Array.isArray(v)){const e=u.P.convert(v);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:u.P.convert(v.center||[0,0]),top:u.P.convert(v.top||[0,0]),"top-left":u.P.convert(v["top-left"]||[0,0]),"top-right":u.P.convert(v["top-right"]||[0,0]),bottom:u.P.convert(v.bottom||[0,0]),"bottom-left":u.P.convert(v["bottom-left"]||[0,0]),"bottom-right":u.P.convert(v["bottom-right"]||[0,0]),left:u.P.convert(v.left||[0,0]),right:u.P.convert(v.right||[0,0])}}return Ec(new u.P(0,0))}const sr=L;T.AJAXError=u.cI,T.Event=u.l,T.Evented=u.E,T.LngLat=u.V,T.MercatorCoordinate=u.aa,T.Point=u.P,T.addProtocol=u.cJ,T.config=u.a,T.removeProtocol=u.cK,T.AttributionControl=ti,T.BoxZoomHandler=Ud,T.CanvasSource=ic,T.CooperativeGesturesHandler=Ds,T.DoubleClickZoomHandler=ao,T.DragPanHandler=Dl,T.DragRotateHandler=Rl,T.EdgeInsets=Bn,T.FullscreenControl=class extends u.E{constructor(v={}){super(),this._onFullscreenChange=()=>{var e;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=a?.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,v&&v.container&&(v.container instanceof HTMLElement?this._container=v.container:u.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=J.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){J.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const v=this._fullscreenButton=J.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);J.create("span","maplibregl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.title=v}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new u.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new u.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},T.GeoJSONSource=qi,T.GeolocateControl=class extends u.E{constructor(v){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new u.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new u.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const a=new u.V(e.coords.longitude,e.coords.latitude),d=e.coords.accuracy,g=this._map.getBearing(),x=u.e({bearing:g},this.options.fitBoundsOptions),E=ui.fromLngLat(a,d);this._map.fitBounds(E,x,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const a=new u.V(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=e.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=e=>{if(this._map){if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&uo)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new u.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this._geolocateButton=J.create("button","maplibregl-ctrl-geolocate",this._container),J.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){u.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=J.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Mu({element:this._dotElement}),this._circleElement=J.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Mu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(a=>{const d=a?.[0]instanceof ResizeObserverEntry;a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||d||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new u.l("trackuserlocationend")),this.fire(new u.l("userlocationlostfocus")))}))}},this.options=u.e({},di,v)}onAdd(v){return this._map=v,this._container=J.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return u._(this,arguments,void 0,(function*(e=!1){if(jr!==void 0&&!e)return jr;if(window.navigator.permissions===void 0)return jr=!!window.navigator.geolocation,jr;try{jr=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{jr=!!window.navigator.geolocation}return jr}))})().then((e=>this._finishSetupUI(e))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),J.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,Go=0,uo=!1}_isOutOfMapMaxBounds(v){const e=this._map.getMaxBounds(),a=v.coords;return e&&(a.longitude<e.getWest()||a.longitude>e.getEast()||a.latitude<e.getSouth()||a.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const v=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&v))return;const e=this._map.project(v),a=this._map.unproject([e.x+100,e.y]),d=v.distanceTo(a)/100,g=2*this._accuracy/d;this._circleElement.style.width=`${g.toFixed(2)}px`,this._circleElement.style.height=`${g.toFixed(2)}px`}trigger(){if(!this._setup)return u.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Go--,uo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new u.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.l("trackuserlocationstart")),this.fire(new u.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let v;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Go++,Go>1?(v={maximumAge:6e5,timeout:0},uo=!0):(v=this.options.positionOptions,uo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,v)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},T.GlobeControl=class{constructor(){this._toggleProjection=()=>{var v;const e=(v=this._map.getProjection())===null||v===void 0?void 0:v.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var v;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((v=this._map.getProjection())===null||v===void 0?void 0:v.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(v){return this._map=v,this._container=J.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=J.create("button","maplibregl-ctrl-globe",this._container),J.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){J.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},T.Hash=$i,T.ImageSource=Hr,T.KeyboardHandler=so,T.LngLatBounds=ui,T.LogoControl=Xi,T.Map=class extends zh{constructor(v){var e,a;u.cF.mark(u.cG.create);const d=Object.assign(Object.assign(Object.assign({},hi),v),{canvasContextAttributes:Object.assign(Object.assign({},hi.canvasContextAttributes),v.canvasContextAttributes)});if(d.minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const g=new $n,x=new ur;if(d.minZoom!==void 0&&g.setMinZoom(d.minZoom),d.maxZoom!==void 0&&g.setMaxZoom(d.maxZoom),d.minPitch!==void 0&&g.setMinPitch(d.minPitch),d.maxPitch!==void 0&&g.setMaxPitch(d.maxPitch),d.renderWorldCopies!==void 0&&g.setRenderWorldCopies(d.renderWorldCopies),d.transformConstrain!==null&&g.setConstrainOverride(d.transformConstrain),super(g,x,{bearingSnap:d.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Lh,this._controls=[],this._mapId=u.ag(),this._lostContextStyle={style:null,images:null},this._contextLost=P=>{P.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.painter.destroy();for(const R of Object.values(this.style._layers))if(R.type==="custom"&&console.warn(`Custom layer with id '${R.id}' cannot be restored after WebGL context loss. You will need to re-add it manually after context restoration.`),R._listeners)for(const[O]of Object.entries(R._listeners))console.warn(`Custom layer with id '${R.id}' had event listeners for event '${O}' which cannot be restored after WebGL context loss. You will need to re-add them manually after context restoration.`);this._lostContextStyle=this._getStyleAndImages(),this.style.destroy(),this.style=null,this.fire(new u.l("webglcontextlost",{originalEvent:P}))},this._contextRestored=P=>{this._lostContextStyle.style&&this.setStyle(this._lostContextStyle.style,{diff:!1}),this._lostContextStyle.images&&(this.style.imageManager.images=this._lostContextStyle.images),this._setupPainter(),this.resize(),this._update(),this.fire(new u.l("webglcontextrestored",{originalEvent:P}))},this._onMapScroll=P=>{if(P.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=d.interactive,this._maxTileCacheSize=d.maxTileCacheSize,this._maxTileCacheZoomLevels=d.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},d.canvasContextAttributes),this._trackResize=d.trackResize===!0,this._bearingSnap=d.bearingSnap,this._centerClampedToGround=d.centerClampedToGround,this._refreshExpiredTiles=d.refreshExpiredTiles===!0,this._fadeDuration=d.fadeDuration,this._crossSourceCollisions=d.crossSourceCollisions===!0,this._collectResourceTiming=d.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},on),d.locale),this._clickTolerance=d.clickTolerance,this._overridePixelRatio=d.pixelRatio,this._maxCanvasSize=d.maxCanvasSize,this._zoomLevelsToOverscale=d.experimentalZoomLevelsToOverscale,this.transformCameraUpdate=d.transformCameraUpdate,this.transformConstrain=d.transformConstrain,this.cancelPendingTileRequestsWhileZooming=d.cancelPendingTileRequestsWhileZooming===!0,d.reduceMotion!==void 0&&(it.prefersReducedMotion=d.reduceMotion),this._imageQueueHandle=Nt.addThrottleControl((()=>this.isMoving())),this._requestManager=new Kt(d.transformRequest),typeof d.container=="string"){if(this._container=document.getElementById(d.container),!this._container)throw new Error(`Container '${d.container}' not found.`)}else{if(!(d.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(d.maxBounds&&this.setMaxBounds(d.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let P=!1;const R=eo((O=>{this._trackResize&&!this._removed&&(this.resize(O),this.redraw())}),50);this._resizeObserver=new ResizeObserver((O=>{P?R(O):P=!0})),this._resizeObserver.observe(this._container)}this.handlers=new Il(this,d),this._hash=d.hash&&new $i(typeof d.hash=="string"&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,elevation:d.elevation,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,roll:d.roll}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,u.e({},d.fitBoundsOptions,{duration:0}))));const E=typeof d.style=="string"||((a=(e=d.style)===null||e===void 0?void 0:e.projection)===null||a===void 0?void 0:a.type)!=="globe";this.resize(null,E),this._localIdeographFontFamily=d.localIdeographFontFamily,this._validateStyle=d.validateStyle,d.style&&this.setStyle(d.style,{localIdeographFontFamily:d.localIdeographFontFamily}),d.attributionControl&&this.addControl(new ti(typeof d.attributionControl=="boolean"?void 0:d.attributionControl)),d.maplibreLogo&&this.addControl(new Xi,d.logoPosition),this.on("style.load",(()=>{if(E||this._resizeTransform(),this.transform.unmodified){const P=u.U(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(P)}})),this.on("data",(P=>{this._update(P.dataType==="style"),this.fire(new u.l(`${P.dataType}data`,P))})),this.on("dataloading",(P=>{this.fire(new u.l(`${P.dataType}dataloading`,P))})),this.on("dataabort",(P=>{this.fire(new u.l("sourcedataabort",P))}))}_getMapId(){return this._mapId}setGlobalStateProperty(v,e){return this.style.setGlobalStateProperty(v,e),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(v,e){if(e===void 0&&(e=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new u.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=v.onAdd(this);this._controls.push(v);const d=this._controlPositions[e];return e.indexOf("bottom")!==-1?d.insertBefore(a,d.firstChild):d.appendChild(a),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new u.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(v);return e>-1&&this._controls.splice(e,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}coveringTiles(v){return Qe(this.transform,v)}calculateCameraOptionsFromTo(v,e,a,d){return d==null&&this.terrain&&(d=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(v,e,a,d)}resize(v,e=!0){const[a,d]=this._containerDimensions(),g=this._getClampedPixelRatio(a,d);if(this._resizeCanvas(a,d,g),this.painter.resize(a,d,g),this.painter.overLimit()){const E=this.painter.context.gl;this._maxCanvasSize=[E.drawingBufferWidth,E.drawingBufferHeight];const P=this._getClampedPixelRatio(a,d);this._resizeCanvas(a,d,P),this.painter.resize(a,d,P)}this._resizeTransform(e);const x=!this._moving;return x&&(this.stop(),this.fire(new u.l("movestart",v)).fire(new u.l("move",v))),this.fire(new u.l("resize",v)),x&&this.fire(new u.l("moveend",v)),this}_resizeTransform(v=!0){var e;const[a,d]=this._containerDimensions();this.transform.resize(a,d,v),(e=this._requestedCameraState)===null||e===void 0||e.resize(a,d,v)}_getClampedPixelRatio(v,e){const{0:a,1:d}=this._maxCanvasSize,g=this.getPixelRatio(),x=v*g,E=e*g;return Math.min(x>a?a/x:1,E>d?d/E:1)*g}getPixelRatio(){var v;return(v=this._overridePixelRatio)!==null&&v!==void 0?v:devicePixelRatio}setPixelRatio(v){this._overridePixelRatio=v,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(v){return this.transform.setMaxBounds(ui.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.setMinZoom(v),this._update(),this.getZoom()<v&&this.setZoom(v),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.setMaxZoom(v),this._update(),this.getZoom()>v&&this.setZoom(v),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.setMinPitch(v),this._update(),this.getPitch()<v&&this.setPitch(v),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(v>=this.transform.minPitch)return this.transform.setMaxPitch(v),this._update(),this.getPitch()>v&&this.setPitch(v),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.setRenderWorldCopies(v),this._update()}setTransformConstrain(v){return this.transform.setConstrainOverride(v),this._update()}project(v){return this.transform.locationToScreenPoint(u.V.convert(v),this.style&&this.terrain)}unproject(v){return this.transform.screenPointToLocation(u.P.convert(v),this.terrain)}isMoving(){var v;return this._moving||((v=this.handlers)===null||v===void 0?void 0:v.isMoving())}isZooming(){var v;return this._zooming||((v=this.handlers)===null||v===void 0?void 0:v.isZooming())}isRotating(){var v;return this._rotating||((v=this.handlers)===null||v===void 0?void 0:v.isRotating())}_createDelegatedListener(v,e,a){if(v==="mouseenter"||v==="mouseover"){let d=!1;return{layers:e,listener:a,delegates:{mousemove:x=>{const E=e.filter((R=>this.getLayer(R))),P=E.length!==0?this.queryRenderedFeatures(x.point,{layers:E}):[];P.length?d||(d=!0,a.call(this,new ai(v,this,x.originalEvent,{features:P}))):d=!1},mouseout:()=>{d=!1}}}}if(v==="mouseleave"||v==="mouseout"){let d=!1;return{layers:e,listener:a,delegates:{mousemove:E=>{const P=e.filter((R=>this.getLayer(R)));(P.length!==0?this.queryRenderedFeatures(E.point,{layers:P}):[]).length?d=!0:d&&(d=!1,a.call(this,new ai(v,this,E.originalEvent)))},mouseout:E=>{d&&(d=!1,a.call(this,new ai(v,this,E.originalEvent)))}}}}{const d=g=>{const x=e.filter((P=>this.getLayer(P))),E=x.length!==0?this.queryRenderedFeatures(g.point,{layers:x}):[];E.length&&(g.features=E,a.call(this,g),delete g.features)};return{layers:e,listener:a,delegates:{[v]:d}}}}_saveDelegatedListener(v,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(e)}_removeDelegatedListener(v,e,a){if(!this._delegatedListeners||!this._delegatedListeners[v])return;const d=this._delegatedListeners[v];for(let g=0;g<d.length;g++){const x=d[g];if(x.listener===a&&x.layers.length===e.length&&x.layers.every((E=>e.includes(E)))){for(const E in x.delegates)this.off(E,x.delegates[E]);return void d.splice(g,1)}}}on(v,e,a){if(a===void 0)return super.on(v,e);const d=typeof e=="string"?[e]:e,g=this._createDelegatedListener(v,d,a);this._saveDelegatedListener(v,g);for(const x in g.delegates)this.on(x,g.delegates[x]);return{unsubscribe:()=>{this._removeDelegatedListener(v,d,a)}}}once(v,e,a){if(a===void 0)return super.once(v,e);const d=typeof e=="string"?[e]:e,g=this._createDelegatedListener(v,d,a);for(const x in g.delegates){const E=g.delegates[x];g.delegates[x]=(...P)=>{this._removeDelegatedListener(v,d,a),E(...P)}}this._saveDelegatedListener(v,g);for(const x in g.delegates)this.once(x,g.delegates[x]);return this}off(v,e,a){return a===void 0?super.off(v,e):(this._removeDelegatedListener(v,typeof e=="string"?[e]:e,a),this)}queryRenderedFeatures(v,e){if(!this.style)return[];let a;const d=v instanceof u.P||Array.isArray(v),g=d?v:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(d?{}:v)||{},g instanceof u.P||typeof g[0]=="number")a=[u.P.convert(g)];else{const x=u.P.convert(g[0]),E=u.P.convert(g[1]);a=[x,new u.P(E.x,x.y),E,new u.P(x.x,E.y),x]}return this.style.queryRenderedFeatures(a,e,this.transform)}querySourceFeatures(v,e){return this.style.querySourceFeatures(v,e)}setStyle(v,e){return(e=u.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&v?(this._diffStyle(v,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(v,e))}setTransformRequest(v){return this._requestManager.setTransformRequest(v),this}_getUIString(v){const e=this._locale[v];if(e==null)throw new Error(`Missing UI string '${v}'`);return e}_updateStyle(v,e){var a,d;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(v,e)));const g=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!v)),v?(this.style=new uu(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof v=="string"?this.style.loadURL(v,e,g):this.style.loadJSON(v,e,g),this):((d=(a=this.style)===null||a===void 0?void 0:a.projection)===null||d===void 0||d.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new uu(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,e){if(typeof v=="string"){const a=this._requestManager.transformRequest(v,"Style");u.j(a,new AbortController).then((d=>{this._updateDiff(d.data,e)})).catch((d=>{d&&this.fire(new u.k(d))}))}else typeof v=="object"&&this._updateDiff(v,e)}_updateDiff(v,e){try{this.style.setState(v,e)&&this._update(!0)}catch(a){u.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(v,e)}}getStyle(){if(this.style)return this.style.serialize()}_getStyleAndImages(){return this.style?{style:this.style.serialize(),images:this.style.imageManager.cloneImages()}:{style:null,images:{}}}isStyleLoaded(){return this.style?this.style.loaded():u.w("There is no style added to the map.")}addSource(v,e){return this._lazyInitEmptyStyle(),this.style.addSource(v,e),this._update(!0)}isSourceLoaded(v){const e=this.style&&this.style.tileManagers[v];if(e!==void 0)return e.loaded();this.fire(new u.k(new Error(`There is no tile manager with ID '${v}'`)))}setTerrain(v){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),v){const e=this.style.tileManagers[v.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${v.source}`);this.terrain===null&&e.reload();for(const a in this.style._layers){const d=this.style._layers[a];d.type==="hillshade"&&d.source===v.source&&u.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),d.type==="color-relief"&&d.source===v.source&&u.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new ds(this.painter,e,v),this.painter.renderToTexture=new Fn(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=a=>{var d;a.dataType==="style"?this.terrain.tileManager.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==v.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((d=a.source)===null||d===void 0?void 0:d.type)==="image"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new u.l("terrain",{terrain:v})),this}getTerrain(){var v,e;return(e=(v=this.terrain)===null||v===void 0?void 0:v.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const v=this.style&&this.style.tileManagers;for(const e in v){const a=v[e]._tiles;for(const d in a){const g=a[d];if(g.state!=="loaded"&&g.state!=="errored")return!1}}return!0}removeSource(v){return this.style.removeSource(v),this._update(!0)}getSource(v){return this.style.getSource(v)}setSourceTileLodParams(v,e,a){if(a){const d=this.getSource(a);if(!d)throw new Error(`There is no source with ID "${a}", cannot set LOD parameters`);d.calculateTileZoom=te(Math.max(1,v),Math.max(1,e))}else for(const d in this.style.tileManagers)this.style.tileManagers[d].getSource().calculateTileZoom=te(Math.max(1,v),Math.max(1,e));return this._update(!0),this}refreshTiles(v,e){const a=this.style.tileManagers[v];if(!a)throw new Error(`There is no tile manager with ID "${v}", cannot refresh tile`);e===void 0?a.reload(!0):a.refreshTiles(e.map((d=>new u.ad(d.z,d.x,d.y))))}addImage(v,e,a={}){const{pixelRatio:d=1,sdf:g=!1,stretchX:x,stretchY:E,content:P,textFitWidth:R,textFitHeight:O}=a;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||u.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new u.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:j,height:$,data:q}=e,Q=e;return this.style.addImage(v,{data:new u.R({width:j,height:$},new Uint8Array(q)),pixelRatio:d,stretchX:x,stretchY:E,content:P,textFitWidth:R,textFitHeight:O,sdf:g,version:0,userImage:Q}),Q.onAdd&&Q.onAdd(this,v),this}}{const{width:j,height:$,data:q}=it.getImageData(e);this.style.addImage(v,{data:new u.R({width:j,height:$},q),pixelRatio:d,stretchX:x,stretchY:E,content:P,textFitWidth:R,textFitHeight:O,sdf:g,version:0})}}updateImage(v,e){const a=this.style.getImage(v);if(!a)return this.fire(new u.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const d=e instanceof HTMLImageElement||u.b(e)?it.getImageData(e):e,{width:g,height:x,data:E}=d;if(g===void 0||x===void 0)return this.fire(new u.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(g!==a.data.width||x!==a.data.height)return this.fire(new u.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const P=!(e instanceof HTMLImageElement||u.b(e));return a.data.replace(E,P),this.style.updateImage(v,a),this}getImage(v){return this.style.getImage(v)}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new u.k(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v){return Nt.getImage(this._requestManager.transformRequest(v,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(v,e){return this._lazyInitEmptyStyle(),this.style.addLayer(v,e),this._update(!0)}moveLayer(v,e){return this.style.moveLayer(v,e),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(v,e,a){return this.style.setLayerZoomRange(v,e,a),this._update(!0)}setFilter(v,e,a={}){return this.style.setFilter(v,e,a),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,e,a,d={}){return this.style.setPaintProperty(v,e,a,d),this._update(!0)}getPaintProperty(v,e){return this.style.getPaintProperty(v,e)}setLayoutProperty(v,e,a,d={}){return this.style.setLayoutProperty(v,e,a,d),this._update(!0)}getLayoutProperty(v,e){return this.style.getLayoutProperty(v,e)}setGlyphs(v,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(v,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(v,e,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(v,e,a,(d=>{d||this._update(!0)})),this}removeSprite(v){return this._lazyInitEmptyStyle(),this.style.removeSprite(v),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(v,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(v,e,(a=>{a||this._update(!0)})),this}setLight(v,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(v,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(v,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(v,e){return this.style.setFeatureState(v,e),this._update()}removeFeatureState(v,e){return this.style.removeFeatureState(v,e),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let v=0,e=0;return this._container&&(v=this._container.clientWidth||400,e=this._container.clientHeight||300),[v,e]}_setupContainer(){const v=this._container;v.classList.add("maplibregl-map");const e=this._canvasContainer=J.create("div","maplibregl-canvas-container",v);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=J.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),d=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],d);const g=this._controlContainer=J.create("div","maplibregl-control-container",v),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((E=>{x[E]=J.create("div",`maplibregl-ctrl-${E} `,g)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(v,e,a){this._canvas.width=Math.floor(a*v),this._canvas.height=Math.floor(a*e),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const v=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",(d=>{e={requestedAttributes:v},d&&(e.statusMessage=d.statusMessage,e.type=d.type)}),{once:!0});let a=null;if(a=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,v):this._canvas.getContext("webgl2",v)||this._canvas.getContext("webgl",v),!a){const d="Failed to initialize WebGL";throw e?(e.message=d,new Error(JSON.stringify(e))):new Error(d)}this.painter=new wu(a,this.transform),mt.testSupport(a)}migrateProjection(v,e){super.migrateProjection(v,e),this.painter.transform=v,this.fire(new u.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_render(v){var e,a,d,g,x;const E=this._idleTriggered?this._fadeDuration:0,P=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(v),this._removed)return;let R=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const $=this.transform.zoom,q=rt();this.style.zoomHistory.update($,q);const Q=new u.H($,{now:q,fadeDuration:E,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),nt=Q.crossFadingFactor();nt===1&&nt===this._crossFadingFactor||(R=!0,this._crossFadingFactor=nt),this.style.update(Q)}const O=((a=this.style.projection)===null||a===void 0?void 0:a.transitionState)>0!==P;(d=this.style.projection)===null||d===void 0||d.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((g=this.style.projection)===null||g===void 0?void 0:g.transitionState,(x=this.style.projection)===null||x===void 0?void 0:x.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||O)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,E,this._crossSourceCollisions,O),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,showPadding:this.showPadding}),this.fire(new u.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,u.cF.mark(u.cG.load),this.fire(new u.l("load"))),this.style&&(this.style.hasTransitions()||R)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const j=this._sourcesDirty||this._styleDirty||this._placementDirty;return j||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new u.l("idle")),!this._loaded||this._fullyLoaded||j||(this._fullyLoaded=!0,u.cF.mark(u.cG.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var v;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Nt.removeThrottleControl(this._imageQueueHandle),(v=this._resizeObserver)===null||v===void 0||v.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e?.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),J.remove(this._canvasContainer),J.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),u.cF.clearMetrics(),this._removed=!0,this.fire(new u.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,it.frame(this._frameRequest,(v=>{u.cF.frame(v),this._frameRequest=null;try{this._render(v)}catch(e){if(!u.cH(e)&&!(function(a){return a.message===mc})(e))throw e}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get version(){return zn}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(v){return this._lazyInitEmptyStyle(),this.style.setProjection(v),this._update(!0)}},T.MapMouseEvent=ai,T.MapTouchEvent=Ra,T.MapWheelEvent=As,T.Marker=Mu,T.NavigationControl=class{constructor(v){this._updateZoomButtons=()=>{const e=this._map.getZoom(),a=e===this._map.getMaxZoom(),d=e===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,a)=>{const d=this._map._getUIString(`NavigationControl.${a}`);e.title=d,e.setAttribute("aria-label",d)},this.options=u.e({},Tc,v),this._container=J.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(e=>this._map.zoomIn({},{originalEvent:e}))),J.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(e=>this._map.zoomOut({},{originalEvent:e}))),J.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})})),this._compassIcon=J.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Uo(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){J.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(v,e){const a=J.create("button",v,this._container);return a.type="button",a.addEventListener("click",e),a}},T.Popup=class extends u.E{constructor(v){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&J.remove(this._content),this._container&&(J.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new u.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=J.create("div","maplibregl-popup",this._map.getContainer()),this._tip=J.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const E of this.options.className.split(" "))this._container.classList.add(E);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=oo(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const a=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let d=this.options.anchor;const g=Ec(this.options.offset);if(!d){const E=this._container.offsetWidth,P=this._container.offsetHeight;let R;R=a.y+g.bottom.y<P?["top"]:a.y>this._map.transform.height-P?["bottom"]:[],a.x<E/2?R.push("left"):a.x>this._map.transform.width-E/2&&R.push("right"),d=R.length===0?"bottom":R.join("-")}let x=a.add(g[d]);this.options.subpixelPositioning||(x=x.round()),J.setTransform(this._container,`${lo[d]} translate(${x.x}px,${x.y}px)`),co(this._container,d,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=u.e(Object.create(Sc),v)}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new u.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(v){return this._lngLat=u.V.convert(v),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(document.createTextNode(v))}setHTML(v){const e=document.createDocumentFragment(),a=document.createElement("body");let d;for(a.innerHTML=v;d=a.firstChild,d;)e.appendChild(d);return this.setDOMContent(e)}getMaxWidth(){var v;return(v=this._container)===null||v===void 0?void 0:v.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=J.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(v),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(v){return this._container&&this._container.classList.add(v),this}removeClassName(v){return this._container&&this._container.classList.remove(v),this}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){if(this._container)return this._container.classList.toggle(v)}setSubpixelPositioning(v){this.options.subpixelPositioning=v}_createCloseButton(){this.options.closeButton&&(this._closeButton=J.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(Du);v&&v.focus()}},T.RasterDEMTileSource=da,T.RasterTileSource=To,T.ScaleControl=class{constructor(v){this._onMove=()=>{Pu(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,Pu(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},kh),v)}getDefaultPosition(){return"bottom-left"}onAdd(v){return this._map=v,this._container=J.create("div","maplibregl-ctrl maplibregl-ctrl-scale",v.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){J.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},T.ScrollZoomHandler=Ps,T.Style=uu,T.TerrainControl=class{constructor(v){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=v}onAdd(v){return this._map=v,this._container=J.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=J.create("button","maplibregl-ctrl-terrain",this._container),J.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){J.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},T.TwoFingersTouchPitchHandler=ro,T.TwoFingersTouchRotateHandler=wc,T.TwoFingersTouchZoomHandler=Cu,T.TwoFingersTouchZoomRotateHandler=qd,T.VectorTileSource=Ss,T.VideoSource=nc,T.addSourceType=(v,e)=>u._(void 0,void 0,void 0,(function*(){if(rc(v))throw new Error(`A source type called "${v}" already exists.`);((a,d)=>{pa[a]=d})(v,e)})),T.clearPrewarmedResources=function(){const v=Le;v&&(v.isPreloaded()&&v.numActive()===1?(v.release(Te),Le=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},T.createTileMesh=ou,T.getMaxParallelImageRequests=function(){return u.a.MAX_PARALLEL_IMAGE_REQUESTS},T.getRTLTextPluginStatus=function(){return Ir().getRTLTextPluginStatus()},T.getVersion=function(){return sr},T.getWorkerCount=function(){return Ze.workerCount},T.getWorkerUrl=function(){return u.a.WORKER_URL},T.importScriptInWorkers=function(v){return br().broadcast("IS",v)},T.isTimeFrozen=function(){return pt.isFrozen()},T.now=rt,T.prewarm=function(){Mn().acquire(Te)},T.restoreNow=function(){pt.restoreNow()},T.setMaxParallelImageRequests=function(v){u.a.MAX_PARALLEL_IMAGE_REQUESTS=v},T.setNow=function(v){pt.setNow(v)},T.setRTLTextPlugin=function(v,e){return Ir().setRTLTextPlugin(v,e)},T.setWorkerCount=function(v){Ze.workerCount=v},T.setWorkerUrl=function(v){u.a.WORKER_URL=v}}));var A=p;return A}))})(R_)),R_.exports}var EF=SF();const v_=m0(EF);function CF({places:s,location:c}){const p=Z.useRef(null),_=Z.useRef(null),[S,A]=Z.useState(null),[T,u]=Z.useState(!1),L=Z.useRef([]);return Z.useEffect(()=>{if(p.current)return _.current=new v_.Map({container:p.current,style:"https://demotiles.maplibre.org/style.json",center:[-74.5,40],zoom:2}),_.current.addControl(new v_.NavigationControl),()=>{_.current?.remove()}},[]),Z.useEffect(()=>{if(!_.current||s.length===0)return;const k=()=>{L.current.forEach(mt=>mt.remove()),L.current=[];let B=90,H=-90,W=180,it=-180,pt=!1,rt=0,J=0;if(s.forEach(mt=>{if(mt.coordinates?.latitude&&mt.coordinates?.longitude){pt=!0,B=Math.min(B,mt.coordinates.latitude),H=Math.max(H,mt.coordinates.latitude),W=Math.min(W,mt.coordinates.longitude),it=Math.max(it,mt.coordinates.longitude);const Et=document.createElement("div");Et.className="w-8 h-8 bg-primary rounded-full flex items-center justify-center text-white text-xs font-bold cursor-pointer hover:scale-110 transition-transform shadow-lg",Et.textContent=String(rt+1);const bt=new v_.Marker({element:Et}).setLngLat([mt.coordinates.longitude,mt.coordinates.latitude]).addTo(_.current);Et.addEventListener("click",()=>A(mt)),L.current.push(bt),rt++}else J++}),console.log(`Map: ${rt} markers added, ${J} places without coordinates`),pt&&rt>0){const mt=new v_.LngLatBounds([W,B],[it,H]);_.current.fitBounds(mt,{padding:50})}};if(_.current.isStyleLoaded())k();else return _.current.on("load",k),()=>{_.current?.off("load",k)}},[s]),Z.useEffect(()=>{!T||!_.current||setTimeout(()=>{_.current?.resize()},100)},[T]),F.jsxs(Tb,{open:T,onOpenChange:u,children:[F.jsx(Sb,{asChild:!0,children:F.jsx(xr,{className:"w-full",children:"Open Map"})}),F.jsxs(mv,{className:"max-w-5xl max-h-[90vh] p-0 overflow-hidden",children:[F.jsx(gv,{className:"px-6 pt-6 pb-0",children:F.jsxs(yv,{className:"flex items-center gap-2",children:[F.jsx(lm,{className:"w-5 h-5"}),c," - ",s.length," Places"]})}),F.jsxs("div",{className:"flex gap-4 h-[calc(90vh-120px)] overflow-hidden",children:[F.jsx("div",{className:"flex-1 relative",children:F.jsx("div",{ref:p,className:"w-full h-full"})}),F.jsx("div",{className:"w-80 border-l",children:F.jsx(xv,{className:"h-full",children:F.jsx("div",{className:"p-4 space-y-3",children:s.map(k=>F.jsx(Ql,{className:`p-3 cursor-pointer transition-all ${S?.id===k.id?"ring-2 ring-primary bg-primary/5":"hover:shadow-md"}`,onClick:()=>A(k),children:F.jsxs("div",{className:"flex gap-3",children:[k.image_url&&F.jsx("img",{src:k.image_url,alt:k.name,className:"w-16 h-16 rounded object-cover"}),F.jsxs("div",{className:"flex-1 min-w-0",children:[F.jsx("h4",{className:"font-semibold text-sm line-clamp-2",children:k.name}),F.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[F.jsx(Ox,{className:"w-3 h-3 fill-yellow-400 text-yellow-400"}),F.jsx("span",{className:"text-xs font-medium",children:k.rating}),F.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",k.review_count,")"]})]}),k.distance&&F.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[(k.distance/1609).toFixed(1)," mi away"]})]})]})},k.id))})})})]}),S&&F.jsxs("div",{className:"absolute bottom-4 left-4 bg-white rounded-lg shadow-xl p-4 max-w-sm z-10 border",children:[F.jsxs("div",{className:"flex justify-between items-start mb-2",children:[F.jsx("h3",{className:"font-bold text-lg",children:S.name}),F.jsx("button",{onClick:()=>A(null),children:F.jsx(mm,{className:"w-4 h-4"})})]}),S.image_url&&F.jsx("img",{src:S.image_url,alt:S.name,className:"w-full h-32 rounded object-cover mb-3"}),F.jsxs("div",{className:"space-y-2 text-sm",children:[F.jsxs("div",{className:"flex items-center gap-2",children:[F.jsx(Ox,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),F.jsxs("span",{className:"font-medium",children:[S.rating,"/5"]}),F.jsxs("span",{className:"text-muted-foreground",children:["(",S.review_count," reviews)"]})]}),S.categories&&F.jsx("p",{className:"text-muted-foreground",children:S.categories.map(k=>k.title).join(", ")}),S.distance&&F.jsxs("p",{className:"text-muted-foreground",children:[(S.distance/1609).toFixed(1)," miles away"]}),F.jsxs("div",{className:"flex gap-2 pt-2",children:[S.phone&&F.jsxs("a",{href:`tel:${S.phone}`,className:"flex items-center gap-1 text-primary hover:underline text-xs",children:[F.jsx(AP,{className:"w-3 h-3"})," Call"]}),S.url&&F.jsxs("a",{href:S.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-primary hover:underline text-xs",children:[F.jsx(yP,{className:"w-3 h-3"})," Website"]})]})]})]})]})]})}const AF="/assets/modern_brunch_cafe_interior-8sS7-W4K.png",cT="/assets/scenic_hiking_trail-B6qJSGRD.png",MF="/assets/gourmet_burger_meal-yWQ8nSJh.png",PF="/assets/modern_art_museum-DL__ogBP.png",DF="/assets/friends_dining_at_night-BEnmmDY4.png";function RF(){const{profile:s,user:c,sessionId:p,logout:_,createNewTrip:S,loadTrip:A,toggleFavorite:T,isFavorite:u}=Vf(),[,L]=ny(),[k,B]=Z.useState(!1),[H,W]=Z.useState([]),[it,pt]=Z.useState(!1),[rt,J]=Z.useState("restaurants"),[mt,Et]=Z.useState(null),[bt,Lt]=Z.useState("For You"),[Ot,ee]=Z.useState({});Z.useEffect(()=>{s.isOnboarded||L("/onboarding")},[s.isOnboarded,L]),Z.useEffect(()=>{s.isOnboarded&&s.country&&p&&Nt()},[s.country,s.isOnboarded,p]);const Nt=async(ae="For You",ze=rt)=>{if(!s.country){Et("Location is required. Please update your profile to add a location."),W([]);return}const We=s.country.trim();if(We.length<3){Et('Location is too short. Use format: "City, Country" (e.g., "Tokyo, Japan")'),W([]);return}if(!We.includes(",")){Et('Location must include city and country/state (e.g., "Paris, France" or "New York, NY"). Please update your location in Edit Preferences.'),W([]);return}if(We.length<2){Et("Location must be at least 2 characters"),W([]);return}const Ee=`${ae}-${ze}`;if(Ot[Ee]){W(Ot[Ee]),Lt(ae);return}pt(!0),Et(null);try{const me=s.interests.join(","),jt=await fetch(`/api/yelp/search?location=${encodeURIComponent(s.country)}&term=${encodeURIComponent(ze)}&interests=${encodeURIComponent(me)}&limit=20`);if(jt.ok){const Gt=(await jt.json()).businesses||[];ee(we=>({...we,[Ee]:Gt})),W(Gt),Lt(ae),(!Gt||Gt.length===0)&&Et("No results found. Try a different location or search term.")}else{const Qt=await jt.json();let Gt="Failed to search. ";Qt.error?.suggestion?Gt+=Qt.error.suggestion:Qt.error?.error?.description?Gt+=Qt.error.error.description:typeof Qt.error=="string"?Gt+=Qt.error:Gt+="Please try a more specific location.",Et(Gt),W([])}}catch(me){console.error("Failed to fetch Yelp data:",me),Et("Connection error. Please try again."),W([])}finally{pt(!1)}},Kt=()=>{_(),L("/auth")},xe=()=>{S(),L("/onboarding")};if(!s.isOnboarded)return null;const Ae=H.slice(0,6).map((ae,ze)=>({id:ae.id,name:ae.name,type:ae.categories[0]?.title||"Place",rating:ae.rating,reviews:ae.review_count,image:[AF,cT,MF,PF,DF][ze%5],tags:ae.categories.slice(0,3).map(We=>We.title),distance:`${(ae.distance/1609).toFixed(1)} mi`,price:ae.price||"$",aiReason:`Highly rated ${ae.categories[0]?.title||"place"} with ${ae.review_count} reviews`}));return F.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20 md:pb-0",children:[F.jsx("header",{className:"sticky top-0 z-50 bg-white/80 backdrop-blur-lg border-b border-border/50",children:F.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 h-16 flex items-center justify-between",children:[F.jsxs("div",{className:"flex items-center gap-4",children:[F.jsxs(gF,{open:k,onOpenChange:B,children:[F.jsx(yF,{asChild:!0,children:F.jsx(xr,{variant:"ghost",size:"icon",children:F.jsx(xP,{className:"w-6 h-6"})})}),F.jsxs(qC,{side:"left",className:"w-[300px]",children:[F.jsx(ZC,{children:F.jsx($C,{children:"My Trips"})}),F.jsxs("div",{className:"mt-6 space-y-4",children:[F.jsxs(xr,{onClick:xe,className:"w-full gap-2",children:[F.jsx(o2,{className:"w-4 h-4"})," New Trip"]}),F.jsxs("div",{className:"space-y-2 mt-4",children:[F.jsx("h4",{className:"text-sm font-medium text-muted-foreground px-2",children:"Past Trips"}),s.trips.map(ae=>F.jsxs("div",{onClick:()=>{A(ae.id),B(!1)},className:"p-3 rounded-lg cursor-pointer transition-colors hover:bg-muted flex items-center justify-between group",children:[F.jsxs("div",{children:[F.jsx("div",{className:"font-medium",children:ae.name}),F.jsx("div",{className:"text-xs text-muted-foreground",children:ae.country})]}),F.jsx(E0,{className:"w-4 h-4 opacity-0 group-hover:opacity-100 transition-opacity"})]},ae.id)),s.trips.length===0&&F.jsx("div",{className:"text-sm text-muted-foreground px-2 italic",children:"No saved trips yet"})]})]})]})]}),F.jsxs("div",{className:"flex items-center gap-2",children:[F.jsx("div",{className:"w-8 h-8 bg-primary rounded-lg flex items-center justify-center text-white font-bold text-xl",children:"Y!"}),F.jsx("span",{className:"font-bold text-lg tracking-tight text-foreground hidden sm:block",children:"Yelp! What to do?"})]})]}),F.jsx("div",{className:"flex-1 max-w-md mx-4 hidden sm:block",children:F.jsxs("div",{className:"relative",children:[F.jsx(l2,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),F.jsx(ua,{placeholder:`Search places in ${s.country}...`,value:rt,onChange:ae=>J(ae.target.value),onKeyDown:ae=>ae.key==="Enter"&&void Nt(bt,rt),disabled:it,className:"pl-9 bg-secondary/50 border-none focus-visible:ring-1 focus-visible:ring-primary/20 rounded-full disabled:opacity-50"})]})}),F.jsxs("div",{className:"flex items-center gap-4",children:[F.jsxs("button",{className:"p-2 hover:bg-secondary rounded-full transition-colors relative",children:[F.jsx(dP,{className:"w-5 h-5 text-muted-foreground"}),F.jsx("span",{className:"absolute top-2 right-2 w-2 h-2 bg-primary rounded-full"})]}),F.jsxs(f0,{className:"h-9 w-9 border-2 border-white shadow-sm cursor-pointer",children:[F.jsx(PC,{src:`https://api.dicebear.com/7.x/avataaars/svg?seed=${c?.username}`}),F.jsx(p0,{children:c?.username?.charAt(0)})]}),F.jsx(xr,{variant:"ghost",size:"icon",onClick:Kt,title:"Logout",children:F.jsx(TP,{className:"w-5 h-5"})})]})]})}),F.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-8",children:[F.jsxs(Wc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-10 flex flex-col md:flex-row md:items-end justify-between gap-4",children:[F.jsxs("div",{children:[F.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-foreground mb-2",children:s.currentTripName||"Your Trip"}),F.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[F.jsx(lm,{className:"w-4 h-4 text-primary"}),F.jsxs("span",{children:["Exploring ",F.jsx("span",{className:"font-semibold text-foreground",children:s.country})]}),s.companions.length>0&&F.jsxs(F.Fragment,{children:[F.jsx("span",{className:"mx-2",children:""}),F.jsxs("span",{children:["With ",s.companions.length," friends"]})]})]})]}),F.jsxs(xr,{variant:"outline",className:"gap-2",onClick:()=>L("/edit-preferences"),children:[F.jsx(kx,{className:"w-4 h-4"})," Edit Preferences"]})]}),!mt&&H.length>0&&F.jsx("div",{className:"mb-8",children:F.jsxs(xv,{className:"w-full",children:[F.jsxs("div",{className:"flex gap-2 pb-4 min-w-max",children:[["For You","Trending","New"].map(ae=>F.jsx("button",{onClick:()=>{let ze=rt;ae==="Trending"&&(ze="popular"),ae==="New"&&(ze="new"),Nt(ae,ze)},className:`
                      px-4 py-2 rounded-full font-medium text-sm transition-all duration-200 whitespace-nowrap
                      ${bt===ae?"bg-primary text-white shadow-lg shadow-primary/25":"bg-white border border-border/50 text-muted-foreground hover:border-primary/30 hover:text-foreground shadow-sm"}
                    `,children:ae},ae)),s.interests.map(ae=>F.jsx("button",{onClick:()=>void Nt("For You",ae),className:"px-4 py-2 rounded-full font-medium text-sm transition-all duration-200 whitespace-nowrap bg-white border border-border/50 text-muted-foreground hover:border-primary/30 hover:text-foreground shadow-sm",children:ae},ae))]}),F.jsx(Rb,{orientation:"horizontal"})]})}),!mt&&H.length>0&&F.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[F.jsxs("div",{className:"lg:col-span-8 space-y-8",children:[F.jsxs(Wc.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.1},className:"relative rounded-3xl overflow-hidden aspect-2/1 group cursor-pointer",children:[F.jsx("img",{src:cT,alt:"Featured",className:"absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"}),F.jsx("div",{className:"absolute inset-0 bg-linear-to-t from-black/80 via-black/20 to-transparent"}),F.jsxs("div",{className:"absolute bottom-0 left-0 p-6 md:p-8 text-white",children:[F.jsxs("div",{className:"flex gap-2 mb-3",children:[F.jsx(jf,{className:"bg-white/20 backdrop-blur-md hover:bg-white/30 text-white border-none",children:"Top Pick"}),F.jsxs(jf,{className:"bg-primary/80 backdrop-blur-md hover:bg-primary/90 text-white border-none flex items-center gap-1",children:[F.jsx($g,{className:"w-3 h-3"})," AI Choice"]})]}),F.jsx("h2",{className:"text-2xl md:text-4xl font-bold mb-2",children:"Discover Amazing Places"}),F.jsxs("p",{className:"text-white/80 max-w-lg line-clamp-2",children:["Based on your interests in ",F.jsx("span",{className:"font-semibold text-white",children:s.interests.join(", ")}),", we found incredible spots for you."]})]})]}),F.jsxs("div",{children:[F.jsxs("div",{className:"flex items-center justify-between mb-6",children:[F.jsx("h3",{className:"text-xl font-bold",children:"We think you'll love these"}),F.jsx("button",{onClick:()=>void Nt(bt,rt),disabled:it,className:"text-sm font-medium text-primary hover:underline disabled:opacity-50",children:it?"Searching...":"Refresh"})]}),mt&&F.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:mt}),it&&F.jsx("div",{className:"flex items-center justify-center py-12",children:F.jsx(a2,{className:"w-6 h-6 animate-spin text-primary"})}),!it&&H.length===0&&!mt&&F.jsx("div",{className:"flex items-center justify-center py-12 text-muted-foreground",children:F.jsx("p",{children:"No places loaded yet. Try searching or refreshing."})}),F.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Ae.map((ae,ze)=>F.jsx(Wc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*ze+.2},children:F.jsxs(Ql,{className:"overflow-hidden border-none shadow-md hover:shadow-xl transition-all duration-300 group h-full flex flex-col",children:[F.jsxs("div",{className:"relative aspect-4/3 overflow-hidden",children:[F.jsx("img",{src:ae.image,alt:ae.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}),F.jsx("button",{onClick:()=>T(ae.id),className:`absolute top-3 right-3 p-2 backdrop-blur rounded-full transition-colors ${u(ae.id)?"bg-red-500/90 text-white":"bg-white/90 text-muted-foreground hover:text-red-500"}`,children:F.jsx(C0,{className:`w-4 h-4 ${u(ae.id)?"fill-current":""}`})}),F.jsxs("div",{className:"absolute bottom-3 left-3 bg-black/60 backdrop-blur text-white text-xs font-bold px-2 py-1 rounded-md flex items-center gap-1",children:[F.jsx(Ox,{className:"w-3 h-3 fill-current text-yellow-400"}),ae.rating]})]}),F.jsxs(sm,{className:"p-4 flex-1 flex flex-col",children:[F.jsxs("div",{className:"flex justify-between items-start mb-2",children:[F.jsxs("div",{children:[F.jsx("h4",{className:"font-bold text-lg leading-tight group-hover:text-primary transition-colors",children:ae.name}),F.jsx("p",{className:"text-sm text-muted-foreground",children:ae.type})]}),F.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:ae.distance})]}),F.jsx("div",{className:"bg-primary/5 p-2 rounded-md my-3",children:F.jsxs("p",{className:"text-xs text-primary/80 italic flex gap-2",children:[F.jsx($g,{className:"w-3 h-3 shrink-0 mt-0.5"}),ae.aiReason]})}),F.jsxs("div",{className:"flex flex-wrap gap-2 mt-auto pt-2",children:[ae.tags.slice(0,3).map(We=>F.jsx("span",{className:"text-[10px] uppercase tracking-wider font-bold text-muted-foreground bg-secondary px-2 py-1 rounded-md",children:We},We)),F.jsx("span",{className:"text-xs ml-auto font-medium text-foreground px-2 py-1",children:ae.price})]})]})]})},ae.id))})]})]}),F.jsxs("div",{className:"lg:col-span-4 space-y-8",children:[F.jsxs(Ql,{className:"p-0 overflow-hidden border-none shadow-lg",children:[F.jsxs("div",{className:"bg-slate-200 h-48 w-full relative flex items-center justify-center",children:[F.jsx(lm,{className:"w-8 h-8 text-primary animate-bounce"}),F.jsxs("div",{className:"absolute bottom-4 left-4 bg-white/90 backdrop-blur px-3 py-1.5 rounded-lg text-xs font-bold shadow-sm",children:[s.country," Area"]})]}),F.jsxs("div",{className:"p-4",children:[F.jsx("h3",{className:"font-bold mb-1",children:"Your Map"}),F.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["View all ",Ae.length," recommended spots on the map."]}),F.jsx(CF,{places:H.map(ae=>{const ze={id:ae.id,name:ae.name,rating:ae.rating,review_count:ae.review_count,image_url:ae.image_url,coordinates:ae.coordinates,phone:ae.phone,url:ae.url,categories:ae.categories,distance:ae.distance};return ze.coordinates||console.warn(`Place ${ze.name} missing coordinates`),ze}),location:s.country})]})]}),F.jsxs(Ql,{className:"p-5 border-none shadow-md",children:[F.jsxs("h3",{className:"font-bold mb-4 flex items-center gap-2",children:[F.jsx(J_,{className:"w-4 h-4 text-primary"}),"Travel Buddies"]}),F.jsxs("div",{className:"space-y-4",children:[s.companions.map((ae,ze)=>F.jsxs("div",{className:"flex items-center gap-3",children:[F.jsx(f0,{className:"h-8 w-8 bg-orange-100",children:F.jsx(p0,{className:"text-orange-600 text-xs",children:ae.name.charAt(0)})}),F.jsxs("div",{className:"flex-1",children:[F.jsx("p",{className:"text-sm font-medium leading-none",children:ae.name}),F.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:ae.interests.length?ae.interests.join(", "):"Just tagging along"})]})]},ze)),s.companions.length===0&&F.jsx("p",{className:"text-sm text-muted-foreground italic",children:"Flying solo on this one."}),F.jsx(wF,{})]})]})]})]}),(mt||H.length===0)&&F.jsx("div",{className:"flex items-center justify-center py-16 text-center",children:F.jsxs("div",{children:[mt&&F.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700 max-w-md",children:mt}),!mt&&H.length===0&&F.jsxs("div",{className:"space-y-4",children:[F.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:"No places loaded yet"}),F.jsx("p",{className:"text-sm text-muted-foreground",children:"Try refreshing or update your location in Edit Preferences"}),F.jsx("button",{onClick:()=>void Nt(bt,rt),disabled:it,className:"mt-4 px-6 py-2 bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90 disabled:opacity-50",children:it?"Searching...":"Refresh"})]})]})})]})]})}const IF=["Fine Dining","Street Food","Hiking","Museums","Nightlife","Coffee","Shopping","Photography","Live Music","History","Architecture","Nature","Family Friendly","For Kids","Parks & Playgrounds"];function zF(){const{profile:s,updateProfile:c,toggleInterest:p}=Vf(),[,_]=ny(),[S,A]=Z.useState(s),[T,u]=Z.useState(!1);Z.useEffect(()=>{A(s)},[s]);const L=W=>{A(it=>({...it,country:W}))},k=W=>{A(it=>({...it,interests:it.interests.includes(W)?it.interests.filter(pt=>pt!==W):[...it.interests,W]}))},B=()=>{c({country:S.country,interests:S.interests,age:S.age,familyFriendly:S.familyFriendly,kidsAge:S.kidsAge}),u(!0),setTimeout(()=>u(!1),2e3)},H=W=>{A(it=>({...it,kidsAge:(it.kidsAge||[]).includes(W)?(it.kidsAge||[]).filter(pt=>pt!==W):[...it.kidsAge||[],W]}))};return F.jsxs("div",{className:"min-h-screen bg-gray-50",children:[F.jsx("header",{className:"sticky top-0 z-50 bg-white/80 backdrop-blur-lg border-b border-border/50",children:F.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 h-16 flex items-center justify-between",children:[F.jsxs("div",{className:"flex items-center gap-4",children:[F.jsx(xr,{variant:"ghost",size:"icon",onClick:()=>_("/dashboard"),children:F.jsx(cP,{className:"w-5 h-5"})}),F.jsx("h1",{className:"text-xl font-bold",children:"Edit Preferences"})]}),F.jsx(xr,{onClick:B,className:"gap-2",children:T?" Saved":"Save Changes"})]})}),F.jsx("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 py-8",children:F.jsxs("div",{className:"space-y-6",children:[F.jsx(Wc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:F.jsxs(Ql,{children:[F.jsx(T_,{children:F.jsxs(S_,{className:"flex items-center gap-2",children:[F.jsx(lm,{className:"w-5 h-5 text-primary"}),"Destination"]})}),F.jsx(sm,{className:"space-y-4",children:F.jsxs("div",{children:[F.jsx("label",{className:"text-sm font-medium",children:"Where are you traveling?"}),F.jsx(vC,{value:S.country,onChange:L,placeholder:"Enter city and country"}),F.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:'e.g., "Paris, France" or "New York, NY"'})]})})]})}),F.jsx(Wc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:F.jsxs(Ql,{children:[F.jsx(T_,{children:F.jsxs(S_,{className:"flex items-center gap-2",children:[F.jsx(J_,{className:"w-5 h-5 text-primary"}),"Personal Info"]})}),F.jsxs(sm,{className:"space-y-4",children:[F.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[F.jsxs("div",{children:[F.jsx("label",{className:"text-sm font-medium block mb-2",children:"Your Age"}),F.jsx(ua,{type:"number",placeholder:"Age",value:S.age||"",onChange:W=>A(it=>({...it,age:W.target.value?parseInt(W.target.value):void 0})),className:"h-10",min:"0",max:"120"})]}),F.jsxs("div",{children:[F.jsx("label",{className:"text-sm font-medium block mb-2",children:"Family travel"}),F.jsx("button",{onClick:()=>A(W=>({...W,familyFriendly:!W.familyFriendly})),className:`w-full h-10 rounded-lg font-medium text-sm transition-all flex items-center justify-center gap-2 ${S.familyFriendly?"bg-primary text-white shadow-lg shadow-primary/25":"bg-secondary border border-border/50 text-muted-foreground hover:border-primary/30 hover:text-foreground"}`,children:S.familyFriendly?" With kids":" Solo/Adults"})]})]}),S.familyFriendly&&F.jsxs("div",{children:[F.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Kids' Ages"}),F.jsx("div",{className:"flex flex-wrap gap-2",children:[3,5,8,12,16].map(W=>F.jsxs(jf,{variant:(S.kidsAge||[]).includes(W)?"default":"outline",className:"cursor-pointer",onClick:()=>H(W),children:[W," yrs"]},W))})]})]})]})}),F.jsx(Wc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:F.jsxs(Ql,{children:[F.jsx(T_,{children:F.jsxs(S_,{className:"flex items-center gap-2",children:[F.jsx(C0,{className:"w-5 h-5 text-primary"}),"Your Interests"]})}),F.jsxs(sm,{children:[F.jsx("div",{className:"flex flex-wrap gap-2",children:IF.map(W=>F.jsx(jf,{variant:S.interests.includes(W)?"default":"outline",className:"cursor-pointer px-3 py-1.5",onClick:()=>k(W),children:W},W))}),F.jsx("p",{className:"text-xs text-muted-foreground mt-4",children:"Select your interests to get better recommendations"})]})]})}),F.jsxs("div",{className:"flex gap-3",children:[F.jsx(xr,{onClick:B,className:"flex-1",size:"lg",children:T?" Changes Saved":"Save All Changes"}),F.jsx(xr,{variant:"outline",onClick:()=>_("/dashboard"),size:"lg",children:"Cancel"})]})]})})]})}function LF(){const[,s]=ny(),{setSession:c}=Vf(),[p,_]=Z.useState(!0),[S,A]=Z.useState(!1),[T,u]=Z.useState(""),[L,k]=Z.useState({username:"",email:"",password:"",confirmPassword:""}),B=W=>{k(it=>({...it,[W.target.name]:W.target.value}))},H=async W=>{W.preventDefault(),u(""),A(!0);try{const it=p?"/api/auth/login":"/api/auth/signup",pt=p?{username:L.username,password:L.password}:{username:L.username,email:L.email,password:L.password};if(!p&&L.password!==L.confirmPassword){u("Passwords do not match"),A(!1);return}const rt=await fetch(it,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(pt)});if(!rt.ok){const mt=await rt.json();throw new Error(mt.error||"Authentication failed")}const J=await rt.json();c(J.sessionId,J.user),s("/")}catch(it){u(it.message)}finally{A(!1)}};return F.jsxs("div",{className:"min-h-screen w-full bg-background flex items-center justify-center p-4 overflow-hidden relative",children:[F.jsx("div",{className:"absolute top-[-10%] right-[-5%] w-96 h-96 bg-primary/10 rounded-full blur-3xl animate-pulse"}),F.jsx("div",{className:"absolute bottom-[-10%] left-[-5%] w-96 h-96 bg-blue-500/10 rounded-full blur-3xl animate-pulse delay-1000"}),F.jsx(Wc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-md relative z-10",children:F.jsxs(Ql,{className:"p-8 shadow-xl border-none bg-white/80 backdrop-blur-xl",children:[F.jsxs("div",{className:"text-center space-y-2 mb-8",children:[F.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4 text-primary",children:F.jsx($g,{className:"w-6 h-6"})}),F.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:p?"Welcome Back":"Create Account"}),F.jsx("p",{className:"text-muted-foreground",children:p?"Sign in to your account to continue":"Join us to start planning your trips"})]}),F.jsxs("form",{onSubmit:H,className:"space-y-4",children:[F.jsxs("div",{className:"space-y-2",children:[F.jsx(Va,{htmlFor:"username",children:"Username"}),F.jsx(ua,{id:"username",name:"username",placeholder:"Enter your username",value:L.username,onChange:B,required:!0,className:"h-11"})]}),!p&&F.jsxs("div",{className:"space-y-2",children:[F.jsx(Va,{htmlFor:"email",children:"Email"}),F.jsx(ua,{id:"email",name:"email",type:"email",placeholder:"Enter your email",value:L.email,onChange:B,required:!0,className:"h-11"})]}),F.jsxs("div",{className:"space-y-2",children:[F.jsx(Va,{htmlFor:"password",children:"Password"}),F.jsx(ua,{id:"password",name:"password",type:"password",placeholder:"Enter your password",value:L.password,onChange:B,required:!0,className:"h-11"})]}),!p&&F.jsxs("div",{className:"space-y-2",children:[F.jsx(Va,{htmlFor:"confirmPassword",children:"Confirm Password"}),F.jsx(ua,{id:"confirmPassword",name:"confirmPassword",type:"password",placeholder:"Confirm your password",value:L.confirmPassword,onChange:B,required:!0,className:"h-11"})]}),T&&F.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:T}),F.jsxs(xr,{type:"submit",disabled:S,className:"w-full h-11 rounded-xl shadow-lg shadow-primary/20",children:[S?"Loading...":p?"Sign In":"Create Account",!S&&F.jsx(E0,{className:"ml-2 w-4 h-4"})]})]}),F.jsx("div",{className:"mt-6 text-center",children:F.jsxs("p",{className:"text-sm text-muted-foreground",children:[p?"Don't have an account? ":"Already have an account? ",F.jsx("button",{onClick:()=>{_(!p),u("")},className:"text-primary hover:underline font-medium",children:p?"Sign up":"Sign in"})]})})]})})]})}function kF(){const{isAuthenticated:s,profile:c}=Vf();return F.jsxs(kA,{children:[F.jsx(Hp,{path:"/auth",component:LF}),F.jsx(Hp,{path:"/onboarding",children:s?F.jsx(qN,{}):F.jsx(ud,{to:"/auth"})}),F.jsx(Hp,{path:"/edit-preferences",children:s&&c.isOnboarded?F.jsx(zF,{}):s?F.jsx(ud,{to:"/onboarding"}):F.jsx(ud,{to:"/auth"})}),F.jsx(Hp,{path:"/dashboard",children:s&&c.isOnboarded?F.jsx(RF,{}):s?F.jsx(ud,{to:"/onboarding"}):F.jsx(ud,{to:"/auth"})}),F.jsx(Hp,{path:"/",children:s?c.isOnboarded?F.jsx(ud,{to:"/dashboard"}):F.jsx(ud,{to:"/onboarding"}):F.jsx(ud,{to:"/auth"})}),F.jsx(Hp,{component:zI})]})}function OF(){return F.jsx(sM,{client:lM,children:F.jsx(LI,{children:F.jsxs(PI,{children:[F.jsx(yD,{}),F.jsxs("div",{className:"relative",children:[F.jsx(kF,{}),F.jsx("div",{className:"fixed bottom-0 left-0 right-0 h-[5%] pointer-events-none bg-gradient-to-t from-red-500/5 to-transparent"})]})]})})})}pA.createRoot(document.getElementById("root")).render(F.jsx(OF,{}));
